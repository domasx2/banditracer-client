(function(p){var f=function(){throw"Synchronous require() is not supported.";};f.unit={};var m="",j,k,q,r=2E4,n,y=this.importScripts!==void 0,D=!y&&document.getElementsByTagName("head")[0],l=Object.prototype.hasOwnProperty;if(function(){for(var a in{hasOwnProperty:!0})return a}()=="hasOwnProperty")var s=function(a,b,d){for(var c in a)l.call(a,c)&&b.call(d,c)};else var z=["isPrototypeOf","hasOwnProperty","toLocaleString","toString","valueOf"],s=function(a,b,d){for(var c in a)l.call(a,c)&&b.call(d,
c);for(var e=z.length;e--;)c=z[e],l.call(a,c)&&b.call(d,c)};var E=function(a,b){for(var d=0;d<a.length;)b.call(null,a[d],d)===!0?a.splice(d,1):d++},A=function(a,b){var d=a.split("/"),b=b||"";b.length&&b.charAt(b.length-1)!="/"&&(b+="/");var c=b.split("/");c.pop();for(var e;e=d.shift();)e!="."&&(e==".."&&c.length&&c[c.length-1]!=".."?c.pop():c.push(e));return c.join("/")},o=f.unit.resolveModuleId=function(a,b){return a.charAt(0)!="."?a:A(a,b)},t=function(a){return a.charAt(0)!="."?m+a+".js":this._resolveModuleId(a,
m)+".js"},i=function(a){if(!l.call(j,a))return null;return j[a]},F=function(a,b){k.push([a.slice(0),b])},C=function(a,b,d){for(var c=[],e=a.length;e--;){var h=o(a[e],d);i(h);u(h)||c.push(h)}c.length?(F(c,function(){b(v(d))}),B(c)):setTimeout(function(){b(v(d))},0)},v=function(a){var b=function(b){var c=o(b,a);if(b=i(c)){if(b.error)throw"Error loading module";}else throw"Module not loaded";if(!b.exports){b.exports={};for(var c=c.substring(0,c.lastIndexOf("/")+1),e=b.injects,h=[],g=0,w=e.length;g<w;g++)e[g]==
"require"?h.push(v(c)):e[g]=="exports"?h.push(b.exports):e[g]=="module"&&h.push(b.module);b.factory.apply(null,h)}return b.exports};b.ensure=function(b,c){C(b,c,a)};if(n!=null)b.main=i(n).module;return b},B=function(a){for(var b=a.length;b--;){var d=a[b];i(d)==null&&(j[d]={},q(d))}},u=function(a){var b={},d=function(a){if(b[a]==!0)return!0;b[a]=!0;a=i(a);if(!a||!a.defined)return!1;else{for(var a=a.deps||[],e=a.length;e--;)if(!d(a[e]))return!1;return!0}};return d(a)},x=function(){for(var a=0;a<k.length;){for(var b=
k[a][0],d=k[a][1],c=0;c<b.length;)u(b[c])?b.splice(c,1):c++;b.length?a++:(k.splice(a,1),d!=null&&setTimeout(d,0))}};q=function(a){var b,d=function(){var b=i(a);if(!b.defined)b.defined=b.error=!0,x()},c=this.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),e=t(a);c.open("GET",e,!0);c.onreadystatechange=function(){if(c.readyState===4)if(clearTimeout(b),c.status==200||c.status===0){for(var h=c.responseText,g=G(h),w=a.substring(0,a.lastIndexOf("/")+1),i={},k=g.length;k--;)g[k]=
o(g[k],w);try{i[a]=p("\r\n"+h+"\r\n")}catch(j){throw j instanceof SyntaxError&&(h="Syntax Error: ",j.lineNumber?h+="line "+(j.lineNumber-581):console.log("GameJs tip: use Firefox to see line numbers in Syntax Errors."),h+=" in file "+e,console.log(h)),j;}f.define(i,g)}else d()};b=setTimeout(d,r);c.send(null)};var G=f.unit.determineShallowDependencies=function(a){for(var b={},d,c=/(?:^|[^\w\$_.])require\s*\(\s*("[^"\\]*(?:\\.[^"\\]*)*"|'[^'\\]*(?:\\.[^'\\]*)*')\s*\)/g;d=c.exec(a);)d=eval(d[1]),l.call(b,
d)||(b[d]=!0);for(c=/(?:^|[^\w\$_.])require.ensure\s*\(\s*(\[("[^"\\]*(?:\\.[^"\\]*)*"|'[^'\\]*(?:\\.[^'\\]*)*'|\s*|,)*\])/g;d=c.exec(a);)for(var e=eval(d[1]),h=e.length;h--;)d=e[h],delete b[d];var g=[];s(b,function(a){g.push(a)});return g},H=function(a){var b=document.createElement("script");b.type="text/javascript";b.src=t(a);var d=!!b.addEventListener,c,e=function(){g(!1)},h=function(){(d||b.readyState=="complete"||b.readyState=="loaded")&&g(i(a).defined)},g=function(g){clearTimeout(c);d?(b.removeEventListener("load",
h,!1),b.removeEventListener("error",e,!1)):b.detachEvent("onreadystatechange",h);if(!g&&(g=i(a),!g.defined))g.defined=g.error=!0,x()};d?(b.addEventListener("load",h,!1),b.addEventListener("error",e,!1)):b.attachEvent("onreadystatechange",h);c=setTimeout(e,r);D.appendChild(b)},I=function(a,b,d){var c={modules:[]},e=["require","exports","module"];typeof a=="object"?(c.deps=b||[],s(a,function(b){var d={id:b};typeof a[b]=="function"?(d.factory=a[b],d.injects=e):(d.factory=a[b].factory,d.injects=a[b].injects||
e);c.modules.push(d)})):(c.deps=b.slice(0),E(c.deps,function(a){a:{for(var b=e.length;b--;)if(e[b]==a){a=b;break a}a=-1}return a>=0}),c.modules.push({id:a,factory:d,injects:b}));return c};f.setModuleRoot=function(a){if(this.window&&!/^http(s?):\/\//.test(a))var b=window.location.href,b=b.substr(0,b.lastIndexOf("/")+1),a=A(a,b);a.length&&a.charAt(a.length-1)!="/"&&(a+="/");m=a};f.getModuleRoot=function(){return m};f.setTimeoutLength=function(a){r=a};f.useScriptTags=function(){q=H};f.def=f.define=function(){for(var a=
I.apply(null,arguments),b=[],d=[],c=a.deps,e=a.modules.length;e--;){var h=a.modules[e],g=h.id,f=i(g);f||(f=j[g]={});f.module={id:g,uri:t(g)};f.defined=!0;f.deps=c.slice(0);f.injects=h.injects;f.factory=h.factory;d.push(f)}for(e=c.length;e--;)g=c[e],f=i(g),(!f||!u(g))&&b.push(g);b.length&&setTimeout(function(){B(b)},0);x()};f.isKnown=function(a){return i(a)!=null};f.isDefined=function(a){a=i(a);return!(!a||!a.defined)};f.ensure=function(a,b){C(a,b,"")};f.run=function(a,b){a=n=o(a,"");f.ensure([a],
function(d){d(a);b!=null&&b()})};f.reset=function(){n=null;j={};k=[];f.define({system:function(){}})};f.reset();y?self.require=f:window.require=f})(function(p){with(this.importScripts?self:window)return new Function("require","exports","module",p)});
require.define({world:function(n,b){var a=n("./utils");n("./weapon_descriptions");n("./combatracer");n("./car_descriptions");n("./cars");n("./weapons");var j=n("./animation"),m=n("./props"),k=n("./settings"),g=n("gamejs");n("./sounds");var e=n("./renderer");n("./buffs");var d=g.utils.math,f=n("./engine");radians=d.radians;degrees=d.degrees;b.MODE_CLIENT=1;b.MODE_SERVER=2;b.MODE_STANDALONE=3;var l=b.World=function(a){f.utils.process_parameters(a,["width","height","ai_waypoints","checkpoints","start_positions",
"mode"]);this.parameters=a;l.superConstructor.apply(this,[a]);this.width=a.width;this.height=a.height;this.size=[this.width,this.height];this.ai_waypoints=a.ai_waypoints;this.checkpoints=a.checkpoints;this.start_positions=a.start_positions;this.mode=a.mode;this.max_waypoint=0;for(var d in this.ai_waypoints)this.max_waypoint=Math.max(this.max_waypoint,d);this.max_checkpoint=0;for(d in this.checkpoints)this.max_checkpoint=Math.max(this.max_checkpoint,d)};g.utils.objects.extend(l,f.World);l.prototype.spawn_animation=
function(d,b,c){this.create(j.AnimationObject,a.copy(j.animations[d],{position:b,follow_obj:c}))};l.prototype.play_sound=function(a,d){k.get("sound")&&f.World.prototype.play_sound.apply(this,["sounds/fx/"+a,d])};b.build_world=function(a,b){var c=k.get("PHYS_SCALE"),f=a.dict,g={};a.start_positions.forEach(function(a){g[a.n]={x:(a.p[0]+30)/c,y:(a.p[1]+30)/c,angle:a.a}});var j={};a.ai_waypoints.forEach(function(a){j[a.n]={x:(a.p[0]+20)/c,y:(a.p[1]+20)/c}});var n={},A,w;a.checkpoints.forEach(function(a){A=
[a.p[0]/c,a.p[1]/c];w=[(a.p[0]+280)/c,(a.p[1]+280)/c];n[a.n]={pt1:A,pt2:w,width:w[0]-A[0],height:w[1]-A[1],center:[(A[0]+w[0])/2,(A[1]+w[1])/2]}});var y=new l({width:a.size[0]/c,height:a.size[1]/c,ai_waypoints:j,checkpoints:n,start_positions:g,mode:b}),G,p,L,J,M;a.props.forEach(function(a){G=d.normaliseDegrees(a.a);p=e.cache.getPropSprite(f[a.f],G);L=p.getSize();p=e.cache.props[f[a.f]].orig;J=p.getSize();M=[J[0]/c,J[1]/c];y.create(m.BoxProp,{filename:f[a.f],position:[(a.p[0]+L[0]/2)/c,(a.p[1]+L[1]/
2)/c],angle:G,size:M})});return y}}},["utils","weapon_descriptions","combatracer","car_descriptions","cars","weapons","animation","props","settings","gamejs","sounds","renderer","buffs","engine"]);
require.define({json:function(n,b){var a;if(!a)b.JSON=a={};(function(){function j(a){return a<10?"0"+a:a}function m(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var d=l[a];return typeof d==="string"?d:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function k(a,c){var b,e,g,j,l=d,w,y=c[a];y&&typeof y==="object"&&typeof y.toJSON==="function"&&(y=y.toJSON(a));typeof h==="function"&&(y=h.call(c,a,y));switch(typeof y){case "string":return m(y);case "number":return isFinite(y)?
String(y):"null";case "boolean":case "null":return String(y);case "object":if(!y)return"null";d+=f;w=[];if(Object.prototype.toString.apply(y)==="[object Array]"){j=y.length;for(b=0;b<j;b+=1)w[b]=k(b,y)||"null";g=w.length===0?"[]":d?"[\n"+d+w.join(",\n"+d)+"\n"+l+"]":"["+w.join(",")+"]";d=l;return g}if(h&&typeof h==="object"){j=h.length;for(b=0;b<j;b+=1)e=h[b],typeof e==="string"&&(g=k(e,y))&&w.push(m(e)+(d?": ":":")+g)}else for(e in y)Object.prototype.hasOwnProperty.call(y,e)&&(g=k(e,y))&&w.push(m(e)+
(d?": ":":")+g);g=w.length===0?"{}":d?"{\n"+d+w.join(",\n"+d)+"\n"+l+"}":"{"+w.join(",")+"}";d=l;return g}}if(typeof Date.prototype.toJSON!=="function")Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+j(this.getUTCMonth()+1)+"-"+j(this.getUTCDate())+"T"+j(this.getUTCHours())+":"+j(this.getUTCMinutes())+":"+j(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var g=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d,f,l={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},h;if(typeof a.stringify!=="function")b.stringify=a.stringify=function(a,c,b){var e;f=d="";if(typeof b==="number")for(e=0;e<b;e+=1)f+=" ";else typeof b==="string"&&(f=b);if((h=c)&&typeof c!=="function"&&(typeof c!=="object"||typeof c.length!=="number"))throw Error("JSON.stringify");return k("",
{"":a})};if(typeof a.parse!=="function")b.parse=a.parse=function(a,c){function d(a,b){var f,e,g=a[b];if(g&&typeof g==="object")for(f in g)Object.prototype.hasOwnProperty.call(g,f)&&(e=d(g,f),e!==void 0?g[f]=e:delete g[f]);return c.call(a,b,g)}var b,a=String(a);g.lastIndex=0;g.test(a)&&(a=a.replace(g,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return b=eval("("+a+")"),typeof c==="function"?d({"":b},""):b;console.log(a);throw new SyntaxError("JSON.parse");}})()}},[]);
require.define({resources:function(n,b){b.props=["9tires.png","3tires.png","tire.png"];b.cars=["bandit_blue.png","bandit_green.png","bandit_red.png","bandit_yellow.png","big_wheel.png","cannon_shell.png","brawler_blue.png","brawler_green.png","brawler_red.png","brawler_yellow.png","bullet.png","missile.png","racer_blue.png","racer_green.png","racer_red.png","racer_yellow.png","wheel.png","sandbug_blue.png","sandbug_green.png","sandbug_red.png","sandbug_yellow.png","missile_homing.png","samaritan_blue.png",
"samaritan_green.png","samaritan_red.png","samaritan_yellow.png","plasma_projectile.png","thunderbolt_blue.png","thunderbolt_green.png","thunderbolt_yellow.png","thunderbolt_red.png"];b.tiles=["sand.png","grass.png","snow.png"];b.animations=["explosion.png","explosion_small.png","sw.png","smoke.png","heal.png","fire64.png","forcefield.png","explosion2.png"];b.ui=["controls.png","garage.png","guncar.png","logo.png","key_bg.png"];b.statics=["mine.png","samaritan_big.png","brawler_big.png","racer_big.png",
"bandit_big.png","icon_machinegun.png","icon_mine.png","icon_missiles.png","ico_damage.png","ico_ammo.png","0stars.png","1stars.png","2stars.png","3stars.png","4stars.png","5stars.png","sandbug_big.png","icon_fix.png","icon_sw.png","icon_missiles_homing.png","ico_nos.png","ico_oil.png","oil_spill.png","icon_plasma.png","icon_flame.png","icon_shield.png","icon_cannon.png","thunderbolt_big.png"];b.levels=["snowpeakcircuit","drycircuit","deathvalley","spiralraceway","greenring","frogfoot","2_icemanloops",
"2_vultureplains","2_queersands","1_bloodbathlane","3_bullpen","3_hunter_end","3_lullabycircuit","3_peril_flats","3_radiator"];b.decals=[,"dideliskampas.png","ilgas.png","trumpas.png","issisakojimas.png","kryzius.png","lenktas.png","paprastas.png","siauras.png","siaurasiplatu.png","siaurejantis1.png","siaurejantis2.png","sonaslenktas1.png","sonaslenktas2.png","startbar.png","susikerta.png","uglyduckling.png","white_bar.png","arrow2.png","arrow3.png","arrow4.png","arrow5.png","arrow.png"];b.sound_fx=
["bullet_impact_metal.wav","bullet_impact_soft.wav","button_click.wav","explosion.wav","machinegun_shot.wav","missile_launch.wav","thud.wav","shockwave.wav","repair.wav","plasma_cannon.wav","fire_cannon.wav"]}},[]);
require.define({leagues:function(n,b){b[0]={name:"Begginer League",tracks:["drycircuit","snowpeakcircuit","greenring","frogfoot","1_bloodbathlane"],bots:["Bob","CatLady","Dominator"],reward_1:1E3,reward_2:600,reward_3:300};b[1]={name:"Veteran League",tracks:["spiralraceway","deathvalley","2_icemanloops","2_vultureplains","2_queersands"],bots:["HotShot","TheDude","Ratman"],reward_1:2E3,reward_2:1E3,reward_3:500};b[2]={name:"Badass League",tracks:["3_bullpen","3_hunter_end","3_lullabycircuit","3_peril_flats",
"3_radiator"],bots:["Bulldog","JC","PainKid"],reward_1:3500,reward_2:2E3,reward_3:1E3}}},[]);
require.define({weapons:function(n,b){var a=n("gamejs"),j=n("./utils");n("./sounds");var m=n("./buffs"),k=n("./weapon_descriptions"),g=a.utils.vectors,e=a.utils.math,m=n("./buffs"),d=n("./engine"),f=n("./settings");radians=e.radians;degrees=e.degrees;var l=n("./animation"),e=function(){var a,c,d,o=this.world.get_objects_by_tag("car");for(a=0;a<o.length;a++)if(c=o[a],c.id!=this.car.id&&(d=g.distance(this.car.get_position(),c.get_position()),c=degrees(g.angle([0,1],this.car.get_local_point(c.get_position()))),
d<20&&c<15))return!0;return!1},h=function(){var a,c,d,o=this.world.get_objects_by_tag("car");for(a=0;a<o.length;a++)if(c=o[a],c.id!=this.car.id&&(d=g.distance(this.car.get_position(),c.get_position()),c=degrees(g.angle([0,-1],this.car.get_local_point(c.get_position()))),d<50&&c<15))return!0;return!1},q=b.Projectile=function(a){a.fixed_rotation=!0;a.bullet=!0;a.linear_damping=0;a.angular_damping=0;q.superConstructor.apply(this,[a]);this.weapon=a.weapon;this.speed=a.speed;this.damage=a.damage;this.position=
a.position;this.angle=a.angle;this.speed=a.speed;this.damage=a.damage;this.car=a.car;this.world=this.car.world;this.add_tag("projectile");this.spent=!1;this.set_speed(this.speed)};a.utils.objects.extend(q,d.Entity);d.register_class(q);q.prototype.impact=function(a){if(a.has_tag("solid")&&!this.spent){this.world.destroy(this);a.has_tag("car")&&a.apply_damage(this.damage,this.car);if(this.onimpact)this.onimpact(a);this.spent=!0}};q.prototype.update=function(){var a=this.get_position();(a[0]<0||a[1]<
0||a[0]>this.car.world.width||a[1]>this.car.world.height)&&this.world.destroy(this)};var c=b.Mine=function(a){a.size=[2,2];a.sensor=!0;a.angle=0;a.fixed_rotation=!0;c.superConstructor.apply(this,[a]);this.car=a.car;this.damage=a.damage;this.add_tag("mine")};a.utils.objects.extend(c,d.Entity);d.register_class(c);c.prototype.impact=function(a){a.has_tag("car")&&(this.world.get_objects_by_tag("car").forEach(function(c){if(c==a||g.distance(this.position,c.get_position())<=8)if(c.apply_damage(this.damage,
this.car),j.push(c,this,15,200),this.onimpact)this.onimpact()},this),this.world.spawn_animation("explosion",this.position),this.world.play_sound("explosion.wav",this.position),this.world.destroy(this))};c.prototype.draw=function(a){a.drawStatic("mine.png",this.position)};var z=b.OilPuddle=function(a){a.size=[4.5,3.5];a.angle=0;a.sensor=!0;a.fixed_rotation=!0;z.superConstructor.apply(this,[a]);this.damage=a.damage;this.car=this.parameters.car;this.drawn=!1};a.utils.objects.extend(z,d.Entity);d.register_class(z);
z.prototype.impact=function(a){a.has_tag("car")&&this.world.create(m.SlipDebuff,{duration:k.Oil.duration,object:a})};z.prototype.draw=function(a){if(!this.drawn){var c=a.cache.getStaticSprite("oil_spill.png"),d=c.getSize(),o=f.get("PHYS_SCALE"),o=[this.position[0]*o,this.position[1]*o];a.background.blit(c,[o[0]-d[0]/2,o[1]-d[1]/2]);this.drawn=!0}};var P=b.Missile=function(a){a.size=[0.5,2.5];a.density=0.3;this.tts=50;P.superConstructor.apply(this,[a]);this.world.play_sound("missile_launch.wav",this.position)};
a.utils.objects.extend(P,q);d.register_class(P);P.prototype.onimpact=function(){var a=this.get_position();this.world.spawn_animation("explosion",a);this.world.play_sound("explosion.wav",a)};P.prototype.draw=function(a){this.spent||a.drawCar("missile.png",this.get_position(),this.get_angle())};P.prototype.update=function(a){this.tts-=a;if(this.tts<0)this.world.spawn_animation("smoke",this.get_world_point([0,1.25])),this.tts=50};var D=b.NapalmFlame=function(a){a.size=[4,4];a.sensor=!0;a.fixed_rotation=
!0;D.superConstructor.apply(this,[a]);this.car=a.car;this.life=6E3;this.damage=a.damage;this.burn_cooldown=200;this.burning={};this.collapse=!1;this.animation=new l.Animation({filename:"fire64.png",duration:800,repeat:!0});this.animation.resize(30,64,800)};a.utils.objects.extend(D,d.Entity);d.register_class(D);D.prototype.impact=function(a){if(a.has_tag("car")&&!this.burning[a.id])a.apply_damage(this.damage,this.car),this.burning[a.id]=this.burn_cooldown};D.prototype.update=function(a){for(var c in this.burning)this.burning[c]-=
a,this.burning[c]<0&&delete this.burning[c];this.animation.update(a);this.life-=a;if(this.life<=800&&!this.collapse)this.animation.resize(64,30,800),this.collapse=!0;this.life<0&&this.world.destroy(this)};D.prototype.draw=function(a){this.animation.draw(a,this.get_position())};var B=b.HomingMissile=function(a){B.superConstructor.apply(this,[a])};a.utils.objects.extend(B,P);d.register_class(B);B.prototype.draw=function(a){this.spent||a.drawCar("missile_homing.png",this.get_position(),this.get_angle())};
B.prototype.update=function(c){this.tts-=c;if(this.tts<0)this.world.spawn_animation("smoke",this.get_world_point([0,1.25])),this.tts=50;var d=null,b=1E6;this.world.objects_by_tag.car.forEach(function(c){if(this.get_local_point(c.get_position())[1]<0){var o=a.utils.vectors.distance(this.get_position(),c.get_position());b>o&&(d=c,b=o)}return!1},this);if(d){var o=this.get_local_point(d.get_position()),p=a.utils.math.radians(this.get_angle());o[0]<0?p+=a.utils.math.radians(-90/700*c):o[0]>0&&(p+=a.utils.math.radians(90/
700*c));this.set_angle(a.utils.math.degrees(p));this.set_speed(this.speed)}};var A=b.Bullet=function(a){a.size=[0.3,0.8];a.density=0.1;A.superConstructor.apply(this,[a]);this.color="#FFD800";this.world.play_sound("machinegun_shot.wav",this.position)};a.utils.objects.extend(A,q);d.register_class(A);A.prototype.onimpact=function(a){var c=this.get_position();this.world.spawn_animation("small_explosion",c);a.has_tag("car")?this.world.play_sound("bullet_impact_metal.wav",c):a.has_tag("prop")&&this.world.play_sound("bullet_impact_soft.wav",
c)};A.prototype.draw=function(a){this.spent||a.drawCar("bullet.png",this.get_position(),this.get_angle())};var w=b.PlasmaProjectile=function(a){a.size=[0.6,2.5];a.sensor=!0;w.superConstructor.apply(this,[a])};a.utils.objects.extend(w,q);d.register_class(w);w.prototype.impact=function(a){if(a.has_tag("car")||a.has_tag("prop"))if(a.has_tag("car")&&a.apply_damage(this.damage,this.car),this.onimpact)this.onimpact(a)};w.prototype.onimpact=function(){this.world.spawn_animation("small_explosion",this.get_position())};
w.prototype.draw=function(a){this.spent||a.drawCar("plasma_projectile.png",this.get_position(),this.get_angle())};var y=b.Weapon=function(a){var o;o=this.pars=j.copy(a,j.copy(k[a.type],{})),a=o;y.superConstructor.apply(this,[a]);this.type=a.type;this.add_tag("weapon");this.car=a.car;this.car[a.slot]=this;this.ammo_capacity=a.ammo_capacity+a.ammo_upgrades*a.ammo_upgrade;this.fire_rate=a.fire_rate;this.ammo=this.cooldown=0;this.damage=a.damage+a.damage_upgrades*a.damage_upgrade;this.speed=a.speed;this.projectile=
a.projectile};a.utils.objects.extend(y,d.Object);d.register_class(y);y.prototype.update=function(a){this.cooldown>0&&(this.cooldown-=a)};y.prototype.reload=function(){this.ammo=this.ammo_capacity};y.prototype._fire=function(){if(this.ammo&&this.cooldown<=0)this.fire(),this.ammo--,this.cooldown=this.fire_rate};y.prototype.AI=function(){return!1};y.prototype.fire=function(){var a=this.get_fire_pos();this.world.create(b[this.projectile],{position:a,damage:this.damage,weapon:this,speed:this.speed,angle:this.car.get_angle(),
car:this.car})};y.prototype.get_fire_pos=function(){return this.car.get_world_point([0,-(this.car.size[1]/2+3)])};var G=b.RepairKit=function(a){G.superConstructor.apply(this,[a]);this.add_tag("repairkit")};a.utils.objects.extend(G,y);d.register_class(G);G.prototype.AI=function(){if(this.car.health<=this.car.max_health/2)return!0;return!1};G.prototype._fire=function(){if(this.ammo&&this.cooldown<=0&&this.car.health<this.car.max_health)this.fire(),this.ammo--,this.cooldown=this.fire_rate};G.prototype.fire=
function(){this.world.spawn_animation("heal",this.car.get_position(),this.car);this.world.play_sound("repair.wav",this.car.get_position());this.car.apply_damage(-this.damage,this.car)};var p=b.Machinegun=function(a){p.superConstructor.apply(this,[a]);this.add_tag("machinegun");this.ofst_x=-0.5};a.utils.objects.extend(p,y);d.register_class(p);p.prototype.AI=h;p.prototype.get_fire_pos=function(){this.ofst_x*=-1;return this.car.get_world_point([this.ofst_x,-(this.car.parameters.size[1]/2+0.9)])};var L=
b.PlasmaCannon=function(a){L.superConstructor.apply(this,[a]);this.add_tag("plasmacannon");this.AI=h};a.utils.objects.extend(L,y);d.register_class(L);L.prototype.fire=function(){var a=this.car.get_world_point([-0.6,-(this.car.parameters.size[1]/2+3)]);this.world.create(b[this.projectile],{position:a,damage:this.damage,speed:this.speed,weapon:this,angle:this.car.get_angle(),car:this.car});this.ammo&&(a=this.car.get_world_point([0.6,-(this.car.parameters.size[1]/2+3)]),this.world.create(b[this.projectile],
{position:a,damage:this.damage,speed:this.speed,weapon:this,angle:this.car.get_angle(),car:this.car}),this.ammo--);this.world.play_sound("plasma_cannon.wav")};var J=b.NOS=function(a){J.superConstructor.apply(this,[a]);this.duration=this.parameters.duration;this.add_tag("nos")};a.utils.objects.extend(J,y);d.register_class(J);J.prototype.AI=function(){if(this.car.get_speed_KMH()>this.car.get_max_speed()-10)return!0;return!1};J.prototype.fire=function(){this.world.create(m.EngineBuff,{duration:this.duration,
value:this.damage,object:this.car})};var M=b.ShockwaveGenerator=function(a){M.superConstructor.apply(this,[a]);this.add_tag("shockwave")};a.utils.objects.extend(M,y);d.register_class(M);M.prototype.AI=function(){var a,c,d=this.world.get_objects_by_tag("car");for(a=0;a<d.length;a++)if(c=d[a],c.id!=this.car.id&&(c=g.distance(this.car.get_position(),c.get_position()),c<=10))return!0;return!1};M.prototype.fire=function(){this.world.get_objects_by_tag("solid").forEach(function(a){if(a.id!=this.car.id){var c=
this.car.get_position(),d=a.get_position();g.distance(c,d)<=12&&(a.apply_damage(this.damage,this.car),j.push(a,this.car,40,500))}},this);this.world.play_sound("shockwave.wav",this.car.get_position());this.world.spawn_animation("shockwave",this.car.get_position(),this.car)};var I=b.MineLauncher=function(a){I.superConstructor.apply(this,[a]);this.add_tag("minelauncher")};a.utils.objects.extend(I,y);d.register_class(I);I.prototype.AI=e;I.prototype.get_fire_pos=function(){return this.car.get_world_point([0,
this.car.parameters.size[1]/2+3])};var C=b.MissileLauncher=function(a){I.superConstructor.apply(this,[a]);this.add_tag("missilelauncher")};a.utils.objects.extend(C,y);d.register_class(C);C.prototype.AI=h;C.prototype.get_fire_pos=function(){return this.car.get_world_point([0,-(this.car.parameters.size[1]/2+3)])};var F=b.Oil=function(a){F.superConstructor.apply(this,[a]);this.add_tag("oil")};a.utils.objects.extend(F,y);d.register_class(F);F.prototype.AI=e;F.prototype.get_fire_pos=function(){return this.car.get_world_point([0,
this.car.parameters.size[1]/2+3])};var R=b.Shield=function(a){R.superConstructor.apply(this,[a]);this.duration=a.duration;this.add_tag("shield")};a.utils.objects.extend(R,y);d.register_class(R);R.prototype.AI=function(){if(this.car.health<=this.car.max_health/3)return!0;return!1};R.prototype._fire=function(){if(this.ammo&&this.cooldown<=0)this.fire(),this.ammo--,this.cooldown=this.fire_rate};R.prototype.fire=function(){this.car.world.create(m.InvulnerabilityBuff,{object:this.car})};var K=b.TankShell=
function(a){a.size=[0.8,1.5];K.superConstructor.apply(this,[a]);this.add_tag("tank_shell");this.world.play_sound("fire_cannon.wav",this.position)};a.utils.objects.extend(K,q);d.register_class(K);K.prototype.impact=function(a){if((a.has_tag("car")||a.has_tag("prop"))&&!this.spent)this.world.destroy(this),this.world.get_objects_by_tag("car").forEach(function(a){if(a.id!=this.car.id){var c=this.get_position(),d=a.get_position();g.distance(c,d)<=5&&(a.apply_damage(this.damage,this.car),this.world.create(m.SlipDebuff,
{duration:500,object:a}),c=g.unit(g.subtract(d,c)),c=g.multiply(c,200),a.apply_impulse(c,a.get_position()))}},this),this.spent=!0,this.world.spawn_animation("explosion2",this.get_position()),this.world.play_sound("explosion.wav",this.position)};K.prototype.draw=function(a){this.spent||a.drawCar("cannon_shell.png",this.get_position(),this.get_angle())}}},["gamejs","utils","sounds","buffs","weapon_descriptions","engine","settings","animation"]);
require.define({engine:function(n,b){game=n("./engine/game");b.initialize_images=function(a){b.preload_list=b.preload_list.concat(a)};b.register_class=function(a){game.register_class(a)};b.get_class_by_id=function(a){return game.get_class_by_id(a)};b.get_id_by_class=function(a){return game.get_id_by_class(a)};b.World=n("./engine/world").World;b.Object=n("./engine/object").Object;b.Entity=n("./engine/entity").Entity;var a=n("./engine/sound");b.Sound=a.Sound;b.SoundObject=a.SoundObject;b.initialize_sounds=
a.initialize;b.play_sound=a.play;b.utils=n("./engine/utils");b.box2d=n("./engine/box2d")}},["engine/game","engine/world","engine/object","engine/entity","engine/sound","engine/utils","engine/box2d"]);
require.define({controllers:function(n,b){var a=n("gamejs"),j=a.utils.vectors;n("./utils");var m=n("./combatracer"),j=a.utils.vectors,k=a.utils.math;radians=k.radians;degrees=k.degrees;var g=b.STEER_NONE=0,e=b.STEER_RIGHT=1,d=b.STEER_LEFT=2,f=b.ACC_NONE=0,l=b.ACC_ACCELERATE=1,h=b.ACC_BRAKE=2,q={1:{FIRE_CHANCE:0.2,MAX_SPEED_BUFF:0,MAX_SPEED_DEBUFF:30},2:{FIRE_CHANCE:0.5,MAX_SPEED_BUFF:10,MAX_SPEED_DEBUFF:25},3:{FIRE_CHANCE:0.6,MAX_SPEED_BUFF:20,MAX_SPEED_DEBUFF:10},4:{FIRE_CHANCE:0.6,MAX_SPEED_BUFF:20,
MAX_SPEED_DEBUFF:10}};b.AIController=function(c,b,f){c.max_steer_angle*=1.1;c.turn_msec=50;this.difficulty=q[m.game.player.singleplayer.difficulty];this.scene=f;this.car=c;this.world=b;this.cur_wp=1;this.ceasfire=!1;this.ceasfire_cur_cooldown=0;this.ceasfire_cooldown=1E3;this.stationary=0;this.update=function(b,f){if(this.car.alive){this.car.accelerate=l;var h=this.world.ai_waypoints[this.cur_wp],z=this.world.ai_waypoints[this.cur_wp<this.world.max_waypoint?this.cur_wp+1:1],q=this.car.get_speed_KMH(),
m=this.scene.player_car.get_race_position(),p=this.car.get_race_position();m<p?c.mod_speed<this.difficulty.MAX_SPEED_BUFF&&(c.mod_speed+=5*(f/1E3)):m>p&&c.mod_speed>-this.difficulty.MAX_SPEED_DEBUFF&&(c.mod_speed-=5*(f/1E3));if(q<6)if(this.car.alive){if(this.stationary+=f,this.stationary>3E3)this.car.teleport([h.x,h.y]),this.stationary=0}else this.stationary=0;else this.stationary=0;m=this.car.get_position();q=this.car.get_local_point([h.x,h.y]);h=j.distance(m,[h.x,h.y]);j.distance(m,[z.x,z.y]);z=
a.utils.math.normaliseDegrees(degrees(j.angle([0,-1],q)));if(h<10||q[1]>0&&h<35)this.cur_wp<this.world.max_waypoint?this.cur_wp++:this.cur_wp=1,h=this.world.ai_waypoints[this.cur_wp];this.car.steer=z>10?q[0]>0?e:d:g;this.ceasfire_cur_cooldown<=0?(this.ceasfire=Math.random()>this.difficulty.FIRE_CHANCE?!0:!1,this.ceasfire_cur_cooldown=this.ceasfire_cooldown):this.ceasfire_cur_cooldown-=f;["front_weapon","util","rear_weapon"].forEach(function(a){this.car[a]&&(this.car["fire_"+a]=this.ceasfire?!1:this.car[a].AI())},
this)}};return this};b.MultiplayerController=function(){this.bindings={accelerate:a.event.K_UP,brake:a.event.K_DOWN,steer_left:a.event.K_LEFT,steer_right:a.event.K_RIGHT,fire_front_weapon:a.event.K_x,fire_rear_weapon:a.event.K_v,fire_util:a.event.K_c};this.actions={accelerate:f,steer:g,fire_front_weapon:!1,fire_rear_weapon:!1,fire_util:!1};this.update=function(a){var b=!1,j,q,m,k;j=a[this.bindings.accelerate]?l:a[this.bindings.brake]?h:f;q=a[this.bindings.steer_right]?e:a[this.bindings.steer_left]?
d:g;m=a[this.bindings.fire_front_weapon]?!0:!1;k=a[this.bindings.fire_rear_weapon]?!0:!1;a=a[this.bindings.util]?!0:!1;if(j!==this.actions.accelerate)this.actions.accelerate=j,b=!0;if(q!==this.actions.steer)this.actions.steer=q,b=!0;if(m!==this.actions.fire_front_weapon)this.actions.fire_front_weapon=m,b=!0;if(k!==this.actions.fire_rear_weapon)this.actions.fire_rear_weapon=k,b=!0;if(a!==this.actions.fire_util)this.actions.fire_util=a,b=!0;return b};return this};b.PlayerCarController=function(c){this.car=
c;this.bindings={accelerate:a.event.K_UP,brake:a.event.K_DOWN,steer_left:a.event.K_LEFT,steer_right:a.event.K_RIGHT,fire_front_weapon:a.event.K_x,fire_rear_weapon:a.event.K_v,fire_util:a.event.K_c};this.update=function(a){if(this.car.alive)this.car.accelerate=a[this.bindings.accelerate]?l:a[this.bindings.brake]?h:f,this.car.steer=a[this.bindings.steer_right]?e:a[this.bindings.steer_left]?d:g,this.car.fire_front_weapon=a[this.bindings.fire_front_weapon]?!0:!1,this.car.fire_rear_weapon=a[this.bindings.fire_rear_weapon]?
!0:!1,this.car.fire_util=a[this.bindings.fire_util]?!0:!1};return this}}},["gamejs","utils","combatracer"]);
require.define({renderer:function(n,b){var a=n("gamejs");n("./utils");var j=a.utils.math;radians=j.radians;degrees=j.degrees;var m=n("./resources"),k=n("./skin"),g=n("./settings"),e=n("./weapon_descriptions");a.font.Font.prototype.size=function(a){return[this.sampleSurface.context.measureText(a).width*4,this.fontHeight]};a.font.Font.prototype.render=function(c,d){var b=this.size(c),f=new a.Surface(b),e=f.context;e.save();e.font=this.sampleSurface.context.font;e.textBaseline=this.sampleSurface.context.textBaseline;
e.textAlign=this.sampleSurface.context.textAlign;e.fillStyle=e.strokeStyle=d||"#000000";e.fillText(c,b[0]/2,f.rect.height,f.rect.width);e.restore();for(var e=0,g=b[0],l,j=new a.surfacearray.SurfaceArray(f),h=!1,e=0;e<j.getSize()[0];e++){for(l=0;l<j.getSize()[1];l++)if(j.get(e,l)[3]!=0){h=!0;break}if(h)break}h=!1;for(g=j.getSize()[0]-1;g>=0;g--){for(l=0;l<j.getSize()[1];l++)if(j.get(g,l)[3]!=0){h=!0;break}if(h)break}b=Math.floor(b[1]);l=new a.Surface([g-e,b]);l.blit(f,new a.Rect([0,0],l.getSize()),
new a.Rect([e,0],[g-e,b]));return l};var d=b.sprite2rotarray=function(c,d){var b={orig:c,0:c,step:d},f=c.getSize(),e;if(f[0]!=f[1]){var g=Math.max(f[0],f[1]);e=new a.Surface(g,g);e.blit(c,[(g-f[0])/2,(g-f[1])/2]);b[0]=e}else e=c,b[0]=c;for(f=d;f<360;f+=d)b[f]=a.transform.rotate(e,f);return b},f=b.ImageCache=function(){this.cars={};this.props={};this.decals={};this.tiles={};this.animations={};this.fonts={};this.ui={};this.alphabet='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890.,:/!?"|()';
this["static"]={};m.tiles.forEach(function(c){this.tiles[c]=a.image.load("images/tiles/"+c)},this);m.props.forEach(function(c){this.props[c]=d(a.image.load("images/props/"+c),5)},this);m.decals.forEach(function(c){this.decals[c]=d(a.image.load("images/decals/"+c),90)},this);m.animations.forEach(function(c){this.animations[c]=a.image.load("images/animations/"+c)},this);m.ui.forEach(function(c){this.ui[c]=a.image.load("images/ui/"+c)},this);m.statics.forEach(function(c){this["static"][c]=a.image.load("images/static/"+
c)},this);this.initFont=function(c,d,b){this.fonts[c]={};for(var d=new a.font.Font(d),f,e=0;e<this.alphabet.length;e++)f=this.alphabet[e],this.fonts[c][f]=d.render(f,b)};this.getDecalSprite=function(a,d){return this.getSpriteFromRotarray(this.decals[a],d)};this.getPropSprite=function(a,d){return this.getSpriteFromRotarray(this.props[a],d)};this.cacheCarSprite=function(c){this.cars[c]||(this.cars[c]=d(a.image.load("images/cars/"+c),2))};this.getCarSprite=function(a,d){this.cars[a]||this.cacheCarSprite(a);
return this.getSpriteFromRotarray(this.cars[a],d)};this.getTile=function(a){return this.tiles[a]};this.getLetter=function(a,d){return this.fonts[a][d]};this.getTextSize=function(a,d){var b=0,f=0,e;if(a){for(var g=0;g<a.length;g++)if(e=a[g],e==" ")b+=8;else if(e=this.getLetter(d,e))f=e.getSize(),b+=f[0],f=f[1];return[b,f]}else return[0,0]};this.getAnimationFrameCount=function(a){a=this.animations[a].getSize();return a[0]/a[1]};this.getAnimationSheet=function(a){return this.animations[a]};this.getUIImage=
function(a){return this.ui[a]};this.getStaticSprite=function(a){return this["static"][a]};this.getSpriteFromRotarray=function(a,d){d=j.normaliseDegrees(d);d%a.step!=0&&(d=parseInt(d/a.step)*a.step);return a[d]};this.initFont("hud",k.fonts.hud[0],k.fonts.hud[1]);return this};b.cache=null;b.init=function(){b.cache=new f;return b.cache};var l=b.Renderer=function(c,d,b){this.width=c;this.height=d;this.cache=b;this.surface=null;this.textLength=function(a,c){for(var d,b=0,f=0;f<a.length;f++)d=a[f],d==" "?
b+=8:(s=this.cache.getLetter(c,d),b+=s.getSize()[0]);return b};this.fillBackground=function(c){a.draw.rect(this.surface,c,new a.Rect([0,0],this.surface.getSize()))};this.drawRect=function(c,d,b,f){a.draw.rect(this.surface,c,new a.Rect(d,b),f||f===0?f:1)};this.drawLine=function(c,d,b,f){a.draw.line(this.surface,c,d,b,f||f===0?f:1)};this.drawText=function(c,d,b,f,e){ofst=b[0];var f=f?f:1,g,p;for(g=0;g<c.length;g++)p=c[g],p==" "?ofst+=8/f:(p=this.cache.getLetter(d,p),f==1?r1=[ofst,b[1]-10]:(size=p.getSize(),
r1=new a.Rect([ofst,b[1]],[parseInt(size[0]/f),parseInt(size[1]/f)])),(e?e:this.surface).blit(p,r1),ofst+=p.getSize()[0]/f)};return this},h=b.UIRenderer=function(a,d,b){h.superConstructor.apply(this,[a,d,b]);this.cache=b;this.surface=null;this.setSurface=function(a){this.surface=a};this.drawUIImage=function(a,c){this.surface.blit(this.cache.getUIImage(a),c)}};a.utils.objects.extend(h,l);var q=b.RaceRenderer=function(c,d,b,f,l,j){q.superConstructor.apply(this,[c,d,l]);this.display_width=c;this.display_height=
d;this.world=b;this.size=[this.width,this.height];this.follow_object=j;this.offset_y=this.offset_x=0;this.background=f;this.surface=null;this.st=new a.Surface(this.display_width*2,this.display_height*2);this.display=null;this.zoom=1;this.r1=new a.Rect([0,0],[this.display_width,this.display_height]);this.r2=new a.Rect([0,0],[this.width,this.height]);this.phys_scale=g.get("PHYS_SCALE");this.follow=function(a){this.follow_object=a};this.updateOffset=function(){if(this.follow_object){var a=this.follow_object.alive?
this.follow_object.get_position():this.follow_object.respawn_location;this.offset_x=Math.min(Math.max(0,a[0]*this.phys_scale-parseInt(this.width/2)),b.width*this.phys_scale-this.width);this.offset_y=Math.min(Math.max(0,a[1]*this.phys_scale-parseInt(this.height/2)),b.height*this.phys_scale-this.height)}return!1};this.getScreenPoint=function(a){return[a[0]*this.phys_scale-this.offset_x,a[1]*this.phys_scale-this.offset_y]};this.drawBackground=function(){this.surface.blit(this.background,new a.Rect([0,
0],[this.width,this.height]),new a.Rect([this.offset_x,this.offset_y],[this.width,this.height]))};this.setZoom=function(c){var d=parseInt(this.display_width/c),b=parseInt(this.display_height/c);if(d<=this.world.width_px&&b<=this.world.height_px)this.zoom=c,this.width=parseInt(this.display_width/c),this.height=parseInt(this.display_height/c),this.r2=new a.Rect([0,0],[this.width,this.height]),this.st=new a.Surface(this.width,this.height)};this.increaseZoom=function(){this.zoom<1&&this.setZoom(this.zoom+
0.01)};this.decreaseZoom=function(){this.zoom>0.5&&this.setZoom(this.zoom-0.01)};this.render=function(a){this.surface=this.zoom==1?a:this.st;this.updateOffset();this.drawBackground();this.world.draw(this);this.zoom!=1&&a.blit(this.surface,this.r1,this.r2)};this.drawLine=function(c,d,b){a.draw.line(this.surface,c,this.getScreenPoint(d),this.getScreenPoint(b),2)};this.drawProp=function(a,c,d){a=this.cache.getPropSprite(a,d?d:0);d=a.getSize()[0]/2;c=this.getScreenPoint(c);this.surface.blit(a,[c[0]-d,
c[1]-d])};this.drawDecal=function(a,c,d){a=this.cache.getDecalSprite(a,d?d:0);d=a.getSize()[0]/2;c=this.getScreenPoint(c);this.surface.blit(a,[c[0]-d,c[1]-d])};this.drawCar=function(a,c,d){a=this.cache.getCarSprite(a,d?d:0);d=a.getSize()[0]/2;c=this.getScreenPoint(c);this.surface.blit(a,[c[0]-d,c[1]-d])};this.drawStatic=function(a,c){var d=this.cache.getStaticSprite(a),b=d.getSize(),c=this.getScreenPoint(c);this.surface.blit(d,[c[0]-b[0]/2,c[1]-b[1]/2])};this.drawAnimation=function(c,d,b,f){var c=
this.cache.getAnimationSheet(c),e=c.getSize()[1],f=f?f:e,d=this.getScreenPoint(d);this.surface.blit(c,new a.Rect([d[0]-f/2,d[1]-f/2],[f,f]),new a.Rect([b*e,0],[e,e]))};this.renderHUD=function(a,c){this.surface=a;this.drawText("FPS: "+parseInt(1E3/c.msDuration),"hud",[10,10]);var d=a.getSize(),b=c.car;if(b){this.drawText("POS: "+b.get_race_position()+"/"+this.world.get_objects_by_tag("car").length,"hud",[d[0]/2-140,10]);this.drawText("LAP: "+b.lap+"/"+c.max_laps,"hud",[d[0]/2+20,10]);this.drawText("SPEED: "+
parseInt(b.get_speed_KMH()),"hud",[10,a.getSize()[1]-40]);var f=250,l=a.getSize()[1]-40;["front_weapon","util","rear_weapon"].forEach(function(a){b[a]&&(this.surface.blit(this.cache.getStaticSprite(e[b[a].type].icon),[f,l-15]),f+=50,this.drawText(String(parseInt(b[a].ammo)),"hud",[f,l]),f+=60)},this)}g.get("DEBUG")&&(c.delta&&this.drawText("D: "+Math.abs(c.delta),"hud",[10,80]),c.bfs&&this.drawText("BFS: "+c.bfs,"hud",[10,140]));if(c.paused)this.drawText("PAUSED","hud",[d[0]/2-100,d[1]/2],0.75);else if(c.message)this.drawText(c.message,
"hud",[d[0]/2-100,d[1]/2],0.75);else{var j=c.time_to_start;j&&(j>3E3?this.drawText("WAITING FOR OTHERS","hud",[d[0]/2-150,d[1]/2]):j>2E3?this.drawText("GET READY 3...","hud",[d[0]/2-150,d[1]/2],0.75):j>1E3?this.drawText("GET READY 2...","hud",[d[0]/2-150,d[1]/2],0.75):j>0?this.drawText("GET READY 1...","hud",[d[0]/2-150,d[1]/2],0.75):j>-1E3&&this.drawText("GO!!!","hud",[d[0]/2-150,d[1]/2],0.75))}};return this};a.utils.objects.extend(q,l)}},["gamejs","utils","resources","skin","settings","weapon_descriptions"]);
require.define({weapon_descriptions:function(n,b){b.Machinegun={damage:5,preload:["bullet.png"],type:"front_weapon",launcher:"Machinegun",projectile:"Bullet",speed:500,fire_rate:200,ammo_capacity:50,damage_upgrade:1,damage_upgrade_price:500,ammo_upgrade:10,ammo_upgrade_price:500,name:"Machineguns",icon:"icon_machinegun.png",price:700,description:"Your basic car accessory: two front mounted high caliber machineguns"};b.MissileLauncher={damage:25,preload:["missile.png"],speed:400,type:"front_weapon",
launcher:"MissileLauncher",projectile:"Missile",fire_rate:600,ammo_capacity:10,ammo_upgrade:2,ammo_upgrade_price:700,damage_upgrade:5,damage_upgrade_price:700,name:"Missiles",icon:"icon_missiles.png",price:1E3,description:"Torpedo missiles with high yield warheads, for when you really don't like the guy in front of you"};b.RepairKit={damage:30,type:"util",launcher:"RepairKit",projectile:null,fire_rate:500,ammo_capacity:2,ammo_upgrade:1,ammo_upgrade_price:500,damage_upgrade:10,damage_upgrade_price:700,
name:"Repair Kit",icon:"icon_fix.png",price:1E3,description:"Repair your car on the go with a automatic repair kit"};b.NOS={damage:15,type:"util",fire_rate:2E3,duration:2E3,ammo_capacity:2,ammo_upgrade:1,ammo_upgrade_price:1500,damage_upgrade:4,damage_upgrade_price:1E3,launcher:"NOS",name:"Boost",price:2E3,icon:"ico_nos.png",description:"Increases top speed and acceleration for a shot time"};b.Shockwave={damage:10,type:"util",fire_rate:1500,ammo_capacity:3,ammo_upgrade:1,ammo_upgrade_price:1300,damage_upgrade:5,
damage_upgrade_price:800,launcher:"ShockwaveGenerator",name:"Shockwave",price:1500,icon:"icon_sw.png",description:"Generates a shockwave that slams nearby cars away from your car"};b.HomingMissiles={damage:18,speed:400,preload:["missile_homing.png"],type:"front_weapon",launcher:"MissileLauncher",projectile:"HomingMissile",fire_rate:500,ammo_capacity:10,ammo_upgrade:2,ammo_upgrade_price:700,damage_upgrade:4,damage_upgrade_price:800,name:"Homing Missiles",price:1300,icon:"icon_missiles_homing.png",
description:"Heat seeking missiles, a blind driver's favourite weapon"};b.MineLauncher={damage:30,type:"rear_weapon",launcher:"MineLauncher",projectile:"Mine",fire_rate:500,ammo_capacity:5,ammo_upgrade:2,ammo_upgrade_price:600,damage_upgrade:8,damage_upgrade_price:500,name:"Mines",icon:"icon_mine.png",price:800,description:"Discourage tailgating with anti-vehicle mines"};b.Oil={damage:0,type:"rear_weapon",fire_rate:500,duration:800,ammo_capacity:2,ammo_upgrade:1,ammo_upgrade_price:2E3,damage_upgrade:null,
damage_upgrade_price:null,name:"Oil",icon:"ico_oil.png",price:2E3,launcher:"Oil",projectile:"OilPuddle",description:"Leave slippery puddles of finest grade oil"};b.Napalm={damage:10,type:"rear_weapon",launcher:"MineLauncher",projectile:"NapalmFlame",fire_rate:160,ammo_capacity:20,ammo_upgrade:5,ammo_upgrade_price:1E3,damage_upgrade:2,damage_upgrade_price:1E3,name:"Napalm",icon:"icon_flame.png",price:2500,description:"Burn your opponents to a crisp"};b.PlasmaCannon={damage:12,speed:500,preload:["plasma_projectile.png"],
type:"front_weapon",launcher:"PlasmaCannon",projectile:"PlasmaProjectile",fire_rate:400,ammo_capacity:24,damage_upgrade:3,damage_upgrade_price:1500,ammo_upgrade:6,ammo_upgrade_price:1500,name:"Plasma Cannon",icon:"icon_plasma.png",price:3E3,description:"Fires super heated blobs of pure plasma that will burn through anything"};b.Shield={damage:0,type:"util",launcher:"Shield",fire_rate:2E3,ammo_capacity:2,ammo_upgrade:1,ammo_upgrade_price:1E3,name:"Force Shield",icon:"icon_shield.png",price:2E3,duration:2E3,
description:"Puts up a forcefield that absorbs 3 hits before disintegrating"};b.Cannon={damage:60,preload:["cannon_shell.png"],type:"front_weapon",launcher:"MissileLauncher",projectile:"TankShell",fire_rate:800,speed:500,ammo_capacity:10,ammo_upgrade:3,ammo_upgrade_price:1500,damage_upgrade:10,damage_upgrade_price:1500,name:"Cannon",icon:"icon_cannon.png",price:4E3,description:"Guns don't get bigger than this massive anti-tank cannon"}}},[]);
require.define({uiscenes:function(n,b){var a=n("gamejs"),j=n("./ui"),m=n("./utils"),k=n("./levels");n("./car_descriptions");var g=n("./gamejs-gui"),e=n("./skin"),d=n("./combatracer");n("./renderer");var f=n("./leagues"),l=n("./sounds"),h=b.CongratulationsScene=function(){h.superConstructor.apply(this,[]);this.titlelbl=new g.Label({parent:this.container,position:[210,40],text:"Congratulations",font:j.getFont("header_black")});this.label=new g.Label({parent:this.container,position:[30,120],text:"You won the game!",
font:j.getFont("header")});this.text=new g.Text({parent:this.container,position:[30,180],font:j.getFont("16_33"),width:500,text:"There are no more leagues yet, which means you win!\nCheck back soon for more cars, weapons and tracks. Follow BanditRacer on twitter!"})};a.utils.objects.extend(h,j.UIScene);var q=b.SPGameOverScene=function(a,c,b){q.superConstructor.apply(this,[]);var p=c==1;this.titlelbl=new g.Label({parent:this.container,position:[210,40],text:"Race Over",font:j.getFont("header_black")});
this.label=new g.Label({parent:this.container,position:[30,120],text:p?"You win! Well done.":"You lose! Better luck next time.",font:j.getFont("header")});new j.Table({parent:this.container,size:[460,300],position:[30,200],columns:[{key:"place",label:"Place",width:80},{key:"player",label:"Player",width:200},{key:"kills",label:"Kills",width:80},{key:"deaths",label:"Deaths",width:80}],data:a});a=f[d.game.player.singleplayer.league];if(d.game.return_to!="editor"){var e=0;new g.Label({position:[510,200],
parent:this.container,font:j.getFont("button2"),text:"Reward"});c>0&&c<4&&(e=a["reward_"+c]);c>0&&(c=c==1?"1st place:":c==2?"2nd place:":c==3?"3d place:":"4th place:",new g.Label({position:[510,240],font:j.getFont("alias"),parent:this.container,text:c}),c=new g.Label({position:[510,240],font:j.getFont("alias"),parent:this.container,text:String(e)+"\u20ac"}),c.rightAlign(730));new g.Label({position:[510,270],font:j.getFont("alias"),parent:this.container,text:"Kills:"});c=new g.Label({position:[510,
270],font:j.getFont("alias"),parent:this.container,text:String(b.player_car.kills*100)+"\u20ac"});c.rightAlign(730);e+=b.player_car.kills*100;new g.Label({position:[510,300],font:j.getFont("alias"),parent:this.container,text:"TOTAL:"});c=new g.Label({position:[510,300],font:j.getFont("alias"),parent:this.container,text:String(e)+"\u20ac"});c.rightAlign(730);d.game.player.singleplayer.balance+=e}this.update=function(a){(new j.UIScene).update.apply(this,[a]);this.congratulate&&this.game.showCongratulations()};
if(p&&(d.game.player.singleplayer.completed_tracks.push(b.level.id),d.game.player.singleplayer.completed_tracks.length>=a.tracks.length))f[d.game.player.singleplayer.league+1]?(d.game.player.singleplayer.league++,d.game.player.singleplayer.completed_tracks=[],this.alert("You have advanced to "+f[d.game.player.singleplayer.league].name+"!")):(this.alert("You win the tournament! Hell difficulty unlocked."),d.game.player.singleplayer.league=0,d.game.player.singleplayer.completed_tracks=[],d.game.player.singleplayer.completed=
!0);d.game.return_to!="editor"&&d.game.save()&&new g.Text({position:[30,510],font:j.getFont("13_green"),parent:this.container,width:460,text:"Game saved to HTML5 storage. You will be able to load it next time you play Bandit Racer on this browser."});(new j.Button({parent:this.container,position:[650,500],size:[150,50],lean:"right",text:"Continue..."})).onClick(function(){this.game.returnTo()},this)};a.utils.objects.extend(q,j.UIScene);var c=b.CreateLobbyScene=function(){c.superConstructor.apply(this,
[]);new g.Label({parent:this.container,position:[210,40],text:"Create Lobby",font:j.getFont("header_black")});new g.Label({parent:this.container,position:[20,150],text:"Title",font:j.getFont("alias")});this.title=new g.TextInput({parent:this.container,position:[20,190],size:[200,34],text:"some game",font:j.getFont("alias")});new g.Label({parent:this.container,position:[20,250],text:"Budget",font:j.getFont("alias")});this.title=new g.TextInput({parent:this.container,position:[20,290],size:[200,34],
text:"10000",font:j.getFont("alias")});this.track_selector=new j.TrackSelector({position:[254,160],parent:this.container,tracks:k.all,label:"Tracks"});this.backbtn=new j.Button({size:[130,50],parent:this.container,position:[0,520],lean:"left",text:"BACK"});this.backbtn.onClick(this.back,this);this.racebtn=new j.Button({size:[130,50],parent:this.container,position:[this.container.size[0]-130,520],lean:"right",text:"CREATE"});this.racebtn.onClick(this.create,this)};a.utils.objects.extend(c,j.UIScene);
c.prototype.back=function(){this.game.showLobbyList()};c.prototype.create=function(){};var z=b.JoinLobbyScene=function(){z.superConstructor.apply(this,[]);this.titlelbl=new g.Label({parent:this.container,position:[210,40],text:"Multiplayer",font:j.getFont("header_black")});this.table=new j.Table({parent:this.container,size:[450,350],position:[300,150],columns:[{key:"title",label:"Title",width:150},{key:"track",label:"Track",width:150},{key:"players",label:"Players",width:150}],data:[]});this.create_btn=
new j.Button({parent:this.container,size:[200,50],lean:"left",position:[0,150],text:"Create Lobby"});this.refresh_btn=new j.Button({parent:this.container,size:[200,50],lean:"left",position:[0,210],text:"Refresh"});this.back_btn=new j.Button({parent:this.container,size:[200,50],lean:"left",position:[0,520],text:"Back"});this.back_btn.onClick(this.returnToTitle,this);this.join_btn=new j.Button({parent:this.container,size:[200,50],lean:"right",position:[this.container.size[0]-200,520],text:"Join"});
this.handleMessage=function(a,c){if(a=="LOBBY_LIST"){for(var d=c.lobbies,b,f=0;f<d.length;f++)b=d[f],b.track=k[b.track].title,b.players=b.playercount;this.table.setData(d,"No lobbies found.")}else a=="JOIN_LOBBY_OK"?this.game.joinLobby(c.lobby_id):this.handleMessageDefault(a,c)};this.refresh_btn.onClick(function(){this.game.getCommunicator().queueMessage("LIST_LOBBIES",{})},this);this.create_btn.onClick(function(){this.game.createLobby()},this);this.game.getCommunicator().queueMessage("LIST_LOBBIES",
{})};a.utils.objects.extend(z,j.UIScene);var P=b.TitleScene=function(c,b){P.superConstructor.apply(this,[c,b]);this.container.on(g.EVT_PAINT,function(){a.draw.polygon(this.surface,e.alias_background,[[0,110],[420,110],[390,180],[0,180]])},this.container);new g.Image({position:[40,260],parent:this.container,image:this.cache.getUIImage("logo.png")});new g.Label({position:[50,115],parent:this.container,font:j.getFont("alias_label"),text:"name:"});this.nameinput=new j.NameInput({position:[178,129],size:[200,
40],text:this.game.player.alias,parent:this.container});this.nameinput.on(g.EVT_CHANGE,function(a){this.game.player.alias=a.value},this);this.btn_single=new j.TitleButton({position:[440,210],size:[360,65],text:"Single player",parent:this.container});this.btn_single.onClick(this.singleplayer,this);this.btn_editor=new j.TitleButton({position:[440,300],size:[360,65],text:"Track Editor",parent:this.container});this.btn_editor.onClick(this.editTrack,this);if(!this.game.tried_loading){if(this.game.haveSave())this.yes_no_dialog=
new j.YesNoDialog({parent:this.gui,size:[550,150],text:"Saved game found. Do you want to load?"}),this.yes_no_dialog.yes.onClick(function(){this.yes_no_dialog.close();this.game.load()&&this.nameinput.setText(d.game.player.alias)},this),this.yes_no_dialog.no.onClick(function(){this.yes_no_dialog.close()},this),this.yes_no_dialog.show();this.game.tried_loading=!0}};a.utils.objects.extend(P,j.UIScene);P.prototype.editTrack=function(){this.game.showEditor()};P.prototype.handleMessage=function(a,c){a==
"HELLO"?(this.game.player.uid=c.uid,this.game.acquainted=!0,this.clearAlert(),this.game.showLobbyList()):this.handleMessageDefault(a,c)};P.prototype.joinLobby=function(){var a=this.game.player.alias;a?(this.alert("Connecting. Please wait...",!1),this.game.getCommunicator().queueMessage("HI",{alias:a})):this.alert("You must enter your name first!")};P.prototype.singleplayer=function(){this.game.singleplayer()};var D=b.SinglePlayerScene=function(){D.superConstructor.apply(this,[]);this.container.header_height=
130;this.container.background_color=e.single_player_scene.background_color;this.container.refresh();this.titlelbl=new g.Label({parent:this.container,position:[210,40],text:"Single Player",font:j.getFont("header_black")});this.backbtn=new j.Button({size:[130,50],parent:this.container,position:[0,520],lean:"left",fill:e.sp_button.fill,font:j.getFont(e.sp_button.font),hover_fill:e.sp_button.fill_hover,text:"BACK"});this.backbtn.onClick(this.back,this);this.racebtn=new j.Button({size:[130,50],parent:this.container,
position:[this.container.size[0]-130,520],lean:"right",fill:e.sp_button.fill,font:j.getFont(e.sp_button.font),hover_fill:e.sp_button.fill_hover,text:"RACE!"});this.racebtn.onClick(this.race,this);this.gotogarage=new j.GoToGarage({position:[14,160],parent:this.container});this.gotogarage.on(g.EVT_MOUSE_DOWN,function(){this.game.return_to="singleplayer";l.play({filename:"button_click.wav"});this.game.showSPGarage()},this);this.car_display=new j.CarDisplay({position:[14,356],gameinfo:d.game.player.singleplayer,
parent:this.container});var a=[];f[d.game.player.singleplayer.league].tracks.forEach(function(c){k[c].title&&!m.inArray(d.game.player.singleplayer.completed_tracks,c)&&a.push(k[c])});this.track_selector=new j.TrackSelector({position:[254,160],parent:this.container,tracks:a,label:f[d.game.player.singleplayer.league].name});this.diff_selector=new j.DifficultySelect({position:[14,431],parent:this.container,size:[210,65]})};a.utils.objects.extend(D,j.UIScene);D.prototype.back=function(){this.game.showTitle()};
D.prototype.race=function(){this.track_selector.track?this.game.playLevel(k[this.track_selector.track],!1,"singleplayer"):this.alert("You must select a track first!",!0)};var B=b.LoadingScene=function(a,c,d){B.superConstructor.apply(this,[a,c]);this.container.destroy();this.gui.center(new g.Label({position:[0,0],parent:this.gui,text:"Loading, please wait...",font:j.getFont("25_66")}));this.next_scene=d};a.utils.objects.extend(B,j.UIScene);var A=b.ControlsSplash=function(a,c,d){A.superConstructor.apply(this,
[a,c]);this.container.destroy();this.next_scene=d;this.gui.on(g.EVT_PAINT,function(){this.surface.fill(e.ui_background)},this.gui);a=new g.Image({position:[0,0],image:c.getUIImage("controls.png"),parent:this.gui});this.gui.center(a);c=a.getPosition()[1]-120;x=a.getPosition()[0];a.move([x,c]);x-=60;c+=a.getSize()[1]+10;new j.KeyExplanation({position:[x,c],key:"x",parent:this.gui,text:"Fire front weapon"});c+=62;new j.KeyExplanation({position:[x,c],key:"c",parent:this.gui,text:"Use utility"});c+=62;
new j.KeyExplanation({position:[x,c],key:"v",parent:this.gui,text:"Fire rear weapon"});c+=62;new j.KeyExplanation({position:[x,c],key:"ESC",parent:this.gui,text:"Menu"});c+=62;this.lbl=new g.Label({position:[x-30,c],parent:this.gui,text:"Loading. Please wait...",font:j.getFont("25_66")});this.first=this.loaded=!1;this.update=function(a){j.UIScene().update.apply(this,[a]);if(this.first){if(!this.loaded)this.game.cacheCarSprites(this.next_scene),this.lbl.setText("Press any key or click to continue..."),
this.gui.despatchEvent({type:g.EVT_FOCUS}),this.gui.on(g.EVT_MOUSE_DOWN,this.next,this),this.gui.on(g.EVT_KEY_DOWN,this.next,this),this.loaded=!0}else this.first=!0}};a.utils.objects.extend(A,j.UIScene);A.prototype.next=function(){this.game.director.replaceScene(this.next_scene)}}},["gamejs","ui","utils","levels","car_descriptions","gamejs-gui","skin","combatracer","renderer","leagues","sounds"]);
require.define({main:function(n,b){function a(){var a=document.createElement("canvas");a.width=e.naturalWidth||e.width;a.height=e.naturalHeight||e.height;a.getContext("2d").drawImage(e,0,0);e.getSize=function(){return[e.naturalWidth,e.naturalHeight]};var b=new j.Surface(e.getSize());b._canvas=a;var l,h=a=null,q=b.getSize();k.init();h=j.display.setMode([k.get("SCREEN_WIDTH"),k.get("SCREEN_HEIGHT")]);j.onTick(function(){var a=h.getSize();j.draw.rect(h,"#FFF",new j.Rect([0,0],a));a=[a[0]/2-q[0]/2,a[1]/
2-q[1]/2-100];h.blit(b,a);if(l){var d=l(),d=Math.min(Math.max(d-0.5,0)*2,1);j.draw.rect(h,"black",new j.Rect([a[0]-100,a[1]+260],[q[0]+200,40]),2);j.draw.rect(h,"black",new j.Rect([a[0]-100,a[1]+260],[(q[0]+200)*d,40]),0)}},this);j.preload(m.get_preload_list());g.init();l=j.ready(function(){(new m.init).start(h)})}var j=n("gamejs"),m=n("./combatracer"),k=n("./settings");n("./skin");var g=n("./levels");n("./engine");j.display.setCaption("Bandit Racer");var e;(b.loadlogo=function(){e=new Image;e.addEventListener("load",
a,!0);e.src=(window.$g&&$g.resourceBaseHref||".")+"/images/ui/logo.png"})()}},["gamejs","combatracer","settings","skin","levels","engine"]);
require.define({garage:function(n,b){var a=n("gamejs"),j=n("./ui");n("./utils");n("./levels");var m=n("./sounds"),k=n("./car_descriptions"),g=n("./weapon_descriptions"),e=n("./gamejs-gui"),d=n("./skin");n("./combatracer");var f=n("./renderer"),l={front_weapon:"Front weapon slot",util:"Utility slot",rear_weapon:"Rear weapon slot"},h={acc_upgrades:"Acceleration",speed_upgrades:"Top Speed",armor_upgrades:"Armor"},q=b.GarageScene=function(a){q.superConstructor.apply(this,[]);this.player_data=a;this.car_descr=
k[this.player_data.car.type];this.container.header_height=130;this.container.background_color=d.garage.background_color;this.container.refresh();this.container.on(e.EVT_PAINT,this.paintBackground,this);this.container.on(e.EVT_AFTER_PAINT,this.afterPaint,this);this.selected_slot=this.selected_item=null;this.titlelbl=new e.Label({parent:this.container,position:[210,40],text:"Garage",font:j.getFont("header_black")});this.backbtn=new j.Button({parent:this.container,size:[130,50],position:[670,530],font:j.getFont(d.garage.back_button.font),
hover_font:j.getFont(d.garage.back_button.hover_font),fill:d.garage.back_button.fill,hover_fill:d.garage.back_button.hover_fill,text:"BACK",lean:"right"});this.buy_car_btn=new j.Button({parent:this.container,size:[300,50],position:[350,530],font:j.getFont("button2_hover"),fill:"#006837",hover_fill:"#00381C",text:"BUY NEW CAR",lean:"both"});this.buy_car_btn.onClick(function(){this.game.showCarDealer(this.player_data)},this);this.balance_label=new e.Label({parent:this.container,font:j.getFont(d.garage.balance_font),
position:[8,172],text:"Balance "+this.player_data.balance+"\u20ac"});new e.Label({parent:this.container,position:[52,234],font:j.getFont(d.garage.car_title_font),text:this.car_descr.name});this.weapon_info=new B({parent:this.container,scene:this,position:[270,160]});this.tuning=new D({parent:this.container,scene:this,position:[537,160]});this.weapon_info.buy_s.button.onClick(this.buyItem,this);this.backbtn.onClick(function(){this.game.returnTo()},this);this.shop=new A({parent:this.container,scene:this,
position:[275,440]});this.shop.on("select",this.selectWeapon,this);this.slots={};this.slots.front_weapon=new EquipmentSlot({parent:this.container,position:[144,295],scene:this,slot_type:"front_weapon"});this.slots.util=new EquipmentSlot({parent:this.container,position:[80,390],scene:this,slot_type:"util"});this.slots.rear_weapon=new EquipmentSlot({parent:this.container,position:[107,505],scene:this,slot_type:"rear_weapon"});for(var c in this.slots)this.slots[c].on("select",this.selectSlot,this);this.slots.front_weapon.select()};
a.utils.objects.extend(q,j.UIScene);q.prototype.selectSlot=function(a){this.shop.selectRow(a.item.slot_type);this.selected_item=this.selected_slot=a.item;this.weapon_info.setItem(a.item)};q.prototype.credit=function(a){if(this.player_data.balance-a<0)return this.alert("Insufficient funds!"),!1;this.player_data.balance-=a;this.balance_label.setText("Balance "+this.player_data.balance+"\u20ac");return!0};q.prototype.buyItem=function(){this.player_data.car[this.selected_slot.slot_type]&&this.selected_item.weapon==
this.player_data.car[this.selected_slot.slot_type].type&&this.alert("This weapon is already equipped!");this.credit(this.selected_item.descr.price)&&(this.player_data.car[this.selected_slot.slot_type]={type:this.selected_item.weapon,ammo_upgrades:0,damage_upgrades:0},this.selected_slot.deselect(),this.selected_slot.select())};q.prototype.deselectSlots=function(){for(var a in this.slots)this.slots[a].deselect()};q.prototype.deselectAll=function(){this.shop.deselectAll();this.deselectSlots()};q.prototype.selectWeapon=
function(a){this.deselectSlots();for(var c in this.slots)if(this.player_data.car[this.slots[c].slot_type]&&a.item.weapon==this.player_data.car[this.slots[c].slot_type].type){a.item.deselect();this.slots[c].select();return}this.weapon_info.setItem(a.item);this.selected_item=a.item};q.prototype.afterPaint=function(){if(this.selected_slot){var c=[];this.selected_slot.slot_type=="front_weapon"?c=[[270,290],[230,290],[230,315],[195,315],[195,320],[230,320],[230,460],[270,460],[270,455],[235,455],[235,
295],[270,295]]:this.selected_slot.slot_type=="util"?c=[[270,290],[230,290],[230,410],[130,410],[130,415],[230,415],[230,460],[270,460],[270,455],[235,455],[235,295],[270,295]]:this.selected_slot.slot_type=="rear_weapon"&&(c=[[270,290],[230,290],[230,525],[157,525],[157,530],[235,530],[235,460],[270,460],[270,455],[235,455],[235,295],[270,295]]);c&&a.draw.polygon(this.container.surface,d.garage.slot_path,c)}};q.prototype.paintBackground=function(){a.draw.polygon(this.container.surface,d.garage.balance_background,
[[0,160],[250,160],[240,210],[0,210]]);a.draw.rect(this.container.surface,d.garage.car_title_background,new a.Rect([45,230],[170,30]));a.draw.rect(this.container.surface,d.garage.car_background,new a.Rect([45,260],[170,310]));var c=f.cache["static"][this.car_descr.art_filename],b=c.getSize(),b=[parseInt(290/b[1]*b[0]),290];this.container.surface.blit(c,[parseInt(45+(170-b[0])/2),270]);a.draw.rect(this.container.surface,d.garage.store_background,new a.Rect([270,435],[515,60]));a.draw.rect(this.container.surface,
d.garage.store_border,new a.Rect([273,438],[509,54]),5);a.draw.rect(this.container.surface,"#333333",new a.Rect([215,242],[322,5]))};EquipmentSlot=b.EquipmentSlot=function(a){a.size=[50,50];EquipmentSlot.superConstructor.apply(this,[a]);this.type="equipment_slot";this.slot_type=a.slot_type;this.selected=!1;this.scene=a.scene;this.on(e.EVT_MOUSE_DOWN,this.select,this);this.on(e.EVT_MOUSE_DOWN,function(){m.play({filename:"button_click.wav"})})};a.utils.objects.extend(EquipmentSlot,e.View);EquipmentSlot.prototype.select=
function(){if(!this.selected)this.scene.deselectAll(),this.selected=!0,this.despatchEvent({type:"select",item:this}),this.refresh()};EquipmentSlot.prototype.deselect=function(){if(this.selected)this.selected=!1,this.refresh()};EquipmentSlot.prototype.paint=function(){this.surface.clear();this.surface.fill(this.selected?d.garage.slot_bg_selected:d.garage.slot_bg);a.draw.rect(this.surface,d.garage.slot_border,new a.Rect([1,1],[48,48]),2);if(this.scene.player_data.car[this.slot_type]){var c=f.cache["static"][g[this.scene.player_data.car[this.slot_type].type].icon],
b=c.getSize();this.surface.blit(c,[parseInt((50-b[0])/2),parseInt((50-b[1])/2)])}};var c=function(a){a.fill=d.garage.white_button.bg;a.hover_fill=d.garage.white_button.bg_hover;a.font=j.getFont(d.garage.white_button.font);a.hover_font=j.getFont(d.garage.white_button.hover_font);a.lean="none";c.superConstructor.apply(this,[a])};a.utils.objects.extend(c,j.Button);var z=function(a){a.fill="#4D4D4D";a.hover_fill="#F2F2F2";a.font=j.getFont(d.garage.white_button.hover_font);a.hover_font=j.getFont(d.garage.white_button.font);
a.lean="none";z.superConstructor.apply(this,[a])};a.utils.objects.extend(z,j.Button);var P=function(a){a.size=[230,45];P.superConstructor.apply(this,[a]);new e.Image({parent:this,position:[10,8],image:f.cache["static"]["ico_ammo.png"]});this.ammo_label=new e.Label({position:[50,14],parent:this,text:"0",font:j.getFont(d.garage.weapon_label_font)});this.damage_icon=new e.Image({parent:this,position:[85,8],image:f.cache["static"]["ico_damage.png"]});this.damage_label=new e.Label({position:[125,14],parent:this,
text:"0",font:j.getFont(d.garage.weapon_label_font)});this.button=new c({position:[175,5],parent:this,size:[50,35],text:"BUY"})};a.utils.objects.extend(P,e.View);P.prototype.paint=function(){this.surface.fill("#CCCCCC")};var D=function(a){a.size=[250,240];D.superConstructor.apply(this,[a]);this.scene=a.scene;this.label=new e.Label({parent:this,font:j.getFont("g_white_title"),position:[20,10],text:"Tuning"});new p({parent:this,position:[10,45],upgrade_type:"acc_upgrades",scene:this.scene});new p({parent:this,
position:[10,110],upgrade_type:"speed_upgrades",scene:this.scene});new p({parent:this,position:[10,175],upgrade_type:"armor_upgrades",scene:this.scene})};a.utils.objects.extend(D,e.View);D.prototype.paint=function(){a.draw.rect(this.surface,d.garage.tuning_title_background,new a.Rect([0,0],[250,40]));a.draw.rect(this.surface,d.garage.tuning_background,new a.Rect([0,40],[250,200]))};var B=function(a){a.size=[250,240];B.superConstructor.apply(this,[a]);this.label=new e.Label({parent:this,font:j.getFont(d.garage.weapon_label_font),
position:[20,10],text:"I"});this.label.setText(" ");this.text=new e.Text({parent:this,width:220,font:j.getFont(d.garage.weapon_info_text_font),position:[15,45],text:"I"});this.scene=a.scene;this.price_label=new e.Label({position:[10,10],parent:this,text:"? \u20ac",font:j.getFont(d.garage.weapon_label_font)});this.price_label.on(e.EVT_RESIZE,function(){this.price_label.move([this.getSize()[0]-this.price_label.getSize()[0]-10,this.price_label.getPosition()[1]])},this);this.buy_s=new P({parent:this,
visible:!1,position:[10,185]});this.damage_upgrade=new L({parent:this,visible:!1,scene:this.scene,upgrade_type:"damage",position:[10,110]});this.ammo_upgrade=new L({parent:this,visible:!1,scene:this.scene,upgrade_type:"ammo",position:[10,165]})};a.utils.objects.extend(B,e.View);B.prototype.paint=function(){a.draw.rect(this.surface,d.garage.weapon_info_title_background,new a.Rect([0,0],[250,40]));a.draw.rect(this.surface,d.garage.weapon_info_background,new a.Rect([0,40],[250,200]))};B.prototype.setItem=
function(a){var c=!1;this.item=a;a.type=="shop_item"?(c=a.descr,this.buy_s.show(),this.ammo_upgrade.hide(),this.damage_upgrade.hide(),this.price_label.show(),this.price_label.setText(c.price+" \u20ac"),this.buy_s.ammo_label.setText(String(c.ammo_capacity)),c.damage_upgrade?(this.buy_s.damage_label.show(),this.buy_s.damage_icon.show(),this.buy_s.damage_label.setText(String(c.damage))):(this.buy_s.damage_label.hide(),this.buy_s.damage_icon.hide())):a.type=="equipment_slot"&&(this.buy_s.hide(),this.price_label.hide(),
this.scene.player_data.car[a.slot_type]?(c=g[this.scene.player_data.car[a.slot_type].type],this.ammo_upgrade.show(),this.ammo_upgrade.setDescr(this.scene.player_data.car[a.slot_type]),c.damage_upgrade?(this.damage_upgrade.show(),this.damage_upgrade.setDescr(this.scene.player_data.car[a.slot_type])):this.damage_upgrade.hide()):(this.ammo_upgrade.hide(),this.damage_upgrade.hide(),this.label.setText(l[a.slot_type]),this.text.setText("This slot is empty. Buy something from the shop below to fill it!")));
c&&(this.label.setText(c.name),this.text.setText(c.description))};var A=b.Shop=function(a){this.rows={};this.items=[];a.size=[510,50];this.scene=a.scene;A.superConstructor.apply(this,[a]);a=new y({parent:this,size:this.getSize(),position:[0,0],type:"front_weapon",visible:!1});this.rows.front_weapon=a;a=new y({parent:this,size:this.getSize(),position:[0,0],type:"util",visible:!1});this.rows.util=a;a=new y({parent:this,size:this.getSize(),position:[0,0],type:"rear_weapon",visible:!1});this.rows.rear_weapon=
a;var c,d;for(d in g)c=g[d],a=this.rows[c.type],a.children.length&&new w({parent:a}),a=new G({parent:a,weapon:d,descr:c}),a.on("select",this.selectItem,this),this.items.push(a);for(var b in this.rows)e.layout.horizontal(this.rows[b].children)};a.utils.objects.extend(A,e.View);A.prototype.deselectAll=function(){this.items.forEach(function(a){a.deselect()})};A.prototype.selectItem=function(a){this.despatchEvent(a)};A.prototype.selectRow=function(a){for(var c in this.rows)c==a?this.rows[c].show():this.rows[c].hide()};
var w=b.ShopItemSep=function(a){a.size=[5,50];w.superConstructor.apply(this,[a])};a.utils.objects.extend(w,e.View);w.prototype.paint=function(){this.surface.clear();a.draw.rect(this.surface,d.garage.store_border,new a.Rect([0,8],[5,34]))};var y=b.ShopItemRow=function(a){this.type=a.type;y.superConstructor.apply(this,[a])};a.utils.objects.extend(y,e.View);var G=b.ShopItem=function(a){this.descr=a.descr;this.weapon=a.weapon;a.size=[50,50];G.superConstructor.apply(this,[a]);this.type="shop_item";this.img=
f.cache["static"][this.descr.icon];this.selected=!1;this.on(e.EVT_MOUSE_DOWN,this.select,this);this.on(e.EVT_MOUSE_DOWN,function(){m.play({filename:"button_click.wav"})})};a.utils.objects.extend(G,e.View);G.prototype.select=function(){if(!this.selected)this.parent.parent.scene.deselectAll(),this.selected=!0,this.despatchEvent({type:"select",item:this}),this.refresh()};G.prototype.paint=function(){e.View.prototype.paint.apply(this,[]);this.selected&&this.surface.fill(d.garage.selected_shop_item_bg);
var a=this.img.getSize();this.surface.blit(this.img,[parseInt((50-a[0])/2),parseInt((50-a[1])/2)])};G.prototype.deselect=function(){if(this.selected)this.selected=!1,this.refresh()};var p=function(a){a.size=[230,60];this.scene=a.scene;this.upgrade_type=a.upgrade_type;this.descr=k[this.scene.player_data.car.type];p.superConstructor.apply(this,[a]);new e.Label({parent:this,position:[20,0],parent:this,font:j.getFont("g_white_title"),text:h[this.upgrade_type]});this.stars=new j.Stars({position:[2,25],
parent:this,stars:this.getValue()});this.price_label=new e.Label({position:[0,29],parent:this,text:this.descr.upgrade_price+"\u20ac",font:j.getFont("g_white_title"),visible:this.getValue()<5});this.button=new z({position:[135,20],parent:this,size:[90,35],text:"UPGRADE",visible:this.getValue()<5});this.button.onClick(this.buy,this);this.price_label.on(e.EVT_RESIZE,function(){this.price_label.move([this.getSize()[0]-this.button.getSize()[0]-this.price_label.getSize()[0]-10,this.price_label.getPosition()[1]])},
this);this.price_label.resize(this.price_label.getSize())};a.utils.objects.extend(p,e.View);p.prototype.getValue=function(){return this.scene.player_data.car[this.upgrade_type]};p.prototype.buy=function(){this.getValue()>=5?this.scene.alert("Upgrade maxed out!"):this.scene.credit(this.descr.upgrade_price)&&(this.scene.player_data.car[this.upgrade_type]++,this.stars.setStars(this.getValue()),this.getValue()>=5&&(this.price_label.hide(),this.button.hide()))};p.prototype.paint=function(){this.surface.clear();
a.draw.rect(this.surface,"#333333",new a.Rect([0,15],[this.getSize()[0],this.getSize()[1]-15]))};var L=function(a){a.size=[230,60];this.upgrade_type=a.upgrade_type;this.weapon_descr=this.descr=null;this.scene=a.scene;L.superConstructor.apply(this,[a]);new e.Image({parent:this,position:[5,23],image:f.cache["static"]["ico_"+this.upgrade_type+".png"]});this.stars=new j.Stars({position:[40,0],parent:this,stars:0});this.label=new e.Label({position:[35,29],parent:this,text:"0",font:j.getFont(d.garage.weapon_label_font)});
this.price_label=new e.Label({position:[0,29],parent:this,text:"0 \u20ac",font:j.getFont(d.garage.weapon_label_font)});this.button=new c({position:[135,20],parent:this,size:[90,35],text:"UPGRADE"});this.button.onClick(this.buy,this);this.price_label.on(e.EVT_RESIZE,function(){this.price_label.move([this.getSize()[0]-this.button.getSize()[0]-this.price_label.getSize()[0]-10,this.price_label.getPosition()[1]])},this)};a.utils.objects.extend(L,e.View);L.prototype.setDescr=function(a){if(this.descr=a)this.weapon_descr=
g[this.descr.type],a=this.descr[this.upgrade_type+"_upgrades"],this.stars.setStars(a),this.label.setText(String(this.getCurValue())),this.price_label.setText(this.weapon_descr[this.upgrade_type+"_upgrade_price"]+"\u20ac"),a<5?(this.button.show(),this.price_label.show()):(this.button.hide(),this.price_label.hide())};L.prototype.buy=function(){!(this.descr[this.upgrade_type+"_upgrades"]>=5)&&this.scene.credit(this.weapon_descr[this.upgrade_type+"_upgrade_price"])&&(this.descr[this.upgrade_type+"_upgrades"]++,
this.setDescr(this.descr))};L.prototype.getCurValue=function(){return(this.upgrade_type=="damage"?this.weapon_descr.damage:this.weapon_descr.ammo_capacity)+this.descr[this.upgrade_type+"_upgrades"]*this.weapon_descr[this.upgrade_type+"_upgrade"]};L.prototype.paint=function(){this.surface.clear();a.draw.rect(this.surface,"#CCCCCC",new a.Rect([0,15],[this.getSize()[0],this.getSize()[1]-15]))};var J=b.BuyCarScene=function(a){J.superConstructor.apply(this,[]);this.player_data=a;this.container.header_height=
130;this.container.background_color=d.garage.background_color;this.container.on(e.EVT_PAINT,this.paint,this);this.container.refresh();this.titlelbl=new e.Label({parent:this.container,position:[210,40],text:"Car Deal",font:j.getFont("header_black")});this.backbtn=new j.Button({parent:this.container,size:[130,50],position:[0,540],font:j.getFont(d.garage.back_button.font),hover_font:j.getFont(d.garage.back_button.hover_font),fill:d.garage.back_button.fill,hover_fill:d.garage.back_button.hover_fill,text:"BACK",
lean:"left"});this.backbtn.onClick(function(){this.game.showGarage(this.player_data)},this);this.car_list=new C({position:[25,160],parent:this.container,scene:this});this.carinfo=new F({position:[450,160],parent:this.container,scene:this});this.balance_label=new e.Label({parent:this.container,font:j.getFont(d.garage.balance_font),position:[260,550],text:"Balance "+this.player_data.balance+"\u20ac"});this.buy_car_btn=new j.Button({parent:this.container,size:[100,50],position:[700,540],font:j.getFont("button2_hover"),
fill:"#006837",hover_fill:"#00381C",text:"BUY",lean:"right",visible:!1});this.buy_car_btn.onClick(this.buy,this)};a.utils.objects.extend(J,j.UIScene);J.prototype.paint=function(){a.draw.rect(this.container.surface,"#B3B3B3",new a.Rect([250,540],[300,50]))};J.prototype.buy=function(){if(this.carinfo.descr&&this.credit(this.carinfo.descr.price))this.player_data.car.type=this.carinfo.descr.id,this.player_data.car.acc_upgrades=0,this.player_data.car.speed_upgrades=0,this.player_data.car.armor_upgrades=
0,this.game.showGarage(this.player_data)};J.prototype.credit=function(a){if(this.player_data.balance-a<0)return this.alert("Insufficient funds!"),!1;this.player_data.balance-=a;this.balance_label.setText("Balance "+this.player_data.balance+"\u20ac");return!0};var M=function(a){M.superConstructor.apply(this,[a])};a.utils.objects.extend(M,e.View);M.prototype.paint=function(){this.surface.fill("#CCCCCC")};var I=function(a){this.descr=a.descr;I.superConstructor.apply(this,[a]);var a=this.getSize()[0],
c=this.getSize()[1],d=f.cache.getCarSprite(this.descr.filenames[0],0);new e.Image({parent:this,image:d,position:[5+parseInt((50-d.getSize()[0])/2),5+parseInt((c-10-d.getSize()[1])/2)]});new e.Label({parent:this,font:j.getFont("16_33"),text:this.descr.name,position:[60,5]});new e.Text({parent:this,font:j.getFont("13_grayish"),text:this.descr.description,width:a-c,position:[60,28]});a=new e.Label({parent:this,font:j.getFont("16_33"),text:this.descr.price+"\u20ac",position:[a-100,c-25]});a.move([this.getSize()[0]-
a.getSize()[0]-10,a.getPosition()[1]]);this.on(e.EVT_MOUSE_DOWN,function(){m.play({filename:"button_click.wav"});this.parent.parent.scene.carinfo.setDescr(this.descr)},this)};a.utils.objects.extend(I,e.View);I.prototype.paint=function(){this.isHovered()?this.surface.fill("#E2E2E2"):this.surface.clear()};var C=function(a){a.size=[330,360];this.scene=a.scene;C.superConstructor.apply(this,[a]);this.scw=new e.ScrollableView({parent:this,position:[5,5],size:[this.getSize()[0]-25,this.getSize()[1]-10]});
this.scw.setVerticalScrollbar(new e.VerticalScrollbar({parent:this,position:[this.getSize()[0]-20,5],size:[20,this.getSize()[1]-10]}));var a=[],c;for(c in k)a.push(k[c]);a.sort(function(a,c){return a.price-c.price});a.forEach(function(a){this.scw.children.length&&new M({parent:this.scw,position:[10,0],size:[this.scw.getSize()[0]-20,5]});new I({parent:this.scw,size:[this.scw.getSize()[0],100],descr:a})},this);e.layout.vertical(this.scw.children);this.scw.autoSetScrollableArea()};a.utils.objects.extend(C,
e.View);C.prototype.paint=function(){this.surface.clear();var c=this.getSize()[1],d=this.getSize()[0];a.draw.rect(this.surface,"#999999",new a.Rect([0,0],[d,5]));a.draw.rect(this.surface,"#999999",new a.Rect([0,c-5],[d,5]));a.draw.rect(this.surface,"#999999",new a.Rect([0,5],[5,c-10]));a.draw.rect(this.surface,"#F2F2F2",new a.Rect([5,5],[d-5,c-10]))};var F=function(a){a.size=[330,360];this.scene=a.scene;this.descr=null;F.superConstructor.apply(this,[a]);this.carimg=null;this.cartitle=new e.Label({parent:this,
position:[20,178],text:"Car not selected",font:j.getFont("alias")});this.cardescr=new e.Text({parent:this,position:[20,213],width:310,font:j.getFont("16_33"),text:"Select a car!"});this.pricelabel=new e.Label({parent:this,position:[230,178],font:j.getFont("alias"),text:"0\u20ac",visible:!1});this.acceleration_label=new e.Label({parent:this,position:[20,240],font:j.getFont("16_33"),text:"Acceleration:",visible:!1});this.acceleration_stars=new j.Stars({parent:this,position:[135,240],stars:0,visible:!1});
this.speed_label=new e.Label({parent:this,position:[20,270],font:j.getFont("16_33"),text:"Top Speed:",visible:!1});this.speed_stars=new j.Stars({parent:this,position:[135,270],stars:0,visible:!1});this.armor_label=new e.Label({parent:this,position:[20,300],font:j.getFont("16_33"),text:"Armor:",visible:!1});this.armor_stars=new j.Stars({parent:this,position:[135,300],stars:0,visible:!1});this.handling_label=new e.Label({parent:this,position:[20,330],font:j.getFont("16_33"),text:"Handling:",visible:!1});
this.handling_stars=new j.Stars({parent:this,position:[135,330],stars:0,visible:!1});this.pricelabel.on(e.EVT_RESIZE,function(){this.pricelabel.move([this.getSize()[0]-this.pricelabel.getSize()[0]-10,this.pricelabel.getPosition()[1]])},this)};a.utils.objects.extend(F,e.View);F.prototype.paint=function(){this.surface.fill("#B3B3B3");a.draw.rect(this.surface,"#F5F5F5",new a.Rect([0,0],[this.getSize()[0],180]));this.carimg&&this.surface.blit(this.carimg,[20,5])};F.prototype.setDescr=function(c){this.descr=
c;this.carimg=a.transform.rotate(f.cache["static"][this.descr.art_filename],90);this.cartitle.setText(c.name);this.cardescr.setText(c.description);this.pricelabel.show();this.scene.player_data.car.type!=c.id?(this.pricelabel.setText(c.price+"\u20ac"),this.scene.buy_car_btn.show()):(this.pricelabel.setText("OWNED"),this.scene.buy_car_btn.hide());this.acceleration_stars.setStars(c.acceleration_stars);this.speed_stars.setStars(c.speed_stars);this.armor_stars.setStars(c.armor_stars);this.handling_stars.setStars(c.handling_stars);
this.acceleration_label.show();this.armor_label.show();this.speed_label.show();this.handling_label.show();this.acceleration_stars.show();this.speed_stars.show();this.armor_stars.show();this.handling_stars.show();this.refresh()}}},["gamejs","ui","utils","levels","sounds","car_descriptions","weapon_descriptions","gamejs-gui","skin","combatracer","renderer"]);
require.define({levels:function(n,b){var a=n("./resources"),j=n("gamejs");try{var m=n("./levels_compiled").levels}catch(k){m={}}b.all=[];b.init=function(){if(!b.all.length)for(var g="",e=0;e<a.levels.length;e++){var g=a.levels[e],d;d=m[g]?m[g]:j.http.load("/levels/"+g+".json");d.id=g;b[g]=d;b.all.push(d)}}}},["resources","gamejs","levels_compiled"]);
require.define({levels_compiled:function(n,b){b.levels={snowpeakcircuit:{size:[2800,2200],title:"Snowpeak Circuit",bgtile:"snow.png",props:[{p:[233,677],f:1,a:0},{p:[359,647],f:2,a:0},{p:[373,620],f:2,a:0},{p:[396,600],f:2,a:0},{p:[426,588],f:2,a:0},{p:[458,465],f:1,a:270},{p:[729,553],f:3,a:270},{p:[820,554],f:3,a:270},{p:[912,588],f:2,a:0},{p:[942,601],f:2,a:0},{p:[963,622],f:2,a:0},{p:[981,650],f:2,a:0},{p:[955,680],f:3,a:180},{p:[952,762],f:3,a:165},{p:[982,844],f:3,a:150},{p:[1035,914],f:3,a:135},
{p:[1117,965],f:3,a:105},{p:[1216,986],f:3,a:90},{p:[1308,896],f:1,a:270},{p:[1580,986],f:3,a:90},{p:[1673,987],f:3,a:90},{p:[1746,949],f:3,a:60},{p:[1817,895],f:3,a:45},{p:[1869,821],f:3,a:30},{p:[1906,747],f:3,a:0},{p:[1907,657],f:3,a:0},{p:[1952,629],f:2,a:0},{p:[1974,608],f:2,a:0},{p:[2002,589],f:2,a:0},{p:[2033,465],f:1,a:270},{p:[2293,551],f:3,a:285},{p:[2360,595],f:3,a:150},{p:[2306,697],f:1,a:180},{p:[2307,969],f:1,a:180},{p:[2398,1243],f:3,a:180},{p:[2415,1319],f:3,a:165},{p:[2435,1418],
f:3,a:180},{p:[2412,1502],f:3,a:195},{p:[2398,1600],f:3,a:180},{p:[2349,1667],f:3,a:225},{p:[2104,1628],f:1,a:90},{p:[2011,1716],f:3,a:270},{p:[1917,1657],f:3,a:315},{p:[1909,1594],f:3,a:0},{p:[1896,1494],f:3,a:345},{p:[1857,1403],f:3,a:330},{p:[1800,1329],f:3,a:315},{p:[1731,1288],f:3,a:285},{p:[1470,1197],f:1,a:90},{p:[1200,1198],f:1,a:90},{p:[928,1196],f:1,a:90},{p:[655,1199],f:1,a:90},{p:[562,1288],f:3,a:270},{p:[472,1290],f:3,a:270},{p:[369,1259],f:3,a:300},{p:[319,1201],f:3,a:345},{p:[231,942],
f:1,a:0},{p:[427,1424],f:1,a:270},{p:[697,1423],f:1,a:270},{p:[969,1424],f:1,a:270},{p:[1240,1424],f:1,a:270},{p:[1512,1515],f:3,a:270},{p:[1583,1512],f:3,a:300},{p:[1646,1576],f:3,a:330},{p:[1677,1678],f:3,a:0},{p:[1676,1757],f:3,a:345},{p:[1711,1834],f:3,a:330},{p:[1778,1893],f:3,a:300},{p:[1871,1930],f:3,a:285},{p:[1971,1860],f:1,a:270},{p:[2242,1859],f:1,a:270},{p:[2490,1905],f:3,a:240},{p:[2556,1840],f:3,a:210},{p:[2601,1763],f:3,a:195},{p:[2626,1683],f:3,a:180},{p:[2535,1411],f:1,a:180},{p:[2535,
1137],f:1,a:180},{p:[2536,865],f:1,a:180},{p:[2534,593],f:1,a:180},{p:[2599,493],f:3,a:165},{p:[2554,405],f:3,a:150},{p:[2486,347],f:3,a:120},{p:[2407,322],f:3,a:105},{p:[2322,325],f:3,a:90},{p:[2046,235],f:1,a:90},{p:[1953,322],f:3,a:90},{p:[1852,325],f:3,a:75},{p:[1761,362],f:3,a:60},{p:[1700,433],f:3,a:30},{p:[1676,523],f:3,a:15},{p:[1675,623],f:3,a:0},{p:[1639,693],f:3,a:30},{p:[1646,783],f:2,a:0},{p:[1376,670],f:1,a:90},{p:[1286,754],f:3,a:90},{p:[1190,697],f:3,a:135},{p:[1186,633],f:3,a:180},
{p:[1186,543],f:3,a:180},{p:[1142,441],f:3,a:150},{p:[1080,367],f:3,a:135},{p:[1006,331],f:3,a:105},{p:[746,238],f:1,a:90},{p:[473,239],f:1,a:90},{p:[382,325],f:3,a:90},{p:[290,334],f:3,a:75},{p:[206,366],f:3,a:60},{p:[138,427],f:3,a:45},{p:[100,511],f:3,a:15},{p:[89,605],f:3,a:0},{p:[1,695],f:1,a:0},{p:[2,967],f:1,a:0},{p:[335,1517],f:3,a:270},{p:[220,1472],f:3,a:300},{p:[143,1412],f:3,a:315},{p:[101,1346],f:3,a:345},{p:[92,1238],f:3,a:0},{p:[125,1327],f:2,a:0}],decals:[{p:[156,1230],f:4,a:270},
{p:[468,1302],f:5,a:0},{p:[756,1302],f:5,a:0},{p:[1044,1302],f:5,a:0},{p:[1332,1302],f:5,a:0},{p:[1620,1350],f:4,a:90},{p:[1740,1662],f:4,a:270},{p:[2052,1734],f:5,a:0},{p:[2340,1662],f:4,a:180},{p:[2460,1470],f:6,a:0},{p:[2460,1278],f:7,a:0},{p:[2460,1086],f:8,a:0},{p:[2460,894],f:8,a:0},{p:[2460,702],f:8,a:0},{p:[2340,390],f:4,a:90},{p:[2052,342],f:5,a:180},{p:[1740,390],f:4,a:0},{p:[1620,702],f:4,a:180},{p:[1332,774],f:5,a:180},{p:[1020,702],f:4,a:270},{p:[900,390],f:4,a:90},{p:[612,342],f:5,a:180},
{p:[108,942],f:5,a:270},{p:[156,750],f:8,a:0},{p:[156,390],f:4,a:0},{p:[468,390],f:8,a:90},{p:[156,702],f:8,a:180},{p:[1374,1356],f:9,a:270},{p:[1374,1434],f:9,a:270},{p:[1356,1368],f:10,a:90},{p:[1260,1476],f:10,a:90},{p:[1164,1368],f:10,a:90},{p:[1050,1476],f:10,a:90},{p:[948,1368],f:10,a:90},{p:[828,1476],f:10,a:90}],laps:4,ai_waypoints:[{p:[1459,1440],n:1},{p:[1728,1536],n:2},{p:[1954,1793],n:3},{p:[2420,1800],n:4},{p:[2527,1549],n:5},{p:[2566,1121],n:6},{p:[2580,824],n:7},{p:[2411,548],n:8},
{p:[1916,556],n:9},{p:[1676,829],n:10},{p:[1205,822],n:11},{p:[981,549],n:12},{p:[363,526],n:13},{p:[218,866],n:14},{p:[279,1336],n:15}],checkpoints:[{p:[1418,1297],n:1},{p:[2035,1746],n:2},{p:[2433,1140],n:3},{p:[2377,416],n:4},{p:[1729,420],n:5},{p:[991,685],n:6},{p:[163,380],n:7},{p:[176,1264],n:8}],start_positions:[{p:[1306,1361],n:1,a:90},{p:[1214,1469],n:2,a:90},{p:[1116,1362],n:3,a:90},{p:[1E3,1469],n:4,a:90},{p:[901,1364],n:5,a:90},{p:[780,1471],n:6,a:90}],dict:{1:"9tires.png",2:"tire.png",
3:"3tires.png",4:"dideliskampas.png",5:"ilgas.png",6:"sonaslenktas2.png",7:"sonaslenktas1.png",8:"paprastas.png",9:"startbar.png",10:"white_bar.png"}},drycircuit:{size:[2800,1700],title:"Dry Circuit",bgtile:"sand.png",props:[{p:[1511,1097],f:1,a:270},{p:[1781,1096],f:1,a:270},{p:[2052,1096],f:1,a:270},{p:[2323,1185],f:2,a:270},{p:[2394,1150],f:2,a:240},{p:[2448,1085],f:2,a:195},{p:[2379,822],f:1,a:180},{p:[2420,723],f:2,a:135},{p:[2362,701],f:2,a:90},{p:[2269,699],f:2,a:90},{p:[2170,732],f:2,a:0},
{p:[2234,728],f:3,a:0},{p:[2158,814],f:2,a:15},{p:[2123,893],f:2,a:30},{p:[2065,960],f:2,a:45},{p:[1993,1013],f:2,a:75},{p:[1908,1035],f:2,a:90},{p:[1636,947],f:1,a:90},{p:[1362,947],f:1,a:90},{p:[1270,1042],f:2,a:90},{p:[1168,1023],f:2,a:105},{p:[1078,976],f:2,a:135},{p:[1023,905],f:2,a:150},{p:[932,654],f:1,a:0},{p:[932,383],f:1,a:0},{p:[1022,291],f:2,a:180},{p:[1052,258],f:3,a:0},{p:[962,854],f:2,a:210},{p:[897,921],f:2,a:240},{p:[821,961],f:2,a:255},{p:[559,892],f:1,a:270},{p:[468,982],f:2,a:270},
{p:[377,981],f:2,a:270},{p:[277,991],f:2,a:225},{p:[258,1087],f:2,a:180},{p:[282,1141],f:2,a:135},{p:[373,1180],f:2,a:105},{p:[464,1250],f:3,a:0},{p:[494,1132],f:1,a:270},{p:[765,1135],f:1,a:270},{p:[1038,1133],f:1,a:270},{p:[1310,1223],f:2,a:90},{p:[1387,1204],f:2,a:75},{p:[1483,1220],f:3,a:0},{p:[1517,1325],f:1,a:270},{p:[1788,1324],f:1,a:270},{p:[2060,1325],f:1,a:270},{p:[2331,1414],f:2,a:90},{p:[2420,1411],f:2,a:90},{p:[2501,1394],f:2,a:75},{p:[2582,1352],f:2,a:60},{p:[2642,1287],f:2,a:30},{p:[2680,
1206],f:2,a:15},{p:[2606,946],f:1,a:180},{p:[2605,674],f:1,a:180},{p:[2650,572],f:2,a:330},{p:[2587,505],f:2,a:300},{p:[2506,473],f:2,a:285},{p:[2247,384],f:1,a:90},{p:[2156,472],f:2,a:270},{p:[2059,467],f:2,a:255},{p:[1975,507],f:2,a:225},{p:[1940,596],f:2,a:195},{p:[1940,698],f:2,a:180},{p:[1882,757],f:2,a:225},{p:[1639,715],f:1,a:90},{p:[1368,716],f:1,a:90},{p:[1337,836],f:3,a:0},{p:[1305,835],f:3,a:0},{p:[1286,808],f:3,a:0},{p:[1166,536],f:1,a:0},{p:[1168,261],f:1,a:0},{p:[1257,170],f:2,a:0},
{p:[1215,67],f:2,a:330},{p:[1148,4],f:2,a:300},{p:[1079,-5],f:2,a:270},{p:[987,-7],f:2,a:270},{p:[883,-5],f:2,a:240},{p:[811,49],f:2,a:225},{p:[780,135],f:2,a:195},{p:[697,236],f:1,a:0},{p:[789,508],f:2,a:180},{p:[790,599],f:2,a:180},{p:[760,671],f:2,a:210},{p:[698,733],f:2,a:255},{p:[436,661],f:1,a:270},{p:[342,752],f:2,a:270},{p:[249,753],f:2,a:270},{p:[145,766],f:2,a:240},{p:[66,821],f:2,a:225},{p:[27,902],f:2,a:195},{p:[-69,1E3],f:1,a:180},{p:[29,1253],f:2,a:150},{p:[80,1327],f:2,a:135},{p:[160,
1384],f:2,a:105},{p:[258,1413],f:2,a:90},{p:[350,1416],f:2,a:90},{p:[419,1379],f:2,a:60},{p:[523,1284],f:1,a:90},{p:[795,1281],f:1,a:90},{p:[1066,1281],f:1,a:90},{p:[1338,1370],f:2,a:90},{p:[1412,1375],f:2,a:120}],decals:[{p:[852,60],f:4,a:0},{p:[1068,60],f:4,a:90},{p:[1044,276],f:5,a:90},{p:[804,270],f:5,a:90},{p:[1044,558],f:5,a:90},{p:[1092,846],f:4,a:270},{p:[1308,822],f:5,a:180},{p:[1596,822],f:5,a:180},{p:[1884,750],f:6,a:180},{p:[2004,534],f:4,a:0},{p:[2220,534],f:7,a:270},{p:[2412,534],f:6,
a:90},{p:[2484,846],f:5,a:270},{p:[2412,1128],f:6,a:180},{p:[2124,1200],f:5,a:0},{p:[1836,1200],f:5,a:0},{p:[1548,1200],f:5,a:0},{p:[1356,1248],f:8,a:0},{p:[1164,1248],f:9,a:0},{p:[972,1248],f:9,a:0},{p:[780,1248],f:9,a:0},{p:[588,1248],f:9,a:0},{p:[396,1248],f:8,a:180},{p:[84,1128],f:6,a:270},{p:[84,816],f:6,a:0},{p:[396,768],f:5,a:180},{p:[732,696],f:6,a:180},{p:[852,552],f:10,a:180},{p:[852,504],f:10,a:180},{p:[594,816],f:10,a:270},{p:[1656,1260],f:11,a:90},{p:[1758,1374],f:11,a:90},{p:[1866,1260],
f:11,a:90},{p:[1980,1374],f:11,a:90},{p:[2100,1260],f:11,a:90},{p:[2214,1374],f:11,a:90},{p:[2226,1254],f:12,a:270},{p:[2226,1332],f:12,a:270}],laps:4,ai_waypoints:[{p:[2476,1270],n:1},{p:[2640,980],n:2},{p:[2493,656],n:3},{p:[2154,650],n:4},{p:[1906,893],n:5},{p:[1520,981],n:6},{p:[1221,840],n:7},{p:[1228,431],n:8},{p:[1215,319],n:9},{p:[966,618],n:12},{p:[818,852],n:13},{p:[251,984],n:14},{p:[223,1208],n:15},{p:[495,1343],n:16},{p:[1444,1323],n:17},{p:[1050,152],n:10},{p:[891,323],n:11}],checkpoints:[{p:[2270,
1203],n:1},{p:[2427,526],n:2},{p:[1900,777],n:3},{p:[1068,793],n:4},{p:[931,24],n:5},{p:[733,743],n:6},{p:[163,777],n:7},{p:[304,1201],n:8}],start_positions:[{p:[2168,1369],n:1,a:90},{p:[2054,1252],n:2,a:90},{p:[1935,1371],n:3,a:90},{p:[1822,1255],n:4,a:90},{p:[1715,1367],n:5,a:90},{p:[1611,1256],n:6,a:90}],dict:{1:"9tires.png",2:"3tires.png",3:"tire.png",4:"lenktas.png",5:"ilgas.png",6:"dideliskampas.png",7:"paprastas.png",8:"siaurasiplatu.png",9:"siauras.png",10:"trumpas.png",11:"white_bar.png",
12:"startbar.png"}},deathvalley:{size:[2400,2200],title:"Death Valley",bgtile:"sand.png",props:[{p:[233,455],f:1,a:0},{p:[329,351],f:2,a:30},{p:[404,314],f:2,a:255},{p:[504,225],f:1,a:270},{p:[778,225],f:1,a:270},{p:[913,378],f:1,a:180},{p:[972,618],f:2,a:270},{p:[869,611],f:2,a:255},{p:[780,634],f:2,a:240},{p:[709,687],f:2,a:225},{p:[671,774],f:2,a:195},{p:[578,876],f:1,a:180},{p:[671,1151],f:2,a:180},{p:[672,1244],f:2,a:180},{p:[702,1335],f:3,a:0},{p:[462,1248],f:1,a:90},{p:[369,1338],f:2,a:90},
{p:[234,1097],f:1,a:0},{p:[234,827],f:1,a:0},{p:[323,732],f:2,a:0},{p:[366,-3],f:1,a:270},{p:[639,-4],f:1,a:270},{p:[912,85],f:2,a:270},{p:[1003,83],f:2,a:270},{p:[1084,82],f:2,a:285},{p:[1153,119],f:2,a:315},{p:[1214,200],f:2,a:345},{p:[1237,301],f:2,a:0},{p:[1148,395],f:1,a:180},{p:[1300,525],f:1,a:270},{p:[1571,614],f:2,a:270},{p:[1630,556],f:2,a:225},{p:[1584,314],f:1,a:180},{p:[1677,213],f:2,a:210},{p:[1738,145],f:2,a:240},{p:[1841,137],f:2,a:270},{p:[1933,137],f:2,a:270},{p:[2012,137],f:2,a:285},
{p:[2081,178],f:2,a:330},{p:[2129,269],f:2,a:345},{p:[2058,372],f:1,a:180},{p:[2109,622],f:2,a:30},{p:[2106,727],f:2,a:0},{p:[2108,821],f:2,a:0},{p:[2125,897],f:2,a:345},{p:[1824,398],f:1,a:180},{p:[1969,665],f:3,a:0},{p:[1956,699],f:2,a:0},{p:[1957,794],f:2,a:0},{p:[1889,663],f:2,a:15},{p:[1836,731],f:2,a:45},{p:[1766,787],f:2,a:60},{p:[1688,825],f:2,a:75},{p:[1424,755],f:1,a:270},{p:[1329,843],f:2,a:90},{p:[1298,873],f:3,a:0},{p:[1230,864],f:2,a:345},{p:[1919,863],f:2,a:45},{p:[1925,960],f:3,a:0},
{p:[1282,922],f:2,a:300},{p:[1385,862],f:1,a:270},{p:[1657,861],f:1,a:270},{p:[2146,995],f:2,a:0},{p:[2104,1068],f:2,a:30},{p:[2045,1135],f:2,a:60},{p:[1797,1088],f:1,a:270},{p:[1525,1089],f:1,a:270},{p:[1253,1090],f:1,a:270},{p:[1146,1147],f:2,a:120},{p:[1068,1094],f:2,a:135},{p:[1013,1022],f:2,a:150},{p:[1008,952],f:2,a:180},{p:[1041,922],f:3,a:0},{p:[1037,888],f:3,a:0},{p:[934,850],f:2,a:60},{p:[893,930],f:2,a:15},{p:[805,1029],f:1,a:180},{p:[897,1300],f:2,a:0},{p:[961,1242],f:1,a:90},{p:[1209,
1286],f:2,a:225},{p:[1281,1237],f:2,a:240},{p:[1383,1141],f:1,a:90},{p:[1656,1230],f:2,a:270},{p:[1738,1232],f:2,a:285},{p:[1809,1269],f:2,a:315},{p:[1909,1334],f:2,a:270},{p:[1993,1332],f:2,a:285},{p:[2071,1358],f:2,a:300},{p:[2141,1412],f:2,a:315},{p:[2195,1496],f:2,a:345},{p:[2128,1593],f:1,a:180},{p:[2176,1846],f:2,a:30},{p:[2118,1912],f:2,a:60},{p:[2049,1965],f:2,a:75},{p:[1787,1904],f:1,a:90},{p:[1693,1996],f:2,a:90},{p:[1600,1995],f:2,a:90},{p:[1564,2007],f:3,a:0},{p:[1480,1953],f:2,a:90},
{p:[1389,1952],f:2,a:90},{p:[1358,1980],f:3,a:0},{p:[1258,1960],f:2,a:45},{p:[1016,1905],f:1,a:90},{p:[1842,1571],f:2,a:45},{p:[1922,1565],f:2,a:300},{p:[1981,1656],f:2,a:0},{p:[1928,1718],f:2,a:45},{p:[1684,1675],f:1,a:90},{p:[1411,1675],f:1,a:90},{p:[1140,1673],f:1,a:90},{p:[1049,1765],f:2,a:90},{p:[941,1731],f:2,a:120},{p:[892,1672],f:2,a:165},{p:[897,1593],f:2,a:180},{p:[962,1471],f:1,a:90},{p:[1205,1572],f:2,a:135},{p:[1284,1629],f:2,a:120},{p:[1385,1580],f:1,a:90},{p:[1657,1672],f:2,a:90},{p:[1741,
1648],f:2,a:75},{p:[1838,1663],f:3,a:0},{p:[1430,1360],f:1,a:90},{p:[1701,1480],f:3,a:0},{p:[923,1997],f:2,a:90},{p:[824,1973],f:2,a:105},{p:[741,1920],f:2,a:135},{p:[679,1852],f:2,a:150},{p:[577,1605],f:1,a:0},{p:[424,1476],f:1,a:270},{p:[330,1566],f:2,a:90},{p:[224,1546],f:2,a:105},{p:[135,1501],f:2,a:135},{p:[92,1434],f:2,a:165},{p:[1,1172],f:1,a:0},{p:[3,900],f:1,a:0},{p:[2,628],f:1,a:0},{p:[0,356],f:1,a:0},{p:[90,255],f:2,a:195},{p:[125,172],f:2,a:225},{p:[194,114],f:2,a:240},{p:[271,87],f:2,
a:255}],decals:[{p:[156,150],f:4,a:0},{p:[468,102],f:5,a:0},{p:[756,102],f:5,a:0},{p:[1044,150],f:6,a:90},{p:[1020,366],f:5,a:90},{p:[1044,654],f:7,a:0},{p:[1068,894],f:4,a:270},{p:[1380,966],f:5,a:180},{p:[1668,966],f:5,a:180},{p:[1956,990],f:6,a:180},{p:[1980,798],f:8,a:0},{p:[1980,606],f:9,a:0},{p:[1980,414],f:10,a:0},{p:[1956,198],f:6,a:90},{p:[1740,198],f:6,a:0},{p:[1284,630],f:5,a:0},{p:[1620,558],f:4,a:180},{p:[1740,414],f:11,a:0},{p:[1740,366],f:11,a:0},{p:[1476,678],f:11,a:90},{p:[732,678],
f:4,a:0},{p:[684,990],f:5,a:90},{p:[1044,1398],f:10,a:270},{p:[1134,1290],f:12,a:270},{p:[1440,1242],f:5,a:180},{p:[1440,1458],f:5,a:180},{p:[1626,1290],f:12,a:90},{p:[1932,1398],f:4,a:90},{p:[1932,1710],f:4,a:180},{p:[1644,1782],f:5,a:180},{p:[1452,1830],f:13,a:270},{p:[1260,1830],f:14,a:270},{p:[708,1374],f:15,a:0},{p:[900,1398],f:11,a:270},{p:[732,1230],f:11,a:0},{p:[732,1710],f:4,a:270},{p:[996,1830],f:11,a:90},{p:[1086,1830],f:11,a:90},{p:[1116,1830],f:11,a:90},{p:[732,1566],f:11,a:180},{p:[156,
462],f:10,a:180},{p:[156,654],f:10,a:180},{p:[156,846],f:10,a:180},{p:[156,1038],f:10,a:180},{p:[516,1398],f:10,a:270},{p:[156,1188],f:10,a:0},{p:[156,1374],f:6,a:270},{p:[324,1398],f:11,a:270},{p:[372,1398],f:11,a:270},{p:[1104,606],f:16,a:90},{p:[1182,606],f:16,a:90},{p:[1314,714],f:16,a:180},{p:[1314,792],f:16,a:180},{p:[162,600],f:17,a:0},{p:[240,600],f:17,a:0},{p:[174,672],f:18,a:0},{p:[276,762],f:18,a:0},{p:[174,864],f:18,a:0},{p:[276,960],f:18,a:0},{p:[174,1092],f:18,a:0},{p:[276,1206],f:18,
a:0}],ai_waypoints:[{p:[235,467],n:1},{p:[390,295],n:2},{p:[1045,289],n:4},{p:[1208,966],n:5},{p:[1776,1157],n:6},{p:[2056,648],n:8},{p:[663,184],n:3},{p:[2092,454],n:9},{p:[1966,318],n:10},{p:[961,795],n:12},{p:[777,1094],n:13},{p:[2063,1594],n:16},{p:[2007,1829],n:17},{p:[913,1826],n:19},{p:[1574,1332],n:15},{p:[2035,904],n:7},{p:[869,1402],n:14},{p:[743,1566],n:20},{p:[1261,1930],n:18},{p:[321,1401],n:21},{p:[1673,727],n:11}],checkpoints:[{p:[108,376],n:1},{p:[1008,119],n:2},{p:[1033,870],n:3},
{p:[1945,883],n:4},{p:[1813,176],n:5},{p:[749,650],n:6},{p:[742,1329],n:7},{p:[1838,1370],n:8},{p:[1688,1780],n:9},{p:[706,1742],n:10},{p:[136,1351],n:11}],start_positions:[{p:[172,707],n:1,a:0},{p:[272,796],n:2,a:0},{p:[170,902],n:3,a:0},{p:[268,1001],n:4,a:0},{p:[171,1129],n:5,a:0},{p:[271,1243],n:6,a:0}],dict:{1:"9tires.png",2:"3tires.png",3:"tire.png",4:"dideliskampas.png",5:"ilgas.png",6:"lenktas.png",7:"kryzius.png",8:"siaurejantis2.png",9:"siaurejantis1.png",10:"paprastas.png",11:"trumpas.png",
12:"issisakojimas.png",13:"sonaslenktas2.png",14:"sonaslenktas1.png",15:"susikerta.png",16:"arrow.png",17:"startbar.png",18:"white_bar.png"}},spiralraceway:{size:[2500,1800],title:"Spiral Raceway",bgtile:"grass.png",props:[{p:[1169,1308],f:1,a:345},{p:[1220,1366],f:1,a:300},{p:[1204,1053],f:1,a:270},{p:[1668,1052],f:1,a:270},{p:[1730,1001],f:1,a:225},{p:[1784,934],f:1,a:195},{p:[1570,756],f:1,a:180},{p:[1536,694],f:1,a:90},{p:[1538,817],f:1,a:90},{p:[1265,601],f:2,a:270},{p:[1268,727],f:2,a:270},
{p:[1238,847],f:3,a:0},{p:[1172,788],f:1,a:0},{p:[1200,756],f:3,a:0},{p:[1205,724],f:3,a:0},{p:[1234,720],f:3,a:0},{p:[1683,474],f:1,a:300},{p:[1750,533],f:1,a:330},{p:[1793,634],f:1,a:0},{p:[1812,1397],f:1,a:90},{p:[1901,1394],f:1,a:90},{p:[1964,1348],f:1,a:45},{p:[2017,1281],f:1,a:15},{p:[2037,1200],f:1,a:0},{p:[1783,1332],f:1,a:0},{p:[1830,1274],f:1,a:75},{p:[1906,1229],f:1,a:60},{p:[2005,1239],f:3,a:0},{p:[2034,1212],f:3,a:0},{p:[1906,276],f:1,a:300},{p:[1972,335],f:1,a:330},{p:[2023,422],f:1,
a:345},{p:[1992,301],f:1,a:315},{p:[1850,1536],f:2,a:270},{p:[2101,1585],f:1,a:240},{p:[2174,1531],f:1,a:225},{p:[2233,1464],f:1,a:195},{p:[2175,1205],f:2,a:180},{p:[2174,935],f:2,a:180},{p:[2175,665],f:2,a:180},{p:[2040,769],f:1,a:180},{p:[2175,393],f:2,a:180},{p:[2266,299],f:1,a:180},{p:[2241,200],f:1,a:165},{p:[2185,115],f:1,a:135},{p:[2113,65],f:1,a:120},{p:[2046,53],f:1,a:90},{p:[1771,-39],f:2,a:90},{p:[1502,-42],f:2,a:90},{p:[1408,49],f:1,a:90},{p:[1317,48],f:1,a:90},{p:[1284,81],f:3,a:0},{p:[1176,
53],f:1,a:60},{p:[973,150],f:2,a:90},{p:[703,150],f:2,a:90},{p:[602,234],f:1,a:75},{p:[924,-6],f:2,a:90},{p:[652,-7],f:2,a:90},{p:[545,49],f:1,a:135},{p:[541,73],f:3,a:0},{p:[450,46],f:1,a:90},{p:[349,48],f:1,a:75},{p:[261,76],f:1,a:60},{p:[193,136],f:1,a:30},{p:[165,228],f:1,a:15},{p:[465,276],f:1,a:60},{p:[399,338],f:1,a:30},{p:[73,331],f:2,a:0},{p:[75,604],f:2,a:0},{p:[74,878],f:2,a:0},{p:[169,1129],f:1,a:330},{p:[221,1200],f:1,a:315},{p:[305,1255],f:1,a:285},{p:[403,1196],f:2,a:270},{p:[674,1197],
f:2,a:270},{p:[945,1315],f:3,a:0},{p:[977,1316],f:3,a:0},{p:[945,1349],f:1,a:180},{p:[945,1428],f:1,a:165},{p:[980,1505],f:1,a:150},{p:[1043,1569],f:1,a:120},{p:[1135,1611],f:1,a:105},{p:[1237,1540],f:2,a:270},{p:[1581,1536],f:2,a:270},{p:[1506,1658],f:3,a:0},{p:[1541,1657],f:3,a:0},{p:[1232,1287],f:1,a:90},{p:[1262,1341],f:1,a:0},{p:[393,938],f:1,a:0},{p:[404,1003],f:1,a:315},{p:[501,1061],f:1,a:270},{p:[419,952],f:1,a:330},{p:[490,1003],f:1,a:300},{p:[914,1053],f:1,a:270},{p:[697,821],f:1,a:270},
{p:[604,760],f:1,a:330},{p:[598,689],f:1,a:0},{p:[598,598],f:1,a:0},{p:[611,497],f:1,a:45},{p:[789,822],f:1,a:90},{p:[881,821],f:1,a:90},{p:[856,610],f:2,a:180},{p:[965,512],f:1,a:45},{p:[1038,479],f:1,a:90},{p:[711,389],f:2,a:90},{p:[980,506],f:3,a:0},{p:[1010,505],f:3,a:0}],decals:[{p:[228,114],f:4,a:0},{p:[1692,66],f:5,a:0},{p:[1980,114],f:4,a:90},{p:[228,426],f:6,a:0},{p:[228,618],f:6,a:0},{p:[228,810],f:6,a:0},{p:[228,1002],f:4,a:270},{p:[540,1074],f:5,a:0},{p:[828,1074],f:5,a:0},{p:[1116,1074],
f:5,a:0},{p:[1404,1074],f:5,a:0},{p:[2052,426],f:5,a:90},{p:[2052,714],f:5,a:90},{p:[1758,1002],f:4,a:180},{p:[1614,1122],f:7,a:90},{p:[1878,816],f:6,a:0},{p:[1878,624],f:6,a:0},{p:[1758,312],f:4,a:90},{p:[1470,264],f:5,a:180},{p:[1182,264],f:5,a:180},{p:[894,264],f:5,a:180},{p:[432,312],f:4,a:0},{p:[744,264],f:5,a:180},{p:[432,576],f:7,a:180},{p:[432,672],f:7,a:180},{p:[1608,528],f:8,a:90},{p:[1632,696],f:7,a:180},{p:[1632,750],f:7,a:180},{p:[1320,480],f:5,a:0},{p:[984,1098],f:9,a:0},{p:[984,858],
f:9,a:0},{p:[792,882],f:6,a:270},{p:[432,762],f:4,a:270},{p:[690,882],f:7,a:270},{p:[1008,528],f:8,a:0},{p:[1176,528],f:7,a:90},{p:[1008,696],f:7,a:180},{p:[1008,720],f:7,a:180},{p:[1224,882],f:6,a:270},{p:[1608,858],f:8,a:180},{p:[1320,834],f:5,a:0},{p:[1008,1338],f:4,a:270},{p:[1320,1410],f:5,a:0},{p:[1608,1410],f:5,a:0},{p:[2052,1002],f:5,a:90},{p:[1980,1338],f:4,a:180},{p:[1836,1458],f:7,a:270},{p:[2100,1206],f:7,a:0},{p:[540,114],f:10,a:180},{p:[732,114],f:11,a:0},{p:[924,114],f:11,a:0},{p:[1116,
114],f:10,a:0},{p:[1308,66],f:5,a:180},{p:[1548,114],f:7,a:90},{p:[1812,1464],f:12,a:90},{p:[1812,1542],f:12,a:90},{p:[1794,1476],f:13,a:90},{p:[1704,1584],f:13,a:90},{p:[1620,1476],f:13,a:90},{p:[1518,1584],f:13,a:90},{p:[1428,1476],f:13,a:90},{p:[1326,1584],f:13,a:90},{p:[1050,822],f:14,a:90},{p:[1122,822],f:14,a:90},{p:[948,924],f:14,a:0},{p:[948,996],f:14,a:0},{p:[1050,1080],f:14,a:90},{p:[1122,1080],f:14,a:90},{p:[948,1158],f:14,a:0},{p:[948,1242],f:14,a:0}],ai_waypoints:[{p:[1966,1498],n:1},
{p:[2135,1365],n:2},{p:[2220,531],n:3},{p:[2067,264],n:4},{p:[1265,196],n:5},{p:[553,187],n:6},{p:[348,341],n:7},{p:[278,662],n:8},{p:[379,1108],n:9},{p:[1083,1199],n:10},{p:[1560,1240],n:11},{p:[1877,1117],n:12},{p:[1995,696],n:13},{p:[1873,488],n:14},{p:[1488,345],n:15},{p:[582,469],n:16},{p:[479,648],n:17},{p:[671,933],n:18},{p:[1098,955],n:19},{p:[1645,910],n:20},{p:[1701,781],n:21},{p:[1609,650],n:22},{p:[1359,571],n:23},{p:[1125,693],n:24},{p:[1079,1089],n:25},{p:[1146,1464],n:26},{p:[1524,
1535],n:27}],checkpoints:[{p:[1856,1415],n:1},{p:[1973,97],n:2},{p:[369,76],n:3},{p:[259,1068],n:4},{p:[1761,1018],n:5},{p:[1751,338],n:6},{p:[455,319],n:7},{p:[448,808],n:8},{p:[1563,818],n:9},{p:[1552,501],n:10},{p:[978,506],n:11},{p:[965,1319],n:12}],start_positions:[{p:[1747,1470],n:1,a:90},{p:[1656,1579],n:2,a:90},{p:[1575,1472],n:3,a:90},{p:[1473,1578],n:4,a:90},{p:[1382,1468],n:5,a:90},{p:[1278,1579],n:6,a:90}],dict:{1:"3tires.png",2:"9tires.png",3:"tire.png",4:"dideliskampas.png",5:"ilgas.png",
6:"paprastas.png",7:"trumpas.png",8:"lenktas.png",9:"kryzius.png",10:"siaurasiplatu.png",11:"siauras.png",12:"startbar.png",13:"white_bar.png",14:"arrow.png"}},greenring:{size:[2700,2100],title:"Grennglade Ring",bgtile:"grass.png",props:[{p:[998,187],f:1,a:270},{p:[1268,187],f:1,a:270},{p:[1540,187],f:1,a:270},{p:[1810,188],f:1,a:270},{p:[2081,277],f:2,a:270},{p:[2173,277],f:2,a:270},{p:[2252,281],f:2,a:285},{p:[2327,310],f:2,a:300},{p:[2388,374],f:2,a:330},{p:[2428,463],f:2,a:345},{p:[2357,563],
f:1,a:0},{p:[2448,834],f:2,a:0},{p:[2425,912],f:2,a:15},{p:[2374,981],f:2,a:45},{p:[2307,1042],f:2,a:60},{p:[2228,1084],f:2,a:75},{p:[2150,1101],f:2,a:90},{p:[2046,1101],f:2,a:60},{p:[2049,1189],f:3,a:0},{p:[1927,1219],f:1,a:0},{p:[2018,1490],f:2,a:0},{p:[1975,1559],f:2,a:30},{p:[1919,1629],f:2,a:45},{p:[1853,1687],f:2,a:75},{p:[1778,1718],f:2,a:90},{p:[1507,1630],f:1,a:270},{p:[1235,1629],f:1,a:270},{p:[965,1631],f:1,a:270},{p:[692,1629],f:1,a:270},{p:[589,1670],f:2,a:120},{p:[522,1608],f:2,a:150},
{p:[489,1531],f:2,a:165},{p:[398,1271],f:1,a:180},{p:[500,1170],f:2,a:30},{p:[561,1102],f:2,a:60},{p:[645,1066],f:2,a:75},{p:[743,1061],f:2,a:90},{p:[834,1090],f:3,a:0},{p:[852,1062],f:3,a:0},{p:[768,964],f:2,a:135},{p:[525,860],f:1,a:90},{p:[434,955],f:2,a:90},{p:[345,954],f:2,a:90},{p:[245,915],f:2,a:120},{p:[165,864],f:2,a:135},{p:[111,793],f:2,a:150},{p:[13,542],f:1,a:0},{p:[101,451],f:2,a:180},{p:[100,360],f:2,a:180},{p:[99,271],f:2,a:180},{p:[104,169],f:2,a:210},{p:[154,95],f:2,a:225},{p:[230,
47],f:2,a:240},{p:[334,-54],f:1,a:270},{p:[605,34],f:2,a:270},{p:[694,35],f:2,a:270},{p:[783,35],f:2,a:270},{p:[853,46],f:2,a:300},{p:[915,109],f:2,a:330},{p:[957,213],f:2,a:0},{p:[511,180],f:1,a:270},{p:[726,331],f:2,a:0},{p:[737,401],f:2,a:330},{p:[801,465],f:2,a:300},{p:[903,417],f:1,a:270},{p:[1173,418],f:1,a:270},{p:[1443,416],f:1,a:270},{p:[1713,415],f:1,a:270},{p:[1985,504],f:2,a:270},{p:[2075,504],f:2,a:270},{p:[2144,505],f:2,a:300},{p:[2120,593],f:1,a:180},{p:[2152,832],f:2,a:240},{p:[2080,
867],f:2,a:270},{p:[1979,865],f:2,a:255},{p:[1889,890],f:2,a:240},{p:[1822,950],f:2,a:210},{p:[1787,1038],f:2,a:195},{p:[1692,1138],f:1,a:180},{p:[1763,1398],f:2,a:195},{p:[1702,1457],f:2,a:240},{p:[1452,1401],f:1,a:90},{p:[1182,1402],f:1,a:90},{p:[910,1402],f:1,a:90},{p:[809,1477],f:2,a:285},{p:[719,1427],f:2,a:315},{p:[716,1352],f:2,a:15},{p:[778,1292],f:2,a:75},{p:[878,1290],f:2,a:90},{p:[945,1244],f:2,a:60},{p:[1012,1186],f:2,a:30},{p:[967,935],f:1,a:0},{p:[1008,836],f:2,a:330},{p:[951,761],f:2,
a:315},{p:[879,724],f:2,a:285},{p:[617,634],f:1,a:270},{p:[408,264],f:2,a:255},{p:[342,322],f:2,a:195},{p:[248,422],f:1,a:180},{p:[346,669],f:2,a:135},{p:[443,718],f:2,a:90},{p:[530,724],f:2,a:90}],decals:[{p:[168,102],f:4,a:0},{p:[480,54],f:5,a:0},{p:[768,102],f:6,a:90},{p:[792,318],f:6,a:270},{p:[480,738],f:5,a:0},{p:[168,666],f:4,a:270},{p:[168,474],f:7,a:0},{p:[168,366],f:8,a:0},{p:[1008,294],f:5,a:180},{p:[1296,294],f:5,a:180},{p:[1584,294],f:5,a:180},{p:[1872,294],f:5,a:180},{p:[768,786],f:4,
a:90},{p:[864,1098],f:6,a:180},{p:[552,1122],f:4,a:0},{p:[552,1434],f:4,a:270},{p:[864,1506],f:5,a:180},{p:[1152,1506],f:5,a:180},{p:[1440,1506],f:5,a:180},{p:[1728,1434],f:4,a:180},{p:[1848,1242],f:7,a:0},{p:[1848,930],f:4,a:0},{p:[2160,342],f:4,a:90},{p:[2160,810],f:4,a:180},{p:[2280,666],f:8,a:0},{p:[2280,606],f:8,a:0},{p:[1806,360],f:9,a:90},{p:[1746,462],f:9,a:90},{p:[1674,360],f:9,a:90},{p:[1596,462],f:9,a:90},{p:[1512,360],f:9,a:90},{p:[1422,462],f:9,a:90},{p:[1848,348],f:10,a:90},{p:[1848,
426],f:10,a:90}],ai_waypoints:[{p:[2175,455],n:1},{p:[2315,618],n:2},{p:[2286,910],n:3},{p:[1985,1128],n:4},{p:[1862,1523],n:5},{p:[1605,1666],n:6},{p:[762,1595],n:7},{p:[645,1442],n:8},{p:[737,1272],n:9},{p:[918,1088],n:10},{p:[813,932],n:11},{p:[337,779],n:12},{p:[250,505],n:13},{p:[335,248],n:14},{p:[567,217],n:15},{p:[804,262],n:16},{p:[1044,400],n:17},{p:[1584,411],n:18}],checkpoints:[{p:[1891,294],n:1},{p:[2202,831],n:2},{p:[1773,1459],n:3},{p:[548,1473],n:4},{p:[604,1107],n:5},{p:[701,743],
n:6},{p:[163,700],n:7},{p:[219,75],n:8},{p:[710,95],n:9}],start_positions:[{p:[1758,354],n:1,a:90},{p:[1698,456],n:2,a:90},{p:[1626,354],n:3,a:90},{p:[1548,456],n:4,a:90},{p:[1464,354],n:5,a:90},{p:[1374,456],n:6,a:90}],dict:{1:"9tires.png",2:"3tires.png",3:"tire.png",4:"dideliskampas.png",5:"ilgas.png",6:"lenktas.png",7:"paprastas.png",8:"trumpas.png",9:"white_bar.png",10:"startbar.png"}},frogfoot:{size:[2500,2500],title:"Frogfoot Circuit",bgtile:"sand.png",props:[{p:[63,1250],f:1,a:0},{p:[59,980],
f:1,a:0},{p:[147,888],f:2,a:0},{p:[152,789],f:2,a:15},{p:[189,705],f:2,a:45},{p:[260,649],f:2,a:60},{p:[349,624],f:2,a:75},{p:[450,539],f:1,a:270},{p:[720,629],f:2,a:90},{p:[658,388],f:1,a:180},{p:[745,284],f:2,a:210},{p:[794,207],f:2,a:225},{p:[878,173],f:2,a:255},{p:[978,174],f:2,a:270},{p:[1059,171],f:2,a:285},{p:[1134,198],f:2,a:300},{p:[1195,272],f:2,a:345},{p:[1133,371],f:1,a:180},{p:[1252,641],f:3,a:0},{p:[1250,550],f:1,a:90},{p:[1521,633],f:2,a:270},{p:[1600,628],f:2,a:285},{p:[1680,653],
f:2,a:300},{p:[1748,713],f:2,a:330},{p:[1799,800],f:2,a:345},{p:[1819,900],f:2,a:0},{p:[1876,859],f:1,a:90},{p:[2135,945],f:2,a:285},{p:[2207,981],f:2,a:315},{p:[2257,1069],f:2,a:345},{p:[2278,1166],f:2,a:0},{p:[2265,1247],f:2,a:15},{p:[2221,1321],f:2,a:45},{p:[2155,1380],f:2,a:60},{p:[1903,1323],f:1,a:90},{p:[1871,1441],f:3,a:0},{p:[1820,1465],f:2,a:0},{p:[1796,1545],f:2,a:15},{p:[1744,1613],f:2,a:45},{p:[1676,1677],f:2,a:60},{p:[1597,1711],f:2,a:75},{p:[1337,1639],f:1,a:90},{p:[1249,1726],f:2,a:90},
{p:[1130,1787],f:1,a:0},{p:[1200,2045],f:2,a:15},{p:[1145,2114],f:2,a:45},{p:[1075,2161],f:2,a:75},{p:[997,2181],f:2,a:90},{p:[896,2166],f:2,a:105},{p:[804,2129],f:2,a:120},{p:[749,2063],f:2,a:150},{p:[660,1812],f:1,a:0},{p:[782,1780],f:3,a:0},{p:[770,1754],f:3,a:0},{p:[498,1635],f:1,a:270},{p:[407,1723],f:2,a:90},{p:[307,1698],f:2,a:105},{p:[220,1649],f:2,a:135},{p:[166,1580],f:2,a:150},{p:[151,1514],f:2,a:180},{p:[1015,1984],f:3,a:0},{p:[1015,1780],f:3,a:0},{p:[1016,640],f:3,a:0},{p:[1018,432],
f:3,a:0},{p:[2079,1211],f:3,a:0},{p:[1881,1210],f:3,a:0},{p:[290,1192],f:1,a:180},{p:[389,1434],f:2,a:135},{p:[483,1402],f:1,a:90},{p:[752,1402],f:1,a:90},{p:[1023,1402],f:1,a:90},{p:[1293,1402],f:1,a:90},{p:[1535,1444],f:2,a:45},{p:[1496,1199],f:1,a:0},{p:[1588,1106],f:2,a:0},{p:[1590,1013],f:2,a:0},{p:[1561,908],f:2,a:330},{p:[1501,861],f:2,a:285},{p:[1239,773],f:1,a:270},{p:[969,772],f:1,a:270},{p:[701,770],f:1,a:270},{p:[610,857],f:2,a:270},{p:[520,855],f:2,a:270},{p:[418,859],f:2,a:240},{p:[376,
937],f:2,a:195},{p:[377,1035],f:2,a:180},{p:[408,1160],f:3,a:0},{p:[407,1125],f:3,a:0}],decals:[{p:[216,696],f:4,a:0},{p:[528,648],f:5,a:0},{p:[816,552],f:6,a:0},{p:[1248,648],f:5,a:0},{p:[1536,696],f:4,a:90},{p:[1560,1008],f:6,a:90},{p:[1536,1440],f:4,a:180},{p:[1248,1512],f:5,a:0},{p:[816,1464],f:6,a:180},{p:[528,1512],f:5,a:0},{p:[216,1440],f:4,a:270},{p:[168,1008],f:5,a:90},{p:[216,1296],f:7,a:0},{p:[216,1248],f:7,a:0},{p:[816,456],f:8,a:0},{p:[1056,456],f:8,a:0},{p:[816,240],f:9,a:0},{p:[1032,
240],f:9,a:90},{p:[1896,1008],f:8,a:90},{p:[1896,1248],f:8,a:90},{p:[2088,1224],f:9,a:180},{p:[2088,1008],f:9,a:90},{p:[1056,1800],f:8,a:180},{p:[816,1800],f:8,a:180},{p:[816,1992],f:9,a:270},{p:[1032,1992],f:9,a:180},{p:[342,1068],f:10,a:0},{p:[234,1140],f:10,a:0},{p:[342,1212],f:10,a:0},{p:[234,1296],f:10,a:0},{p:[336,1374],f:10,a:0},{p:[228,1452],f:10,a:0},{p:[222,1002],f:11,a:0},{p:[300,1002],f:11,a:0},{p:[954,738],f:12,a:180},{p:[954,810],f:12,a:180},{p:[1092,546],f:13,a:270},{p:[1164,546],f:13,
a:270},{p:[876,630],f:14,a:270},{p:[930,630],f:14,a:270},{p:[1698,1086],f:12,a:270},{p:[1776,1086],f:12,a:270},{p:[1938,1290],f:13,a:0},{p:[1944,1356],f:13,a:0},{p:[1884,1056],f:14,a:0},{p:[1884,1128],f:14,a:0},{p:[852,1866],f:13,a:90},{p:[930,1860],f:13,a:90},{p:[1104,1788],f:14,a:90},{p:[1176,1788],f:14,a:90},{p:[1092,1596],f:12,a:0},{p:[1092,1668],f:12,a:0}],ai_waypoints:[{p:[333,907],n:1},{p:[467,792],n:2},{p:[1073,712],n:3},{p:[1124,479],n:4},{p:[1007,356],n:5},{p:[871,576],n:6},{p:[1094,800],
n:7},{p:[1582,820],n:8},{p:[1834,1278],n:9},{p:[2156,1266],n:10},{p:[2119,1132],n:11},{p:[1794,1150],n:12},{p:[1678,1508],n:13},{p:[1453,1619],n:14},{p:[954,1713],n:15},{p:[953,2055],n:16},{p:[1079,2056],n:17},{p:[1162,1867],n:18},{p:[959,1654],n:19},{p:[446,1605],n:20},{p:[325,1491],n:21},{p:[295,1199],n:22}],checkpoints:[{p:[158,778],n:1},{p:[984,630],n:2},{p:[992,205],n:3},{p:[777,218],n:4},{p:[801,633],n:5},{p:[1556,732],n:6},{p:[1638,1188],n:7},{p:[2055,1203],n:8},{p:[2029,972],n:9},{p:[1633,
998],n:10},{p:[1435,1522],n:11},{p:[779,1546],n:12},{p:[792,1954],n:13},{p:[1003,1958],n:14},{p:[982,1522],n:15},{p:[197,1467],n:16}],start_positions:[{p:[336,1104],n:1,a:0},{p:[228,1176],n:2,a:0},{p:[336,1248],n:3,a:0},{p:[228,1332],n:4,a:0},{p:[330,1416],n:5,a:0},{p:[222,1488],n:6,a:0}],dict:{1:"9tires.png",2:"3tires.png",3:"tire.png",4:"dideliskampas.png",5:"ilgas.png",6:"uglyduckling.png",7:"trumpas.png",8:"paprastas.png",9:"lenktas.png",10:"white_bar.png",11:"startbar.png",12:"arrow4.png",13:"arrow.png",
14:"arrow5.png"}},"2_icemanloops":{size:[3400,2500],title:"Iceman Loops",bgtile:"snow.png",props:[{p:[785,184],f:1,a:270},{p:[683,278],f:2,a:240},{p:[606,326],f:2,a:225},{p:[553,399],f:2,a:210},{p:[455,500],f:1,a:180},{p:[687,611],f:1,a:180},{p:[792,513],f:2,a:225},{p:[1056,183],f:1,a:90},{p:[1327,274],f:2,a:270},{p:[1418,272],f:2,a:270},{p:[1498,274],f:2,a:285},{p:[1569,307],f:2,a:315},{p:[1628,379],f:2,a:330},{p:[1669,470],f:2,a:345},{p:[1685,570],f:2,a:0},{p:[1592,659],f:1,a:0},{p:[894,413],f:1,
a:270},{p:[793,851],f:2,a:315},{p:[893,808],f:1,a:270},{p:[1164,413],f:1,a:270},{p:[1164,808],f:1,a:270},{p:[1433,927],f:3,a:0},{p:[1463,929],f:3,a:0},{p:[1487,903],f:3,a:0},{p:[1366,633],f:1,a:180},{p:[1407,523],f:2,a:315},{p:[1713,899],f:2,a:270},{p:[1794,954],f:3,a:0},{p:[1822,941],f:2,a:270},{p:[1912,940],f:2,a:270},{p:[1984,903],f:2,a:240},{p:[1991,690],f:1,a:180},{p:[2082,932],f:3,a:0},{p:[2080,599],f:2,a:180},{p:[2077,500],f:2,a:195},{p:[2108,414],f:2,a:225},{p:[2189,373],f:2,a:255},{p:[2289,
280],f:1,a:90},{p:[2560,281],f:1,a:90},{p:[2806,380],f:2,a:300},{p:[2871,438],f:2,a:330},{p:[2917,539],f:2,a:0},{p:[2828,630],f:1,a:0},{p:[2340,505],f:1,a:270},{p:[2216,654],f:1,a:180},{p:[2339,810],f:1,a:90},{p:[2600,880],f:2,a:255},{p:[2659,820],f:2,a:210},{p:[2609,594],f:2,a:270},{p:[2670,615],f:2,a:345},{p:[2693,713],f:2,a:0},{p:[2721,807],f:3,a:0},{p:[2920,903],f:2,a:0},{p:[2875,974],f:2,a:30},{p:[2817,1046],f:2,a:45},{p:[2748,1095],f:2,a:75},{p:[2489,1034],f:1,a:90},{p:[2399,1126],f:2,a:90},
{p:[2369,1155],f:3,a:0},{p:[2339,1160],f:3,a:0},{p:[2218,1191],f:1,a:0},{p:[2306,1462],f:2,a:0},{p:[2304,1533],f:2,a:330},{p:[2376,1596],f:2,a:285},{p:[2475,1618],f:2,a:270},{p:[2541,1629],f:2,a:300},{p:[2604,1693],f:2,a:330},{p:[2643,1794],f:2,a:0},{p:[2641,1884],f:2,a:0},{p:[2621,1963],f:2,a:15},{p:[2559,2024],f:2,a:45},{p:[2490,2069],f:2,a:75},{p:[2231,1994],f:1,a:90},{p:[1961,1994],f:1,a:90},{p:[1691,1996],f:1,a:90},{p:[1421,1996],f:1,a:90},{p:[1331,2085],f:2,a:90},{p:[1231,2063],f:2,a:105},{p:[1148,
2009],f:2,a:135},{p:[1113,1940],f:2,a:165},{p:[1118,1861],f:2,a:180},{p:[1116,1769],f:2,a:180},{p:[1129,1672],f:2,a:225},{p:[1201,1619],f:2,a:240},{p:[1305,1617],f:2,a:270},{p:[1375,1583],f:2,a:240},{p:[1436,1518],f:2,a:195},{p:[1457,1427],f:2,a:225},{p:[1498,1365],f:2,a:180},{p:[1498,1274],f:2,a:180},{p:[1453,1175],f:2,a:135},{p:[1247,1030],f:1,a:90},{p:[1485,1177],f:3,a:0},{p:[975,1033],f:1,a:90},{p:[884,1124],f:2,a:90},{p:[793,1124],f:2,a:90},{p:[693,1098],f:2,a:105},{p:[608,1045],f:2,a:135},{p:[555,
975],f:2,a:150},{p:[542,905],f:2,a:180},{p:[542,816],f:2,a:180},{p:[574,780],f:3,a:0},{p:[1379,1883],f:3,a:0},{p:[1590,1640],f:1,a:0},{p:[1741,1763],f:1,a:270},{p:[1525,1880],f:3,a:0},{p:[1630,1847],f:3,a:0},{p:[1683,1546],f:2,a:180},{p:[1648,1437],f:2,a:135},{p:[1642,1372],f:2,a:180},{p:[1641,1278],f:2,a:180},{p:[1646,1177],f:2,a:225},{p:[1715,1169],f:3,a:0},{p:[1724,1096],f:2,a:240},{p:[1831,1088],f:2,a:270},{p:[1927,1084],f:2,a:270},{p:[1996,1092],f:2,a:300},{p:[1989,1159],f:1,a:180},{p:[1988,
1432],f:1,a:180},{p:[2077,1702],f:2,a:180},{p:[2077,1792],f:2,a:180},{p:[2012,1853],f:2,a:90},{p:[2104,1882],f:3,a:0},{p:[2439,1878],f:3,a:0},{p:[2284,1882],f:3,a:0},{p:[2171,1843],f:3,a:0}],decals:[{p:[606,840],f:4,a:270},{p:[918,912],f:5,a:180},{p:[1206,912],f:5,a:180},{p:[1494,936],f:6,a:0},{p:[1734,960],f:7,a:180},{p:[1926,960],f:7,a:0},{p:[2118,936],f:6,a:0},{p:[2346,912],f:5,a:180},{p:[2634,840],f:4,a:180},{p:[2754,648],f:8,a:0},{p:[2730,432],f:9,a:90},{p:[2094,648],f:5,a:270},{p:[2442,384],
f:5,a:0},{p:[2142,432],f:9,a:0},{p:[2310,432],f:10,a:270},{p:[2094,1176],f:5,a:90},{p:[1518,1176],f:7,a:270},{p:[1518,1368],f:7,a:90},{p:[2142,1416],f:10,a:0},{p:[1470,648],f:5,a:270},{p:[1398,336],f:4,a:90},{p:[1110,288],f:5,a:0},{p:[606,648],f:8,a:180},{p:[606,336],f:4,a:0},{p:[918,336],f:8,a:270},{p:[1398,1560],f:4,a:180},{p:[1182,1680],f:9,a:0},{p:[1182,1896],f:9,a:270},{p:[1398,1872],f:5,a:180},{p:[1686,1872],f:5,a:180},{p:[1974,1872],f:5,a:180},{p:[2142,1560],f:4,a:270},{p:[2454,1680],f:9,a:90},
{p:[2454,1896],f:9,a:180},{p:[2262,1920],f:8,a:270},{p:[864,966],f:11,a:90},{p:[864,1044],f:11,a:90},{p:[912,978],f:12,a:270},{p:[972,1080],f:12,a:270},{p:[1032,978],f:12,a:270},{p:[1092,1080],f:12,a:270},{p:[1146,978],f:12,a:270},{p:[1194,1080],f:12,a:270}],laps:3,ai_waypoints:[{p:[789,977],n:1},{p:[715,852],n:2},{p:[717,569],n:3},{p:[840,464],n:4},{p:[1428,463],n:5},{p:[1547,593],n:6},{p:[1588,1038],n:7},{p:[1595,1522],n:8},{p:[1306,1820],n:9},{p:[1408,2030],n:10},{p:[2326,2047],n:11},{p:[2500,
1873],n:12},{p:[2373,1705],n:13},{p:[2258,1574],n:14},{p:[2222,1039],n:15},{p:[2207,666],n:16},{p:[2319,546],n:17},{p:[2760,575],n:18},{p:[2830,800],n:19},{p:[2687,977],n:20},{p:[2179,1048],n:21},{p:[1547,1040],n:22}],checkpoints:[{p:[640,904],n:1},{p:[601,337],n:2},{p:[1408,364],n:3},{p:[1471,923],n:4},{p:[1462,1468],n:5},{p:[1129,1882],n:6},{p:[2437,1868],n:7},{p:[2096,1429],n:8},{p:[2097,925],n:9},{p:[2137,421],n:10},{p:[2681,427],n:11},{p:[2666,879],n:12},{p:[1778,901],n:13}],start_positions:[{p:[948,
972],n:1,a:270},{p:[1008,1074],n:2,a:270},{p:[1068,972],n:3,a:270},{p:[1128,1074],n:4,a:270},{p:[1188,972],n:5,a:270},{p:[1236,1074],n:6,a:270}],dict:{1:"9tires.png",2:"3tires.png",3:"tire.png",4:"dideliskampas.png",5:"ilgas.png",6:"kryzius.png",7:"siaurasiplatu.png",8:"paprastas.png",9:"lenktas.png",10:"trumpas.png",11:"startbar.png",12:"white_bar.png"}},"2_vultureplains":{size:[3100,1900],title:"Vulture Plains",bgtile:"sand.png",props:[{p:[1003,334],f:1,a:180},{p:[1077,233],f:2,a:345},{p:[1039,
145],f:2,a:330},{p:[983,71],f:2,a:315},{p:[914,32],f:2,a:285},{p:[656,-66],f:1,a:90},{p:[386,-67],f:1,a:90},{p:[284,28],f:2,a:240},{p:[207,79],f:2,a:225},{p:[152,148],f:2,a:210},{p:[144,250],f:2,a:180},{p:[53,341],f:1,a:0},{p:[54,612],f:1,a:0},{p:[52,881],f:1,a:0},{p:[141,1149],f:2,a:180},{p:[154,1216],f:2,a:150},{p:[223,1273],f:2,a:120},{p:[324,1311],f:2,a:90},{p:[415,1342],f:3,a:0},{p:[446,1342],f:3,a:0},{p:[431,1372],f:2,a:0},{p:[430,1452],f:2,a:345},{p:[462,1526],f:2,a:330},{p:[528,1586],f:2,
a:300},{p:[616,1629],f:2,a:285},{p:[715,1557],f:1,a:270},{p:[659,818],f:2,a:180},{p:[719,780],f:2,a:90},{p:[772,1070],f:2,a:75},{p:[832,1007],f:2,a:30},{p:[404,1087],f:2,a:90},{p:[368,1027],f:2,a:180},{p:[434,1025],f:2,a:180},{p:[429,713],f:2,a:0},{p:[443,614],f:2,a:45},{p:[514,557],f:2,a:60},{p:[615,555],f:2,a:90},{p:[397,768],f:3,a:0},{p:[364,676],f:2,a:180},{p:[365,586],f:2,a:180},{p:[372,292],f:2,a:30},{p:[448,249],f:2,a:75},{p:[803,262],f:2,a:315},{p:[857,357],f:2,a:0},{p:[832,555],f:2,a:270},
{p:[896,552],f:3,a:0},{p:[1087,811],f:2,a:0},{p:[1147,783],f:2,a:270},{p:[1087,901],f:2,a:180},{p:[656,1329],f:2,a:165},{p:[719,1309],f:2,a:90},{p:[808,1308],f:2,a:90},{p:[712,1394],f:2,a:105},{p:[808,1417],f:2,a:90},{p:[399,394],f:3,a:0},{p:[800,281],f:3,a:0},{p:[895,522],f:3,a:0},{p:[1152,462],f:1,a:270},{p:[1422,461],f:1,a:270},{p:[1694,552],f:2,a:90},{p:[1784,582],f:3,a:0},{p:[1804,552],f:3,a:0},{p:[1772,461],f:2,a:0},{p:[1773,357],f:2,a:30},{p:[1825,283],f:2,a:45},{p:[1898,229],f:2,a:60},{p:[1998,
219],f:2,a:90},{p:[2090,130],f:1,a:270},{p:[2360,131],f:1,a:270},{p:[2609,229],f:2,a:120},{p:[2680,281],f:2,a:135},{p:[2737,366],f:2,a:165},{p:[2679,465],f:1,a:180},{p:[2680,737],f:1,a:180},{p:[2768,1009],f:2,a:180},{p:[2756,1091],f:2,a:195},{p:[2716,1171],f:2,a:210},{p:[2655,1239],f:2,a:240},{p:[2580,1287],f:2,a:255},{p:[2502,1309],f:2,a:270},{p:[2416,1309],f:2,a:270},{p:[2325,1307],f:2,a:270},{p:[2293,1337],f:3,a:0},{p:[2269,1363],f:3,a:0},{p:[2239,1393],f:2,a:180},{p:[2161,1541],f:2,a:225},{p:[2093,
1601],f:2,a:240},{p:[2218,1472],f:2,a:195},{p:[1842,1554],f:1,a:90},{p:[1570,1556],f:1,a:90},{p:[987,1558],f:1,a:90},{p:[1256,1559],f:1,a:90},{p:[1538,1675],f:3,a:0},{p:[897,1330],f:1,a:90},{p:[1169,1328],f:1,a:90},{p:[1439,1330],f:1,a:90},{p:[1712,1329],f:1,a:90},{p:[1953,1369],f:2,a:225},{p:[2044,1367],f:3,a:0},{p:[2047,1338],f:3,a:0},{p:[2017,1342],f:3,a:0},{p:[1924,1309],f:2,a:90},{p:[1822,1258],f:2,a:135},{p:[1766,1189],f:2,a:150},{p:[1677,939],f:1,a:0},{p:[1770,849],f:2,a:180},{p:[1563,692],
f:1,a:270},{p:[1236,691],f:1,a:270},{p:[1506,810],f:3,a:0},{p:[1533,809],f:3,a:0},{p:[886,1288],f:2,a:75},{p:[962,1248],f:2,a:60},{p:[1027,1185],f:2,a:30},{p:[1067,1110],f:2,a:15},{p:[1089,1035],f:2,a:0},{p:[1119,997],f:3,a:0},{p:[2036,1108],f:3,a:0},{p:[2034,817],f:3,a:0},{p:[2035,559],f:2,a:270},{p:[2E3,488],f:2,a:210},{p:[2411,446],f:2,a:270},{p:[2476,453],f:2,a:315},{p:[2524,540],f:2,a:345},{p:[2271,1086],f:2,a:270},{p:[2242,1024],f:2,a:180},{p:[2452,1065],f:2,a:75},{p:[2511,1001],f:2,a:30}],
decals:[{p:[204,90],f:4,a:0},{p:[516,42],f:5,a:180},{p:[804,90],f:4,a:90},{p:[924,402],f:6,a:0},{p:[156,402],f:5,a:270},{p:[156,690],f:5,a:270},{p:[756,618],f:7,a:90},{p:[660,618],f:7,a:90},{p:[492,618],f:8,a:0},{p:[444,834],f:5,a:270},{p:[468,1122],f:9,a:0},{p:[924,834],f:6,a:0},{p:[804,1026],f:4,a:180},{p:[660,1146],f:7,a:270},{p:[324,1146],f:7,a:270},{p:[204,930],f:7,a:0},{p:[204,1122],f:8,a:270},{p:[204,978],f:7,a:0},{p:[492,1362],f:4,a:270},{p:[804,1434],f:5,a:0},{p:[1092,1434],f:5,a:0},{p:[1380,
1434],f:5,a:0},{p:[1668,1434],f:5,a:0},{p:[1956,1362],f:4,a:180},{p:[1140,618],f:6,a:90},{p:[900,594],f:10,a:0},{p:[1836,1122],f:8,a:270},{p:[2292,1146],f:6,a:270},{p:[2484,1026],f:4,a:180},{p:[1788,834],f:5,a:90},{p:[2052,1122],f:10,a:90},{p:[1716,618],f:7,a:90},{p:[1812,594],f:9,a:90},{p:[2052,618],f:8,a:90},{p:[2028,834],f:5,a:90},{p:[1836,282],f:4,a:0},{p:[2556,738],f:5,a:90},{p:[2148,234],f:5,a:180},{p:[2484,282],f:4,a:90},{p:[2604,594],f:6,a:0},{p:[2346,282],f:7,a:90},{p:[1332,570],f:5,a:180},
{p:[1572,618],f:7,a:90},{p:[1620,618],f:7,a:90},{p:[1050,1488],f:11,a:90},{p:[1050,1566],f:11,a:90},{p:[1134,1500],f:12,a:270},{p:[1212,1602],f:12,a:270},{p:[1290,1500],f:12,a:270},{p:[1368,1602],f:12,a:270},{p:[1446,1500],f:12,a:270},{p:[1524,1602],f:12,a:270},{p:[534,1356],f:13,a:270},{p:[606,1356],f:13,a:270},{p:[708,1188],f:13,a:180},{p:[708,1260],f:13,a:180},{p:[1788,654],f:13,a:0},{p:[1788,720],f:13,a:0},{p:[1878,834],f:13,a:270},{p:[1944,834],f:13,a:270}],laps:3,ai_waypoints:[{p:[722,1530],
n:1},{p:[577,1339],n:2},{p:[538,1004],n:3},{p:[630,743],n:4},{p:[778,679],n:5},{p:[963,800],n:6},{p:[949,1103],n:7},{p:[667,1251],n:8},{p:[326,1151],n:9},{p:[281,698],n:10},{p:[327,302],n:11},{p:[464,211],n:12},{p:[871,223],n:13},{p:[961,338],n:14},{p:[1096,655],n:15},{p:[1757,649],n:16},{p:[2084,763],n:17},{p:[2179,954],n:18},{p:[2063,1163],n:19},{p:[1951,1098],n:20},{p:[1908,847],n:21},{p:[1953,498],n:22},{p:[2106,400],n:23},{p:[2523,398],n:24},{p:[2646,574],n:25},{p:[2681,810],n:26},{p:[2622,1080],
n:27},{p:[2489,1181],n:28},{p:[2212,1295],n:29},{p:[2062,1469],n:30},{p:[1632,1558],n:31}],checkpoints:[{p:[825,1441],n:1},{p:[449,1336],n:2},{p:[455,603],n:3},{p:[844,620],n:4},{p:[793,1058],n:5},{p:[213,1081],n:6},{p:[155,542],n:7},{p:[202,112],n:8},{p:[848,118],n:9},{p:[910,571],n:10},{p:[1981,582],n:11},{p:[2024,1093],n:12},{p:[1801,1085],n:13},{p:[1810,335],n:14},{p:[2538,335],n:15},{p:[2521,1032],n:16},{p:[2064,1107],n:17},{p:[1723,1420],n:18}],start_positions:[{p:[1170,1494],n:1,a:270},{p:[1248,
1596],n:2,a:270},{p:[1326,1494],n:3,a:270},{p:[1404,1596],n:4,a:270},{p:[1482,1494],n:5,a:270},{p:[1560,1596],n:6,a:270}],dict:{1:"9tires.png",2:"3tires.png",3:"tire.png",4:"dideliskampas.png",5:"ilgas.png",6:"paprastas.png",7:"trumpas.png",8:"lenktas.png",9:"kryzius.png",10:"susikerta.png",11:"startbar.png",12:"white_bar.png",13:"arrow.png"}},"2_queersands":{size:[2500,2500],title:"Queer Sands",bgtile:"sand.png",props:[{p:[964,321],f:1,a:0},{p:[1372,322],f:1,a:0},{p:[487,405],f:2,a:90},{p:[579,405],
f:2,a:270},{p:[670,405],f:2,a:270},{p:[436,463],f:2,a:180},{p:[435,555],f:2,a:180},{p:[1890,906],f:2,a:180},{p:[1485,940],f:2,a:270},{p:[1614,940],f:2,a:270},{p:[1576,967],f:1,a:285},{p:[1422,1180],f:2,a:270},{p:[832,1965],f:2,a:180},{p:[1421,1660],f:2,a:90},{p:[1150,1570],f:3,a:90},{p:[1718,1802],f:3,a:270},{p:[1223,1810],f:3,a:270},{p:[1357,1961],f:3,a:180},{p:[1723,1571],f:3,a:90},{p:[1718,1134],f:1,a:285},{p:[1706,1102],f:1,a:285},{p:[1688,1067],f:1,a:285},{p:[1677,1032],f:1,a:285},{p:[1677,1E3],
f:1,a:285},{p:[1318,1182],f:2,a:75},{p:[1236,1225],f:2,a:45},{p:[1219,1329],f:2,a:0},{p:[1997,526],f:3,a:180},{p:[1838,530],f:3,a:180},{p:[2132,498],f:1,a:285},{p:[1126,863],f:3,a:180},{p:[1461,614],f:3,a:90},{p:[580,1986],f:2,a:345},{p:[521,1909],f:2,a:300},{p:[450,1897],f:2,a:270},{p:[595,2079],f:2,a:345},{p:[628,2152],f:2,a:315},{p:[715,2209],f:2,a:285},{p:[828,2231],f:2,a:270},{p:[918,2211],f:2,a:255},{p:[996,2155],f:2,a:225},{p:[1051,2083],f:2,a:195},{p:[1070,1989],f:2,a:195},{p:[1119,1910],
f:2,a:240},{p:[1451,2226],f:2,a:165},{p:[1491,2300],f:2,a:135},{p:[1565,2363],f:2,a:120},{p:[1661,2407],f:2,a:105},{p:[1766,2427],f:2,a:90},{p:[1858,2427],f:2,a:90},{p:[1950,2428],f:2,a:90},{p:[2043,2428],f:2,a:90},{p:[2127,2404],f:2,a:75},{p:[2205,2360],f:2,a:60},{p:[1691,1601],f:2,a:0},{p:[1646,1494],f:2,a:330},{p:[1581,1444],f:2,a:285},{p:[1485,1420],f:2,a:270},{p:[1573,1386],f:2,a:255},{p:[1644,1321],f:2,a:225},{p:[1693,1241],f:2,a:195},{p:[1715,1162],f:2,a:180},{p:[1765,1152],f:2,a:105},{p:[1867,
1174],f:2,a:90},{p:[1964,1173],f:2,a:90},{p:[2036,1125],f:2,a:60},{p:[2093,1057],f:2,a:30},{p:[2121,981],f:2,a:0},{p:[2090,864],f:2,a:330},{p:[2124,404],f:2,a:180},{p:[2103,300],f:2,a:165},{p:[2054,209],f:2,a:135},{p:[1983,174],f:2,a:105},{p:[1719,84],f:3,a:270},{p:[1645,314],f:3,a:270},{p:[1625,173],f:2,a:90},{p:[1522,154],f:2,a:105},{p:[1445,97],f:2,a:120},{p:[1366,63],f:2,a:105},{p:[1273,67],f:2,a:75},{p:[1543,401],f:2,a:75},{p:[1454,443],f:2,a:60},{p:[1378,492],f:2,a:75},{p:[1290,495],f:2,a:105},
{p:[1201,453],f:2,a:120},{p:[1182,104],f:2,a:45},{p:[1198,457],f:1,a:0},{p:[1171,435],f:1,a:0},{p:[1141,456],f:1,a:0},{p:[1190,201],f:1,a:0},{p:[1162,209],f:1,a:0},{p:[1132,183],f:1,a:0},{p:[1042,446],f:2,a:60},{p:[966,493],f:2,a:75},{p:[876,494],f:2,a:105},{p:[786,449],f:2,a:120},{p:[1038,96],f:2,a:120},{p:[956,65],f:2,a:105},{p:[865,71],f:2,a:75},{p:[771,103],f:2,a:60},{p:[700,156],f:2,a:75},{p:[615,179],f:2,a:90},{p:[581,210],f:1,a:0},{p:[761,435],f:1,a:0},{p:[786,453],f:1,a:0},{p:[487,179],f:2,
a:90},{p:[395,179],f:2,a:90},{p:[289,184],f:2,a:60},{p:[219,247],f:2,a:30},{p:[211,351],f:2,a:0},{p:[117,446],f:3,a:180},{p:[435,646],f:2,a:0},{p:[307,721],f:3,a:180},{p:[396,994],f:2,a:0},{p:[356,1060],f:2,a:45},{p:[349,1162],f:2,a:0},{p:[351,1254],f:2,a:0},{p:[208,718],f:2,a:0},{p:[208,809],f:2,a:0},{p:[177,883],f:2,a:30},{p:[166,986],f:2,a:0},{p:[169,1059],f:2,a:330},{p:[202,1163],f:2,a:0},{p:[202,1257],f:2,a:0},{p:[157,1325],f:2,a:15},{p:[375,1326],f:2,a:345},{p:[69,1426],f:3,a:180},{p:[398,1428],
f:2,a:0},{p:[397,1521],f:2,a:0},{p:[397,1594],f:2,a:330},{p:[475,1651],f:2,a:285},{p:[580,1668],f:2,a:270},{p:[655,1673],f:2,a:300},{p:[730,1725],f:2,a:315},{p:[785,1811],f:2,a:345},{p:[164,1687],f:2,a:345},{p:[196,1765],f:2,a:330},{p:[263,1832],f:2,a:300},{p:[351,1874],f:2,a:285},{p:[832,1876],f:2,a:0},{p:[859,1810],f:2,a:15},{p:[903,1723],f:2,a:45},{p:[991,1684],f:2,a:75},{p:[1093,1706],f:1,a:0},{p:[1120,1692],f:1,a:0},{p:[1273,1599],f:2,a:120},{p:[1219,1528],f:2,a:150},{p:[1217,1457],f:2,a:180},
{p:[1246,1419],f:1,a:0},{p:[2264,2286],f:2,a:210},{p:[2304,2204],f:2,a:195},{p:[2320,2121],f:2,a:180},{p:[2321,2025],f:2,a:180},{p:[2319,1932],f:2,a:180},{p:[2292,1833],f:2,a:165},{p:[2236,1742],f:2,a:135},{p:[2166,1687],f:2,a:120},{p:[2087,1660],f:2,a:105},{p:[2001,1662],f:2,a:90},{p:[1983,1889],f:2,a:105},{p:[2049,1934],f:2,a:150},{p:[1688,1953],f:2,a:180},{p:[1691,2044],f:2,a:180},{p:[1690,2117],f:2,a:150},{p:[1765,2177],f:2,a:105},{p:[1867,2195],f:2,a:90},{p:[1958,2195],f:2,a:90},{p:[2084,2040],
f:2,a:0},{p:[2056,2112],f:2,a:30},{p:[2048,2218],f:1,a:0},{p:[2057,2188],f:1,a:0},{p:[1244,1100],f:2,a:315},{p:[1344,1184],f:1,a:0},{p:[1232,760],f:2,a:225},{p:[1353,702],f:2,a:255},{p:[1729,701],f:2,a:285},{p:[1805,733],f:2,a:315},{p:[1892,828],f:1,a:0},{p:[1906,856],f:1,a:0},{p:[1960,804],f:1,a:0},{p:[1961,836],f:1,a:0},{p:[1960,867],f:1,a:0},{p:[1931,875],f:1,a:0},{p:[1330,767],f:1,a:0},{p:[2116,855],f:1,a:0},{p:[2116,795],f:1,a:0},{p:[2114,825],f:1,a:0},{p:[1917,435],f:1,a:0},{p:[1925,465],f:1,
a:0},{p:[1937,498],f:1,a:0}],decals:[{p:[486,192],f:4,a:0},{p:[672,132],f:5,a:270},{p:[876,132],f:5,a:90},{p:[1080,132],f:5,a:270},{p:[1284,132],f:5,a:90},{p:[270,240],f:6,a:0},{p:[270,456],f:7,a:0},{p:[270,648],f:8,a:180},{p:[228,840],f:8,a:0},{p:[228,1032],f:9,a:180},{p:[228,1224],f:10,a:180},{p:[228,1416],f:7,a:0},{p:[540,1728],f:11,a:90},{p:[660,2040],f:6,a:270},{p:[876,2040],f:6,a:180},{p:[900,1728],f:11,a:0},{p:[1212,1680],f:4,a:180},{p:[1500,1704],f:12,a:0},{p:[1524,1944],f:7,a:0},{p:[1740,
1680],f:4,a:180},{p:[1524,2136],f:11,a:270},{p:[2028,1728],f:11,a:90},{p:[2028,2136],f:11,a:180},{p:[1836,2256],f:7,a:270},{p:[2148,1992],f:13,a:0},{p:[1500,1488],f:6,a:90},{p:[1284,1464],f:6,a:270},{p:[1284,1248],f:6,a:0},{p:[1500,1224],f:6,a:180},{p:[1500,1008],f:6,a:90},{p:[1284,984],f:6,a:270},{p:[1284,768],f:6,a:0},{p:[1500,768],f:7,a:270},{p:[1692,768],f:6,a:90},{p:[1716,984],f:6,a:270},{p:[1932,984],f:6,a:180},{p:[1956,792],f:14,a:90},{p:[1590,192],f:4,a:180},{p:[1956,648],f:15,a:90},{p:[1956,
456],f:14,a:270},{p:[1932,240],f:6,a:90},{p:[1788,240],f:13,a:270},{p:[1596,1704],f:16,a:90},{p:[1596,1890],f:16,a:90},{p:[1518,1812],f:16,a:180},{p:[1698,1812],f:16,a:180},{p:[228,1608],f:11,a:270},{p:[702,252],f:17,a:270},{p:[702,312],f:17,a:270},{p:[702,372],f:17,a:270},{p:[606,372],f:17,a:270},{p:[606,312],f:17,a:270},{p:[606,252],f:17,a:270},{p:[696,324],f:18,a:90},{p:[696,246],f:18,a:90}],laps:3,ai_waypoints:[{p:[951,256],n:1},{p:[1367,387],n:2},{p:[1799,272],n:3},{p:[2014,436],n:4},{p:[2037,
927],n:5},{p:[1920,1044],n:6},{p:[1699,897],n:7},{p:[1569,831],n:8},{p:[1405,955],n:9},{p:[1556,1205],n:10},{p:[1383,1468],n:11},{p:[1547,1643],n:12},{p:[1579,2034],n:13},{p:[1722,2288],n:14},{p:[2107,2286],n:15},{p:[2236,2062],n:16},{p:[2070,1860],n:17},{p:[1598,1803],n:18},{p:[1078,1881],n:19},{p:[882,2096],n:20},{p:[642,1908],n:21},{p:[349,1648],n:22},{p:[300,1350],n:23},{p:[333,687],n:24},{p:[417,376],n:25}],checkpoints:[{p:[741,210],n:1},{p:[1886,224],n:2},{p:[1935,942],n:3},{p:[1458,1180],n:4},
{p:[1207,1472],n:5},{p:[1483,2179],n:6},{p:[2095,2195],n:7},{p:[2086,1698],n:8},{p:[896,1701],n:9},{p:[739,2035],n:10},{p:[182,1666],n:11},{p:[210,176],n:12}],start_positions:[{p:[660,246],n:1,a:90},{p:[660,306],n:2,a:90},{p:[564,306],n:3,a:90},{p:[564,246],n:4,a:90},{p:[660,366],n:5,a:90},{p:[564,366],n:6,a:90}],dict:{1:"tire.png",2:"3tires.png",3:"9tires.png",4:"ilgas.png",5:"issisakojimas.png",6:"lenktas.png",7:"paprastas.png",8:"sonaslenktas2.png",9:"siaurejantis2.png",10:"siaurejantis1.png",
11:"dideliskampas.png",12:"kryzius.png",13:"trumpas.png",14:"siaurasiplatu.png",15:"siauras.png",16:"arrow.png",17:"white_bar.png",18:"startbar.png"}},"1_bloodbathlane":{size:[2800,1E3],title:"Bloodbath Lane",bgtile:"snow.png",props:[{p:[739,144],f:1,a:270},{p:[1011,144],f:1,a:270},{p:[1280,144],f:1,a:270},{p:[1550,143],f:1,a:270},{p:[1820,238],f:2,a:270},{p:[1911,235],f:2,a:270},{p:[2001,265],f:3,a:0},{p:[2033,262],f:3,a:0},{p:[2007,171],f:2,a:180},{p:[2023,75],f:2,a:225},{p:[2097,26],f:2,a:240},
{p:[2202,20],f:2,a:270},{p:[2292,17],f:2,a:270},{p:[2373,22],f:2,a:285},{p:[2452,52],f:2,a:300},{p:[2512,115],f:2,a:330},{p:[2553,208],f:2,a:345},{p:[2575,307],f:2,a:0},{p:[2575,401],f:2,a:0},{p:[2554,480],f:2,a:15},{p:[2510,558],f:2,a:30},{p:[2444,619],f:2,a:60},{p:[2365,660],f:2,a:75},{p:[2284,683],f:2,a:90},{p:[2195,683],f:2,a:90},{p:[2092,647],f:2,a:120},{p:[2024,587],f:2,a:150},{p:[2009,518],f:2,a:180},{p:[2234,411],f:2,a:180},{p:[2233,318],f:2,a:180},{p:[2252,258],f:2,a:120},{p:[2324,339],f:2,
a:180},{p:[2270,400],f:2,a:225},{p:[1798,372],f:1,a:270},{p:[1528,374],f:1,a:270},{p:[1258,376],f:1,a:270},{p:[987,377],f:1,a:270},{p:[895,465],f:2,a:90},{p:[802,464],f:2,a:90},{p:[774,491],f:3,a:0},{p:[694,484],f:2,a:15},{p:[665,564],f:2,a:30},{p:[609,637],f:2,a:60},{p:[538,678],f:2,a:90},{p:[448,680],f:2,a:90},{p:[255,627],f:2,a:120},{p:[186,569],f:2,a:150},{p:[347,662],f:2,a:105},{p:[149,495],f:2,a:165},{p:[51,236],f:1,a:180},{p:[149,133],f:2,a:30},{p:[201,59],f:2,a:45},{p:[288,21],f:2,a:75},{p:[386,
-73],f:1,a:90},{p:[624,40],f:2,a:315},{p:[684,124],f:2,a:345},{p:[739,226],f:3,a:0},{p:[364,314],f:2,a:15},{p:[425,252],f:2,a:75},{p:[476,312],f:2,a:0},{p:[475,407],f:2,a:0},{p:[377,386],f:2,a:315},{p:[474,468],f:3,a:0}],decals:[{p:[204,78],f:4,a:0},{p:[204,390],f:4,a:270},{p:[516,486],f:5,a:180},{p:[516,78],f:5,a:90},{p:[540,294],f:6,a:0},{p:[726,300],f:6,a:90},{p:[918,252],f:7,a:180},{p:[1206,252],f:7,a:180},{p:[1494,252],f:7,a:180},{p:[1782,252],f:7,a:180},{p:[2070,300],f:6,a:180},{p:[2070,84],
f:5,a:0},{p:[2070,492],f:5,a:270},{p:[2286,396],f:4,a:180},{p:[2286,84],f:4,a:90},{p:[1932,300],f:8,a:90},{p:[1464,306],f:9,a:90},{p:[1464,384],f:9,a:90},{p:[1452,324],f:10,a:90},{p:[1392,426],f:10,a:90},{p:[1320,324],f:10,a:90},{p:[1242,426],f:10,a:90},{p:[1182,324],f:10,a:90},{p:[1110,426],f:10,a:90},{p:[1620,426],f:11,a:0},{p:[1770,426],f:11,a:0},{p:[1902,426],f:11,a:0},{p:[2034,426],f:12,a:0},{p:[2130,432],f:12,a:0},{p:[2160,552],f:13,a:270},{p:[2136,264],f:12,a:90},{p:[2202,270],f:12,a:90},{p:[1896,
324],f:11,a:180},{p:[1764,324],f:11,a:180},{p:[1608,324],f:11,a:180},{p:[936,336],f:11,a:180},{p:[762,336],f:12,a:180},{p:[630,330],f:12,a:180},{p:[612,492],f:12,a:270},{p:[624,414],f:12,a:270},{p:[750,414],f:11,a:0},{p:[918,414],f:11,a:0}],laps:5,ai_waypoints:[{p:[1869,352],n:1},{p:[2088,438],n:2},{p:[2273,561],n:3},{p:[2440,442],n:4},{p:[2410,269],n:5},{p:[2231,218],n:6},{p:[2056,340],n:7},{p:[1671,328],n:8},{p:[1132,382],n:9},{p:[685,326],n:10},{p:[503,203],n:11},{p:[297,317],n:12},{p:[350,487],
n:13},{p:[503,568],n:14},{p:[689,425],n:15},{p:[1049,374],n:16}],checkpoints:[{p:[1510,254],n:1},{p:[2042,448],n:2},{p:[2352,251],n:3},{p:[2035,67],n:4},{p:[1193,248],n:5},{p:[471,54],n:6},{p:[147,201],n:7},{p:[478,451],n:8}],start_positions:[{p:[1404,318],n:1,a:90},{p:[1338,420],n:2,a:90},{p:[1266,318],n:3,a:90},{p:[1188,420],n:4,a:90},{p:[1128,318],n:5,a:90},{p:[1056,420],n:6,a:90}],dict:{1:"9tires.png",2:"3tires.png",3:"tire.png",4:"dideliskampas.png",5:"lenktas.png",6:"paprastas.png",7:"ilgas.png",
8:"trumpas.png",9:"startbar.png",10:"white_bar.png",11:"arrow.png",12:"arrow3.png",13:"arrow4.png"}},"3_bullpen":{size:[2900,2500],title:"Bullpen",bgtile:"sand.png",props:[{p:[363,1552],f:1,a:135},{p:[554,1743],f:1,a:135},{p:[804,1905],f:1,a:105},{p:[1097,1978],f:1,a:90},{p:[1367,1978],f:1,a:90},{p:[1637,1978],f:1,a:90},{p:[1843,1863],f:1,a:60},{p:[2078,1727],f:1,a:60},{p:[2091,376],f:1,a:300},{p:[2101,741],f:1,a:225},{p:[1907,927],f:1,a:225},{p:[1885,1153],f:1,a:150},{p:[2047,1354],f:1,a:135},{p:[2326,
1572],f:2,a:75},{p:[2390,1514],f:2,a:45},{p:[2342,1271],f:1,a:0},{p:[2342,1E3],f:1,a:0},{p:[2431,911],f:2,a:0},{p:[2370,812],f:2,a:315},{p:[2396,576],f:2,a:270},{p:[2476,579],f:2,a:285},{p:[2545,612],f:2,a:315},{p:[2609,684],f:2,a:330},{p:[2648,776],f:2,a:345},{p:[2575,877],f:1,a:0},{p:[2573,1149],f:1,a:0},{p:[2574,1419],f:1,a:0},{p:[2383,1809],f:2,a:270},{p:[2463,1788],f:2,a:255},{p:[2539,1746],f:2,a:240},{p:[2606,1686],f:2,a:210},{p:[2682,1682],f:3,a:0},{p:[1857,241],f:1,a:300},{p:[1620,105],f:1,
a:300},{p:[399,183],f:1,a:240},{p:[635,49],f:1,a:240},{p:[938,31],f:1,a:270},{p:[1209,27],f:1,a:270},{p:[1466,116],f:2,a:105},{p:[1554,140],f:2,a:105},{p:[1651,202],f:3,a:0},{p:[374,381],f:2,a:90},{p:[273,381],f:2,a:75},{p:[185,413],f:2,a:45},{p:[130,481],f:2,a:30},{p:[97,568],f:2,a:15},{p:[7,667],f:1,a:180},{p:[10,940],f:1,a:180},{p:[101,1210],f:2,a:0},{p:[97,1302],f:2,a:0},{p:[91,1384],f:2,a:345},{p:[117,1463],f:2,a:330},{p:[169,1537],f:2,a:315},{p:[256,1591],f:2,a:285},{p:[360,1614],f:2,a:270},
{p:[379,1359],f:2,a:300},{p:[330,1298],f:2,a:345},{p:[239,1037],f:1,a:180},{p:[239,766],f:1,a:180},{p:[332,667],f:2,a:15},{p:[392,609],f:2,a:75},{p:[398,563],f:1,a:135},{p:[588,758],f:1,a:135},{p:[413,1175],f:1,a:60},{p:[619,1002],f:1,a:45},{p:[846,1013],f:2,a:330},{p:[1128,1110],f:3,a:0},{p:[1416,1138],f:3,a:0},{p:[1738,1174],f:3,a:0}],decals:[{p:[114,756],f:4,a:270},{p:[114,1044],f:4,a:90},{p:[162,444],f:5,a:0},{p:[162,1332],f:5,a:270},{p:[2376,1524],f:5,a:180},{p:[2448,1236],f:4,a:90},{p:[2448,
948],f:4,a:90},{p:[2376,636],f:5,a:90},{p:[2412,678],f:6,a:0},{p:[2406,774],f:6,a:0},{p:[402,1470],f:6,a:180},{p:[402,1572],f:6,a:180},{p:[168,816],f:7,a:180},{p:[246,816],f:7,a:180},{p:[408,486],f:8,a:0},{p:[408,570],f:8,a:0},{p:[2388,1674],f:8,a:180},{p:[2388,1752],f:8,a:180},{p:[282,876],f:9,a:180},{p:[186,960],f:9,a:180},{p:[282,1050],f:9,a:180},{p:[180,1140],f:9,a:180},{p:[282,1242],f:9,a:180},{p:[180,1332],f:9,a:180}],laps:5,ai_waypoints:[{p:[277,672],n:1},{p:[428,550],n:2},{p:[1032,558],n:3},
{p:[1927,656],n:4},{p:[2438,788],n:5},{p:[2611,971],n:6},{p:[2622,1350],n:7},{p:[2493,1616],n:8},{p:[2013,1746],n:9},{p:[1107,1684],n:10},{p:[377,1469],n:11},{p:[265,1337],n:12},{p:[233,1047],n:13}],checkpoints:[{p:[131,591],n:1},{p:[411,388],n:2},{p:[2376,613],n:3},{p:[2375,1572],n:4},{p:[197,1400],n:5}],start_positions:[{p:[276,912],n:1,a:0},{p:[180,996],n:2,a:0},{p:[276,1086],n:3,a:0},{p:[174,1176],n:4,a:0},{p:[276,1278],n:5,a:0},{p:[174,1368],n:6,a:0}],dict:{1:"9tires.png",2:"3tires.png",3:"tire.png",
4:"ilgas.png",5:"dideliskampas.png",6:"arrow2.png",7:"startbar.png",8:"arrow.png",9:"white_bar.png"}},"3_hunter_end":{size:[2500,2900],title:"Hunter End",bgtile:"grass.png",props:[{p:[850,1857],f:1,a:180},{p:[696,1736],f:1,a:90},{p:[425,1736],f:1,a:90},{p:[335,1826],f:2,a:90},{p:[244,1825],f:2,a:90},{p:[144,1773],f:2,a:135},{p:[101,1706],f:2,a:165},{p:[98,1625],f:2,a:180},{p:[96,1533],f:2,a:180},{p:[107,1430],f:2,a:30},{p:[173,1363],f:2,a:60},{p:[276,1359],f:2,a:90},{p:[368,1361],f:2,a:90},{p:[433,
1351],f:3,a:60},{p:[350,1259],f:2,a:135},{p:[313,1187],f:2,a:165},{p:[220,926],f:1,a:0},{p:[267,819],f:2,a:135},{p:[210,750],f:2,a:150},{p:[207,678],f:2,a:180},{p:[211,576],f:2,a:195},{p:[250,493],f:2,a:225},{p:[315,441],f:2,a:180},{p:[309,336],f:2,a:195},{p:[331,243],f:2,a:210},{p:[393,175],f:2,a:240},{p:[480,139],f:2,a:255},{p:[583,42],f:1,a:270},{p:[856,131],f:2,a:270},{p:[936,127],f:2,a:285},{p:[1018,152],f:2,a:300},{p:[1089,205],f:2,a:315},{p:[1144,298],f:2,a:345},{p:[1078,398],f:1,a:180},{p:[1194,
664],f:3,a:60},{p:[1194,695],f:3,a:60},{p:[1220,716],f:3,a:60},{p:[1257,602],f:1,a:90},{p:[1529,601],f:1,a:90},{p:[1800,598],f:1,a:90},{p:[2072,687],f:2,a:270},{p:[2152,686],f:2,a:285},{p:[2222,723],f:2,a:315},{p:[2279,811],f:2,a:345},{p:[2300,911],f:2,a:0},{p:[2285,995],f:2,a:15},{p:[2242,1073],f:2,a:30},{p:[2178,1129],f:2,a:75},{p:[2098,1152],f:2,a:90},{p:[2007,1151],f:2,a:90},{p:[1914,1153],f:2,a:90},{p:[1901,1183],f:2,a:135},{p:[1961,1257],f:2,a:150},{p:[2005,1360],f:2,a:180},{p:[1918,1450],f:1,
a:0},{p:[2009,1719],f:2,a:180},{p:[2006,1812],f:2,a:180},{p:[2015,1895],f:3,a:60},{p:[1993,1920],f:3,a:60},{p:[1878,1955],f:1,a:0},{p:[1966,2225],f:2,a:180},{p:[1992,2314],f:3,a:60},{p:[1992,2336],f:2,a:165},{p:[2013,2438],f:2,a:180},{p:[1989,2520],f:2,a:195},{p:[1940,2594],f:2,a:225},{p:[1872,2660],f:2,a:240},{p:[1792,2702],f:2,a:255},{p:[1711,2719],f:2,a:270},{p:[1614,2740],f:2,a:225},{p:[1544,2795],f:2,a:255},{p:[1462,2818],f:2,a:270},{p:[1359,2780],f:2,a:300},{p:[1280,2722],f:2,a:315},{p:[1497,
2628],f:3,a:60},{p:[1216,2716],f:2,a:270},{p:[1115,2694],f:2,a:285},{p:[1027,2645],f:2,a:315},{p:[966,2581],f:2,a:330},{p:[935,2502],f:2,a:345},{p:[844,2241],f:1,a:0},{p:[937,2152],f:2,a:0},{p:[962,2118],f:3,a:60},{p:[352,1620],f:3,a:60},{p:[383,1620],f:3,a:60},{p:[937,1617],f:3,a:60},{p:[957,1391],f:3,a:60},{p:[906,1616],f:3,a:60},{p:[925,1392],f:3,a:60},{p:[910,1145],f:2,a:270},{p:[964,1137],f:3,a:60},{p:[965,1104],f:3,a:60},{p:[548,1082],f:2,a:330},{p:[635,1163],f:3,a:60},{p:[564,1067],f:3,a:60},
{p:[666,1166],f:3,a:60},{p:[459,698],f:3,a:90},{p:[554,815],f:2,a:225},{p:[616,747],f:2,a:210},{p:[650,675],f:2,a:180},{p:[617,566],f:2,a:150},{p:[559,486],f:2,a:135},{p:[538,408],f:2,a:210},{p:[611,359],f:2,a:255},{p:[824,361],f:2,a:270},{p:[888,375],f:2,a:315},{p:[942,475],f:2,a:0},{p:[942,909],f:2,a:0},{p:[1220,952],f:3,a:90},{p:[1251,952],f:3,a:90},{p:[1199,1180],f:3,a:90},{p:[1229,1180],f:3,a:90},{p:[2093,953],f:3,a:90},{p:[2063,951],f:3,a:90},{p:[1725,1382],f:2,a:135},{p:[1661,1369],f:2,a:90},
{p:[1776,1481],f:2,a:180},{p:[1195,1367],f:2,a:270},{p:[1169,1579],f:2,a:0},{p:[1194,1426],f:3,a:90},{p:[1195,1458],f:3,a:90},{p:[1165,2331],f:2,a:0},{p:[1163,2401],f:2,a:330},{p:[1227,2464],f:2,a:300},{p:[1293,2432],f:2,a:225},{p:[1377,2390],f:2,a:255},{p:[1479,2385],f:2,a:270},{p:[1550,2390],f:2,a:300},{p:[1623,2441],f:2,a:315},{p:[1706,2450],f:2,a:240},{p:[1765,2381],f:2,a:195},{p:[1822,2360],f:3,a:90},{p:[1847,2335],f:3,a:90},{p:[1728,2064],f:1,a:0},{p:[1816,1970],f:2,a:180},{p:[1786,1863],f:2,
a:150},{p:[1689,1611],f:1,a:0},{p:[1808,1576],f:3,a:90},{p:[1077,2059],f:1,a:0},{p:[1078,1784],f:1,a:0},{p:[1169,1693],f:2,a:180},{p:[1199,1666],f:3,a:90},{p:[1166,1489],f:2,a:180},{p:[1562,1368],f:2,a:90}],decals:[{p:[978,1182],f:4,a:0},{p:[906,750],f:5,a:90},{p:[858,1422],f:5,a:270},{p:[1242,702],f:6,a:0},{p:[1242,942],f:6,a:0},{p:[1530,702],f:6,a:0},{p:[1530,942],f:6,a:0},{p:[1818,702],f:6,a:0},{p:[1818,942],f:6,a:0},{p:[2106,750],f:7,a:90},{p:[2106,966],f:7,a:180},{p:[666,1374],f:6,a:0},{p:[666,
1614],f:6,a:0},{p:[378,1374],f:6,a:0},{p:[378,1614],f:6,a:0},{p:[162,1422],f:7,a:0},{p:[162,1638],f:7,a:270},{p:[690,1158],f:6,a:0},{p:[378,1086],f:8,a:270},{p:[378,198],f:8,a:0},{p:[690,198],f:9,a:270},{p:[1002,558],f:9,a:180},{p:[882,198],f:8,a:90},{p:[1002,462],f:10,a:0},{p:[954,1854],f:6,a:90},{p:[1218,1158],f:6,a:0},{p:[1458,1206],f:10,a:270},{p:[270,408],f:11,a:0},{p:[270,612],f:11,a:180},{p:[378,948],f:10,a:180},{p:[378,870],f:10,a:180},{p:[954,2142],f:6,a:90},{p:[1002,2430],f:8,a:270},{p:[1212,
2442],f:11,a:270},{p:[1416,2442],f:11,a:90},{p:[1722,2430],f:8,a:180},{p:[1842,2238],f:12,a:90},{p:[1842,2046],f:13,a:270},{p:[1842,1854],f:12,a:270},{p:[1794,1566],f:6,a:90},{p:[1722,1206],f:8,a:90},{p:[1842,1470],f:10,a:180},{p:[1554,1206],f:10,a:270},{p:[1578,1206],f:10,a:270},{p:[1008,1950],f:14,a:180},{p:[1086,1950],f:14,a:180},{p:[1122,2010],f:15,a:180},{p:[1020,2088],f:15,a:180},{p:[1122,2172],f:15,a:180},{p:[1020,2256],f:15,a:180},{p:[1122,2352],f:15,a:180},{p:[1020,2436],f:15,a:180},{p:[1026,
1656],f:16,a:90},{p:[1098,1650],f:16,a:90},{p:[870,1458],f:17,a:180},{p:[876,1542],f:17,a:180},{p:[888,1704],f:16,a:180},{p:[888,1788],f:16,a:180},{p:[1032,1374],f:16,a:90},{p:[1038,816],f:16,a:270},{p:[1116,810],f:16,a:270},{p:[1332,1020],f:17,a:0},{p:[1332,1104],f:17,a:0},{p:[1302,780],f:16,a:0},{p:[1302,858],f:16,a:0},{p:[1140,1212],f:16,a:270}],laps:3,ai_waypoints:[{p:[1038,1612],n:1},{p:[789,1485],n:2},{p:[297,1530],n:3},{p:[260,1712],n:4},{p:[980,1714],n:5},{p:[1087,1465],n:6},{p:[983,1329],
n:7},{p:[549,1222],n:8},{p:[460,1045],n:9},{p:[373,739],n:10},{p:[541,346],n:11},{p:[775,289],n:12},{p:[1017,381],n:13},{p:[1133,975],n:14},{p:[1577,1117],n:15},{p:[2137,1024],n:16},{p:[2117,811],n:17},{p:[1623,779],n:18},{p:[1142,921],n:19},{p:[1059,1117],n:20},{p:[1264,1323],n:21},{p:[1781,1316],n:22},{p:[1918,1536],n:23},{p:[1915,2346],n:24},{p:[1793,2585],n:25},{p:[1505,2707],n:26},{p:[1171,2562],n:27},{p:[1079,2316],n:28}],checkpoints:[{p:[967,1726],n:1},{p:[650,1394],n:2},{p:[115,1499],n:3},
{p:[649,1649],n:4},{p:[905,1195],n:5},{p:[382,1127],n:6},{p:[331,736],n:7},{p:[365,192],n:8},{p:[885,193],n:9},{p:[956,927],n:10},{p:[2076,819],n:11},{p:[992,739],n:12},{p:[970,1176],n:13},{p:[1740,1192],n:14},{p:[1781,2359],n:15},{p:[975,2446],n:16}],start_positions:[{p:[1116,2046],n:1,a:0},{p:[1014,2124],n:2,a:0},{p:[1116,2208],n:3,a:0},{p:[1014,2292],n:4,a:0},{p:[1116,2388],n:5,a:0},{p:[1014,2472],n:6,a:0}],dict:{1:"9tires.png",2:"3tires.png",3:"tire.png",4:"susikerta.png",5:"uglyduckling.png",
6:"ilgas.png",7:"lenktas.png",8:"dideliskampas.png",9:"paprastas.png",10:"trumpas.png",11:"issisakojimas.png",12:"siaurasiplatu.png",13:"siauras.png",14:"startbar.png",15:"white_bar.png",16:"arrow4.png",17:"arrow.png"}},"3_lullabycircuit":{size:[2500,2400],title:"Lullaby Circuit",bgtile:"sand.png",props:[{p:[1579,1097],f:1,a:270},{p:[1849,1098],f:1,a:270},{p:[2122,1189],f:2,a:90},{p:[2212,1188],f:2,a:90},{p:[2282,1147],f:2,a:60},{p:[2357,1088],f:2,a:45},{p:[2415,1019],f:2,a:15},{p:[2352,761],f:1,
a:180},{p:[2405,658],f:2,a:330},{p:[2350,580],f:2,a:315},{p:[2276,530],f:2,a:300},{p:[2025,437],f:1,a:90},{p:[1988,551],f:3,a:45},{p:[1955,545],f:3,a:45},{p:[1918,462],f:2,a:180},{p:[1877,359],f:2,a:150},{p:[1819,292],f:2,a:120},{p:[1567,196],f:1,a:90},{p:[1476,287],f:2,a:90},{p:[1443,336],f:3,a:45},{p:[1178,237],f:1,a:90},{p:[907,238],f:1,a:90},{p:[870,353],f:3,a:45},{p:[840,350],f:3,a:45},{p:[816,328],f:3,a:45},{p:[553,198],f:1,a:90},{p:[461,286],f:2,a:90},{p:[423,311],f:3,a:45},{p:[391,312],f:3,
a:45},{p:[361,319],f:3,a:45},{p:[266,304],f:2,a:225},{p:[208,374],f:2,a:210},{p:[207,477],f:2,a:180},{p:[207,567],f:2,a:180},{p:[211,639],f:2,a:150},{p:[274,705],f:2,a:120},{p:[375,751],f:2,a:90},{p:[455,753],f:2,a:105},{p:[513,803],f:2,a:150},{p:[510,886],f:2,a:210},{p:[446,938],f:2,a:255},{p:[366,957],f:2,a:270},{p:[262,961],f:2,a:240},{p:[186,1007],f:2,a:225},{p:[129,1078],f:2,a:210},{p:[25,1179],f:1,a:0},{p:[117,1439],f:2,a:165},{p:[153,1510],f:2,a:135},{p:[229,1570],f:2,a:120},{p:[334,1614],
f:2,a:90},{p:[426,1617],f:2,a:90},{p:[488,1630],f:2,a:135},{p:[568,1721],f:3,a:45},{p:[559,1753],f:3,a:45},{p:[475,1728],f:2,a:90},{p:[373,1730],f:2,a:75},{p:[285,1765],f:2,a:45},{p:[231,1836],f:2,a:30},{p:[199,1923],f:2,a:15},{p:[201,2023],f:2,a:0},{p:[202,2115],f:2,a:0},{p:[206,2196],f:2,a:345},{p:[240,2265],f:2,a:315},{p:[312,2327],f:2,a:300},{p:[402,2366],f:2,a:285},{p:[504,2386],f:2,a:270},{p:[597,2383],f:2,a:270},{p:[676,2363],f:2,a:255},{p:[745,2312],f:2,a:225},{p:[808,2247],f:2,a:210},{p:[853,
2169],f:2,a:195},{p:[871,2087],f:2,a:180},{p:[872,1984],f:2,a:210},{p:[964,1961],f:2,a:270},{p:[1024,1972],f:2,a:315},{p:[1071,2074],f:2,a:0},{p:[1073,2164],f:2,a:0},{p:[1086,2234],f:2,a:330},{p:[1139,2305],f:2,a:315},{p:[1226,2360],f:2,a:285},{p:[1326,2293],f:1,a:270},{p:[1575,2345],f:2,a:240},{p:[1645,2288],f:2,a:225},{p:[1700,2213],f:2,a:210},{p:[1733,2142],f:2,a:180},{p:[1734,2050],f:2,a:180},{p:[1731,1957],f:2,a:180},{p:[1690,1852],f:2,a:150},{p:[1635,1774],f:2,a:135},{p:[1566,1734],f:2,a:105},
{p:[1484,1727],f:2,a:90},{p:[1448,1747],f:3,a:45},{p:[1419,1725],f:3,a:45},{p:[1395,1638],f:2,a:0},{p:[1360,1532],f:2,a:330},{p:[1308,1454],f:2,a:315},{p:[1349,1419],f:2,a:255},{p:[1426,1379],f:2,a:240},{p:[1488,1316],f:2,a:210},{p:[1531,1245],f:2,a:180},{p:[1070,1219],f:2,a:180},{p:[997,1187],f:2,a:240},{p:[957,1264],f:2,a:195},{p:[973,1336],f:2,a:135},{p:[1068,1299],f:2,a:165},{p:[1060,1363],f:2,a:255},{p:[1297,1162],f:2,a:180},{p:[1304,1058],f:2,a:210},{p:[1350,978],f:2,a:225},{p:[1438,949],f:2,
a:255},{p:[1537,951],f:2,a:270},{p:[1629,861],f:1,a:270},{p:[1899,862],f:1,a:270},{p:[2151,919],f:2,a:240},{p:[2210,859],f:2,a:180},{p:[2154,761],f:2,a:135},{p:[1908,663],f:1,a:270},{p:[1807,734],f:2,a:105},{p:[1722,680],f:2,a:135},{p:[1687,611],f:2,a:165},{p:[1714,585],f:3,a:60},{p:[1714,552],f:3,a:60},{p:[1631,512],f:2,a:90},{p:[1540,512],f:2,a:90},{p:[1500,537],f:3,a:60},{p:[1405,473],f:2,a:135},{p:[1160,380],f:1,a:270},{p:[890,381],f:1,a:270},{p:[786,472],f:2,a:60},{p:[465,520],f:2,a:90},{p:[557,
519],f:2,a:90},{p:[649,519],f:2,a:90},{p:[734,541],f:3,a:60},{p:[768,538],f:3,a:60},{p:[638,548],f:2,a:120},{p:[703,613],f:2,a:150},{p:[749,701],f:2,a:165},{p:[771,800],f:2,a:180},{p:[770,893],f:2,a:180},{p:[792,952],f:2,a:135},{p:[451,1185],f:2,a:90},{p:[543,1185],f:2,a:90},{p:[354,1200],f:2,a:45},{p:[335,1289],f:2,a:345},{p:[380,1356],f:2,a:300},{p:[484,1391],f:2,a:270},{p:[882,967],f:2,a:75},{p:[980,961],f:2,a:90},{p:[1070,960],f:2,a:90},{p:[1150,956],f:2,a:105},{p:[1218,995],f:2,a:135},{p:[1302,
1092],f:3,a:60},{p:[1299,1975],f:2,a:180},{p:[1294,2057],f:2,a:165},{p:[1341,2122],f:2,a:120},{p:[1424,2124],f:2,a:60},{p:[1484,2061],f:2,a:15},{p:[1453,1973],f:2,a:315},{p:[1381,1945],f:2,a:285},{p:[1356,1970],f:3,a:60},{p:[900,1729],f:2,a:270},{p:[992,1729],f:2,a:270},{p:[1083,1729],f:2,a:270},{p:[1062,1613],f:2,a:105},{p:[982,1615],f:2,a:90},{p:[772,1666],f:2,a:0},{p:[802,1604],f:2,a:270},{p:[946,1632],f:3,a:60},{p:[915,1628],f:3,a:60},{p:[887,1628],f:3,a:60},{p:[432,2062],f:2,a:345},{p:[445,1971],
f:2,a:45},{p:[546,1956],f:2,a:90},{p:[605,1977],f:2,a:150},{p:[551,2132],f:2,a:255},{p:[495,2149],f:3,a:60},{p:[527,2168],f:3,a:60},{p:[615,2069],f:2,a:195},{p:[797,1750],f:3,a:60},{p:[793,1782],f:3,a:60},{p:[825,1770],f:3,a:60},{p:[862,1757],f:3,a:60},{p:[1164,1768],f:3,a:60},{p:[1191,1786],f:3,a:60},{p:[1195,1752],f:3,a:60},{p:[1187,1720],f:3,a:60},{p:[1174,1691],f:3,a:60},{p:[1152,1668],f:3,a:60},{p:[563,1390],f:2,a:105},{p:[640,1418],f:2,a:120},{p:[737,1467],f:3,a:60},{p:[737,1395],f:2,a:0},{p:[735,
1304],f:2,a:0},{p:[738,1212],f:2,a:0},{p:[615,1141],f:2,a:60},{p:[708,1182],f:3,a:60},{p:[732,1197],f:3,a:60}],decals:[{p:[270,2100],f:4,a:270},{p:[582,2100],f:4,a:180},{p:[702,1788],f:4,a:0},{p:[1014,1788],f:4,a:90},{p:[1134,2100],f:4,a:270},{p:[1446,2100],f:4,a:180},{p:[1446,1788],f:4,a:90},{p:[1230,1764],f:5,a:270},{p:[270,1788],f:4,a:0},{p:[582,1764],f:5,a:180},{p:[486,1452],f:4,a:90},{p:[174,1332],f:4,a:270},{p:[174,1020],f:4,a:0},{p:[486,900],f:4,a:180},{p:[486,588],f:4,a:90},{p:[270,564],f:5,
a:270},{p:[270,348],f:5,a:0},{p:[480,300],f:6,a:0},{p:[768,348],f:7,a:180},{p:[960,348],f:8,a:0},{p:[1152,348],f:8,a:0},{p:[1110,1452],f:4,a:90},{p:[798,1332],f:4,a:270},{p:[798,1020],f:4,a:0},{p:[1104,1020],f:5,a:90},{p:[1128,1236],f:5,a:270},{p:[1344,1236],f:5,a:180},{p:[1368,1020],f:5,a:0},{p:[1584,972],f:6,a:0},{p:[1872,972],f:6,a:0},{p:[2160,900],f:4,a:180},{p:[1344,348],f:7,a:0},{p:[1536,348],f:9,a:90},{p:[1728,348],f:5,a:90},{p:[1752,564],f:5,a:270},{p:[2160,588],f:4,a:90},{p:[1968,588],f:9,
a:90},{p:[2076,1026],f:10,a:90},{p:[2076,1104],f:10,a:90},{p:[2058,1044],f:11,a:90},{p:[1980,1140],f:11,a:90},{p:[1896,1044],f:11,a:90},{p:[1806,1140],f:11,a:90},{p:[1704,1044],f:11,a:90},{p:[1608,1140],f:11,a:90}],laps:3,ai_waypoints:[{p:[2241,1050],n:1},{p:[2345,870],n:2},{p:[2193,710],n:3},{p:[1916,627],n:4},{p:[1761,498],n:5},{p:[1486,426],n:6},{p:[796,423],n:7},{p:[417,485],n:8},{p:[433,618],n:9},{p:[629,786],n:10},{p:[383,1143],n:12},{p:[254,1329],n:13},{p:[590,1600],n:14},{p:[621,1803],n:15},
{p:[386,1986],n:16},{p:[458,2252],n:17},{p:[718,2196],n:18},{p:[875,1945],n:19},{p:[1096,1928],n:20},{p:[1296,2233],n:21},{p:[1582,2206],n:22},{p:[1564,1967],n:23},{p:[1358,1783],n:24},{p:[1140,1558],n:25},{p:[904,1348],n:26},{p:[1005,1135],n:27},{p:[1194,1214],n:28},{p:[1345,1304],n:29},{p:[1508,1142],n:30},{p:[609,1012],n:11}],checkpoints:[{p:[2121,979],n:1},{p:[2165,600],n:2},{p:[1716,467],n:3},{p:[282,285],n:4},{p:[444,581],n:5},{p:[410,959],n:6},{p:[176,1358],n:7},{p:[516,1690],n:8},{p:[337,
2139],n:9},{p:[871,1757],n:10},{p:[1227,2180],n:11},{p:[1448,1783],n:12},{p:[1047,1454],n:13},{p:[772,1077],n:14},{p:[1186,1175],n:15}],start_positions:[{p:[2010,1038],n:1,a:90},{p:[1932,1134],n:2,a:90},{p:[1848,1038],n:3,a:90},{p:[1758,1134],n:4,a:90},{p:[1656,1038],n:5,a:90},{p:[1560,1134],n:6,a:90}],dict:{1:"9tires.png",2:"3tires.png",3:"tire.png",4:"dideliskampas.png",5:"lenktas.png",6:"ilgas.png",7:"siaurasiplatu.png",8:"siauras.png",9:"paprastas.png",10:"startbar.png",11:"white_bar.png"}},"3_peril_flats":{size:[2900,
2700],title:"Peril Flats",bgtile:"snow.png",props:[{p:[1141,1534],f:1,a:0},{p:[1111,1534],f:1,a:0},{p:[546,1504],f:2,a:270},{p:[448,1448],f:2,a:315},{p:[447,1516],f:2,a:255},{p:[365,1555],f:2,a:225},{p:[312,1629],f:2,a:210},{p:[208,1730],f:3,a:0},{p:[303,1990],f:2,a:165},{p:[338,2061],f:2,a:135},{p:[412,2119],f:2,a:120},{p:[504,2156],f:2,a:105},{p:[604,2083],f:3,a:270},{p:[876,2083],f:3,a:270},{p:[1138,2152],f:2,a:75},{p:[1213,2106],f:2,a:60},{p:[1277,2042],f:2,a:45},{p:[1341,1985],f:2,a:0},{p:[1352,
2078],f:2,a:0},{p:[1353,2169],f:2,a:0},{p:[1349,2250],f:2,a:345},{p:[1379,2326],f:2,a:330},{p:[1440,2391],f:2,a:300},{p:[1530,2437],f:2,a:285},{p:[1631,2458],f:2,a:270},{p:[1723,2488],f:1,a:0},{p:[1754,2484],f:1,a:0},{p:[1780,2466],f:1,a:0},{p:[1806,2445],f:1,a:0},{p:[1839,2324],f:3,a:270},{p:[2111,2415],f:2,a:270},{p:[2174,2421],f:2,a:315},{p:[2277,2370],f:3,a:270},{p:[2537,2442],f:2,a:255},{p:[2605,2390],f:2,a:225},{p:[2666,2325],f:2,a:195},{p:[2685,2245],f:2,a:180},{p:[2684,2154],f:2,a:180},{p:[2640,
2053],f:2,a:150},{p:[2573,1994],f:2,a:120},{p:[2321,1899],f:3,a:270},{p:[2228,1988],f:2,a:90},{p:[2125,1970],f:2,a:105},{p:[2112,1980],f:1,a:0},{p:[2094,1948],f:1,a:0},{p:[2061,1856],f:2,a:180},{p:[2062,1764],f:2,a:180},{p:[2035,1666],f:2,a:165},{p:[1981,1579],f:2,a:135},{p:[1910,1522],f:2,a:120},{p:[1839,1513],f:2,a:90},{p:[1739,1493],f:2,a:105},{p:[1773,1446],f:2,a:60},{p:[1842,1386],f:2,a:45},{p:[1895,1314],f:2,a:15},{p:[1916,1231],f:2,a:0},{p:[1915,1130],f:2,a:15},{p:[1968,1061],f:2,a:60},{p:[2070,
1064],f:2,a:90},{p:[2150,1045],f:2,a:75},{p:[2226,1001],f:2,a:60},{p:[2289,938],f:2,a:30},{p:[2331,861],f:2,a:15},{p:[2351,778],f:2,a:0},{p:[2349,685],f:2,a:0},{p:[2329,585],f:2,a:345},{p:[2286,492],f:2,a:330},{p:[2220,429],f:2,a:300},{p:[2142,404],f:2,a:285},{p:[2061,403],f:2,a:270},{p:[1970,402],f:2,a:270},{p:[1869,404],f:2,a:255},{p:[1778,433],f:2,a:240},{p:[1712,495],f:2,a:210},{p:[1686,586],f:2,a:195},{p:[1690,686],f:2,a:180},{p:[1656,743],f:2,a:90},{p:[1556,739],f:2,a:75},{p:[1466,762],f:2,
a:60},{p:[1398,820],f:2,a:30},{p:[1366,902],f:2,a:15},{p:[1336,905],f:2,a:0},{p:[1347,994],f:2,a:0},{p:[1248,633],f:3,a:0},{p:[1319,531],f:2,a:345},{p:[1271,440],f:2,a:315},{p:[1202,382],f:2,a:300},{p:[1123,354],f:2,a:285},{p:[862,264],f:3,a:270},{p:[768,357],f:2,a:270},{p:[676,356],f:2,a:270},{p:[574,355],f:2,a:255},{p:[485,387],f:2,a:240},{p:[420,448],f:2,a:210},{p:[391,539],f:2,a:195},{p:[389,639],f:2,a:180},{p:[421,730],f:1,a:0},{p:[394,743],f:2,a:150},{p:[344,847],f:3,a:180},{p:[434,1119],f:2,
a:180},{p:[396,1182],f:2,a:225},{p:[392,1283],f:2,a:180},{p:[395,1360],f:2,a:165},{p:[458,1452],f:1,a:0},{p:[580,1139],f:2,a:180},{p:[630,1222],f:1,a:0},{p:[623,1240],f:2,a:180},{p:[683,1272],f:2,a:90},{p:[1085,1275],f:2,a:90},{p:[1116,1215],f:2,a:0},{p:[1053,1306],f:1,a:0},{p:[578,808],f:2,a:0},{p:[631,783],f:1,a:0},{p:[621,694],f:2,a:0},{p:[636,595],f:2,a:45},{p:[738,617],f:1,a:0},{p:[769,617],f:1,a:0},{p:[990,583],f:2,a:90},{p:[1054,595],f:2,a:135},{p:[1114,694],f:2,a:180},{p:[579,1046],f:2,a:180},
{p:[578,952],f:2,a:180},{p:[608,922],f:1,a:0},{p:[608,894],f:1,a:0},{p:[1377,1303],f:1,a:0},{p:[1374,1274],f:1,a:0},{p:[1579,1242],f:2,a:180},{p:[1639,1300],f:1,a:0},{p:[1665,1284],f:1,a:0},{p:[1760,995],f:1,a:0},{p:[1729,995],f:1,a:0},{p:[1762,1025],f:1,a:0},{p:[1699,996],f:1,a:0},{p:[1753,1056],f:1,a:0},{p:[1790,986],f:1,a:0},{p:[1931,873],f:1,a:0},{p:[1936,842],f:1,a:0},{p:[1960,870],f:1,a:0},{p:[1915,750],f:2,a:180},{p:[1993,840],f:2,a:90},{p:[1927,650],f:2,a:45},{p:[2024,638],f:2,a:90},{p:[2079,
662],f:2,a:150},{p:[2103,753],f:2,a:195},{p:[2083,861],f:1,a:0},{p:[2110,844],f:1,a:0},{p:[1378,1536],f:1,a:0},{p:[1609,1534],f:1,a:0},{p:[1375,1771],f:1,a:0},{p:[1579,1766],f:2,a:0},{p:[1641,1765],f:1,a:0},{p:[1670,1736],f:2,a:270},{p:[1750,1738],f:2,a:285},{p:[1810,1798],f:2,a:345},{p:[1832,1896],f:2,a:0},{p:[1834,1990],f:2,a:0},{p:[1846,2059],f:2,a:330},{p:[1898,2132],f:2,a:315},{p:[1985,2188],f:2,a:285},{p:[2084,2214],f:2,a:270},{p:[2487,2254],f:1,a:0},{p:[2459,2253],f:1,a:0},{p:[2169,2262],f:1,
a:0},{p:[2187,2289],f:1,a:0},{p:[2155,2302],f:1,a:0},{p:[1883,2182],f:3,a:90},{p:[1794,2273],f:2,a:270},{p:[1777,2277],f:1,a:0},{p:[1744,2260],f:1,a:0},{p:[1645,2211],f:2,a:285},{p:[1576,2147],f:2,a:330},{p:[1581,2076],f:2,a:0},{p:[1579,1984],f:2,a:0},{p:[1580,1893],f:2,a:0},{p:[1609,1859],f:1,a:0},{p:[591,1924],f:2,a:285},{p:[520,1860],f:2,a:330},{p:[524,1776],f:2,a:30},{p:[605,1737],f:2,a:75},{p:[1082,1734],f:2,a:90},{p:[1113,1796],f:2,a:0},{p:[1080,1868],f:2,a:30},{p:[1017,1930],f:2,a:75}],decals:[{p:[1152,
1308],f:4,a:270},{p:[1152,1548],f:4,a:270},{p:[1392,1548],f:4,a:270},{p:[1392,1308],f:4,a:270},{p:[1128,1020],f:5,a:90},{p:[1128,732],f:5,a:90},{p:[1056,420],f:6,a:90},{p:[768,372],f:5,a:0},{p:[456,420],f:6,a:0},{p:[456,732],f:7,a:270},{p:[456,924],f:8,a:90},{p:[864,1284],f:5,a:0},{p:[456,1116],f:7,a:90},{p:[456,1308],f:9,a:270},{p:[624,1332],f:10,a:90},{p:[720,1332],f:10,a:90},{p:[864,1524],f:5,a:0},{p:[720,1572],f:10,a:90},{p:[624,1572],f:10,a:90},{p:[360,1572],f:6,a:0},{p:[360,1884],f:6,a:270},
{p:[672,1956],f:5,a:0},{p:[1176,1740],f:10,a:180},{p:[1056,1884],f:6,a:180},{p:[912,2004],f:10,a:270},{p:[1632,1212],f:6,a:180},{p:[1752,900],f:6,a:0},{p:[2064,780],f:6,a:180},{p:[2064,468],f:6,a:90},{p:[1752,468],f:6,a:0},{p:[1728,780],f:9,a:180},{p:[1416,804],f:6,a:0},{p:[1416,1116],f:11,a:0},{p:[1368,1788],f:5,a:90},{p:[1416,2028],f:10,a:0},{p:[1416,2172],f:6,a:270},{p:[1728,2292],f:7,a:180},{p:[1920,2292],f:8,a:180},{p:[2112,2292],f:7,a:0},{p:[2304,2292],f:11,a:90},{p:[2496,2268],f:9,a:180},{p:[2496,
2052],f:9,a:90},{p:[2208,2004],f:5,a:180},{p:[1896,1932],f:6,a:270},{p:[1632,1572],f:11,a:90},{p:[1896,1788],f:10,a:0},{p:[1776,1572],f:6,a:90},{p:[1440,1770],f:12,a:270},{p:[1542,1770],f:12,a:270},{p:[1434,1524],f:12,a:270},{p:[1536,1524],f:12,a:270},{p:[1614,1362],f:12,a:180},{p:[1620,1446],f:12,a:180},{p:[1368,1356],f:12,a:180},{p:[1368,1458],f:12,a:180},{p:[1206,1290],f:12,a:90},{p:[1290,1290],f:12,a:90},{p:[1206,1524],f:12,a:90},{p:[1296,1524],f:12,a:90},{p:[1134,1602],f:12,a:0},{p:[1134,1680],
f:12,a:0},{p:[1368,1596],f:12,a:0},{p:[1368,1680],f:12,a:0},{p:[1056,1578],f:13,a:270},{p:[1056,1656],f:13,a:270},{p:[1044,1590],f:14,a:270},{p:[972,1698],f:14,a:270},{p:[894,1590],f:14,a:270},{p:[804,1698],f:14,a:270},{p:[702,1590],f:14,a:270},{p:[630,1698],f:14,a:270}],laps:4,ai_waypoints:[{p:[1769,1617],n:1},{p:[1931,1817],n:2},{p:[2093,2072],n:3},{p:[2536,2189],n:5},{p:[2490,2323],n:6},{p:[2203,2378],n:7},{p:[1669,2348],n:8},{p:[1530,2234],n:9},{p:[1492,1856],n:10},{p:[1472,1266],n:11},{p:[1557,
987],n:12},{p:[1752,841],n:13},{p:[1918,623],n:14},{p:[2122,577],n:15},{p:[2237,781],n:16},{p:[2069,961],n:17},{p:[1864,1113],n:18},{p:[1713,1350],n:19},{p:[853,1460],n:21},{p:[589,1336],n:22},{p:[535,1226],n:23},{p:[531,749],n:24},{p:[615,561],n:25},{p:[875,476],n:26},{p:[1170,575],n:27},{p:[1253,759],n:28},{p:[1249,1155],n:29},{p:[1250,1656],n:30},{p:[1196,1974],n:31},{p:[900,2101],n:32},{p:[539,2019],n:33},{p:[456,1867],n:34},{p:[538,1680],n:35},{p:[877,1645],n:36},{p:[2338,2069],n:4},{p:[1256,
1422],n:20}],checkpoints:[{p:[1101,1532],n:1},{p:[1772,1538],n:2},{p:[1879,1932],n:3},{p:[2463,2108],n:4},{p:[1438,2203],n:5},{p:[1387,855],n:6},{p:[1890,440],n:7},{p:[1993,845],n:8},{p:[1624,1265],n:9},{p:[428,1254],n:10},{p:[442,428],n:11},{p:[1071,429],n:12},{p:[1108,1878],n:13},{p:[359,1903],n:14},{p:[367,1562],n:15}],start_positions:[{p:[1002,1584],n:1,a:90},{p:[930,1692],n:2,a:90},{p:[852,1584],n:3,a:90},{p:[762,1692],n:4,a:90},{p:[660,1584],n:5,a:90},{p:[588,1692],n:6,a:90}],dict:{1:"tire.png",
2:"3tires.png",3:"9tires.png",4:"kryzius.png",5:"ilgas.png",6:"dideliskampas.png",7:"siaurasiplatu.png",8:"siauras.png",9:"lenktas.png",10:"trumpas.png",11:"paprastas.png",12:"arrow.png",13:"startbar.png",14:"white_bar.png"}},"3_radiator":{size:[2500,2500],title:"The Radiator",bgtile:"sand.png",props:[{p:[530,1036],f:1,a:90},{p:[430,1040],f:1,a:75},{p:[345,1080],f:1,a:45},{p:[311,1166],f:1,a:15},{p:[224,1264],f:2,a:0},{p:[314,1534],f:1,a:0},{p:[310,1614],f:1,a:345},{p:[336,1692],f:1,a:330},{p:[402,
1749],f:1,a:300},{p:[507,1788],f:1,a:270},{p:[601,1789],f:1,a:270},{p:[671,1754],f:1,a:240},{p:[740,1694],f:1,a:210},{p:[791,1624],f:1,a:180},{p:[813,1689],f:1,a:150},{p:[877,1749],f:1,a:120},{p:[983,1791],f:1,a:90},{p:[1074,1789],f:1,a:90},{p:[1151,1762],f:1,a:75},{p:[1212,1701],f:1,a:30},{p:[1273,1636],f:1,a:0},{p:[1295,1701],f:1,a:330},{p:[1364,1762],f:1,a:300},{p:[1467,1794],f:1,a:270},{p:[1559,1796],f:1,a:270},{p:[1630,1759],f:1,a:240},{p:[1697,1703],f:1,a:210},{p:[1755,1638],f:1,a:180},{p:[1777,
1701],f:1,a:150},{p:[1843,1760],f:1,a:120},{p:[1948,1798],f:1,a:90},{p:[2040,1796],f:1,a:90},{p:[2112,1760],f:1,a:60},{p:[2180,1701],f:1,a:30},{p:[2229,1633],f:1,a:0},{p:[2141,1363],f:2,a:0},{p:[2233,1271],f:1,a:0},{p:[2213,1169],f:1,a:345},{p:[2164,1082],f:1,a:315},{p:[2100,1038],f:1,a:285},{p:[2019,1037],f:1,a:270},{p:[1898,797],f:2,a:0},{p:[1988,706],f:1,a:0},{p:[1974,605],f:1,a:345},{p:[1932,515],f:1,a:330},{p:[1864,472],f:1,a:285},{p:[1784,467],f:1,a:270},{p:[1690,466],f:1,a:270},{p:[1590,479],
f:1,a:240},{p:[1526,547],f:1,a:210},{p:[1515,647],f:1,a:180},{p:[1466,536],f:1,a:150},{p:[1404,472],f:1,a:120},{p:[1334,468],f:1,a:90},{p:[1243,469],f:1,a:90},{p:[1145,470],f:1,a:75},{p:[1066,514],f:1,a:45},{p:[1038,607],f:1,a:0},{p:[982,515],f:1,a:330},{p:[911,460],f:1,a:300},{p:[841,460],f:1,a:270},{p:[749,460],f:1,a:270},{p:[646,465],f:1,a:240},{p:[579,523],f:1,a:210},{p:[564,622],f:1,a:180},{p:[472,713],f:2,a:0},{p:[563,979],f:1,a:180},{p:[797,716],f:1,a:180},{p:[1276,722],f:1,a:180},{p:[1757,
723],f:1,a:180},{p:[1996,1541],f:1,a:180},{p:[1994,1292],f:1,a:180},{p:[1752,1292],f:1,a:180},{p:[1514,1290],f:1,a:180},{p:[1275,1292],f:1,a:180},{p:[1516,1541],f:1,a:180},{p:[1035,1534],f:1,a:180},{p:[556,1533],f:1,a:180},{p:[558,1291],f:1,a:180},{p:[1753,1004],f:1,a:180},{p:[1517,1004],f:1,a:180},{p:[1275,1006],f:1,a:180},{p:[1031,1007],f:1,a:180},{p:[790,1008],f:1,a:180},{p:[796,1296],f:1,a:180},{p:[1037,1297],f:1,a:180}],decals:[{p:[1056,1320],f:3,a:270},{p:[1056,1032],f:3,a:270},{p:[1056,744],
f:3,a:270},{p:[1104,528],f:4,a:0},{p:[1320,528],f:4,a:90},{p:[1296,744],f:3,a:270},{p:[1296,1032],f:3,a:270},{p:[1296,1320],f:3,a:270},{p:[1344,1608],f:4,a:270},{p:[1560,1608],f:4,a:180},{p:[1080,1602],f:4,a:180},{p:[864,1602],f:4,a:270},{p:[816,1314],f:3,a:270},{p:[816,1026],f:3,a:270},{p:[816,738],f:3,a:270},{p:[840,522],f:4,a:90},{p:[624,522],f:4,a:0},{p:[576,738],f:3,a:270},{p:[576,1026],f:3,a:270},{p:[576,1314],f:3,a:270},{p:[600,1602],f:4,a:180},{p:[384,1602],f:4,a:270},{p:[336,1314],f:3,a:270},
{p:[384,1098],f:4,a:0},{p:[600,1074],f:5,a:0},{p:[840,1074],f:5,a:0},{p:[1080,1074],f:5,a:0},{p:[1320,1074],f:5,a:0},{p:[1560,1074],f:5,a:0},{p:[1536,1320],f:3,a:270},{p:[1584,1266],f:6,a:0},{p:[1536,786],f:3,a:270},{p:[1584,696],f:6,a:0},{p:[1584,528],f:4,a:0},{p:[1800,528],f:4,a:90},{p:[1776,744],f:3,a:270},{p:[1776,1032],f:3,a:270},{p:[1776,1320],f:3,a:270},{p:[1824,1608],f:4,a:270},{p:[2040,1608],f:4,a:180},{p:[1800,1074],f:5,a:0},{p:[2040,1098],f:4,a:90},{p:[2016,1314],f:3,a:270},{p:[2064,1470],
f:6,a:0},{p:[1518,1104],f:7,a:270},{p:[1518,1182],f:7,a:270},{p:[1500,1128],f:8,a:270},{p:[1410,1212],f:8,a:270},{p:[1308,1128],f:8,a:270},{p:[1200,1212],f:8,a:270},{p:[1074,1134],f:8,a:270},{p:[948,1212],f:8,a:270}],laps:3,ai_waypoints:[{p:[1890,1142],n:1},{p:[2093,1284],n:2},{p:[2187,1497],n:3},{p:[2034,1658],n:4},{p:[1848,1512],n:5},{p:[1901,1199],n:6},{p:[1958,779],n:7},{p:[1801,653],n:8},{p:[1620,805],n:9},{p:[1662,1189],n:10},{p:[1715,1517],n:11},{p:[1554,1653],n:12},{p:[1361,1505],n:13},{p:[1413,
1173],n:14},{p:[1480,783],n:15},{p:[1320,657],n:16},{p:[1128,798],n:17},{p:[1179,1173],n:18},{p:[1234,1521],n:19},{p:[1073,1642],n:20},{p:[886,1516],n:21},{p:[931,1171],n:22},{p:[994,798],n:23},{p:[829,644],n:24},{p:[640,802],n:25},{p:[700,1186],n:26},{p:[743,1504],n:27},{p:[590,1650],n:28},{p:[400,1506],n:29},{p:[529,1233],n:30},{p:[985,1166],n:31}],checkpoints:[{p:[1560,1063],n:1},{p:[2019,1073],n:2},{p:[1893,1588],n:3},{p:[1645,490],n:4},{p:[1429,1573],n:5},{p:[1175,485],n:6},{p:[926,1575],n:7},
{p:[698,497],n:8},{p:[445,1570],n:9},{p:[335,1068],n:10}],start_positions:[{p:[1452,1122],n:1,a:90},{p:[1362,1206],n:2,a:90},{p:[1260,1122],n:3,a:90},{p:[1152,1206],n:4,a:90},{p:[1032,1128],n:5,a:90},{p:[894,1206],n:6,a:90}],dict:{1:"3tires.png",2:"9tires.png",3:"ilgas.png",4:"lenktas.png",5:"kryzius.png",6:"trumpas.png",7:"startbar.png",8:"white_bar.png"}}}}},[]);
require.define({animation:function(n,b){n("./utils");var a=n("gamejs"),j=n("./engine"),m=b.Animation=function(a){this.filename=a.filename;this.age=0;this.duration=a.duration;this.type="animation";this.finished=!1;this.repeat=a.repeat?!0:!1;this.resize_duration=this.resize_age=this.resize_to=this.resize_from=0;this.onFinish=function(){};this.restart=function(){this.age=0};this.resize=function(a,d,b){this.resize_from=a;this.resize_to=d;this.resize_duration=b;this.resize_age=0};this.update=function(a){this.age+=
a;this.resize_age<this.resize_duration&&(this.resize_age+=a);if(this.age>this.duration)this.onFinish(),this.repeat?this.restart():this.finished=!0};this.draw=function(a,d){var b=a.cache.getAnimationFrameCount(this.filename),g=null;this.resize_age<this.resize_duration&&(g=this.resize_from+parseInt((this.resize_to-this.resize_from)*(this.resize_age/this.resize_duration)));a.drawAnimation(this.filename,d,Math.min(parseInt(this.age/(this.duration/b)),b-1),g)};return this},k=b.AnimationObject=function(a){k.superConstructor.apply(this,
[a]);this.add_tag("animation_object");this.anim=new m(a);this.position=a.position;this.world=a.world;this.duration=a.duration;this.follow_obj=a.follow_obj;a.resize&&this.anim.resize(a.resize.from,a.resize.to,a.resize.duration)};a.utils.objects.extend(k,j.Object);j.register_class(k);k.prototype.update=function(a){this.anim.update(a);this.anim.finished&&this.world.destroy(this)};k.prototype.draw=function(a){var b=this.follow_obj?this.follow_obj.get_position():this.position;this.anim.draw(a,b)};b.animations=
{small_explosion:{filename:"explosion_small.png",duration:500},smoke:{filename:"smoke.png",duration:300},explosion:{filename:"explosion.png",duration:1E3},explosion2:{filename:"explosion2.png",duration:1E3},shockwave:{filename:"sw.png",duration:200,resize:{from:40,to:200,duration:200}},heal:{filename:"heal.png",duration:500},fire:{filename:"fire64.png",duration:500},shield:{filename:"forcefield.png",duration:2E3}}}},["utils","gamejs","engine"]);
require.define({cars:function(n,b){var a=n("gamejs"),j=n("./utils");n("./sounds");var m=n("./buffs"),k=n("./car_descriptions");n("./combatracer");var g=n("./weapons"),e=n("./weapon_descriptions"),d=n("./engine"),f=n("./settings"),l=d.box2d,h=j.vec,q=a.utils.vectors,c=a.utils.math;radians=c.radians;degrees=c.degrees;n("./animation");var z=b.STEER_NONE=0,P=b.STEER_RIGHT=1,D=b.STEER_LEFT=2,B=b.ACC_NONE=0,A=b.ACC_ACCELERATE=1,w=b.ACC_BRAKE=2,y=b.Wheel=function(a){this.car=a.car;this.local_position=a.position;
d.utils.process_parameters(a,[["revolving",!1],["powered",!1]]);a.position=this.car.get_world_point(this.local_position);a.angle=this.car.get_angle();a.sensor=!0;y.superConstructor.apply(this,[a]);this.prev_position=this.position;this.add_tag("wheel");this.parameters.revolving?(a=new l.b2RevoluteJointDef,a.Initialize(this.car.body,this.body,this.body.GetWorldCenter()),a.enableMotor=!1,a.referenceAngle=0):(a=new l.b2PrismaticJointDef,a.Initialize(this.car.body,this.body,this.body.GetWorldCenter(),
h([1,0])),a.enableLimit=!0,a.lowerTranslation=a.upperTranslation=a.referenceAngle=0);this.world.b2world.CreateJoint(a)};a.utils.objects.extend(y,d.Entity);y.prototype.reset_angle=function(){this.set_angle(this.car.get_angle())};y.prototype.set_relative_angle=function(a){this.set_angle(this.car.get_angle()+a)};y.prototype.get_world_position=function(){return this.car.get_world_point(this.local_position)};y.prototype.draw=function(c){c.drawCar(this.parameters.filename,this.car.get_world_point(this.local_position),
this.get_angle());if(this.alive){if(this.prev_position&&a.utils.vectors.angle(this.get_linear_velocity(),this.get_world_vector([0,-1]))>a.utils.math.radians(20)){var d=f.get("PHYS_SCALE"),b=this.prev_position,e=this.position,g=[-this.parameters.size[0]/2,0],l=[this.parameters.size[0]/2,0],j=radians(this.get_angle()),g=a.utils.vectors.rotate(g,j),l=a.utils.vectors.rotate(l,j);a.draw.polygon(c.background,"#282828",[[(g[0]+b[0])*d,(g[1]+b[1])*d],[(g[0]+e[0])*d,(g[1]+e[1])*d],[(l[0]+e[0])*d,(l[1]+e[1])*
d],[(l[0]+b[0])*d,(l[1]+b[1])*d]])}this.prev_position=this.position}};y.prototype.get_local_velocity=function(){return this.get_local_vector(this.car.get_linear_velocity(this.local_position))};y.prototype.get_kill_velocity_vector=function(){var a=this.get_linear_velocity(),c=this.get_direction_vector(),a=q.dot(a,c);return q.multiply(c,a)};y.prototype.kill_sideways_velocity=function(){var a=this.get_kill_velocity_vector();this.k_velocity=a;this.set_linear_velocity(a)};y.prototype.die=function(){this.alive=
!1;this.set_linear_velocity([0,0]);this.prev_position=null};y.prototype.get_local_angle=function(){var a=c.normaliseDegrees(this.get_angle()-this.car.get_angle());a>180&&(a-=360);return a};y.prototype.respawn=function(){this.alive=!0};var G=b.Car=function(a){this.descr=k[a.car_type];a.size=[this.descr.width,this.descr.height];d.utils.process_parameters(a,[["filename",""],"car_type",["mod_speed",0],["engine_sound",!1],["turn_msec",200],["front_weapon",null],["rear_weapon",null],["util",null],["alias",
""],["speed_upgrades",0],["armor_upgrades",0],["acc_upgrades",0]]);this.health=this.max_health=a.max_health=this.descr.health+a.armor_upgrades*this.descr.armor_upgrade;this.max_speed=this.descr.max_speed+a.speed_upgrades*this.descr.speed_upgrade;G.superConstructor.apply(this,[a]);this.filename=this.descr.filenames[this.world.get_objects_by_tag("car").length%this.descr.filenames.length];this.add_tag("car");this.active=!0;this.alias=this.parameters.alias;this.next_checkpoint_no=1;this.time_to_respawn=
this.lap=0;this.respawn_location=this.position;this.respawn_angle=0;this.respawn_time=2E3;this.deaths=this.kills=0;this.util=this.rear_weapon=this.front_weapon=null;if(this.parameters.front_weapon)a=j.copy(this.parameters.front_weapon,{}),a.car=this,a.slot="front_weapon",a.world=this.world,this.world.create(g[e[a.type].launcher],a);if(this.parameters.rear_weapon)a=j.copy(this.parameters.rear_weapon,{}),a.car=this,a.world=this.world,a.slot="rear_weapon",this.world.create(g[e[a.type].launcher],a);if(this.parameters.util)a=
j.copy(this.parameters.util,{}),a.car=this,a.world=this.world,a.slot="util",this.world.create(g[e[a.type].launcher],a);this.fire_util=this.fire_rear_weapon=this.fire_front_weapon=!1;this.accelerate=B;this.steer=z;this.max_steer_angle=this.descr.max_steer_angle;this.power=this.descr.power+this.parameters.acc_upgrades*this.descr.power_upgrade;this.max_speed=this.descr.max_speed+this.parameters.speed_upgrades*this.descr.speed_upgrade;this.turn_msec=this.parameters.turn_msec;this.local_engine_pos=[0,
-(this.parameters.height/2)];this.cur_wheel_angle=0;this.mod_speed=this.parameters.mod_speed;this.smoke_cd=0;this.wheels=[];this.descr.wheels.forEach(function(a){a=j.copy(a,{});a.position=[a.x,a.y];a.size=[a.width,a.length];a.car=this;a.world=this.world;this.wheels.push(new y(a))},this)};a.utils.objects.extend(G,d.Entity);d.register_class(G);G.prototype.impact=function(a){a.has_tag("car")&&this.world.play_sound("thud.wav",this.get_position())};G.prototype.cross_finish_line=function(){this.front_weapon&&
this.front_weapon.reload();this.rear_weapon&&this.rear_weapon.reload();this.util&&this.util.reload()};G.prototype.get_power=function(){var a=this.power;this.buffs.forEach(function(c){c.effect==m.EFFECT_ENGINE&&(a+=c.value)},this);return parseInt(a)};G.prototype.get_max_speed=function(){var a=this.max_speed;this.buffs.forEach(function(c){c.effect==m.EFFECT_ENGINE&&(a+=c.value)},this);return parseInt(a+this.mod_speed)};G.prototype.update_checkpoint=function(){var a=this.world.checkpoints[this.next_checkpoint_no],
c=this.get_position();if(c[0]>=a.pt1[0]&&c[0]<=a.pt2[0]&&c[1]>=a.pt1[1]&&c[1]<=a.pt2[1])this.next_checkpoint_no==1&&(this.lap++,this.cross_finish_line()),this.next_checkpoint_no==this.world.max_checkpoint?this.next_checkpoint_no=1:this.next_checkpoint_no++};G.prototype.get_race_position=function(){var a=this.world.objects_by_tag.car.length,c,d;for(c=0;c<this.world.objects_by_tag.car.length;c++)d=this.world.objects_by_tag.car[c],d!==this&&(this.lap>d.lap?a--:this.lap==d.lap&&(this.next_checkpoint_no>
d.next_checkpoint_no||this.next_checkpoint_no==1&&d.next_checkpoint_no!=1)?a--:this.lap==d.lap&&this.next_checkpoint_no==d.next_checkpoint_no&&q.distance(this.alive?this.get_position():this.respawn_location,this.world.checkpoints[this.next_checkpoint_no].center)<q.distance(d.alive?d.get_position():d.respawn_location,this.world.checkpoints[d.next_checkpoint_no].center)&&a--);return a};G.prototype.get_powered_wheels=function(){var a=[];this.wheels.forEach(function(c){c.parameters.powered&&a.push(c)});
return a};G.prototype.get_revolving_wheels=function(){var a=[];this.wheels.forEach(function(c){c.parameters.revolving&&a.push(c)});return a};G.prototype.get_speed_KMH=function(){var a=this.get_linear_velocity();return q.len(a)/1E3*3600};G.prototype.draw=function(a){if(this.alive&&this.active){this.wheels.forEach(function(c){c.draw(a)});var c=this.get_position();a.drawCar(this.filename,c,this.get_angle())}};G.prototype.teleport=function(a,c){c=c?c:this.get_angle();this.set_position(a);this.set_angle(c);
this.wheels.forEach(function(a){a.set_position(this.get_world_point(a.local_position))},this)};G.prototype.die=function(){this.alive=!1;this.deaths+=1;this.time_to_respawn=this.respawn_time;this.respawn_location=this.get_position();this.world.spawn_animation("explosion",this.get_position());this.world.play_sound("explosion.wav",this.get_position());this.respawn_angle=this.get_angle();this.teleport([0,0]);this.set_linear_velocity([0,0]);this.wheels.forEach(function(a){a.die()});this.clear_buffs()};
G.prototype.respawn=function(){this.alive=!0;this.wheels.forEach(function(a){a.respawn()});this.teleport(this.respawn_location,this.respawn_angle);this.health=this.max_health};G.prototype.kill=function(){this.kills+=1};G.prototype.apply_damage=function(a,c){for(var d=0;d<this.buffs.length;d++)if(!this.buffs[d].process_hit(a,c))return;if(this.alive)this.health=Math.min(this.health-a,this.max_health),this.health<=0&&(this.die(),c&&c.kill(this))};G.prototype.update=function(a){this.active&&(this.alive?
this.alive&&this.update_alive(a):(this.time_to_respawn-=a,this.time_to_respawn<=0&&this.respawn()))};G.prototype.update_alive=function(a){this.update_checkpoint();var c=this.steer,d=this.accelerate,b=this.get_speed_KMH(),f=this.get_local_vector(this.get_linear_velocity()),e=this.get_max_speed(),e=f[1]>0?0.5*e:e;this.has_effect(m.EFFECT_NO_GRIP)||this.wheels.forEach(function(a){a.kill_sideways_velocity()});f=this.max_steer_angle;b<100&&(f+=(40-f)*(1-b/100));var g=this.max_steer_angle/this.turn_msec*
a,l=this.get_revolving_wheels();for(i=0;i<l.length;i++)wheel=l[i],c==P?(this.cur_wheel_angle=Math.min(Math.max(this.cur_wheel_angle,0)+g,f),wheel.set_relative_angle(this.cur_wheel_angle)):c==D?(this.cur_wheel_angle=Math.max(Math.min(this.cur_wheel_angle,0)-g,-f),wheel.set_relative_angle(this.cur_wheel_angle)):(this.cur_wheel_angle=0,wheel.reset_angle());var c=d==A&&b<e?[0,-1]:d==w?this.get_local_velocity()[1]<0?[0,1.2]:[0,0.7]:[0,0],j=q.multiply(c,this.get_power());this.get_powered_wheels().forEach(function(a){a.apply_force(j,
[0,0])},this);this.get_speed_KMH()<4&&d==B&&this.set_speed(0);this.front_weapon&&(this.front_weapon.update(a),this.fire_front_weapon&&this.front_weapon._fire());this.rear_weapon&&(this.rear_weapon.update(a),this.fire_rear_weapon&&this.rear_weapon._fire());this.util&&(this.util.update(a),this.fire_util&&this.util._fire());this.health<=40?this.smoke_cd<=0?(this.world.spawn_animation("smoke",this.get_world_point([0,-1.5])),this.smoke_cd=100):this.smoke_cd-=a:this.smoke_cd=0};G.prototype.initialize_shape=
function(){var a=new l.b2PolygonShape,c=this.descr.width/2,d=this.descr.height/2;a.SetAsArray([h(c,d),h(-c,d),h(-c,-d),h(0,-d-0.5),h(c,-d)]);return a};G.prototype.get_buff=function(a){for(var c=0;c<this.buffs.length;c++)if(this.buffs[c].effect==a)return this.buffs[c];return null};G.prototype.has_effect=function(a){for(var c=0;c<this.buffs.length;c++)if(this.buffs[c].effect==a)return!0;return!1};G.prototype.clear_buffs=function(){this.buffs.forEach(function(a){this.world.destroy(a)},this)};b.get_car_parameters=
function(a,c,d,b,f){return{car_type:d.type,position:a,angle:c,alias:b,handling_upgrades:d.handling_upgrades?d.handling_upgrades:0,engine_sound:f,acc_upgrades:d.acc_upgrades,speed_upgrades:d.speed_upgrades,armor_upgrades:d.armor_upgrades,front_weapon:d.front_weapon?j.copy(d.front_weapon,{}):null,util:d.util?j.copy(d.util,{}):null,rear_weapon:d.rear_weapon?j.copy(d.rear_weapon,{}):null}}}},["gamejs","utils","sounds","buffs","car_descriptions","combatracer","weapons","weapon_descriptions","engine","settings",
"animation"]);
require.define({editor:function(n,b){function a(a){return[Math.floor(a[0]/6)*6,Math.floor(a[1]/6)*6]}function j(a){var r=[];a.start_positions.length<6&&r.push("All six starting positions must be placed.");a.ai_waypoints.length<2&&r.push("At least two AI waypoints must be placed.");a.checkpoints.length<2&&r.push("At least two checkpoints must be placed.");a.title||r.push("Level must have a title.");console.log(r);return r}function m(a){function r(a){T[a]==void 0&&(T[a]=d,c.dict[d]=a,d++);return T[a]}
var c=A([2500,2500]);c.size=a.size;c.bgtile=a.bgtile;c.title=a.title;c.laps=a.laps;c.dict={};var T={},d=1;a.props.forEach(function(a){c.props.push({p:a.position,f:r(a.original.filename),a:a.angle})});a.decals.forEach(function(a){c.decals.push({p:a.position,f:r(a.original.filename),a:a.angle})});a.ai_waypoints.forEach(function(a){c.ai_waypoints.push({p:a.position,n:a.number})});a.checkpoints.forEach(function(a){c.checkpoints.push({p:a.position,n:a.number})});a.start_positions.forEach(function(a){c.start_positions.push({p:a.position,
n:a.number,a:a.angle})});return c}function k(a,r){for(var c=0;c<r.length;c++)if(r[c].instance_id==a.instance_id){r.splice(c,1);break}}function g(a){a.text="On";a.size=[100,40];g.superConstructor.apply(this,[a]);this.layer=a.layer;this.scene=a.scene;this.is_on=!0;this.onClick(this.onclick,this)}function e(a){a.size=[220,300];e.superConstructor.apply(this,[a]);this.scene=a.scene;this.playbtn=new f.Button({parent:this,text:"Play",size:[180,40],lean:"both",position:[20,20]});this.playbtn.onClick(function(){this.close();
var a=j(this.scene.level);a.length?this.scene.alert(a[0]):l.game.playLevel(m(this.scene.level),!1,!1,"editor")},this);this.testaibtn=new f.Button({parent:this,text:"Test AI",size:[180,40],lean:"both",position:[20,70]});this.testaibtn.onClick(function(){this.close();var a=j(this.scene.level);a.length?this.scene.alert(a[0]):l.game.playLevel(m(this.scene.level),!0,!1,"editor")},this);this.cancelbtn=new f.Button({parent:this,text:"Cancel",size:[180,40],lean:"both",position:[20,120]});this.cancelbtn.onClick(function(){this.close()},
this)}var d=n("./gamejs-gui"),f=n("./ui"),l=n("./combatracer");n("./settings");var h=n("gamejs"),q=n("./renderer"),c=n("./resources"),z=n("./skin"),P=[280,280],D=1,B=["decalinstance","propinstance","checkpointinstance","startpositioninstance","aiwaypointinstance"],A=function(a){return{size:a,title:"New track",bgtile:"sand.png",props:[],decals:[],laps:3,ai_waypoints:[],checkpoints:[],start_positions:[]}};ToolViewSelectItem=b.ToolViewSelectItem=function(a){a.size=[200,22];this.what=a.what;ToolViewSelectItem.superConstructor.apply(this,
[a]);this.label=new d.Label({position:[0,0],parent:this,font:f.getFont(z.track_selector.item_font),text:a.text});this.center(this.label);this.label.move([this.size[0]-this.label.size[0]-16,this.label.position[1]]);this.selected=!1;this.on(d.EVT_MOUSE_DOWN,this.select,this)};h.utils.objects.extend(ToolViewSelectItem,d.View);ToolViewSelectItem.prototype.select=function(){this.selected=!0;this.refresh();this.despatchEvent({type:"select",what:this.what})};ToolViewSelectItem.prototype.deselect=function(){this.selected=
!1;this.refresh()};ToolViewSelectItem.prototype.paint=function(){this.surface.fill(this.selected?z.track_selector.front_color:this.isHovered()?z.track_selector.item_hover_color:z.track_selector.back_color)};var w=b.ToolView=function(a){w.superConstructor.apply(this,[a]);this.scene=a.scene;this.scw=new d.ScrollableView({parent:this,size:[this.size[0],this.size[1]-20],position:[0,0]});this.scw.setHorizontalScrollbar(new d.HorizontalScrollbar({parent:this,size:[this.size[0],20],position:[0,this.size[1]-
20]}))};h.utils.objects.extend(w,d.View);var y=b.DecalView=function(a){y.superConstructor.apply(this,[a]);this.filename_to_decal={};c.decals.forEach(function(a){var c=new v({filename:a,size:[100,100],position:[0,3],scene:this.scene,parent:this.scw});this.scene.tools.push(c);this.filename_to_decal[a]=c;c.on("select",this.scene.selectTool,this.scene)},this);d.layout.horizontal(this.scw.children,2,2);this.scw.autoSetScrollableArea()};h.utils.objects.extend(y,w);var G=b.MarkerView=function(a){this.scene=
a.scene;G.superConstructor.apply(this,[a]);new d.Label({parent:this,font:f.getFont("16_33"),text:"AI Waypoints",position:[20,2]});this.ai_waypoint=new E({parent:this,position:[40,45],size:[40,40],scene:this.scene});this.scene.tools.push(this.ai_waypoint);this.ai_waypoint.on("select",this.scene.selectTool,this.scene);this.ai_waypoint_up=new f.IncrementButton({direction:"up",position:[100,30],size:[40,30],parent:this});this.ai_waypoint_up.onClick(function(){this.setNumber(this.number+1)},this.ai_waypoint);
this.ai_waypoint_down=new f.IncrementButton({direction:"down",position:[100,70],size:[40,30],parent:this});this.ai_waypoint_down.onClick(function(){this.setNumber(this.number-1)},this.ai_waypoint);new d.Label({parent:this,font:f.getFont("16_33"),text:"Checkpoints",position:[150,2]});this.checkpoint=new o({parent:this,position:[170,45],size:[170,40],scene:this.scene});this.scene.tools.push(this.checkpoint);this.checkpoint.on("select",this.scene.selectTool,this.scene);this.checkpoint_up=new f.IncrementButton({direction:"up",
position:[230,30],size:[40,30],parent:this});this.checkpoint_up.onClick(function(){this.setNumber(this.number+1)},this.checkpoint);this.checkpoint_down=new f.IncrementButton({direction:"down",position:[230,70],size:[40,30],parent:this});this.checkpoint_down.onClick(function(){this.setNumber(this.number-1)},this.checkpoint);new d.Label({parent:this,font:f.getFont("16_33"),text:"Start Positions",position:[280,2]});this.start_position=new u({parent:this,position:[300,35],size:[60,60],scene:this.scene});
this.scene.tools.push(this.start_position);this.start_position.on("select",this.scene.selectTool,this.scene);this.start_position_up=new f.IncrementButton({direction:"up",position:[370,30],size:[40,30],parent:this});this.start_position_up.onClick(function(){this.setNumber(this.number+1)},this.start_position);this.start_position_down=new f.IncrementButton({direction:"down",position:[370,70],size:[40,30],parent:this});this.start_position_down.onClick(function(){this.setNumber(this.number-1)},this.start_position)};
h.utils.objects.extend(G,d.View);var p=b.PropertiesView=function(a){p.superConstructor.apply(this,[a]);this.scene=a.scene;new d.Label({parent:this.scw,font:f.getFont("16_33"),text:"Title",position:[100,2]});this.title=new d.TextInput({parent:this.scw,font:f.getFont("16_33"),text:this.scene.level.title,position:[40,50],size:[180,30]});this.title.on(d.EVT_CHANGE,this.titleChange,this);new d.Label({parent:this.scw,font:f.getFont("16_33"),text:"Width, PX",position:[260,2]});this.widthlbl=new d.Label({parent:this.scw,
font:f.getFont("16_33"),text:String(this.scene.level.size[0]),position:[260,50]});this.width_up_btn=new f.IncrementButton({parent:this.scw,position:[350,20],size:[40,40],direction:"up"});this.width_up_btn.onClick(function(){this.scene.level.size[0]=Math.max(1E3,this.scene.level.size[0]+100);this.scene.resizeLevelView()},this);this.width_down_btn=new f.IncrementButton({parent:this.scw,position:[350,70],size:[40,40],direction:"down"});this.width_down_btn.onClick(function(){this.scene.level.size[0]=
Math.max(1E3,this.scene.level.size[0]-100);this.scene.resizeLevelView()},this);new d.Label({parent:this.scw,font:f.getFont("16_33"),text:"Height, PX",position:[420,2]});this.heightlbl=new d.Label({parent:this.scw,font:f.getFont("16_33"),text:String(this.scene.level.size[1]),position:[420,50]});this.height_up_btn=new f.IncrementButton({parent:this.scw,position:[520,20],size:[40,40],direction:"up"});this.height_up_btn.onClick(function(){this.scene.level.size[1]=Math.max(1E3,this.scene.level.size[1]+
100);this.scene.resizeLevelView()},this);this.height_down_btn=new f.IncrementButton({parent:this.scw,position:[520,70],size:[40,40],direction:"down"});this.height_down_btn.onClick(function(){this.scene.level.size[1]=Math.max(1E3,this.scene.level.size[1]-100);this.scene.resizeLevelView()},this);new d.Label({parent:this.scw,font:f.getFont("16_33"),text:"Laps",position:[590,2]});this.lapslbl=new d.Label({parent:this.scw,font:f.getFont("16_33"),text:String(this.scene.level.laps),position:[600,50]});this.laps_up_btn=
new f.IncrementButton({parent:this.scw,position:[700,20],size:[40,40],direction:"up"});this.laps_up_btn.onClick(function(){this.scene.level.laps=Math.max(1,this.scene.level.laps+1);this.lapslbl.setText(String(this.scene.level.laps))},this);this.laps_down_btn=new f.IncrementButton({parent:this.scw,position:[700,70],size:[40,40],direction:"down"});this.laps_down_btn.onClick(function(){this.scene.level.laps=Math.max(1,this.scene.level.laps-1);this.lapslbl.setText(String(this.scene.level.laps))},this);
this.scw.autoSetScrollableArea()};h.utils.objects.extend(p,w);p.prototype.titleChange=function(a){this.scene.level.title=a.value};var L=b.PropView=function(a){L.superConstructor.apply(this,[a]);this.filename_to_prop={};c.props.forEach(function(a){var c=new O({filename:a,size:[100,100],position:[0,3],scene:this.scene,parent:this.scw});this.scene.tools.push(c);this.filename_to_prop[a]=c;c.on("select",this.scene.selectTool,this.scene)},this);d.layout.horizontal(this.scw.children,2,2);this.scw.autoSetScrollableArea()};
h.utils.objects.extend(L,w);var J=b.LayerView=function(a){J.superConstructor.apply(this,[a]);new d.Label({parent:this.scw,font:f.getFont("16_33"),text:"Decals",position:[10,2]});new g({parent:this.scw,layer:"decals",scene:this.scene,position:[10,50]});new d.Label({parent:this.scw,font:f.getFont("16_33"),text:"Props",position:[160,2]});new g({parent:this.scw,layer:"props",scene:this.scene,position:[160,50]});new d.Label({parent:this.scw,font:f.getFont("16_33"),text:"AI Waypoints",position:[320,2]});
new g({parent:this.scw,layer:"ai_waypoints",scene:this.scene,position:[320,50]});new d.Label({parent:this.scw,font:f.getFont("16_33"),text:"Checkpoints",position:[470,2]});new g({parent:this.scw,layer:"checkpoints",scene:this.scene,position:[470,50]});new d.Label({parent:this.scw,font:f.getFont("16_33"),text:"Start pos.",position:[620,2]});new g({parent:this.scw,layer:"start_positions",scene:this.scene,position:[620,50]});this.scw.autoSetScrollableArea()};h.utils.objects.extend(J,w);var M=b.BgView=
function(a){M.superConstructor.apply(this,[a]);c.tiles.forEach(function(a){new U({filename:a,size:[100,100],position:[0,3],scene:this.scene,parent:this.scw})},this);d.layout.horizontal(this.scw.children,2,2);this.scw.autoSetScrollableArea()};h.utils.objects.extend(M,w);var I=b.Instance=function(a){I.superConstructor.apply(this,[a]);this.instance_id=D++;this.angle=a.angle;this.original=a.original;this.subtype="instance";this.selected=!1;this.scene=a.scene;this.on(d.EVT_MOUSE_DOWN,this.select,this);
this.on("select",this.scene.selectInstance,this.scene)};h.utils.objects.extend(I,d.View);I.prototype.select=function(){if(!this.selected&&!(this.scene.selected&&this.scene.selected.subtype=="tool"))this.selected=!0,this.despatchEvent({type:"select",instance:this}),this.refresh()};I.prototype.move=function(a){this.selected&&d.View.prototype.move.apply(this,[a])};I.prototype.deselect=function(){this.selected=!1;this.refresh()};I.prototype.paint=function(){this.surface.clear();var a=this.original.getCursorImage(this.angle);
this.surface.blit(a,[(this.size[0]-a.getSize()[0])/2,(this.size[1]-a.getSize()[1])/2]);this.selected&&h.draw.rect(this.surface,"#0026FF",new h.Rect([0,0],this.surface.getSize()),6)};var C=function(a){C.superConstructor.apply(this,[a]);d.draggable(this);this.type="checkpointinstance";this.number=a.number;this.on("select",function(){this.scene.marker_view.checkpoint.setNumber(this.number)},this)};h.utils.objects.extend(C,I);C.prototype.destroy=function(a){a===void 0&&(a=!0);I.prototype.destroy.apply(this,
[]);a&&(k(this,this.scene.level.checkpoints),this.scene.level.checkpoints.forEach(function(a){a.number>this.number&&(a.number--,a.refresh())},this))};C.prototype.paint=function(){this.surface.clear();this.surface.blit(this.original.genHugeImage(this.number),[0,0]);this.selected&&h.draw.rect(this.surface,"#0026FF",new h.Rect([0,0],this.surface.getSize()),6)};var F=function(a){F.superConstructor.apply(this,[a]);this.type="startpositioninstance";this.number=a.number;this.on("select",function(){this.scene.marker_view.start_position.setNumber(this.number)},
this)};h.utils.objects.extend(F,I);F.prototype.move=function(c){I.prototype.move.apply(this,[a(c)])};F.prototype.destroy=function(a){a===void 0&&(a=!0);I.prototype.destroy.apply(this,[]);a&&(k(this,this.scene.level.start_positions),this.scene.level.start_positions.forEach(function(a){a.number>this.number&&(a.number--,a.refresh())},this))};F.prototype.paint=function(){this.surface.clear();this.surface.blit(this.original.genImage(this.number,this.angle),[0,0]);this.selected&&h.draw.rect(this.surface,
"#0026FF",new h.Rect([0,0],this.surface.getSize()),6)};var R=function(a){R.superConstructor.apply(this,[a]);d.draggable(this);this.type="aiwaypointinstance";this.number=a.number;this.on("select",function(){this.scene.marker_view.ai_waypoint.setNumber(this.number)},this)};h.utils.objects.extend(R,I);R.prototype.destroy=function(a){a===void 0&&(a=!0);I.prototype.destroy.apply(this,[]);a&&(k(this,this.scene.level.ai_waypoints),this.scene.level.ai_waypoints.forEach(function(r){r.number==this.number&&
(a=!1)},this),a&&this.scene.level.ai_waypoints.forEach(function(a){a.number>this.number&&(a.number--,a.refresh())},this))};R.prototype.paint=function(){this.surface.clear();this.surface.blit(this.original.genImage(this.number),[0,0]);this.selected&&h.draw.rect(this.surface,"#0026FF",new h.Rect([0,0],this.surface.getSize()),6)};var K=function(a){K.superConstructor.apply(this,[a]);this.type="decalinstance"};h.utils.objects.extend(K,I);K.prototype.destroy=function(){I.prototype.destroy.apply(this,[]);
k(this,this.scene.level.decals)};K.prototype.move=function(c){I.prototype.move.apply(this,[a(c)])};var N=function(a){N.superConstructor.apply(this,[a]);d.draggable(this);this.type="propinstance"};h.utils.objects.extend(N,I);N.prototype.destroy=function(){I.prototype.destroy.apply(this,[]);k(this,this.scene.level.props)};var U=function(a){this.filename=a.filename;a.image=q.cache.getTile(a.filename);U.superConstructor.apply(this,[a]);this.scene=a.scene;this.on(d.EVT_MOUSE_DOWN,this.select,this)};h.utils.objects.extend(U,
d.Image);U.prototype.select=function(){this.scene.level.bgtile=this.filename;this.scene.level_view.refresh()};var Q=b.Tool=function(a){Q.superConstructor.apply(this,[a]);this.selected=!1;this.angle=0;this.rotate_angle=a.rotate_angle;this.on(d.EVT_MOUSE_DOWN,this.select,this);this.subtype="tool";this.scene=a.scene};h.utils.objects.extend(Q,d.Image);Q.prototype.select=function(){this.selected=!0;this.despatchEvent({type:"select",tool:this});this.refresh()};Q.prototype.rotateLeft=function(){this.angle-=
this.rotate_angle;this.angle<0&&(this.angle+=360);this.refresh()};Q.prototype.rotateRight=function(){this.angle+=this.rotate_angle;this.angle>=360&&(this.angle-=360);this.refresh()};Q.prototype.deselect=function(){this.selected=!1;this.refresh()};Q.prototype.paint=function(){d.Image.prototype.paint.apply(this,[]);this.selected&&h.draw.rect(this.surface,"#0026FF",new h.Rect([0,0],this.surface.getSize()),6)};var o=b.Checkpoint=function(a){a.image=this.genImage(1);a.rotate_angle=0;a.size=[40,40];a.rotate_angle=
0;o.superConstructor.apply(this,[a]);this.number=1;this.type="checkpoint"};h.utils.objects.extend(o,Q);o.prototype.genImage=function(a){var r=new h.Surface([40,40]),c=f.getFont("editor_checkpoint");h.draw.rect(r,"RGBA(255, 86, 86, 0.2)",new h.Rect([0,0],r.getSize()));c.render(r,String(a),[12,12]);h.draw.rect(r,"#FF5656",new h.Rect([0,0],r.getSize()),3);return r};o.prototype.genHugeImage=function(a){var r=new h.Surface([280,280]),c=f.getFont("editor_checkpoint");h.draw.rect(r,"RGBA(255, 86, 86, 0.2)",
new h.Rect([0,0],r.getSize()));c.render(r,String(a),[130,130]);h.draw.rect(r,"#FF5656",new h.Rect([0,0],r.getSize()),3);return r};o.prototype.getCursorImage=function(){return this.genHugeImage(this.number)};o.prototype.setNumber=function(a){this.number=Math.max(1,a);this.setImage(this.genImage(this.number))};o.prototype.place=function(a){this.getCursorImage();for(var r,c=0;c<this.scene.level.checkpoints.length;c++)r=this.scene.level.checkpoints[c],r.number==this.number&&r.destroy(!1);this.scene.level.checkpoints.push(new C({parent:this.scene.level_view,
size:P,scene:this.scene,angle:0,original:this,number:this.number,position:[a[0]-Math.ceil(P[0]/2),a[1]-Math.ceil(P[0]/2)]}));this.setNumber(this.number+1);this.refresh()};var u=b.StartPosition=function(a){a.image=this.genImage(1);a.rotate_angle=90;u.superConstructor.apply(this,[a]);this.type="startposition";this.number=1};h.utils.objects.extend(u,Q);u.prototype.genImage=function(a,r){var c=new h.Surface([60,60]),T=f.getFont("editor_start_pos"),d=c.getSize()[0],b=c.getSize()[1];h.draw.polygon(c,"#3AFF51",
[[10,10],[20,0],[d-20,0],[d-10,10],[d-10,b],[10,b]],3);if(r===void 0)r=this.angle;c=h.transform.rotate(c,r);T.render(c,String(a),[20,20]);return c};u.prototype.getCursorImage=function(){return this.genImage(this.number)};u.prototype.setNumber=function(a){this.number=Math.min(Math.max(1,a),6);this.setImage(this.genImage(this.number))};u.prototype.place=function(c){this.getCursorImage();for(var r=this.size,d,T=0;T<this.scene.level.start_positions.length;T++)d=this.scene.level.start_positions[T],d.number==
this.number&&d.destroy(!1);this.scene.level.start_positions.push(new F({parent:this.scene.level_view,size:r,scene:this.scene,angle:this.angle,original:this,number:this.number,position:a([c[0]-Math.ceil(r[0]/2),c[1]-Math.ceil(r[0]/2)])}));this.setNumber(this.number+1);this.refresh()};var E=b.AIWaypoint=function(a){a.image=this.genImage(1);a.rotate_angle=0;E.superConstructor.apply(this,[a]);d.draggable(this);this.type="aiwaypoint";this.number=1};h.utils.objects.extend(E,Q);E.prototype.genImage=function(a){var r=
new h.Surface([40,40]);f.getFont("editor_ai_wp").render(r,String(a),[12,12]);h.draw.rect(r,"#0094FF",new h.Rect([0,0],r.getSize()),3);return r};E.prototype.getCursorImage=function(){return this.genImage(this.number)};E.prototype.setNumber=function(a){this.number=Math.max(1,a);this.setImage(this.genImage(this.number))};E.prototype.place=function(a){for(var r=this.getCursorImage().getSize(),c,T=0;T<this.scene.level.ai_waypoints.length;T++)c=this.scene.level.ai_waypoints[T],c.number>=this.number&&c.number++;
this.scene.level.ai_waypoints.push(new R({parent:this.scene.level_view,size:r,scene:this.scene,angle:0,original:this,number:this.number,position:[a[0]-Math.ceil(r[0]/2),a[1]-Math.ceil(r[0]/2)]}));this.setNumber(this.number+1);this.refresh()};var v=b.Decal=function(a){a.image=q.cache.getDecalSprite(a.filename,0);a.rotate_angle=90;v.superConstructor.apply(this,[a]);this.type="decal";this.filename=a.filename};h.utils.objects.extend(v,Q);v.prototype.getCursorImage=function(a){if(a==void 0)a=this.angle;
return q.cache.getDecalSprite(this.filename,a)};v.prototype.place=function(c){var r=this.getCursorImage().getSize();this.scene.level.decals.push(new K({parent:this.scene.level_view,size:r,scene:this.scene,angle:this.angle,original:this,position:a([c[0]-Math.ceil(r[0]/2),c[1]-Math.ceil(r[0]/2)])}))};var O=b.Prop=function(a){a.image=q.cache.getPropSprite(a.filename,0);a.rotate_angle=5;O.superConstructor.apply(this,[a]);this.type="prop";this.filename=a.filename;this.scene=a.scene};h.utils.objects.extend(O,
Q);O.prototype.getCursorImage=function(a){if(a==void 0)a=this.angle;return q.cache.getPropSprite(this.filename,a)};O.prototype.place=function(a){var r=this.getCursorImage(this.angle).getSize();this.scene.level.props.push(new N({parent:this.scene.level_view,size:r,scene:this.scene,angle:this.angle,original:this,position:[a[0]-Math.ceil(r[0]/2),a[1]-Math.ceil(r[0]/2)]}))};var V=b.LevelView=function(a){this.scene=a.scene;V.superConstructor.apply(this,[a]);this.mpos=[0,0];this.on(d.EVT_MOUSE_MOTION,function(a){this.mpos=
a.pos;this.refresh()},this)};h.utils.objects.extend(V,d.View);V.prototype.paint=function(){for(var a=q.cache.getTile(this.scene.level.bgtile),r=a.getSize(),c=0;c<this.size[0];c+=r[0])for(var T=0;T<this.size[1];T+=r[1])this.surface.blit(a,[c,T])};V.prototype.post_paint=function(){if(this.isHovered()&&this.scene.selected&&this.scene.selected.subtype=="tool"&&this.scene.selected.getCursorImage){var c=this.scene.selected.getCursorImage(),r=c.getSize(),r=[parseInt(this.mpos[0]-r[0]/2),parseInt(this.mpos[1]-
r[1]/2)];if(this.scene.selected.type=="decal"||this.scene.selected.type=="startposition")r=a(r);this.surface.blit(c,r)}};V.prototype.draw=function(){var a=!1;this.children.forEach(function(r){if(r.draw()||this._refresh)a=!0},this);if(this._refresh||a){this.paint();for(var r,c=0;c<B.length;c++)r=B[c],this.children.forEach(function(a){a.type==r&&a.visible&&this.blitChild(a)},this);this.scene.minimap.image.blit(this.surface,new h.Rect([0,0],this.scene.minimap.image.getSize()),new h.Rect([0,0],this.surface.getSize()));
this.scene.minimap.refresh();this.post_paint();this.despatchEvent({type:d.EVT_PAINT,surface:this.surface});a=!0;this._refresh=!1}return a};var S=b.EditorScene=function(){document.getElementById("gjs-canvas").oncontextmenu=new Function("return false");this.gui=new d.GUI(l.game.display);this.gui.on(d.EVT_PAINT,function(){this.surface.clear()},this.gui);this.alertdialog=new f.Dialog({parent:this.gui,size:[600,150]});this.tools=[];this.minimap=new d.Image({position:[0,0],size:[200,200],parent:this.gui,
image:new h.Surface([200,200])});this.saveloadbtn=new f.Button({position:[0,210],size:[190,50],parent:this.gui,text:"Save / Load",lean:"left"});this.saveloadbtn.onClick(function(){this.textarea.value=JSON.stringify(m(this.level));$(this.dialogel).dialog("open")},this);this.playdialog=new e({parent:this.gui,scene:this});this.playbtn=new f.Button({position:[0,270],size:[190,50],parent:this.gui,text:"Play",lean:"left"});this.playbtn.onClick(function(){this.show()},this.playdialog);this.helpbtn=new f.Button({position:[0,
330],size:[190,50],parent:this.gui,text:"Help",lean:"left"});this.helpbtn.onClick(function(){window.open("http://www.banditracer.eu/index.php?page=track-editor-help")},this);this.backbtn=new f.Button({position:[0,390],size:[190,50],parent:this.gui,text:"Back",lean:"left"});this.backbtn.onClick(function(){l.game.showTitle()},this);this.dialog=new f.Dialog({parent:this.gui,size:[450,150]});this.scw=new d.ScrollableView({parent:this.gui,position:[200,0],size:[this.gui.size[0]-200-20,this.gui.size[1]-
150-20]});this.hscrollbar=new d.HorizontalScrollbar({parent:this.gui,position:[200,this.gui.size[1]-150-20],size:[this.gui.size[0]-200-20,20]});this.scw.setHorizontalScrollbar(this.hscrollbar);this.vscrollbar=new d.VerticalScrollbar({parent:this.gui,position:[this.gui.size[0]-20,0],size:[20,this.gui.size[1]-150-20]});this.scw.setVerticalScrollbar(this.vscrollbar);this.level=A([2500,2500]);this.level_view=new V({parent:this.scw,size:[20,20],scene:this,position:[0,0]});this.decal_view=new y({parent:this.gui,
scene:this,position:[200,this.gui.size[1]-150],size:[this.gui.size[0]-200,150]});this.prop_view=new L({parent:this.gui,scene:this,position:[200,this.gui.size[1]-150],size:[this.gui.size[0]-200,150]});this.prop_view.hide();this.marker_view=new G({parent:this.gui,scene:this,position:[200,this.gui.size[1]-150],size:[this.gui.size[0]-200,150]});this.marker_view.hide();this.bg_view=new M({parent:this.gui,scene:this,position:[200,this.gui.size[1]-150],size:[this.gui.size[0]-200,150]});this.bg_view.hide();
this.layer_view=new J({parent:this.gui,scene:this,position:[200,this.gui.size[1]-150],size:[this.gui.size[0]-200,150]});this.layer_view.hide();this.properties_view=new p({parent:this.gui,scene:this,position:[200,this.gui.size[1]-150],size:[this.gui.size[0]-200,150]});this.properties_view.hide();this.select_decal_view=new ToolViewSelectItem({parent:this.gui,what:"decalView",position:[0,this.gui.size[1]-150],text:"Decals"});this.select_decal_view.on("select",this.selectView,this);this.select_decal_view.selected=
!0;this.select_prop_view=new ToolViewSelectItem({parent:this.gui,what:"propView",position:[0,this.gui.size[1]-150+22],text:"Props"});this.select_prop_view.on("select",this.selectView,this);this.select_marker_view=new ToolViewSelectItem({parent:this.gui,what:"markerView",position:[0,this.gui.size[1]-150+44],text:"Markers"});this.select_marker_view.on("select",this.selectView,this);this.select_bg_view=new ToolViewSelectItem({parent:this.gui,what:"bgView",position:[0,this.gui.size[1]-150+66],text:"Background"});
this.select_bg_view.on("select",this.selectView,this);this.select_properties_view=new ToolViewSelectItem({parent:this.gui,what:"propertiesView",position:[0,this.gui.size[1]-150+88],text:"Properties"});this.select_properties_view.on("select",this.selectView,this);this.select_layer_view=new ToolViewSelectItem({parent:this.gui,what:"layerView",position:[0,this.gui.size[1]-150+110],text:"Layers"});this.select_layer_view.on("select",this.selectView,this);this.gui.on(d.EVT_MOUSE_WHEEL,this.mouseWheel,this);
this.level_view.on(d.EVT_MOUSE_DOWN,this.viewMouseDown,this);this.gui.on(d.EVT_MOUSE_DOWN,this.mouseDown,this);this.level_view.on(d.EVT_KEY_DOWN,this.keyDown,this);this.dialogel=document.getElementById("saveload_dialog");if(!this.dialogel){this.dialogel=document.createElement("div");this.dialogel.id="saveload_dialog";var a=document.createElement("p");a.innerHTML='To save, copy level code below and save it as a text file on your computer or however is convenient. To load, paste level code into textarea below and click "load".';
this.dialogel.appendChild(a);this.textarea=document.createElement("textarea");this.textarea.style.width="400px";this.textarea.style.height="300px";this.dialogel.appendChild(this.textarea);document.body.appendChild(this.dialogel);$(this.dialogel).click(function(a){a.stopPropagation()})}$(this.dialogel).dialog({autoOpen:!1,title:"Save / Load",width:460,buttons:[{text:"New",click:function(){l.game.editor_scene.loadLevel(A([2500,2500]));$(this).dialog("close")}},{text:"Load example",click:function(){l.game.editor_scene.loadExample();
$(this).dialog("close")}},{text:"Load",click:function(){l.game.editor_scene.load();$(this).dialog("close")}},{text:"Close",click:function(){$(this).dialog("close")}}]});$(this.dialogel).scene=this;this.loadLevel(this.level)};S.prototype.selectView=function(a){a.what=="decalView"?this.decal_view.show():(this.decal_view.hide(),this.select_decal_view.deselect());a.what=="propView"?this.prop_view.show():(this.prop_view.hide(),this.select_prop_view.deselect());a.what=="markerView"?this.marker_view.show():
(this.marker_view.hide(),this.select_marker_view.deselect());a.what=="bgView"?this.bg_view.show():(this.bg_view.hide(),this.select_bg_view.deselect());a.what=="propertiesView"?this.properties_view.show():(this.properties_view.hide(),this.select_properties_view.deselect());a.what=="layerView"?this.layer_view.show():(this.layer_view.hide(),this.select_layer_view.deselect())};S.prototype.mouseDown=function(a){if(a.button==2)this.deselectEverything(),this.selected=null};S.prototype.destroyInstance=function(a){a.destroy();
this.deselectEverything(this.instance);if(this.selected.subtype=="instance"&&this.selected.instance_id==a.instance_id)this.selected=null};S.prototype.keyDown=function(a){this.selected&&this.selected.subtype=="instance"&&a.key==46&&this.destroyInstance(this.selected)};S.prototype.viewMouseDown=function(a){a.button==0&&this.selected&&this.selected.place&&this.selected.place(a.pos)};S.prototype.selectTool=function(a){this.deselectEverything(this.selected=a.tool)};S.prototype.deselectEverything=function(a){this.tools.forEach(function(r){(!a||
!(r.type==a.type&&r.filename==a.filename))&&r.deselect()},this);this.level_view.children.forEach(function(r){(!a||r.instance_id!=a.instance_id)&&r.deselect()},this)};S.prototype.selectInstance=function(a){this.deselectEverything(this.selected=a.instance)};S.prototype.mouseWheel=function(a){if(this.selected)if(a.delta<0){if(this.selected.rotateRight)for(var r=0;r<Math.abs(a.delta);r++)this.selected.rotateRight()}else if(a.delta>0&&this.selected.rotateLeft)for(r=0;r<Math.abs(a.delta);r++)this.selected.rotateLeft()};
S.prototype.loadExample=function(){try{this.loadLevel(JSON.parse('{"size":[2100,1100],"title":"Example Raceway","bgtile":"sand.png","props":[{"p":[413,159],"f":1,"a":270},{"p":[687,158],"f":1,"a":270},{"p":[960,157],"f":1,"a":270},{"p":[310,259],"f":2,"a":240},{"p":[283,350],"f":2,"a":180},{"p":[282,442],"f":2,"a":180},{"p":[283,515],"f":2,"a":150},{"p":[360,579],"f":2,"a":105},{"p":[469,596],"f":2,"a":90},{"p":[561,596],"f":2,"a":90},{"p":[654,596],"f":2,"a":90},{"p":[706,561],"f":2,"a":15},{"p":[725,475],"f":2,"a":15},{"p":[768,388],"f":2,"a":225},{"p":[857,355],"f":2,"a":75},{"p":[957,261],"f":1,"a":270},{"p":[1232,352],"f":2,"a":90},{"p":[1321,351],"f":2,"a":90},{"p":[1310,276],"f":2,"a":330},{"p":[1238,278],"f":3,"a":0},{"p":[1272,278],"f":3,"a":0},{"p":[1307,282],"f":3,"a":0},{"p":[1608,587],"f":2,"a":270},{"p":[1704,586],"f":2,"a":270},{"p":[1577,628],"f":2,"a":150},{"p":[1669,686],"f":2,"a":90},{"p":[1729,626],"f":2,"a":45},{"p":[1802,618],"f":3,"a":0},{"p":[1103,-73],"f":1,"a":270},{"p":[832,-74],"f":1,"a":270},{"p":[562,-73],"f":1,"a":270},{"p":[1367,19],"f":2,"a":285},{"p":[1449,49],"f":2,"a":300},{"p":[1516,115],"f":2,"a":330},{"p":[1558,204],"f":2,"a":345},{"p":[1578,304],"f":2,"a":0},{"p":[1610,361],"f":2,"a":270},{"p":[1702,359],"f":2,"a":270},{"p":[1794,359],"f":2,"a":270},{"p":[1877,359],"f":2,"a":285},{"p":[1943,410],"f":2,"a":330},{"p":[1988,498],"f":2,"a":345},{"p":[2006,598],"f":2,"a":0},{"p":[1992,685],"f":2,"a":15},{"p":[1956,767],"f":2,"a":30},{"p":[1901,839],"f":2,"a":45},{"p":[1833,894],"f":2,"a":75},{"p":[1752,921],"f":2,"a":90},{"p":[1660,927],"f":2,"a":90},{"p":[1557,909],"f":2,"a":105},{"p":[1462,870],"f":2,"a":120},{"p":[1389,810],"f":2,"a":135},{"p":[1352,738],"f":2,"a":165},{"p":[1349,655],"f":2,"a":180},{"p":[1380,622],"f":3,"a":0},{"p":[1352,612],"f":3,"a":0},{"p":[1080,493],"f":1,"a":270},{"p":[988,585],"f":2,"a":90},{"p":[953,645],"f":2,"a":0},{"p":[913,717],"f":2,"a":30},{"p":[853,783],"f":2,"a":60},{"p":[781,826],"f":2,"a":90},{"p":[503,739],"f":1,"a":270},{"p":[410,828],"f":2,"a":90},{"p":[320,825],"f":2,"a":90},{"p":[219,802],"f":2,"a":105},{"p":[133,754],"f":2,"a":135},{"p":[75,689],"f":2,"a":150},{"p":[45,613],"f":2,"a":165},{"p":[-42,349],"f":1,"a":0},{"p":[48,257],"f":2,"a":180},{"p":[53,154],"f":2,"a":210},{"p":[106,74],"f":2,"a":225},{"p":[182,24],"f":2,"a":240},{"p":[289,21],"f":2,"a":270},{"p":[383,19],"f":2,"a":270},{"p":[472,18],"f":2,"a":270}],"decals":[{"p":[114,84],"f":4,"a":0},{"p":[426,36],"f":5,"a":0},{"p":[714,36],"f":5,"a":0},{"p":[1002,36],"f":5,"a":0},{"p":[1290,84],"f":4,"a":90},{"p":[1386,396],"f":6,"a":0},{"p":[1410,636],"f":4,"a":270},{"p":[1716,636],"f":4,"a":180},{"p":[1812,420],"f":7,"a":90},{"p":[1668,420],"f":8,"a":90},{"p":[1578,420],"f":8,"a":90},{"p":[1194,420],"f":9,"a":90},{"p":[1002,420],"f":9,"a":90},{"p":[786,420],"f":7,"a":0},{"p":[762,636],"f":7,"a":180},{"p":[474,612],"f":5,"a":0},{"p":[114,540],"f":4,"a":270},{"p":[114,402],"f":8,"a":180},{"p":[114,342],"f":8,"a":180},{"p":[378,660],"f":8,"a":270},{"p":[1446,372],"f":10,"a":90},{"p":[1524,372],"f":10,"a":90},{"p":[1614,450],"f":10,"a":180},{"p":[1614,540],"f":10,"a":180},{"p":[1062,90],"f":11,"a":90},{"p":[1062,168],"f":11,"a":90},{"p":[1014,102],"f":12,"a":90},{"p":[924,210],"f":12,"a":90},{"p":[822,102],"f":12,"a":90},{"p":[720,210],"f":12,"a":90},{"p":[600,102],"f":12,"a":90},{"p":[480,210],"f":12,"a":90}],"ai_waypoints":[{"p":[1362,212],"n":1},{"p":[1492,504],"n":2},{"p":[1559,750],"n":3},{"p":[928,554],"n":6},{"p":[1849,727],"n":4},{"p":[1814,544],"n":5},{"p":[1109,443],"n":6},{"p":[739,675],"n":7},{"p":[343,688],"n":8},{"p":[228,463],"n":9},{"p":[237,277],"n":10},{"p":[444,186],"n":11}],"checkpoints":[{"p":[1107,45],"n":1},{"p":[1377,648],"n":2},{"p":[1763,409],"n":3},{"p":[787,413],"n":4},{"p":[118,577],"n":5},{"p":[167,67],"n":6}],"start_positions":[{"p":[965,95],"n":1,"a":90},{"p":[872,203],"n":2,"a":90},{"p":[771,98],"n":3,"a":90},{"p":[668,206],"n":4,"a":90},{"p":[546,94],"n":5,"a":90},{"p":[426,202],"n":6,"a":90}],"dict":{"1":"9tires.png","2":"3tires.png","3":"tire.png","4":"dideliskampas.png","5":"ilgas.png","6":"kryzius.png","7":"lenktas.png","8":"trumpas.png","9":"paprastas.png","10":"arrow.png","11":"startbar.png","12":"white_bar.png"}}'))}catch(a){alert("failed! "+
a)}};S.prototype.load=function(){try{this.loadLevel(JSON.parse(this.textarea.value))}catch(a){alert("failed! "+a)}};S.prototype.resizeLevelView=function(){var a=this.level.size,r=a[0],c=a[1];this.level_view.resize(a);this.scw.autoSetScrollableArea();this.properties_view.widthlbl.setText(String(r));this.properties_view.heightlbl.setText(String(c));a=Math.max(r,c)/198;r=[parseInt(r/a),parseInt(c/a)];this.minimap.resize(r);this.minimap.image=new h.Surface(r)};S.prototype.loadLevel=function(a){this.level=
A(a.size);this.level.bgtile=a.bgtile;this.level.title=a.title;if(a.laps)this.level.laps=a.laps;this.properties_view.title.setText(a.title);this.properties_view.lapslbl.setText(String(this.level.laps));this.resizeLevelView();this.level_view.children=[];var r,c,T;a.decals.forEach(function(r){c=this.decal_view.filename_to_decal[a.dict[r.f]];T=new K({parent:this.level_view,size:c.getCursorImage().getSize(),scene:this,angle:r.a,original:c,position:r.p});this.level.decals.push(T)},this);a.props.forEach(function(c){r=
this.prop_view.filename_to_prop[a.dict[c.f]];T=new N({parent:this.level_view,size:r.getCursorImage(c.a).getSize(),scene:this,angle:c.a,original:r,position:c.p});this.level.props.push(T)},this);var d=0,b=0,f=0;a.ai_waypoints.forEach(function(a){T=new R({parent:this.level_view,size:this.marker_view.ai_waypoint.getCursorImage().getSize(),scene:this,angle:0,number:a.n,original:this.marker_view.ai_waypoint,position:a.p});this.level.ai_waypoints.push(T);d=Math.max(d,a.n)},this);this.marker_view.ai_waypoint.setNumber(d+
1);a.checkpoints.forEach(function(a){T=new C({parent:this.level_view,size:P,scene:this,angle:0,original:this.marker_view.checkpoint,number:a.n,position:a.p});this.level.checkpoints.push(T);b=Math.max(b,a.n)},this);this.marker_view.checkpoint.setNumber(b+1);a.start_positions.forEach(function(a){T=new F({parent:this.level_view,size:this.marker_view.start_position.size,scene:this,angle:a.a,original:this.marker_view.start_position,number:a.n,position:a.p});this.level.start_positions.push(T);f=Math.max(f,
a.n)},this);this.marker_view.start_position.setNumber(f+1);this.level_view.refresh()};S.prototype.alert=function(){this.dialog.show(text,button)};S.prototype.clearAlert=function(){this.dialog.close()};S.prototype.handleEvent=function(a){this.gui.despatchEvent(a)};S.prototype.alert=function(a,r){this.alertdialog.show(a,r)};S.prototype.clearAlert=function(){this.alertdialog.close()};S.prototype.update=function(a){if(this.ping&&(this.ms_to_ping-=a,this.ms_to_ping<=0))this.game.getCommunicator().queueMessage("PING"),
this.ms_to_ping=1E4;this.gui.update(a)};S.prototype.draw=function(){this.gui.draw()};h.utils.objects.extend(g,f.Button);g.prototype.onclick=function(){this.is_on?(this.scene.level[this.layer].forEach(function(a){a.hide()}),this.is_on=!1,this.setText("Off")):(this.scene.level[this.layer].forEach(function(a){a.show()}),this.is_on=!0,this.setText("On"))};h.utils.objects.extend(e,d.Dialog)}},["gamejs-gui","ui","combatracer","settings","gamejs","renderer","resources","skin"]);
require.define({sounds:function(n,b){n("gamejs");n("./resources");var a=n("./settings"),j=n("./engine");b.play=function(b){a.get("sound")&&j.play_sound("sounds/fx/"+b.filename)};b.engine=null;b.init=function(){}}},["gamejs","resources","settings","engine"]);
require.define({gamescenes:function(n,b){function a(c){c.size=[220,200];a.superConstructor.apply(this,[c]);this.scene=c.scene;this.quitbtn=new f.Button({parent:this,text:"Quit",size:[180,40],lean:"both",position:[20,20]});this.quitbtn.onClick(function(){this.close();this.scene.game.showSPGameOver(this.scene.genScoreTable(),0,this.scene)},this);this.continuebtn=new f.Button({parent:this,text:"Continue",size:[180,40],lean:"both",position:[20,70]});this.continuebtn.onClick(function(){this.close();this.scene.paused=
!1},this)}var j=n("gamejs"),m=n("./utils");n("./sounds");var k=n("./combatracer"),g=n("./cars"),e=n("./bots"),d=n("./gamejs-gui"),f=n("./ui"),l=n("./leagues"),h=j.utils.math;radians=h.radians;degrees=h.degrees;var q=n("./world"),c=n("./renderer"),z=n("./settings"),P=n("./controllers");n("./car_descriptions");var h=b.LevelScene=function(a){this.game=k.game;this.level=a;this.cache=c.cache;this.paused=this.started=!1;this.time_to_start=3E3;this.controllers=[];this.keys_down={};this.started=!1;this.max_laps=
a.laps?a.laps:3;this.world=q.build_world(a,q.MODE_STANDALONE);this.gui=new d.GUI(this.game.display);this.background=m.renderLevelBackground(a,!0);this.renderer=new c.RaceRenderer(z.get("SCREEN_WIDTH"),z.get("SCREEN_HEIGHT"),this.world,this.background,this.cache);this.handleEvent=function(a){if(a.type===j.event.KEY_DOWN){this.keys_down[a.key]=!0;if(a.key===j.event.K_SPACE)this.paused=!this.paused;if(a.key===j.event.K_ESC&&this.dialog)this.dialog.visible?(this.paused=!1,this.dialog.hide()):(this.paused=
!0,this.dialog.show())}else a.type===j.event.KEY_UP&&(this.keys_down[a.key]=!1);this.gui.despatchEvent(a)};this.updateZoom=function(){this.keys_down[j.event.K_p]?this.renderer.increaseZoom():this.keys_down[j.event.K_l]&&this.renderer.decreaseZoom()};this.destroy=function(){}},D=b.MultiplayerLevelScene=function(a,c,d){D.superConstructor.apply(this,[a,c,d]);this.game=a;this.processed_events={};this.world.mode=q.MODE_CLIENT;this.last_known_event_no=this.last_event_no=0;this.queued_updates=[];this.time_to_start=
3E3;this.player_car=null;this.delta=this.time=this.upds_stacked=0;this.last_t=null;this.deltas=[];this.delta_q=0;this.states={};this.queued_events={};this.extradelay=50;this.last_upd_time=0;this.carid=null;this.bfs=0;this.send_update=!0;this.time_since_last_update_sent=0;this.state=1;this.controllers[this.controllers.length]=this.controller=new P.MultiplayerController;this.setState=function(a){var c=0,d=0,b;for(b in this.states){if(b==a){c=b;d=0;break}if(b<a&&b>c)c=b;else if(b>a&&(b<d||d===0))d=b}if(c||
d){b=this.states[c];var f=d?this.states[d]:null,e=0;c&&d&&(e=(a-c)/(d-c));var g,l;for(l in b)if(g=this.world.getObjectById(l))f&&f[l]&&g.interpolate?(d=g.interpolate(b[l],f[l],e),this.last_upd_time=a):(this.bfs++,d=b[l],this.last_upd_time=c),g.setState(d)}else console.log("no known state!")};this.update=function(a){this.time+=a;this.handleWorldUpdate();this.paused=!1;this.updateZoom(a);if(this.time_to_start<0)this.started=!0;var c=this.time+this.delta-10;this.processEvents(c);if(this.started){this.setState(c);
if(c>this.last_upd_time)this.world.b2world.Step((c-this.last_upd_time)/1E3,10,8),this.world.b2world.ClearForces(),this.last_upd_time=c;this.controllers.forEach(function(c){if(c.update(this.keys_down,a))this.send_update=!0},this);this.world.update(a)}this.time_since_last_update_sent+=a;if(this.time_since_last_update_sent>1E3&&!this.send_update)this.send_update=!0;this.sendInfo()};this.sendInfo=function(){if(this.send_update)this.game.getCommunicator().queueMessage("GAME_UPDATE",{actions:this.controller.actions,
eventno:this.last_known_event_no}),this.send_update=!1,this.time_since_last_update_sent=0};this.processEvents=function(a){for(;this.queued_events[this.last_event_no+1]&&this.queued_events[this.last_event_no+1].t<=a;){var c=this.queued_events[this.last_event_no+1];this.world.handleEvent(c.type,c.descr);this.last_event_no=c.no;delete this.queued_events[c.no];if(!this.player_car&&this.carid&&(obj=this.world.getObjectById(this.carid)))this.player_car=obj,this.renderer.follow(obj),this.game.getCommunicator().queueMessage("GAME_READY",
{})}};this.handleWorldUpdate=function(){this.queued_updates.forEach(function(a){this.time_to_start=a.tts;this.state=a.st;a.events.forEach(function(c){if(c.no>this.last_event_no&&!this.queued_events[c.no])c.t=a.t,this.queued_events[c.no]=c,this.last_known_event_no=c.no},this);this.carid=a.carid;this.states[a.t]=a.states;this.last_t=a.t;this.upds_stacked=0},this);for(var a in this.states)a<this.time+this.delta-300&&a!=this.last_t&&delete this.states[a];if(this.queued_updates.length)a=this.time-this.queued_updates[0].t,
this.deltas.push(a),dlen=this.deltas.length,this.delta_q+=a,dlen>60&&(this.delta_q-=this.deltas.shift(),dlen=60),this.delta=parseInt(this.delta_q/dlen);this.queued_updates=[]};this.draw=function(a,c){this.renderer.render(a);this.state==2&&this.renderer.follow_object.active==!1&&this.world.objects.car.some(function(a){if(a.active)return this.renderer.follow_object=a,!0;return!1},this);this.renderer.renderHUD(a,{car:this.player_car,max_laps:this.max_laps,time_to_start:this.time_to_start,paused:this.paused,
delta:this.delta,msDuration:c,bfs:this.bfs,message:this.state==2?"Finished!":""})};this.handleMessage=function(a,c){a=="GAME_UPDATE"?this.queued_updates[this.queued_updates.length]=c:a=="GAME_OVER"?this.game.showGameOver(c.table):a=="CRITICAL_ERR"&&(this.returnToTitle(),this.game.title_scene.alert(c.text))}};j.utils.objects.extend(D,h);var B=b.SingleplayerLevelScene=function(c,d){B.superConstructor.apply(this,[c]);this.dialog=new a({parent:this.gui,scene:this});this.test_ai=d;var b=g.get_car_parameters([this.world.start_positions[1].x,
this.world.start_positions[1].y],this.world.start_positions[1].angle,k.game.player.singleplayer.car,k.game.player.alias,!0);this.player_car=this.world.create(g.Car,b);this.test_ai?this.controllers.push(new P.AIController(this.player_car,this.world,this)):this.controllers.push(new P.PlayerCarController(this.player_car));var f=l[this.game.player.singleplayer.league];if(!this.test_ai)for(i=1;i<4;i++)if(this.world.start_positions[i+1]){b=e[f.bots[i-1]];b=g.get_car_parameters([this.world.start_positions[i+
1].x,this.world.start_positions[i+1].y],this.world.start_positions[i+1].angle,b,b.name,!1);if(k.game.player.singleplayer.difficulty==4)b.acc_upgrades=5,b.speed_upgrades=5,b.armor_upgrades=5,["util","rear_weapon","front_weapon"].forEach(function(a){if(this[a])this[a].ammo_upgrades=Math.min(this[a].ammo_upgrades+2,5),this[a].damage_upgrades=Math.min(this[a].damage_upgrades+2,5)},b);b=this.world.create(g.Car,b);this.controllers.push(new P.AIController(b,this.world,this))}this.renderer.follow(this.player_car);
this.update=function(a){this.updateZoom(a);if(this.time_to_start>-1E3&&(this.time_to_start-=a,this.time_to_start<0))this.started=!0;!this.paused&&this.started&&(this.controllers.forEach(function(c){c.update(this.keys_down,a)},this),this.world.update(a),this.world.b2world.Step(a/1E3,10,8),this.world.b2world.ClearForces());this.player_car.lap>this.max_laps&&this.game.showSPGameOver(this.genScoreTable(),this.player_car.get_race_position(),this)};this.draw=function(a,c){this.renderer.render(a);this.renderer.renderHUD(a,
{car:this.player_car,max_laps:this.max_laps,msDuration:c,time_to_start:this.time_to_start,paused:this.paused});this.dialog.visible&&this.gui.draw(!0)};this.genScoreTable=function(){var a=this.world.get_objects_by_tag("car").map(function(a,c){return{place:a.get_race_position(),id:c,player:a.alias,kills:a.kills,deaths:a.deaths}});a.sort(function(a,c){if(a.place>c.place)return 1;else if(a.place<c.place)return-1;return 0});return a};this.handleMessage=function(){}};j.utils.objects.extend(B,h);j.utils.objects.extend(a,
d.Dialog)}},["gamejs","utils","sounds","combatracer","cars","bots","gamejs-gui","ui","leagues","world","renderer","settings","controllers","car_descriptions"]);
require.define({"gamejs/image":function(n,b){var a=n("../gamejs"),j={};b.load=function(b){var k;if(typeof b==="string"){if(k=j[b],!k)throw Error('Missing "'+b+'", gamejs.preload() all images before trying to load them.');}else k=b;b=document.createElement("canvas");b.width=k.naturalWidth||k.width;b.height=k.naturalHeight||k.height;var g=b.getContext("2d");g.drawImage(k,0,0);k.getSize=function(){return[k.naturalWidth,k.naturalHeight]};var e=new a.Surface(k.getSize());e._canvas=b;e._context=g;return e};
b.init=function(){};b.preload=function(b){function k(){d++;d%10===0&&a.log("gamejs.image: preloaded  "+d+" of "+f)}function g(){j[this.gamejsKey]=this;k()}function e(){k();throw Error("Error loading "+this.src);}var d=0,f=0,l;for(l in b){var h=l.toLowerCase();if(!(h.indexOf(".png")==-1&&h.indexOf(".jpg")==-1&&h.indexOf(".jpeg")==-1&&h.indexOf(".svg")==-1&&h.indexOf(".gif")==-1))h=new Image,h.addEventListener("load",g,!0),h.addEventListener("error",e,!0),h.src=b[l],h.gamejsKey=l,f++}return function(){return f>
0?d/f:1}}}},["gamejs"]);
require.define({"gamejs/sprite":function(n,b){n("../gamejs");var a=n("./utils/arrays"),j=n("./utils/objects"),m=n("./utils/vectors"),k=b.Sprite=function(){this._groups=[];this._alive=!0;this.rect=this.image=null;j.accessor(this,"groups",function(){return this._groups});return this};k.prototype.kill=function(){this._alive=!1;this._groups.forEach(function(a){a.remove(this)},this)};k.prototype.remove=function(a){a instanceof Array||(a=[a]);a.forEach(function(a){a.remove(this)},this)};k.prototype.add=
function(a){a instanceof Array||(a=[a]);a.forEach(function(a){a.add(this)},this)};k.prototype.groups=function(){return this._groups.slice(0)};k.prototype.draw=function(a){a.blit(this.image,this.rect)};k.prototype.update=function(){};k.prototype.isDead=function(){return!this._alive};var g=b.Group=function(a){this._sprites=[];(a instanceof k||a instanceof Array&&a.length&&a[0]instanceof k)&&this.add(a);return this};g.prototype.update=function(){var a=arguments;this._sprites.forEach(function(b){b.update.apply(b,
a)},this)};g.prototype.add=function(a){a instanceof Array||(a=[a]);a.forEach(function(a){this._sprites.push(a);a._groups.push(this)},this)};g.prototype.remove=function(d){d instanceof Array||(d=[d]);d.forEach(function(d){a.remove(d,this._sprites);a.remove(this,d._groups)},this)};g.prototype.has=function(a){a instanceof Array||(a=[a]);return a.every(function(a){return this._sprites.indexOf(a)!==-1},this)};g.prototype.sprites=function(){return this._sprites};g.prototype.draw=function(){var a=arguments;
this._sprites.forEach(function(b){b.draw.apply(b,a)},this)};g.prototype.clear=function(a,b){this._sprites.forEach(function(e){a.blit(b,e.rect)},this)};g.prototype.empty=function(){this._sprites=[]};g.prototype.collidePoint=function(){var a=Array.prototype.slice.apply(arguments);return this._sprites.filter(function(b){return b.rect.collidePoint.apply(b.rect,a)},this)};g.prototype.forEach=function(a,b){return this._sprites.forEach(a,b)};g.prototype.some=function(a,b){return this._sprites.some(a,b)};
b.spriteCollide=function(a,b,g,j){var j=j||e,g=g||!1,q=[];b.sprites().forEach(function(c){j(a,c)&&(g&&c.kill(),q.push(c))});return q};b.groupCollide=function(a,b,g,j,q){var g=g||!1,j=j||!1,c=[],z=q||e;a.sprites().forEach(function(a){b.sprites().forEach(function(d){z(a,d)&&(g&&a.kill(),j&&d.kill(),c.push({a:a,b:d}))})});return c};var e=b.collideRect=function(a,b){return a.rect.collideRect(b.rect)};b.collideMask=function(a,b){if(!a.mask||!b.mask)throw Error("Both sprites must have 'mask' attribute set to an gamejs.mask.Mask");
return a.mask.overlap(b.mask,[b.rect.left-a.rect.left,b.rect.top-a.rect.top])};b.collideCircle=function(a,b){var e=a.radius||Math.max(a.rect.width,a.rect.height),g=b.radius||Math.max(b.rect.width,b.rect.height);return m.distance(a.rect.center,b.rect.center)<=e+g}}},["gamejs","gamejs/utils/arrays","gamejs/utils/objects","gamejs/utils/vectors"]);
require.define({"gamejs/pathfinding/astar":function(n,b){function a(a){var b={};this.store=function(f,g){b[a(f)]=g};this.find=function(f){return b[a(f)]};return this}var j=n("../utils/binaryheap").BinaryHeap;b.findRoute=function(b,d,f,g){function h(a){c.push(a);z.store(a.point,a)}function q(a){var d=z.find(a),f=D.length+b.actualDistance(D.point,a);if(!d||d.length>f)d&&c.remove(d),h({point:a,from:D,length:f})}var c=new j(function(a){if(a.score===void 0)a.score=b.estimatedDistance(a.point,f)+a.length;
return a.score}),z=new a(typeof b.hash==="function"?b.hash:k),n=Date.now(),D=null;h({point:d,from:null,length:0});for(d=typeof b.equals==="function"?b.equals:m;c.size()>0&&(!g||Date.now()-n<g);){D=c.pop();if(d(f,D.point))return D;b.adjacent(D.point).forEach(q)}return null};var m=function(a,b){return a[0]===b[0]&&a[1]===b[1]},k=function(a){return a[0]+"-"+a[1]},g=b.Map=function(){throw Error("not instantiable, this is an interface");};g.prototype.adjacent=function(){};g.prototype.equals=m;g.prototype.hash=
k;g.prototype.estimatedDistance=function(){return 1};g.prototype.actualDistance=function(){return 1}}},["gamejs/utils/binaryheap"]);
require.define({"gamejs/font":function(n,b){var a=n("../gamejs").Surface,j=n("./utils/objects"),m=b.Font=function(b,g){this.sampleSurface=new a([10,10]);this.sampleSurface.context.font=b;this.sampleSurface.context.textAlign="start";this.sampleSurface.context.textBaseline="bottom";this.backgroundColor=g||!1;return this};m.prototype.render=function(b,g){var e=this.size(b),e=new a(e),d=e.context;d.save();if(this.backgroundColor)d.fillStyle=this.backgroundColor,d.fillRect(0,0,e.rect.width,e.rect.height);
d.font=this.sampleSurface.context.font;d.textBaseline=this.sampleSurface.context.textBaseline;d.textAlign=this.sampleSurface.context.textAlign;d.fillStyle=d.strokeStyle=g||"#000000";d.fillText(b,0,e.rect.height,e.rect.width);d.restore();return e};m.prototype.size=function(a){return[this.sampleSurface.context.measureText(a).width,this.fontHeight]};j.accessors(m.prototype,{fontHeight:{get:function(){return this.sampleSurface.context.measureText("M").width*1.5}}})}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/mixer":function(n,b){function a(a){a instanceof Array||(a=[a]);a.forEach(function(a){j[a.gamejsKey]=a})}n("../gamejs");var j={},m=!1,k=8;b.setNumChannels=function(a){k=parseInt(a,10)||k};b.getNumChannels=function(){return k};b.init=function(){var b=Array.prototype.slice.call(document.getElementsByTagName("audio"),0);a(b)};b.preload=function(b){function e(){a(this);j++;j==f&&(m=!1)}function d(){j++;j==f&&(m=!1);throw Error("Error loading "+this.src);}var f=0,j=0,h;for(h in b)if(!(h.indexOf("wav")==
-1&&h.indexOf("ogg")==-1&&h.indexOf("webm")==-1)){f++;var q=new Audio;q.addEventListener("canplay",e,!0);q.addEventListener("error",d,!0);q.src=b[h];q.gamejsKey=h;q.load()}f>0&&(m=!0);return function(){return f>0?j/f:1}};b.isPreloading=function(){return m};b.Sound=function(a){var b;b=typeof a==="string"?j[a]:a;if(!b)throw Error('Missing "'+a+'", gamejs.preload() all audio files before loading');for(var d=[],a=k;a-- >0;){var f=new Audio;f.preload="auto";f.loop=!1;f.src=b.src;d.push(f)}this.play=function(a){d.some(function(b){if(b.ended||
b.paused)return b.loop=!!a,b.play(),!0;return!1})};this.stop=function(){d.forEach(function(a){a.pause();a.currentTime=0})};this.setVolume=function(a){d.forEach(function(b){b.volume=a})};this.getVolume=function(){return d[0].volume};this.getLength=function(){return d[0].duration};return this}}},["gamejs"]);require.define({"gamejs/callback":function(n,b){(b.Callback=function(a,b){this.fn=a;this.fnScope=b||{};return this}).prototype.trigger=function(){this.fn.apply(this.fnScope,arguments)}}},[]);
require.define({"gamejs/http":function(n,b){function a(a){return eval("("+a.responseText+")")}b.Response=function(){this.getResponseHeader=function(){};throw Error("response class not instantiable");};var j=b.ajax=function(a,b,d,f){var d=d||null,j=new XMLHttpRequest;j.open(a,b,!1);f&&j.setRequestHeader("Accept",f);d instanceof Object&&(d=JSON.stringify(d),j.setRequestHeader("Content-Type","application/json"));j.setRequestHeader("X-Requested-With","XMLHttpRequest");j.send(d);return j},m=b.get=function(a){return j("GET",
a)},k=b.post=function(a,b,d){return j("POST",a,b,d)};b.load=function(b){return a(m((window.$g&&window.$g.ajaxBaseHref||"./")+b))};b.save=function(b,e,d){return a(k((window.$g&&window.$g.ajaxBaseHref||"./")+b,{payload:e},d))}}},[]);
require.define({"gamejs/transform":function(n,b){var a=n("../gamejs").Surface,j=n("./utils/matrix");n("./utils/math");var m=n("./utils/vectors");b.rotate=function(b,g){var e=b.getSize(),d=g*Math.PI/180,f=e;if(g%360!==0)var f=b.getRect(),f=[[-f.width/2,f.height/2],[f.width/2,f.height/2],[-f.width/2,-f.height/2],[f.width/2,-f.height/2]].map(function(a){return m.rotate(a,d)}),l=f.map(function(a){return a[0]}),h=f.map(function(a){return a[1]}),f=Math.min.apply(Math,l),l=Math.max.apply(Math,l),q=Math.min.apply(Math,
h),h=Math.max.apply(Math,h),f=[l-f,h-q];h=new a(f);l=b._matrix;b._matrix=j.translate(b._matrix,e[0]/2,e[1]/2);b._matrix=j.rotate(b._matrix,d);b._matrix=j.translate(b._matrix,-e[0]/2,-e[1]/2);h.blit(b,[(f[0]-e[0])/2,(f[1]-e[1])/2]);b._matrix=l;return h};b.scale=function(b,g){var e=g[0],d=g[1];if(e<=0||d<=0)throw Error("[gamejs.transform.scale] Invalid arguments for height and width",[e,d]);var f=b.getSize(),l=e/f[0],f=d/f[1],e=new a([e,d]),d=b._matrix.slice(0);b._matrix=j.scale(b._matrix,[l,f]);e.blit(b);
b._matrix=d;return e};b.flip=function(b,g,e){var d=b.getSize(),f=new a(d),j=1,h=1,q=0,c=0;g===!0&&(j=-1,q=-d[0]);e===!0&&(h=-1,c=-d[1]);f.context.save();f.context.scale(j,h);f.context.drawImage(b.canvas,q,c);f.context.restore();return f}}},["gamejs","gamejs/utils/matrix","gamejs/utils/math","gamejs/utils/vectors"]);
require.define({"gamejs/event":function(n,b){var a=n("./display"),j=n("./callback").Callback;b._CALLBACK=new j(function(){},{});b._triggerCallback=function(){b._CALLBACK.trigger.apply(b._CALLBACK,arguments)};b.K_UP=38;b.K_DOWN=40;b.K_RIGHT=39;b.K_LEFT=37;b.K_SPACE=32;b.K_BACKSPACE=8;b.K_TAB=9;b.K_ENTER=13;b.K_SHIFT=16;b.K_CTRL=17;b.K_ALT=18;b.K_ESC=27;b.K_0=48;b.K_1=49;b.K_2=50;b.K_3=51;b.K_4=52;b.K_5=53;b.K_6=54;b.K_7=55;b.K_8=56;b.K_9=57;b.K_a=65;b.K_b=66;b.K_c=67;b.K_d=68;b.K_e=69;b.K_f=70;b.K_g=
71;b.K_h=72;b.K_i=73;b.K_j=74;b.K_k=75;b.K_l=76;b.K_m=77;b.K_n=78;b.K_o=79;b.K_p=80;b.K_q=81;b.K_r=82;b.K_s=83;b.K_t=84;b.K_u=85;b.K_v=86;b.K_w=87;b.K_x=88;b.K_y=89;b.K_z=90;b.K_KP1=97;b.K_KP2=98;b.K_KP3=99;b.K_KP4=100;b.K_KP5=101;b.K_KP6=102;b.K_KP7=103;b.K_KP8=104;b.K_KP9=105;b.NOEVENT=0;b.NUMEVENTS=32E3;b.DISPLAY_FULLSCREEN_ENABLED=300;b.DISPLAY_FULLSCREEN_DISABLED=301;b.QUIT=0;b.KEY_DOWN=1;b.KEY_UP=2;b.MOUSE_MOTION=3;b.MOUSE_UP=4;b.MOUSE_DOWN=5;b.MOUSE_WHEEL=6;b.USEREVENT=2E3;b.Event=function(){this.pos=
this.button=this.rel=this.key=this.type=null};b.init=function(){function j(e){var d=a._getCanvasOffset();b._CALLBACK.trigger({type:b.MOUSE_WHEEL,pos:[e.clientX-d[0],e.clientY-d[1]],delta:e.detail||-e.wheelDeltaY/40})}var k=[],g=a.getSurface()._canvas;g.addEventListener("mousedown",function(e){var d=a._getCanvasOffset();b._CALLBACK.trigger({type:b.MOUSE_DOWN,pos:[e.clientX-d[0],e.clientY-d[1]],button:e.button,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey})},!1);g.addEventListener("mouseup",
function(e){var d=a._getCanvasOffset();b._CALLBACK.trigger({type:b.MOUSE_UP,pos:[e.clientX-d[0],e.clientY-d[1]],button:e.button,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey})},!1);document.addEventListener("keydown",function(e){var d=e.keyCode||e.which;b._CALLBACK.trigger({type:b.KEY_DOWN,key:d,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey});(a._hasFocus()&&!e.ctrlKey&&!e.metaKey&&(d>=b.K_LEFT&&d<=b.K_DOWN||d>=b.K_0&&d<=b.K_z||d>=b.K_KP1&&d<=b.K_KP9||d===b.K_SPACE||d===b.K_TAB||
d===b.K_ENTER)||d===b.K_ALT||d===b.K_BACKSPACE)&&e.preventDefault()},!1);document.addEventListener("keyup",function(a){b._CALLBACK.trigger({type:b.KEY_UP,key:a.keyCode,shiftKey:a.shiftKey,ctrlKey:a.ctrlKey,metaKey:a.metaKey})},!1);document.addEventListener("mousemove",function(e){var d=a._getCanvasOffset(),d=[e.clientX-d[0],e.clientY-d[1]],f=[];k.length&&(f=[k[0]-d[0],k[1]-d[1]]);b._CALLBACK.trigger({type:b.MOUSE_MOTION,pos:d,rel:f,buttons:null,timestamp:e.timeStamp,movement:[e.movementX||e.mozMovementX||
e.webkitMovementX||0,e.movementY||e.mozMovementY||e.webkitMovementY||0]});k=d},!1);g.addEventListener("mousewheel",j,!1);g.addEventListener("DOMMouseScroll",j,!1);g.addEventListener("beforeunload",function(){b._CALLBACK.trigger({type:b.QUIT})},!1)}}},["gamejs/display","gamejs/callback"]);
require.define({"gamejs/noise":function(n,b){var a=b.Simplex=function(a){a==void 0&&(a=Math);this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]];this.p=[];var b;for(b=0;b<256;b++)this.p[b]=Math.floor(a.random()*256);this.perm=[];for(b=0;b<512;b++)this.perm[b]=this.p[b&255];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,
0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]};a.prototype.dot=
function(a,b,k){return a[0]*b+a[1]*k};a.prototype.get=function(a,b){var k,g,e;e=(a+b)*0.5*(Math.sqrt(3)-1);var d=Math.floor(a+e),f=Math.floor(b+e),l=(3-Math.sqrt(3))/6;e=(d+f)*l;k=a-(d-e);var h=b-(f-e),q,c;k>h?(q=1,c=0):(q=0,c=1);g=k-q+l;var z=h-c+l;e=k-1+2*l;var l=h-1+2*l,n=d&255;f&=255;d=this.perm[n+this.perm[f]]%12;q=this.perm[n+q+this.perm[f+c]]%12;c=this.perm[n+1+this.perm[f+1]]%12;f=0.5-k*k-h*h;f<0?k=0:(f*=f,k=f*f*this.dot(this.grad3[d],k,h));h=0.5-g*g-z*z;h<0?g=0:(h*=h,g=h*h*this.dot(this.grad3[q],
g,z));z=0.5-e*e-l*l;z<0?e=0:(z*=z,e=z*z*this.dot(this.grad3[c],e,l));return 70*(k+g+e)};a.prototype.get3d=function(a,b,k){var g,e,d,f=(a+b+k)*(1/3),l=Math.floor(a+f),h=Math.floor(b+f),q=Math.floor(k+f),f=1/6;d=(l+h+q)*f;g=a-(l-d);e=b-(h-d);var c=k-(q-d),z,n,D,B,A,w;g>=e?e>=c?(z=1,D=n=0,A=B=1,w=0):(g>=c?(z=1,D=n=0):(n=z=0,D=1),B=1,A=0,w=1):e<c?(n=z=0,D=1,B=0,w=A=1):g<c?(z=0,n=1,B=D=0,w=A=1):(z=0,n=1,D=0,A=B=1,w=0);var y=g-z+f,G=e-n+f,p=c-D+f;d=g-B+2*f;var a=e-A+2*f,L=c-w+2*f,k=g-1+3*f,b=e-1+3*f,f=
c-1+3*f;l&=255;var J=h&255,M=q&255,h=this.perm[l+this.perm[J+this.perm[M]]]%12,q=this.perm[l+z+this.perm[J+n+this.perm[M+D]]]%12;B=this.perm[l+B+this.perm[J+A+this.perm[M+w]]]%12;l=this.perm[l+1+this.perm[J+1+this.perm[M+1]]]%12;A=0.6-g*g-e*e-c*c;A<0?g=0:(A*=A,g=A*A*this.dot(this.grad3[h],g,e,c));e=0.6-y*y-G*G-p*p;e<0?e=0:(e*=e,e=e*e*this.dot(this.grad3[q],y,G,p));y=0.6-d*d-a*a-L*L;y<0?d=0:(y*=y,d=y*y*this.dot(this.grad3[B],d,a,L));a=0.6-k*k-b*b-f*f;a<0?k=0:(a*=a,k=a*a*this.dot(this.grad3[l],k,b,
f));return 32*(g+e+d+k)}}},[]);
require.define({"gamejs/surfacearray":function(n,b){var a=n("../gamejs"),j=n("./utils/objects").accessors;b.blitArray=function(a,b){a.context.putImageData(b.imageData,0,0)};b.SurfaceArray=function(b){var k=null,g=null,e=null;this.set=function(a,b,e){a=a*4+b*k[0]*4;g[a]=e[0];g[a+1]=e[1];g[a+2]=e[2];g[a+3]=e[3]===void 0?255:e[3]};this.get=function(a,b){var e=a*4+b*k[0]*4;return[g[e],g[e+1],g[e+2],g[e+3]]};this.surface=null;j(this,{surface:{get:function(){var b=new a.Surface(k);b.context.putImageData(e,
0,0);return b}},imageData:{get:function(){return e}}});this.getSize=function(){return k};b instanceof Array?(k=b,e=a.display.getSurface().context.createImageData(k[0],k[1])):(k=b.getSize(),e=b.getImageData(0,0,k[0],k[1]));g=e.data;return this}}},["gamejs","gamejs/utils/objects"]);
require.define({"gamejs/utils/objects":function(n,b){b.extend=function(a,b){if(a===void 0)throw Error("unknown subClass");if(b===void 0)throw Error("unknown superClass");var g=new Function;g.prototype=b.prototype;a.prototype=new g;a.prototype.constructor=a;a.superClass=b.prototype;a.superConstructor=b};b.merge=function(){var a={},b,g;for(b=arguments.length;b>0;--b){var e=arguments[b-1];for(g in e)a[g]=e[g]}return a};var a=b.keys=function(a){if(Object.keys)return Object.keys(a);var b=[],g;for(g in a)Object.prototype.hasOwnProperty.call(a,
g)&&b.push(g);return b},j=b.accessor=function(a,b,g,e){Object.defineProperty!==void 0?Object.defineProperty(a,b,{get:g,set:e}):Object.prototype.__defineGetter__!==void 0&&(a.__defineGetter__(b,g),e&&a.__defineSetter__(b,e))};b.accessors=function(b,k){a(k).forEach(function(a){j(b,a,k[a].get,k[a].set)})}}},[]);
require.define({"gamejs/utils/arrays":function(n,b){b.remove=function(a,b){if(b.indexOf(a)!==-1)return b.splice(b.indexOf(a),1);return null};b.shuffle=function(a){for(i=a.length-1;i>0;i--){var b=parseInt(Math.random()*(i+1),10),m=a[i];a[i]=a[b];a[b]=m}return a}}},[]);
require.define({"gamejs/utils/strings":function(n,b){b.getCommonPrefix=function(a,b){if(a==null||b==null)return null;else if(a.length>b.length&&a.indexOf(b)==0)return b;else if(b.length>a.length&&b.indexOf(a)==0)return a;var m=Math.min(a.length,b.length),k;for(k=0;k<m;k++)if(a[k]!=b[k])return a.slice(0,k);return a.slice(0,m)}}},[]);
require.define({"gamejs/utils/binaryheap":function(n,b){var a=b.BinaryHeap=function(a){this.content=[];this.scoreFunction=a;return this};a.prototype.push=function(a){this.content.push(a);this.sinkDown(this.content.length-1)};a.prototype.pop=function(){var a=this.content[0],b=this.content.pop();this.content.length>0&&(this.content[0]=b,this.bubbleUp(0));return a};a.prototype.remove=function(a){this.content.some(function(b,k){if(b==a){var g=this.content.pop();k!=this.content.length&&(this.content[k]=
g,this.scoreFunction(g)<this.scoreFunction(a)?this.sinkDown(k):this.bubbleUp(k));return!0}return!1},this)};a.prototype.size=function(){return this.content.length};a.prototype.sinkDown=function(a){for(var b=this.content[a];a>0;){var k=Math.floor((a+1)/2)-1,g=this.content[k];if(this.scoreFunction(b)<this.scoreFunction(g))this.content[k]=b,this.content[a]=g,a=k;else break}};a.prototype.bubbleUp=function(a){for(var b=this.content.length,k=this.content[a],g=this.scoreFunction(k);;){var e=(a+1)*2,d=e-1,
f=null;if(d<b){var l=this.scoreFunction(this.content[d]);l<g&&(f=d)}if(e<b&&this.scoreFunction(this.content[e])<(f===null?g:l))f=e;if(f!==null)this.content[a]=this.content[f],this.content[f]=k,a=f;else break}}}},[]);
require.define({"gamejs/utils/prng":function(n,b){var a=function(){var a=4022871197;this.hash=function(b){var b=b.toString(),d;for(d=0;d<b.length;d++){a+=b.charCodeAt(d);var f=0.02519603282416938*a;a=f>>>0;f-=a;f*=a;a=f>>>0;f-=a;a+=f*4294967296}return(a>>>0)*2.3283064365386963E-10};this.version="Mash 0.9";return this},j=b.Alea=function(){var b=Array.prototype.slice.call(arguments),e=0,d=0,f=0,j=1;if(b.length==0||!b[0])b=[Date.now()];var h=new a,e=h.hash(" "),d=h.hash(" "),f=h.hash(" "),q;for(q=0;q<
b.length;q++)e-=h.hash(b[q]),e<0&&(e+=1),d-=h.hash(b[q]),d<0&&(d+=1),f-=h.hash(b[q]),f<0&&(f+=1);h=null;this.random=function(){var a=2091639*e+j*2.3283064365386963E-10;e=d;d=f;return f=a-(j=a|0)};return this},m=null,k=b.integer=function(a,b){return a+parseInt(m.random()*(b-a+1),10)};b.vector=function(a,b){return[k(a[0],b[0]),k(a[1],b[1])]};b.choose=function(a){return a[k(0,a.length-1)]};b.random=function(){return m.random()};b.init=function(a){m=new j(a)}}},["gamejs/utils/prng"]);
require.define({"gamejs/utils/matrix":function(n,b){b.identity=function(){return[1,0,0,1,0,0]};b.add=function(a,b){return[a[0]+b[0],a[1]+b[1],a[2]+b[2],a[3]+b[3],a[4]+b[4],a[5]+b[5],a[6]+b[6]]};var a=b.multiply=function(a,b){return[a[0]*b[0]+a[2]*b[1],a[1]*b[0]+a[3]*b[1],a[0]*b[2]+a[2]*b[3],a[1]*b[2]+a[3]*b[3],a[0]*b[4]+a[2]*b[5]+a[4],a[1]*b[4]+a[3]*b[5]+a[5]]};b.translate=function(b,m,k){return a(b,[1,0,0,1,m,k])};b.rotate=function(b,m){var k=Math.sin(m),g=Math.cos(m);return a(b,[g,k,-k,g,0,0])};
b.rotation=function(a){return Math.atan2(a[1],a[0])};b.scale=function(b,m){return a(b,[m[0],0,0,m[1],0,0])}}},[]);
require.define({"gamejs/utils/base64":function(n,b){var a=b.decode=function(a){for(var b=[],k,g,e,d,f,l=0,a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<a.length;)k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(l++)),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(l++)),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(l++)),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(l++)),
k=k<<2|g>>4,g=(g&15)<<4|d>>2,e=(d&3)<<6|f,b.push(String.fromCharCode(k)),d!=64&&b.push(String.fromCharCode(g)),f!=64&&b.push(String.fromCharCode(e));return b=b.join("")};b.decodeAsArray=function(b,m){var m=m||1,k=a(b),g=k.length/m,e=[],d,f;for(d=0;d<g;d++){e[d]=0;for(f=m-1;f>=0;--f)e[d]+=k.charCodeAt(d*m+f)<<(f<<3)}return e}}},[]);
require.define({"gamejs/utils/math":function(n,b){b.normaliseDegrees=function(a){a%=360;a<0&&(a+=360);return a};b.normaliseRadians=function(a){a%=2*Math.PI;a<0&&(a+=2*Math.PI);return a};b.degrees=function(a){return a*(180/Math.PI)};b.radians=function(a){return a*(Math.PI/180)};b.centroid=function(){var a=Array.prototype.slice.apply(arguments,[0]),b=[0,0];a.forEach(function(a){b[0]+=parseInt(a[0],10);b[1]+=parseInt(a[1],10)});a=a.length;return[b[0]/a,b[1]/a]}}},[]);
require.define({"gamejs/utils/vectors":function(n,b){var a=n("./math");b.distance=function(a,b){return k(j(a,b))};var j=b.subtract=function(a,b){return[a[0]-b[0],a[1]-b[1]]};b.add=function(a,b){return[a[0]+b[0],a[1]+b[1]]};var m=b.multiply=function(a,b){if(typeof b==="number")return[a[0]*b,a[1]*b];return[a[0]*b[0],a[1]*b[1]]};b.divide=function(a,b){if(typeof b==="number")return[a[0]/b,a[1]/b];throw Error("only divide by scalar supported");};var k=b.len=function(a){return Math.sqrt(a[0]*a[0]+a[1]*
a[1])},g=b.unit=function(a){var b=k(a);if(b)return[a[0]/b,a[1]/b];return[0,0]};b.rotate=function(b,f){f=a.normaliseRadians(f);return[b[0]*Math.cos(f)-b[1]*Math.sin(f),b[0]*Math.sin(f)+b[1]*Math.cos(f)]};var e=b.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};b.angle=function(a,b){return Math.atan2(a[0]*b[1]-a[1]*b[0],e(a,b))};b.truncate=function(a,b){if(k(a)>b)return m(g(a),b);return a}}},["gamejs/utils/math"]);
require.define({"gamejs/utils/uri":function(n,b){var a=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([\\w\\d\\-\\u0100-\\uffff.%]*)(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),j=b.resolve=function(a,b){var e=m(a),d=m(b),f="";e[1]&&e[3]&&(f=e[1]+"://"+e[3]);if(d[1])return b;e[4]&&(f=f+":"+e[4]);e=e[5];b.charAt(0)!=="/"?(d=e.lastIndexOf("/"),e=e.substr(0,d+1)+b):e=b;d=e;if(d==".."||d==".")e="";else{var e=d.indexOf("/")>-1,d=d.split("/"),l=[],h;for(h=0;h<d.length;){var j=d[h++];j=="."?e&&h==
d.length&&l.push(""):j==".."?((l.length>1||l.length==1&&l[0]!="")&&l.pop(),e&&h==d.length&&l.push("")):(l.push(j),e=!0)}e=l.join("/")}return f+e},m=b.match=function(b){return b.match(a)};b.makeRelative=function(a){var b=j(document.location.href,"./");a.indexOf(b)==0&&(a="./"+a.substring(b.length));return a}}},[]);
require.define({"gamejs/display":function(n,b){var a=n("../gamejs").Surface,j=null,m=b.DISABLE_SMOOTHING=2,k=b.FULLSCREEN=4,g=b.POINTERLOCK=8,e=0,d=function(){var a=document.getElementById("gjs-canvas");a||(a=document.createElement("canvas"),a.setAttribute("id","gjs-canvas"),document.body.appendChild(a));return a},f=function(){var a={type:l()?n("./event").DISPLAY_FULLSCREEN_ENABLED:n("./event").DISPLAY_FULLSCREEN_DISABLED};if(l()&&e&g){var b=d();b.requestPointerLock=b.requestPointerLock||b.mozRequestPointerLock||
b.webkitRequestPointerLock;b.requestPointerLock&&b.requestPointerLock()}n("./event")._triggerCallback(a)};b.hasPointerLock=function(){return!(!document.pointerLockElement&&!document.webkitFullscreenElement&&!document.mozFullscreenElement&&!document.mozFullScreenElement)};b.init=function(){var a=d();a.getAttribute("tabindex")||(a.setAttribute("tabindex",1),a.focus());if(a=document.getElementById("gjs-loader"))a.style.display="none"};var l=b.isFullscreen=function(){return document.fullScreenElement||
document.mozFullScreen||document.webkitIsFullScreen||document.webkitDisplayingFullscreen},h=function(){var a=d();a.requestFullScreen=a.requestFullScreen||a.mozRequestFullScreen||a.webkitRequestFullScreen;if(!a.requestFullScreen)return!1;Element.ALLOW_KEYBOARD_INPUT?a.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):a.requestFullScreen();return!0};b._hasFocus=function(){return document.activeElement==d()};b.setMode=function(a,b){j=null;var l=d();l.width=a[0];l.height=a[1];e=e||b;e&g&&(e|=k);if(e&
k){l=document.getElementById("gjs-fullscreen-toggle");if(!l){l=document.createElement("button");l.innerHTML="Fullscreen";l.id="gjs-fullscreen-toggle";var m=d();m.parentNode.insertBefore(l,m);m.parentNode.insertBefore(document.createElement("br"),m)}l.removeEventListener("click",h,!1);l.addEventListener("click",h,!1);document.removeEventListener("fullScreenchange",f,!1);document.removeEventListener("webkitfullscreenchange",f,!1);document.removeEventListener("mozfullscreenchange",f,!1);document.addEventListener("fullscreenchange",
f,!1);document.addEventListener("webkitfullscreenchange",f,!1);document.addEventListener("mozfullscreenchange",f,!1)}return q()};b.setCaption=function(a){document.title=a};b._isSmoothingEnabled=function(){return!(e&m)};b._getCanvasOffset=function(){var a=d().getBoundingClientRect();return[a.left,a.top]};var q=b.getSurface=function(){if(j===null){var c=d();j=new a([c.clientWidth,c.clientHeight]);j._canvas=c;j._context=c.getContext("2d");e&m?j._noSmooth():j._smooth()}return j}}},["gamejs","gamejs/event"]);
require.define({"gamejs/xml":function(n,b){b.Parser=function(){var a=null,b=new DOMParser;this.parseFromString=function(k){return a=b.parseFromString(k,"text/xml")};return this};var a=b.Document=function(a){if(!a||!a instanceof XMLDocument)throw Error("Need a valid xmlDocument.");this._xmlDocument=a;return this};a.prototype.element=function(b){return(b=this._xmlDocument.getElementsByTagName(b)[0])&&new a(b)||null};a.prototype.elements=function(b){b=this._xmlDocument.getElementsByTagName(b);return Array.prototype.slice.apply(b,
[0]).map(function(b){return new a(b)})};a.prototype.attribute=function(a){a=(a=this._xmlDocument.getAttribute(a))?a.trim():null;if(a===null)return null;if(a.toLowerCase()==="true")return!0;if(a.toLowerCase()==="false")return!1;var b=parseInt(a,10),k=parseFloat(a,10);if(!isNaN(b)){if(k!==b)return k;return b}return a};a.prototype.value=function(){return this._xmlDocument.nodeValue};a.prototype.children=function(){return Array.prototype.slice.apply(this._xmlDocument.childNodes,[0]).map(function(b){return new a(b)})};
a.fromString=function(b){b=(new DOMParser).parseFromString(b,"text/xml");return new a(b)};a.fromURL=function(b){var m=new XMLHttpRequest;m.open("GET",b,!1);m.setRequestHeader("X-Requested-With","XMLHttpRequest");m.setRequestHeader("Content-Type","text/xml");m.overrideMimeType("text/xml");m.send();return new a(m.responseXML)}}},[]);
require.define({"gamejs/worker":function(n,b){function a(a){var b=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return a+"@"+(b()+b())}var j=n("../gamejs"),m=n("./utils/uri"),k=n("./callback").Callback,g=b._EVENTS={RESULT:1001,ALIVE:1002,LOG:1004},e=b.inWorker=this.importScripts!==void 0;b._ready=function(){self.onmessage=function(a){j.event._triggerCallback(a.data)};self.postMessage({type:g.ALIVE})};b.post=function(a){if(e)self.postMessage({type:g.RESULT,data:a});else throw Error("gamejs.postMessage only available in a gamejs/worker module");
};b._logMessage=function(){self.postMessage({type:g.LOG,arguments:Array.prototype.slice.apply(arguments)})};var d=function(){__scripts.forEach(function(a){try{importScripts(a)}catch(b){}})},f=function(a){var b=m.resolve(document.location.href,window.require.getModuleRoot()),f=[];Array.prototype.slice.apply(document.getElementsByTagName("script"),[0]).forEach(function(a){a.src&&f.push(a.src)});var c=window.URL||window.webkitURL,e=d.toString(),e=e.substring(e.indexOf("{")+1,e.lastIndexOf("}")),a=new Blob(['var __scripts = ["'+
f.join('","')+'"];',e,'self.require.setModuleRoot("'+b+'");','self.require.run("'+a+'");'],{type:"application/javascript"}),c=c.createObjectURL(a);return new Worker(c)};b.Worker=function(b){var d=this.id=a(b),e=f(b),c=[],z=!1,m=this,n=new k(function(){},{}),B=new k(function(){},{});e.onmessage=function(a){a.data.type===g.ALIVE?(z=!0,c.forEach(function(a){m.post(a)})):a.data.type===g.LOG?j.log.apply(null,[d].concat(a.data.arguments)):n.trigger(a.data.data)};e.onerror=function(a){j.error('Error in worker "'+
d+'" line '+a.lineno+": ",a.message);B.trigger({data:a.data,worker:m,event:a})};this.onEvent=function(a,c){n=new k(a,c)};this.onError=function(a,c){B=new k(a,c)};this.post=function(a){z?e.postMessage(a):c.push(a)};return this}}},["gamejs","gamejs/utils/uri","gamejs/callback"]);
require.define({"gamejs/draw":function(n,b){b.line=function(a,b,m,k,g){a=a.context;a.save();a.beginPath();a.strokeStyle=b;a.lineWidth=g||1;a.moveTo(m[0],m[1]);a.lineTo(k[0],k[1]);a.stroke();a.restore()};b.lines=function(a,b,m,k,g){var m=m||!1,e=a.context;e.save();e.beginPath();e.strokeStyle=e.fillStyle=b;e.lineWidth=g||1;k.forEach(function(a,b){b===0?e.moveTo(a[0],a[1]):e.lineTo(a[0],a[1])});m&&e.lineTo(k[0][0],k[0][1]);e.stroke();e.restore()};b.circle=function(a,b,m,k,g){if(!k)throw Error("[circle] radius required argument");
if(!m||!(m instanceof Array))throw Error("[circle] pos must be given & array"+m);a=a.context;a.save();a.beginPath();a.strokeStyle=a.fillStyle=b;a.lineWidth=g||1;a.arc(m[0],m[1],k,0,2*Math.PI,!0);g===void 0||g===0?a.fill():a.stroke();a.restore()};b.rect=function(a,b,m,k){a=a.context;a.save();a.beginPath();a.strokeStyle=a.fillStyle=b;isNaN(k)||k===0?a.fillRect(m.left,m.top,m.width,m.height):(a.lineWidth=k||1,a.strokeRect(m.left,m.top,m.width,m.height));a.restore()};b.arc=function(a,b,m,k,g,e){a=a.context;
a.save();a.beginPath();a.strokeStyle=a.fillStyle=b;a.arc(m.center[0],m.center[1],m.width/2,k*(Math.PI/180),g*(Math.PI/180),!1);isNaN(e)||e===0?a.fill():(a.lineWidth=e||1,a.stroke());a.restore()};b.polygon=function(a,b,m,k){var g=a.context;g.save();g.fillStyle=g.strokeStyle=b;g.beginPath();m.forEach(function(a,b){b==0?g.moveTo(a[0],a[1]):g.lineTo(a[0],a[1])});g.closePath();isNaN(k)||k===0?g.fill():(g.lineWidth=k||1,g.stroke());g.restore()};b.quadraticCurve=function(a,b,m,k,g,e){if(!m||!(m instanceof
Array))throw Error("[quadratic_curve] startPos must be defined!");if(!k||!(k instanceof Array))throw Error("[quadratic_curve] endPos must be defined!");if(!g||!(g instanceof Array))throw Error("[quadratic_curve] controlPos must be defined!");a=a.context;a.save();a.fillStyle=a.strokeStyle=b;a.lineWidth=e||1;a.beginPath();a.moveTo(m[0],m[1]);a.quadraticCurveTo(g[0],g[1],k[0],k[1]);a.stroke();a.restore()};b.bezierCurve=function(a,b,m,k,g,e,d){if(!m||!(m instanceof Array))throw Error("[bezier_curve] startPos must be defined!");
if(!k||!(k instanceof Array))throw Error("[bezier_curve] endPos must be defined!");if(!g||!(g instanceof Array))throw Error("[bezier_curve] ct1Pos must be defined!");if(!e||!(e instanceof Array))throw Error("[bezier_curve] ct2Pos must be defined!");a=a.context;a.save();a.fillStyle=a.strokeStyle=b;a.lineWidth=d||1;a.beginPath();a.moveTo(m[0],m[1]);a.bezierCurveTo(g[0],g[1],e[0],e[1],k[0],k[1]);a.stroke();a.restore()}}},[]);
require.define({"gamejs/time":function(n,b){var a=n("./callback").Callback,j=null;b._CALLBACK=new a(function(){},{});var m=typeof window!="undefined"?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null:null,k=function(){g();m(k)};b.init=function(){Date.now();m?m(k):setInterval(g,10)};var g=function(){var a=Date.now();b._CALLBACK.trigger(a-(j||a));j=a}}},["gamejs/callback"]);
require.define({"gamejs/tmx":function(n,b){var a=n("../gamejs");n("./utils/objects");var j=n("./xml"),m=n("./utils/base64"),k=n("./utils/uri");b.Map=function(a){var a=k.resolve(document.location.href,a),b=j.Document.fromURL(a).element("map");this.tileWidth=b.attribute("tilewidth");this.tileHeight=b.attribute("tileheight");this.width=b.attribute("width");this.height=b.attribute("height");if(b.attribute("orientation")!=="orthogonal")throw Error("only orthogonol maps supported");this.properties={};d(this.properties,
b);this.tiles=new g(b,a);this.layers=e(b);return this};b.Tile=function(){throw Error("Can not be instantiated.");};var g=b.TileSets=function(b,e){var g=[];this.getSurface=function(a){return(a=this.getTile(a))&&a.surface||null};this.getProperties=function(a){return(a=this.getTile(a))&&a.properties||{}};this.getTile=function(a){var b=null;g.some(function(d){if(d.firstGid<=a)return b=d.tiles[a-d.firstGid],!0;return!1},this);return b};var q=function(b){for(var f=[],g=b.attribute("tilewidth"),h=b.attribute("tileheight"),
q=b.attribute("spacing")||0,j=b.element("image").attribute("source"),j=k.makeRelative(k.resolve(e,j)),j=a.image.load(j),b=b.elements("tile"),m=j.getSize(),n=new a.Rect([0,0],[g,h]),G=0,p=0;p+h<=m[1];){for(x=0;x+g<=m[0];){var L=new a.Surface(g,h),J=new a.Rect([x,p],[g,h]);L.blit(j,n,J);var M={};b.some(function(a){if(a.attribute("id")===G)return d(M,a),!0},this);f.push({surface:L,properties:M});x+=g+q;G++}p+=h+q}return f};b.elements("tileset").forEach(function(a){var b=a.attribute("firstgid"),d=a.attribute("source");
d&&(a=j.Document.fromURL(k.resolve(e,d)).element("tileset"));g.push({tiles:q(a),firstGid:b})});g.reverse();return this},e=function(a){var b=[],e=function(a){var a=a.element("data"),b=a.attribute("encoding"),c=a.attribute("compression"),d="";a.children().forEach(function(a){d+=a.value()});var f=[];if(b==="base64"){if(c)throw Error("Compression of map data unsupported");f=m.decodeAsArray(d,4)}else if(b==="csv")d.trim().split("\n").forEach(function(a){a.split(",",g).forEach(function(a){f.push(parseInt(a,
10))})});else throw Error("individual tile format not supported");return f},g=a.attribute("width"),c=a.attribute("height");a.elements("layer").forEach(function(a){for(var f=[],j=c;j-- >0;){var k=g;for(f[j]=[];k-- >0;)f[j][k]=0}e(a).forEach(function(a,b){a&=1073741823;f[parseInt(b/g,10)][parseInt(b%g,10)]=a});b.push({gids:f,opacity:a.attribute("opacity"),visible:a.attribute("visible"),properties:d({},a)})});return b},d=function(a,b){var d=b.element("properties");if(d)return d.elements("property").forEach(function(b){var c=
b.attribute("name"),b=b.attribute("value");a[c]=b}),a}}},["gamejs","gamejs/utils/objects","gamejs/xml","gamejs/utils/base64","gamejs/utils/uri"]);
require.define({"gamejs/mask":function(n,b){var a=n("../gamejs"),j=n("./utils/objects");b.fromSurface=function(a,b){var b=b&&255-b||255,e=a.getImageData().data,d=a.getSize(),f=new m(d),l;for(l=0;l<e.length;l+=4){var h=parseInt(l/4/d[0],10),j=parseInt(l/4%d[0],10);e[l+3]>=b&&f.setAt(j,h)}return f};var m=b.Mask=function(a){this.width=a[0];this.height=a[1];this._bits=[];for(var b,a=0;a<this.width;a++){this._bits[a]=[];for(b=0;b<this.height;b++)this._bits[a][b]=!1}};m.prototype.overlapRect=function(b,
g){var e=this.rect,d=b.rect;g&&d.moveIp(g);if(!d.collideRect(e))return null;var f=Math.max(e.left,d.left),l=Math.max(e.top,d.top);return new a.Rect([f,l],[Math.min(e.right,d.right)-f,Math.min(e.bottom,d.bottom)-l])};m.prototype.overlap=function(a,b){var e=this.overlapRect(a,b);if(e===null)return!1;var d=this.rect,f=a.rect;b&&f.moveIp(b);var l,h;for(h=e.top;h<=e.bottom;h++)for(l=e.left;l<=e.right;l++)if(this.getAt(l-d.left,h-d.top)&&a.getAt(l-f.left,h-f.top))return!0;return!1};m.prototype.overlapArea=
function(a,b){var e=this.overlapRect(a,b);if(e===null)return 0;var d=this.rect,f=a.rect;b&&f.moveIp(b);var l=0,h,j;for(j=e.top;j<=e.bottom;j++)for(h=e.left;h<=e.right;h++)this.getAt(h-d.left,j-d.top)&&a.getAt(h-f.left,j-f.top)&&l++;return l};m.prototype.overlapMask=function(a,b){var e=this.overlapRect(a,b);if(e===null)return 0;var d=this.rect,f=a.rect;b&&f.moveIp(b);var l=new m([e.width,e.height]),h,j;for(j=e.top;j<=e.bottom;j++)for(h=e.left;h<=e.right;h++)this.getAt(h-d.left,j-d.top)&&a.getAt(h-
f.left,j-f.top)&&l.setAt(h,j);return l};m.prototype.setAt=function(a,b){this._bits[a][b]=!0};m.prototype.getAt=function(a,b){a=parseInt(a,10);b=parseInt(b,10);if(a<0||b<0||a>=this.width||b>=this.height)return!1;return this._bits[a][b]};m.prototype.invert=function(){this._bits=this._bits.map(function(a){return a.map(function(a){return!a})})};m.prototype.getSize=function(){return[this.width,this.height]};j.accessors(m.prototype,{rect:{get:function(){return new a.Rect([0,0],[this.width,this.height])}},
length:{get:function(){var a=0;this._bits.forEach(function(b){b.forEach(function(b){b&&a++})});return a}}})}},["gamejs","gamejs/utils/objects"]);
require.define({utils:function(n,b){var a=n("gamejs"),j=a.utils.math,m=n("./engine").box2d,k=n("./buffs");n("./settings");var g=a.utils.vectors,e=n("./renderer");b.renderLevelBackground=function(b,f){var g=e.cache,h=b.size[0],q=b.size[1],c=new a.Surface([h,q]),z,m,k=g.getTile(b.bgtile),n=k.getSize();for(m=0;m<q;m+=n[1])for(z=0;z<h;z+=n[0])c.blit(k,[z,m]);var A;b.decals.forEach(function(a){A=j.normaliseDegrees(a.a);c.blit(g.getDecalSprite(b.dict[a.f],A),a.p)},this);(f||f==void 0)&&b.props.forEach(function(a){A=
j.normaliseDegrees(a.a);c.blit(g.getPropSprite(b.dict[a.f],A),a.p)},this);return c};b.interpolatePoints=function(a,b,e){return[a[0]+(b[0]>a[0]?1:-1)*Math.abs(b[0]-a[0])*e,a[1]+(b[1]>a[1]?1:-1)*Math.abs(b[1]-a[1])*e]};b.interpolateInts=function(a,b,e){return a+(b>a?1:-1)*Math.abs(b-a)*e};b.copy=function(a,b){for(var e in a)b[e]=a[e];return b};b.vec=function(){if(!arguments.length||!arguments[0].hasOwnProperty("x"))if(arguments.length==1)return new m.b2Vec2(arguments[0][0],arguments[0][1]);else if(arguments.length==
2)return new m.b2Vec2(arguments[0],arguments[1]);else throw"kablooie";else return arguments[0]};b.vectorToList=b.arr=function(a){if(a.hasOwnProperty("x"))return[a.x,a.y];return a};b.removeObjFromList=function(a,b){for(var e=0;e<b.length;e++)if(b[e]==a){b.splice(e,1);break}};b.resizeSurfaceToHeight=function(b,e){var g=b.getSize(),h=g[1]/e,g=[parseInt(g[0]/h),parseInt(g[1]/h)],g=new a.Surface(g[0],g[1]);g.blit(b,new a.Rect([0,0],g.getSize()),new a.Rect([0,0],b.getSize()));return g};b.inArray=function(a,
b){for(var e=0;e<a.length;e++)if(a[e]==b)return!0;return!1};b.supports_html5_storage=function(){try{return"localStorage"in window&&window.localStorage!==null}catch(a){return!1}};b.push=function(a,b,e,h){a.has_tag("car")&&h&&a.world.create(k.SlipDebuff,{duration:h,object:a});b=g.unit(g.subtract(a.get_position(),b.get_position()));b=g.multiply(b,a.get_mass()*e);a.apply_impulse(b,a.get_position())}}},["gamejs","engine","buffs","settings","renderer"]);
require.define({bots:function(n,b){b.names=["Bob","The Dominator","Desert Penguin","Smiley"];var a=n("./car_descriptions");b.generateBotCarDescr=function(){var b=[],m;for(m in a)b.push(m);m=["Machinegun","MissileLauncher"];return{type:b[Math.floor(Math.random()*b.length)],front_weapon:{type:m[Math.floor(Math.random()*m.length)],ammo_upgrades:0,damage_upgrades:0},util:null,rear_weapon:null,acc_upgrades:0,speed_upgrades:0,armor_upgrades:0}};b.CatLady={type:"Sandbug",name:"Cat Lady",front_weapon:{type:"Machinegun",
ammo_upgrades:0,damage_upgrades:0},util:null,rear_weapon:{type:"MineLauncher",ammo_upgrades:0,damage_upgrades:0},acc_upgrades:0,speed_upgrades:0,armor_upgrades:0};b.Bob={type:"Hillbilly",name:"Bob",front_weapon:{type:"MissileLauncher",ammo_upgrades:1,damage_upgrades:1},util:null,rear_weapon:null,acc_upgrades:2,speed_upgrades:0,armor_upgrades:0};b.Dominator={type:"Sandbug",name:"The Dominator",front_weapon:{type:"Machinegun",ammo_upgrades:3,damage_upgrades:0},util:null,rear_weapon:null,acc_upgrades:0,
speed_upgrades:0,armor_upgrades:2};b.HotShot={type:"Racer",name:"HotShot",front_weapon:{type:"Machinegun",ammo_upgrades:5,damage_upgrades:3},util:{type:"Shockwave",ammo_upgrades:0,damage_upgrades:0},rear_weapon:null,acc_upgrades:0,speed_upgrades:0,armor_upgrades:0};b.TheDude={type:"Hillbilly",name:"The Dude",front_weapon:{type:"HomingMissiles",ammo_upgrades:1,damage_upgrades:1},util:null,rear_weapon:{type:"Oil",ammo_upgrades:1,damage_upgrades:1},acc_upgrades:2,speed_upgrades:2,armor_upgrades:0};b.Ratman=
{type:"Bandit",name:"Ratman",front_weapon:{type:"PlasmaCannon",ammo_upgrades:2,damage_upgrades:0},util:{type:"RepairKit",ammo_upgrades:2,damage_upgrades:0},rear_weapon:null,acc_upgrades:0,speed_upgrades:2,armor_upgrades:2};b.Bulldog={type:"Brawler",name:"Brawler",front_weapon:{type:"MissileLauncher",ammo_upgrades:4,damage_upgrades:3},util:{type:"NOS",ammo_upgrades:1,damage_upgrades:0},rear_weapon:{type:"Oil",ammo_upgrades:1,damage_upgrades:1},acc_upgrades:2,speed_upgrades:1,armor_upgrades:2};b.JC=
{type:"Bandit",name:"JC",front_weapon:{type:"Machinegun",ammo_upgrades:2,damage_upgrades:3},util:{type:"Shield",ammo_upgrades:0,damage_upgrades:0},rear_weapon:{type:"Napalm",ammo_upgrades:2,damage_upgrades:1},acc_upgrades:0,speed_upgrades:3,armor_upgrades:1};b.PainKid={type:"Racer",name:"Pain Kid",front_weapon:{type:"Machinegun",ammo_upgrades:5,damage_upgrades:3},util:{type:"Shockwave",ammo_upgrades:1,damage_upgrades:0},rear_weapon:{type:"MineLauncher",ammo_upgrades:2,damage_upgrades:4},acc_upgrades:0,
speed_upgrades:2,armor_upgrades:2}}},["car_descriptions"]);
require.define({skin:function(n,b){b.ui_header_background="#FFF";b.ui_background="#E6E6E6";b.alias_background="#333333";b.alert_box_border="black";b.alert_box_background="#E6E6E6";b.fonts={hud:["30px maass","red"],header:["40px maass","#351A15"],"default":["20px maass","#351A15"],small_header:["16px maass","white"],small:["14px maass","black"],alias:["23px maass","#333333"],"16_33":["16px maass","#333333"],"13_1a":["13px maass","#1A1A1A"],"13_green":["13px maass","#00BC12"],alias_label:["40px maass",
"#FFFFFF"],button:["25px maass","#000"],button2:["30px maass","#333333"],button2_hover:["30px maass","#F2F2F2"],loading:["40px maass","#351A15"],"40_black":["40px maass","#000"],"13_grayish":["13px maass","#383736"],"25_66":["25px maass","#666666"],sp_btn:["30px maass","#FFF"],header_black:["56px maass","#333333"],header_brown:["56px maass","#A67C52"],editor_ai_wp:["19px maass","#0094FF"],editor_checkpoint:["19px maass","#FF5656"],editor_start_pos:["19px maass","#3AFF51"],g_white_title:["16px maass",
"#F2F2F2"]};b.single_player_scene={background_color:"#C7B299"};b.dialog={font:"default"};b.sp_car_display={bg_color:"#998675",font1:"13_grayish",font2:"sp_btn"};b.garage_btn={bg_color:"#CCCCCC",bg_color_hover:"#B3B3B3",label_bg:"#E6E6E6",font:"alias"};b.track_selector={back_color:"#E6E6E6",front_color:"#CCCCCC",item_hover_color:"#D8D8D8",item_font:"16_33"};b.title_button={fill:"#CCCCCC",fill_hover:"#B3B3B3",font:"40_black"};b.sp_button={fill:"#333333",fill_hover:"#000",font:"sp_btn"};b.button={border:"#282828",
font:"button",fill:"#CCCCCC",hover_fill:"#B3B3B3",selected_fill:"#FF6A00"};b.garage={background_color:"#666666",back_button:{fill:"#E6E6E6",hover_fill:"#000",font:"button2",hover_font:"button2_hover"},balance_background:"#E6E6E6",car_title_background:"#333333",car_background:"#CCCCCC",car_title_font:"g_white_title",balance_font:"alias",weapon_info_title_background:"#F5F5F5",weapon_info_background:"#B3B3B3",weapon_label_font:"16_33",weapon_info_text_font:"13_1a",tuning_title_background:"#4D4D4D",tuning_background:"#1A1A1A",
store_background:"#F2F2F2",store_border:"#CCCCCC",selected_shop_item_bg:"#B3B3B3",slot_border:"rgba(204, 204, 204, 0.5)",slot_bg:"rgba(204, 204, 204, 0.8)",slot_bg_selected:"#777777",slot_path:"#CCCCCC",white_button:{bg:"#F2F2F2",bg_hover:"#1A1A1A",font:"16_33",hover_font:"g_white_title"}};b.trackdisplay={font:"16_33"};b.label={font:"default"};b.textbox={font:"default",border:"#282828",background:"#FFEFAA"};b.table={header_font:"small_header",data_font:"small",border:"#C6A500",header_fill:"#333333",
hover_fill:"#FFBE00",body_fill:"#CCCCCC",selected_fill:"#FF6A00"};b.trackinfodisplay={header_font:"default",outline_color:"#808080"}}},[]);
require.define({car_descriptions:function(n,b){b.Bandit={width:1.7,height:3.5,id:"Bandit",name:"Bandit",description:"Small but agile",filenames:["bandit_yellow.png","bandit_green.png","bandit_blue.png","bandit_red.png"],art_filename:"bandit_big.png",power:105,max_speed:110,max_steer_angle:17,health:80,power_upgrade:6,speed_upgrade:4,armor_upgrade:20,upgrade_price:600,speed_stars:1,acceleration_stars:4,armor_stars:1,handling_stars:4,price:3E3,main_weapon:"Machinegun",wheels:[{x:-0.85,y:-1,width:0.4,
length:0.8,revolving:!0,powered:!0,filename:"wheel.png"},{x:0.85,y:-1,width:0.4,length:0.8,revolving:!0,powered:!0,filename:"wheel.png"},{x:-0.85,y:1.1,width:0.4,length:0.8,revolving:!1,powered:!1,filename:"wheel.png"},{x:0.85,y:1.1,width:0.4,length:0.8,revolving:!1,powered:!1,filename:"wheel.png"}]};b.Sandbug={id:"Sandbug",width:1.8,height:4,name:"Sandbug",description:"A basic, low budget car",filenames:["sandbug_yellow.png","sandbug_green.png","sandbug_blue.png","sandbug_red.png"],art_filename:"sandbug_big.png",
power:75,max_steer_angle:15,max_speed:100,health:100,power_upgrade:7,speed_upgrade:4,armor_upgrade:20,upgrade_price:300,speed_stars:1,acceleration_stars:1,armor_stars:2,handling_stars:2,price:1E3,wheels:[{x:-0.9,y:-1.2,width:0.4,length:0.8,revolving:!0,powered:!0,filename:"wheel.png"},{x:0.9,y:-1.2,width:0.4,length:0.8,revolving:!0,powered:!0,filename:"wheel.png"},{x:-0.9,y:1.2,width:0.4,length:0.8,revolving:!1,powered:!1,filename:"wheel.png"},{x:0.9,y:1.2,width:0.4,length:0.8,revolving:!1,powered:!1,
filename:"wheel.png"}]};b.Thunderbolt={width:2.1,height:4.5,id:"Thunderbolt",name:"Thunderbolt",description:"A powerful muscle car",filenames:["thunderbolt_yellow.png","thunderbolt_green.png","thunderbolt_blue.png","thunderbolt_red.png"],art_filename:"thunderbolt_big.png",power:140,max_steer_angle:13,max_speed:135,health:140,power_upgrade:9,speed_upgrade:5,armor_upgrade:25,upgrade_price:1200,speed_stars:4,acceleration_stars:4,armor_stars:3,handling_stars:1,price:7E3,wheels:[{x:-1,y:-1.4,width:0.4,
length:0.8,revolving:!0,powered:!0,filename:"wheel.png"},{x:1,y:-1.4,width:0.4,length:0.8,revolving:!0,powered:!0,filename:"wheel.png"},{x:-1,y:1.4,width:0.4,length:0.8,revolving:!1,powered:!1,filename:"wheel.png"},{x:1,y:1.4,width:0.4,length:0.8,revolving:!1,powered:!1,filename:"wheel.png"}]};b.Racer={width:2,id:"Racer",name:"Racer",description:"A well rounded racing car",height:4,filenames:["racer_yellow.png","racer_green.png","racer_blue.png","racer_red.png"],art_filename:"racer_big.png",power:90,
max_steer_angle:16,max_speed:125,health:100,power_upgrade:7,speed_upgrade:4,armor_upgrade:20,upgrade_price:600,speed_stars:3,acceleration_stars:2,armor_stars:2,handling_stars:3,price:4500,wheels:[{x:-0.9,y:-1.2,width:0.4,length:0.8,revolving:!0,powered:!0,filename:"wheel.png"},{x:0.9,y:-1.2,width:0.4,length:0.8,revolving:!0,powered:!0,filename:"wheel.png"},{x:-0.9,y:1.2,width:0.4,length:0.8,revolving:!1,powered:!1,filename:"wheel.png"},{x:0.9,y:1.2,width:0.4,length:0.8,revolving:!1,powered:!1,filename:"wheel.png"}]};
b.Hillbilly={width:2.4,height:5,id:"Hillbilly",name:"Hillbilly",description:"Sturdy, lots of space in the back",filenames:["samaritan_yellow.png","samaritan_green.png","samaritan_blue.png","samaritan_red.png"],art_filename:"samaritan_big.png",power:120,max_steer_angle:16,max_speed:115,health:140,power_upgrade:10,speed_upgrade:4,armor_upgrade:25,upgrade_price:600,speed_stars:2,armor_stars:3,acceleration_stars:1,handling_stars:2,price:4E3,wheels:[{x:-1,y:-1.7,width:0.6,length:1.2,revolving:!0,powered:!0,
filename:"big_wheel.png"},{x:1,y:-1.7,width:0.6,length:1.2,revolving:!0,powered:!0,filename:"big_wheel.png"},{x:-0.9,y:1.6,width:0.6,length:1.2,revolving:!1,powered:!1,filename:"big_wheel.png"},{x:0.9,y:1.6,width:0.6,length:1.2,revolving:!1,powered:!1,filename:"big_wheel.png"}]};b.Brawler={width:3,height:6,id:"Brawler",name:"Brawler",description:"Heavily armored combat SUV",filenames:["brawler_yellow.png","brawler_green.png","brawler_blue.png","brawler_red.png"],art_filename:"brawler_big.png",power:150,
max_steer_angle:16,max_speed:120,health:180,power_upgrade:12,speed_upgrade:4,armor_upgrade:30,upgrade_price:600,speed_stars:3,armor_stars:4,acceleration_stars:1,handling_stars:1,price:6E3,main_weapon:"MissileLauncher",wheels:[{x:-1.25,y:-2,width:0.6,length:1.2,revolving:!0,powered:!0,filename:"big_wheel.png"},{x:1.25,y:-2,width:0.6,length:1.2,revolving:!0,powered:!0,filename:"big_wheel.png"},{x:-1.25,y:2.1,width:0.6,length:1.2,revolving:!1,powered:!1,filename:"big_wheel.png"},{x:1.25,y:2.1,width:0.6,
length:1.2,revolving:!1,powered:!1,filename:"big_wheel.png"}]}}},[]);require.define({props:function(n,b){var a=n("gamejs");n("./utils");var j=n("./engine");b.rotarrays={};var m=b.BoxProp=function(a){j.utils.process_parameters(a,["filename"]);this.filename=a.filename;a.fixed_rotation=!0;a.body_type=j.box2d.b2Body.b2_staticBody;m.superConstructor.apply(this,[a]);this.add_tag("prop")};a.utils.objects.extend(m,j.Entity);j.register_class(m)}},["gamejs","utils","engine"]);
require.define({ui:function(n,b){var a=n("gamejs"),j=n("./gamejs-gui"),m=n("./skin"),k=n("./renderer"),g=n("./settings"),e=n("./combatracer"),d=n("./car_descriptions");n("./weapon_descriptions");var f=n("./levels"),l=n("./utils"),h=n("./sounds");n("./leagues");b.fonts={};b.init=function(){for(var a in m.fonts)b.fonts[a]=new j.CachedFont(m.fonts[a][0],m.fonts[a][1])};var q=b.getFont=function(a){return b.fonts[a]},c=function(a){this.background_color=a.background_color||m.ui_background;this.header_height=
a.header_height||110;c.superConstructor.apply(this,[a])};a.utils.objects.extend(c,j.View);c.prototype.paint=function(){this.surface.clear();a.draw.rect(this.surface,m.ui_header_background,new a.Rect([0,0],[this.surface.getSize()[0],this.header_height]));a.draw.rect(this.surface,this.background_color,new a.Rect([0,this.header_height],[this.surface.getSize()[0],this.surface.getSize()[1]-this.header_height]))};(b.UIScene=function(){var a=this.cache=a=k.cache,b=this.game=e.game;this.gui=new j.GUI(b.display);
this.gui.on(j.EVT_PAINT,function(){this.surface.clear()},this.gui);this.container=new c({position:[0,0],size:[800,600],parent:this.gui});this.gui.center(this.container);this.br_title=new z({position:[60,11],parent:this.container});this.guncar=new j.Image({position:[32,66],parent:this.container,image:a.getUIImage("guncar.png")});this.ping=!1;this.ms_to_ping=1E4;this.dialog=new w({parent:this.gui,size:[600,150]});this.alert=function(a,b){this.dialog.show(a,b)};this.clearAlert=function(){this.dialog.close()};
this.handleEvent=function(a){this.gui.despatchEvent(a)};this.returnToTitle=function(){this.game.showTitle()};this.handleMessageDefault=function(a,b){a==="ERR"?this.alert(b.text):a==="CRITICAL_ERR"?(this.returnToTitle(),this.game.title_scene.alert(b.text)):a==="HELLO"||a==="PONG"||this.alert("Unknown server message:"+a)};this.renderer=new k.UIRenderer(g.get("SCREEN_WIDTH"),g.get("SCREEN_HEIGHT"),this.cache);this.update=function(a){if(this.ping&&(this.ms_to_ping-=a,this.ms_to_ping<=0))this.game.getCommunicator().queueMessage("PING"),
this.ms_to_ping=1E4;this.gui.update(a)};this.draw=function(){this.gui.draw()};return this}).prototype.handleMessage=function(a,b){console.log("uiscene",a,b);this.handleMessageDefault(a,b)};var z=b.BRTitle=function(a){a.text="Bandit Racer";a.font=q("header_black");z.superConstructor.apply(this,[a])};a.utils.objects.extend(z,j.Label);z.prototype.paint=function(){var a=q("header_brown"),b=q("header_black"),c=0;b.render(this.surface,"B",[0,0],null,-3);c+=b.getTextSize("B")[0]-3;a.render(this.surface,
"andit ",[c,0],null,-3);c+=a.getTextSize("andit ")[0]-3;b.render(this.surface,"R",[c,0],null,-3);c+=b.getTextSize("R")[0]-3;a.render(this.surface,"acer",[c,0],null,-3)};var P=b.NameInput=function(a){a.size=[200,40];a.font=q("alias");a.scw_size=[190,40];P.superConstructor.apply(this,[a])};a.utils.objects.extend(P,j.TextInput);P.prototype.paint=function(){this.surface.clear();a.draw.polygon(this.surface,"#FFF",[[10,0],[this.size[0],0],[this.size[0]-10,this.size[1]],[0,this.size[1]]])};var D=b.TitleButton=
function(a){a.font=a.font||q(m.title_button.font);D.superConstructor.apply(this,[a]);this.onClick(function(){h.play({filename:"button_click.wav"})})};a.utils.objects.extend(D,j.Button);D.prototype.paint=function(){var b=this.isHovered()?m.title_button.fill_hover:m.title_button.fill;this.surface.clear();a.draw.polygon(this.surface,b,[[40,0],[this.size[0],0],[this.size[0],this.size[1]],[0,this.size[1]]])};var B=b.Button=function(a){this.font=a.font=a.font||q(m.button.font);this.hover_font=a.hover_font;
this.fill=a.fill||m.button.fill;this.hover_fill=a.hover_fill||m.button.hover_fill;this.lean=a.lean||"right";B.superConstructor.apply(this,[a]);this.onClick(function(){h.play({filename:"button_click.wav"})})};a.utils.objects.extend(B,j.Button);B.prototype.paint=function(){this.label.font=this.label&&this.isHovered()&&this.hover_font?this.hover_font:this.font;this.label.refresh();var b=this.isHovered()?this.hover_fill:this.fill;this.surface.clear();this.lean=="right"?a.draw.polygon(this.surface,b,[[10,
0],[this.size[0],0],[this.size[0],this.size[1]],[0,this.size[1]]]):this.lean=="both"?a.draw.polygon(this.surface,b,[[10,0],[this.size[0],0],[this.size[0]-10,this.size[1]],[0,this.size[1]]]):this.lean=="none"?a.draw.rect(this.surface,b,new a.Rect([0,0],this.getSize())):a.draw.polygon(this.surface,b,[[0,0],[this.size[0]-10,0],[this.size[0],this.size[1]],[0,this.size[1]]])};var A=b.YesNoDialog=function(a){A.superConstructor.apply(this,[a]);this.label=new j.Label({position:[0,0],parent:this,font:q(m.dialog.font),
text:a.text||"b"});this.yes=new B({position:[0,0],size:[150,50],parent:this,lean:"both",text:"Yes"});this.no=new B({position:[0,0],size:[150,50],parent:this,lean:"both",text:"No"});this.center(this.yes);this.center(this.no);this.center(this.label);this.label.move([this.label.getPosition()[0],this.label.getPosition()[1]-30]);this.yes.move([this.yes.position[0]-80,this.yes.position[1]+30]);this.no.move([this.no.position[0]+80,this.no.position[1]+30]);this.yes.onClick(function(){this.close()},this);
this.no.onClick(function(){this.close()},this)};a.utils.objects.extend(A,j.Dialog);var w=b.Dialog=function(a){w.superConstructor.apply(this,[a]);this.label=new j.Label({position:[0,0],parent:this,font:q(m.dialog.font),text:"b"});this.btn=new B({position:[0,0],size:[150,50],parent:this,lean:"both",text:"Ok"});this.center(this.btn);this.btn.move([this.btn.position[0],this.btn.position[1]+30]);this.btn.onClick(function(){this.close()},this)};a.utils.objects.extend(w,j.Dialog);w.prototype.show=function(a,
b){b==void 0&&(b=!0);this.label.setText(a);this.center(this.label);this.label.move([this.label.position[0],this.label.position[1]-30]);b?this.btn.show():this.btn.hide();j.Dialog.prototype.show.apply(this,[])};var y=b.GoToGarage=function(a){a.size=[210,180];y.superConstructor.apply(this,[a]);this.img=new j.Image({position:[0,0],parent:this,image:k.cache.getUIImage("garage.png")});this.center(this.img);this.img.move([this.img.position[0],7]);this.lbl=new j.Label({position:[0,0],parent:this,font:q(m.garage_btn.font),
text:"Garage"});this.center(this.lbl);this.lbl.move([this.lbl.position[0],this.size[1]-this.lbl.size[1]-17])};a.utils.objects.extend(y,j.View);y.prototype.paint=function(){this.surface.fill(m.garage_btn.label_bg);a.draw.rect(this.surface,this.isHovered()?m.garage_btn.bg_color_hover:m.garage_btn.bg_color,new a.Rect([0,0],[this.size[0],126]))};var G=b.DifficultySelect=function(a){G.superConstructor.apply(this,[a]);this.difficulties=["Easy","Medium","Hard"];e.game.player.singleplayer.completed&&this.difficulties.push("Hell");
new j.Label({parent:this,position:[10,6],font:q(m.sp_car_display.font1),text:"Difficulty:"});this.difflbl=new j.Label({parent:this,position:[27,17],font:q(m.sp_car_display.font2),text:this.difficulties[e.game.player.singleplayer.difficulty-1]});this.left=new M({parent:this,position:[5,28],size:[16,25],direction:"left"});this.left.onClick(function(){e.game.player.singleplayer.difficulty--;if(e.game.player.singleplayer.difficulty==0)e.game.player.singleplayer.difficulty=this.difficulties.length;this.difflbl.setText(this.difficulties[e.game.player.singleplayer.difficulty-
1])},this);this.right=new M({parent:this,position:[185,28],size:[16,25],direction:"right"});this.right.onClick(function(){e.game.player.singleplayer.difficulty++;if(e.game.player.singleplayer.difficulty==this.difficulties.length+1)e.game.player.singleplayer.difficulty=1;this.difflbl.setText(this.difficulties[e.game.player.singleplayer.difficulty-1])},this)};a.utils.objects.extend(G,j.View);G.prototype.paint=function(){a.draw.polygon(this.surface,m.sp_car_display.bg_color,[[0,0],[this.size[0]-20,0],
[this.size[0],20],[this.size[0],this.size[1]],[0,this.size[1]]])};var p=b.CarDisplay=function(a){a.size=[210,65];p.superConstructor.apply(this,[a]);this.gameinfo=a.gameinfo;new j.Label({parent:this,position:[10,6],font:q(m.sp_car_display.font1),text:"Current Car:"});this.carlbl=new j.Label({parent:this,position:[16,17],font:q(m.sp_car_display.font2),text:d[this.gameinfo.car.type].name})};a.utils.objects.extend(p,j.View);p.prototype.paint=function(){a.draw.polygon(this.surface,m.sp_car_display.bg_color,
[[0,0],[this.size[0],0],[this.size[0],this.size[1]-20],[this.size[0]-20,this.size[1]],[0,this.size[1]]])};TrackSelectorItem=b.TrackSelectorItem=function(a){a.size=[a.parent.size[0],22];this.track=a.track;this.track_obj=f[this.track];TrackSelectorItem.superConstructor.apply(this,[a]);this.label=new j.Label({position:[0,0],parent:this,font:q(m.track_selector.item_font),text:this.track_obj.title});this.center(this.label);this.label.move([this.size[0]-this.label.size[0]-16,this.label.position[1]]);this.selected=
!1;this.on(j.EVT_MOUSE_DOWN,this.select,this)};a.utils.objects.extend(TrackSelectorItem,j.View);TrackSelectorItem.prototype.select=function(){this.selected=!0;this.refresh();h.play({filename:"button_click.wav"});this.despatchEvent({type:"track_select",track:this.track})};TrackSelectorItem.prototype.deselect=function(){this.selected=!1;this.refresh()};TrackSelectorItem.prototype.paint=function(){this.surface.fill(this.selected?m.track_selector.front_color:this.isHovered()?m.track_selector.item_hover_color:
m.track_selector.back_color)};TrackSelector=b.TrackSelector=function(b){b.size=[536,320];TrackSelector.superConstructor.apply(this,[b]);this.track=null;b.tracks.length<=7?this.tbg1=new j.View({position:[0,30],size:[226,231],parent:this}):(this.tbg1=new j.ScrollableView({position:[0,30],size:[206,201],parent:this}),this.tbg1.setVerticalScrollbar(new j.VerticalScrollbar({parent:this,position:[this.tbg1.getSize()[0],35],size:[20,this.tbg1.getSize()[1]-10]})));this.tbg1.on(j.EVT_PAINT,function(){a.draw.polygon(this.surface,
m.track_selector.back_color,[[0,0],[this.size[0],0],[this.size[0],this.size[1]],[20,this.size[1]],[0,this.size[1]-20]])},this.tbg1);this.tbg2=new j.View({position:[226,0],size:[310,320],parent:this});this.tbg2.on(j.EVT_PAINT,function(){this.surface.fill(m.track_selector.front_color)},this.tbg2);this.trackdisplay=new L({parent:this.tbg2,position:[0,0]});new j.Label({parent:this,position:[10,0],font:q("alias"),text:b.label});b.tracks.forEach(function(a){ti=new TrackSelectorItem({parent:this.tbg1,track:a.id,
position:[0,0]});ti.on("track_select",this.select,this)},this);j.layout.vertical(this.tbg1.children,5);this.tbg1.autoSetScrollableArea&&this.tbg1.autoSetScrollableArea()};a.utils.objects.extend(TrackSelector,j.View);TrackSelector.prototype.select=function(a){this.track=a.track;this.tbg1.children.forEach(function(a){a.deselect&&a.track!=this.track&&a.deselect()},this);this.trackdisplay.setTrack(this.track)};var L=b.TrackDisplay=function(a){this.lbl=this.img=this.track=null;a.size=[316,320];L.superConstructor.apply(this,
[a]);a.track&&this.setTrack(a.track);this.lbl2=new j.Label({parent:this,position:[0,0],font:q(m.trackdisplay.font),text:"Select a track!"});this.center(this.lbl2)};a.utils.objects.extend(L,j.View);L.prototype.setTrack=function(b){if(this.track=b){this.lbl2.hide();var c=l.renderLevelBackground(f[b],!1),d=c.getSize(),e=d[0]>d[1]?d[0]/280:d[1]/280,d=[parseInt(d[0]/e),parseInt(d[1]/e)];s=new a.Surface(d[0],d[1]);s.blit(c,new a.Rect([0,0],d),new a.Rect([0,0],c.getSize()));this.img?(this.img.resize(s.getSize()),
this.img.setImage(s)):this.img=new j.Image({parent:this,position:[15,10],image:s});this.lbl?this.lbl.setText(f[b].title):this.lbl=new j.Label({parent:this,position:[0,0],text:f[b].title,font:q(m.trackdisplay.font)});this.center(this.lbl);this.lbl.move([this.lbl.position[0],this.size[1]-this.lbl.size[1]-5])}};var J=b.Table=function(a){J.superConstructor.apply(this,[a]);this.columns=a.columns;this.data=a.data;this.header=new j.View({parent:this,size:[this.size[0],30],position:[0,0]});this.header.on(j.EVT_PAINT,
function(){this.surface.fill(m.table.header_fill)},this.header);var b=0;this.columns.forEach(function(a){new j.Label({parent:this.header,position:[b+20,3],font:q(m.table.header_font),text:a.label});b+=a.width},this);this.body=new j.View({parent:this,size:[this.size[0],this.size[1]-30],position:[0,30]});this.body.on(j.EVT_PAINT,function(){this.surface.fill(m.table.body_fill)},this.body);this.data&&this.setData(this.data)};a.utils.objects.extend(J,j.View);J.prototype.setData=function(a,b){this.body.children=
[];var c=0,d;a.length?a.forEach(function(a){d=0;var b=new j.View({parent:this.body,size:[this.size[0],30],position:[0,c]});this.columns.forEach(function(c){new j.Label({parent:b,position:[d+20,3],font:q(m.table.header_font),text:String(a[c.key]),font:q(m.table.data_font)});d+=c.width},this);c+=30},this):b&&new j.Label({parent:this.body,position:[20,3],font:q(m.table.header_font),text:String(b),font:q(m.table.data_font)})};var M=b.IncrementButton=function(b){var c=new a.Surface(b.size),d=new a.Surface(b.size),
e=b.direction=="up"?[[parseInt(b.size[0]/2),0],b.size,[0,b.size[1]]]:b.direction=="down"?[[0,0],[b.size[0],0],[parseInt(b.size[0]/2),b.size[1]]]:b.direction=="left"?[[0,parseInt(b.size[1]/2)],[b.size[0],0],b.size]:[[0,0],[b.size[0],parseInt(b.size[1]/2)],[0,b.size[1]]];a.draw.polygon(c,m.title_button.fill,e);a.draw.polygon(d,m.title_button.fill_hover,e);b.image=c;b.image_hover=d;b.image_down=!1;M.superConstructor.apply(this,[b]);this.onClick(function(){h.play({filename:"button_click.wav"})})};a.utils.objects.extend(M,
j.Button);var I=b.Stars=function(a){a.image=k.cache["static"][a.stars+"stars.png"];I.superConstructor.apply(this,[a])};a.utils.objects.extend(I,j.Image);I.prototype.setStars=function(a){a=k.cache["static"][a+"stars.png"];this.resize(a.getSize());this.setImage(a)};var C=b.KeyExplanation=function(a){a.size=[400,52];C.superConstructor.apply(this,[a]);var b=q("25_66");this.key=a.key;this.text=a.text;a=60;this.key.length>1&&(a=b.getTextSize(this.key)[0]+50);this.btn=new j.Button({size:[a,this.getSize()[1]],
position:[0,0],font:b,parent:this,image:k.cache.getUIImage("key_bg.png"),text:this.key});this.btn.label.move([this.btn.label.getPosition()[0],this.btn.label.getPosition()[1]-7]);this.lbl=new j.Label({position:[0,0],parent:this,font:b,text:this.text});this.center(this.lbl);this.lbl.move([a+30,this.lbl.getPosition()[1]])};a.utils.objects.extend(C,j.View)}},["gamejs","gamejs-gui","skin","renderer","settings","combatracer","car_descriptions","weapon_descriptions","levels","utils","sounds","leagues"]);
require.define({"gamejs-gui":function(n,b){function a(a,b){var c={};for(key in a)c[key]=a[key];if(c.pos&&b)c.pos=[c.pos[0]-b[0],c.pos[1]-b[1]];return c}function j(a,b){return[Math.max(parseInt((a[0]-b[0])/2),0),Math.max(parseInt((a[1]-b[1])/2),0)]}var m=n("gamejs"),k=b.EVT_FOCUS="focus",g=b.EVT_BLUR="blur",e=b.EVT_MOUSE_OVER="mouse_over",d=b.EVT_MOUSE_OUT="mouse_out",f=b.EVT_KEY_DOWN=m.event.KEY_DOWN,l=b.EVT_KEY_UP=m.event.KEY_UP,h=b.EVT_MOUSE_UP=m.event.MOUSE_UP,q=b.EVT_MOUSE_DOWN=m.event.MOUSE_DOWN;
b.EVT_MOUSE_WHEEL=m.event.MOUSE_WHEEL;var c=b.EVT_MOUSE_MOTION=m.event.MOUSE_MOTION,z=b.EVT_BTN_CLICK="btn_click",P=b.EVT_CLOSE="close",D=b.EVT_SCROLL="scroll",B=b.EVT_DRAG="drag",A=b.EVT_MOVE="move",w=b.EVT_RESIZE="resize",y=b.EVT_PAINT="paint",G=b.EVT_AFTER_PAINT="after_paint",p=b.EVT_CHANGE="change",L=1,J=b.draggable=function(a){a.grab_pos=null;a.on(q,function(a){this.grab_pos=a.global_pos},a);a.getGUI().on(h,function(){this.grab_pos=null},a);a.getGUI().on(c,function(a){if(this.grab_pos){var b=
this.position,c=[this.position[0]+a.pos[0]-this.grab_pos[0],this.position[1]+a.pos[1]-this.grab_pos[1]];this.grab_pos=a.pos;this.move(c);this.despatchEvent({type:B,old_pos:b,new_pos:this.position})}},a)},M=b.CachedFont=function(a,b){this.space_width=3;this.tab_width=12;this.chars={};this.font=null;typeof a=="string"?(this.color=b?b:"#000",this.font=new m.font.Font(a)):(this.chars=a,this.font=new m.font.Font("14px Verdana"),this.color="#000");this.space_width=parseInt(Math.ceil(this.getCharSurface("m").getSize()[0]/
3));this.tab_width=3*this.space_width};M.prototype.getCharSurface=function(a){if(!this.chars[a]){var b=this.font.render(a,this.color);this.chars[a]=b}return this.chars[a]};M.prototype.getTextSize=function(a){var b=0,c=0,t;if(a){for(var d=0;d<a.length;d++)if(t=a[d],t==" ")b+=this.space_width;else if(t=="\t")b+=this.tab_width;else if(t=this.getCharSurface(t))t=t.getSize(),b+=t[0],c=Math.max(t[1],c);c||(c=this.getCharSurface("m").getSize()[1]);return[b,c]}else return[0,0]};M.prototype.render=function(a,
b,c,t){ofst=c[0];var t=t?t:this.space_width,d,o;for(d=0;d<b.length;d++)o=b[d],o==" "?ofst+=t:o=="\t"?ofst+=this.tab_width:(o=this.getCharSurface(o),r1=[ofst,c[1]],a.blit(o,r1),ofst+=o.getSize()[0])};try{b.DEFAULT_FONT=new M("12px Verdana","black")}catch(I){}var C=b.View=function(a){this.type="view";this.id=L++;if(!a.size)throw"View: size must be specified";this.size=a.size;if(!a.position)a.position=[0,0];this.position=[parseInt(a.position[0]),parseInt(a.position[1])];this.surface=a.surface?a.surface:
new m.Surface(this.size);if(a.parent===void 0)throw"Element's parent not given.";this.parent=a.parent;this.visible=a.visible===void 0?!0:a.visible;this.parent&&this.parent.addChild(this);this.children=[];this._refresh=!0;this.is_focused=this.is_hovered=!1;this.listeners={};return this};C.prototype.isFocused=function(){return this.is_focused};C.prototype.isHovered=function(){return this.is_hovered};C.prototype.getSize=function(){return[this.size[0],this.size[1]]};C.prototype.getPosition=function(){return[this.position[0],
this.position[1]]};C.prototype.isVisible=function(){return this.visible};C.prototype.removeChild=function(a){if(typeof a!="number")a=a.id;for(var b=0;b<this.children.length;b++)if(this.children[b].id==a)return this.children.splice(b,1),this.refresh(),!0;return!1};C.prototype.destroy=function(){this.parent&&this.parent.removeChild(this)};C.prototype.getRect=function(){return new m.Rect(this.position,this.size)};C.prototype.rightAlign=function(a){this.move([a-this.getSize()[0],this.getPosition()[1]])};
C.prototype.addChild=function(a){this.children.push(a)};C.prototype.draw=function(){if(!this.visible){if(this._refresh)return this._refresh=!1,!0;return!1}var a=!1;this.children.forEach(function(b){if(b.draw()||this._refresh)a=!0},this);if(this._refresh||a)this.paint(),this.despatchEvent({type:y,surface:this.surface}),this.children.forEach(function(a){a.visible&&this.blitChild(a)},this),this.despatchEvent({type:G,surface:this.surface}),a=!0,this._refresh=!1;return a};C.prototype.blitChild=function(a){this.surface.blit(a.surface,
a.position)};C.prototype.paint=function(){this.surface.clear()};C.prototype.update=function(){};C.prototype._update=function(a){this.children.forEach(function(b){b._update(a)});this.update(a)};C.prototype.on=function(a,b,c){this.listeners[a]||(this.listeners[a]=[]);this.listeners[a].push({callback:b,scope:c})};C.prototype.despatchEventToChildren=function(a){this.children.forEach(function(b){b.despatchEvent(a)})};C.prototype.move=function(a){var b=this.position;this.position=a;this.parent.refresh();
this.despatchEvent({type:A,old_pos:b,new_pos:a})};C.prototype.moveRelative=function(a){this.move([this.position[0]+a[0],this.position[1]+a[1]])};C.prototype.resize=function(a){var b=this.size;this.size=a;this.surface=new m.Surface([Math.max(a[0],1),Math.max(a[1],1)]);this.refresh();this.despatchEvent({type:w,old_size:b,new_size:a})};C.prototype.refresh=function(){this._refresh=!0};C.prototype.show=function(){if(!this.visible)this.visible=!0,this.refresh()};C.prototype.hide=function(){if(this.visible)this.despatchEvent({type:g}),
this.despatchEvent({type:d}),this.visible=!1,this.refresh()};C.prototype.despatchEvent=function(b){if(this.visible)if(b.type==g){if(this.is_focused)this.is_focused=!1,this.refresh(),this.handleEvent(b);this.despatchEventToChildren(b)}else if(b.type==d){if(this.is_hovered)this.is_hovered=!1,this.refresh(),this.handleEvent(b);this.despatchEventToChildren(b)}else b.type==e?(this.is_hovered=!0,this.refresh(),this.handleEvent(b)):b.type==k?(this.is_focused=!0,this.refresh(),this.handleEvent(b)):b.type==
q?(this.isFocused()||this.despatchEvent({type:k}),this.children.forEach(function(c){c.getRect().collidePoint(b.pos)?c.despatchEvent(a(b,c.position)):c.isFocused()&&c.despatchEvent({type:g})},this),this.handleEvent(b)):b.type==h?(this.children.forEach(function(c){c.getRect().collidePoint(b.pos)&&c.despatchEvent(a(b,c.position))},this),this.handleEvent(b)):b.type==c?(this.children.forEach(function(c){c.getRect().collidePoint(b.pos)?(c.isHovered()||c.despatchEvent(a({type:e,pos:b.pos},c.position)),c.despatchEvent(a(b,
c.position))):c.isHovered()&&c.despatchEvent(a({type:d,pos:b.pos},c.position))},this),this.handleEvent(b)):b.type==l||b.type==f||b.type==l?this.isFocused()&&(this.children.forEach(function(c){c.isFocused()&&c.despatchEvent(a(b))}),this.handleEvent(b)):this.handleEvent(b)};C.prototype.getGUI=function(){for(var a=this.parent;a!=null&&a.type!="gui";)a=a.parent;return a};C.prototype.center=function(a){a.move(j(this.size,a.size))};C.prototype.handleEvent=function(a){this.listeners[a.type]&&this.listeners[a.type].forEach(function(b){b.scope?
b.callback.apply(b.scope,[a,this]):b.callback(a,this)})};var F=b.Label=function(a){this.font=a.font?a.font:b.DEFAULT_FONT;a.size=[1,1];F.superConstructor.apply(this,[a]);if(a.text==void 0||a.text==null)throw"Label: label text must be provided!";this.setText(String(a.text));this.type="label"};m.utils.objects.extend(F,C);F.prototype.setText=function(a){this.text=String(a)?String(a):" ";this.size=this.font.getTextSize(a);this.resize(this.size)};F.prototype.paint=function(){this.surface.clear();this.font.render(this.surface,
this.text,[0,0])};var R=b.Button=function(a){R.superConstructor.apply(this,[a]);this.type="button";this.label=this.image=null;this.image=a.image;this.image_down=a.image_down;this.image_hover=a.image_hover;if(!this.image)this.image=new m.Surface(this.size),this.image.fill("#FFF"),m.draw.rect(this.image,"#808080",new m.Rect([0,0],this.size),1);if(a.text)this.label=new F({parent:this,position:[0,0],text:a.text,font:a.font}),this.center(this.label);this.pressed_down=!1;this.on(q,function(){if(!this.pressed_down)this.pressed_down=
!0,this.refresh()},this);this.on(h,function(){if(this.pressed_down)this.pressed_down=!1,this.despatchEvent({type:z}),this.refresh()},this);this.on(d,function(){if(this.pressed_down)this.pressed_down=!1,this.refresh()},this)};m.utils.objects.extend(R,C);R.prototype.onClick=function(a,b){this.on(z,a,b)};R.prototype.paint=function(){var a;a=this.pressed_down&&this.image_down?this.image_down:this.isHovered()&&this.image_hover?this.image_hover:this.image;this.surface.blit(a,new m.Rect([0,0],this.surface.getSize()),
new m.Rect([0,0],a.getSize()))};R.prototype.setText=function(a){this.label&&(this.label.setText(a),this.center(this.label))};var K=b.Image=function(a){if(!a.image)throw"Image: parameter image is required";if(!a.size)a.size=a.image.getSize();this.image=a.image;K.superConstructor.apply(this,[a]);this.type="image";return this};m.utils.objects.extend(K,C);K.prototype.setImage=function(a){this.image=a;this.refresh()};K.prototype.paint=function(){C.prototype.paint.apply(this,[]);this.surface.blit(this.image,
new m.Rect([0,0],this.surface.getSize()),new m.Rect([0,0],this.image.getSize()))};var N=b.FrameHeader=function(a){if(!a.parent)throw"FrameHeader: parent parameter is required";this.height=a.height||20;a.width=a.parent.size[0];a.size=[a.width,this.height];a.position=[0,0];this.title_font=a.title_font;N.superConstructor.apply(this,[a]);J(this);a.title&&this.setTitle(a.title);if(a.close_btn)a.close_icon?a=a.close_icon:(a=new m.Surface([this.height,this.height]),m.draw.line(a,"#000",[3,3],[this.height-
3,this.height-3],3),m.draw.line(a,"#000",[3,this.height-3],[this.height-3,3],3)),a=new K({parent:this,position:[this.size[0]-a.getSize()[0],0],image:a}),a.on(q,function(){this.close();this.despatchEvent({type:P})},this.parent);this.type="frameheader"};m.utils.objects.extend(N,C);N.prototype.move=function(a){this.parent.move([this.parent.position[0]+a[0]-this.position[0],this.parent.position[1]+a[1]-this.position[1]])};N.prototype.setTitle=function(a){this.title_label?this.title_label.setText(a):this.title_label=
new F({parent:this,position:[0,0],font:this.title_font,text:a});var b=this.title_label.font,a=b.getTextSize(a);this.title_label.move([b.space_width,Math.max(parseInt(this.height-a[1]))],0);J(this)};N.prototype.paint=function(){m.draw.rect(this.surface,"#C0C0C0",new m.Rect([0,0],this.size))};var U=b.Frame=function(a){if(!a.parent)throw"Frame: parent parameter is required";if(a.parent.type!="gui")throw"Frame: parent object must be instance of GUI";var b=a.parent;a.parent=null;U.superConstructor.apply(this,
[a]);this.type="frame";this.visible=!1;b.frames.push(this);this.parent=b;this.constrain=a.constrain;return this};m.utils.objects.extend(U,C);U.prototype.paint=function(){m.draw.rect(this.surface,"#FFF",new m.Rect([0,0],this.size));m.draw.rect(this.surface,"#404040",new m.Rect([0,0],this.size),1)};U.prototype.show=function(){C.prototype.show.apply(this,[]);this.parent.moveFrameToTop(this)};U.prototype.close=function(){C.prototype.hide.apply(this,[]);this.despatchEvent({type:P})};U.prototype.move=function(a){this.constrain&&
(a[0]<0&&(a[0]=0),a[0]>this.parent.size[0]-this.size[0]&&(a[0]=this.parent.size[0]-this.size[0]),a[1]<0&&(a[1]=0),a[1]>this.parent.size[1]-this.size[1]&&(a[1]=this.parent.size[1]-this.size[1]));C.prototype.move.apply(this,[a])};U.prototype.destroy=function(){this.visible&&this.close();this.parent&&this.parent.removeFrame(this)};var Q=b.DraggableView=function(a){Q.superConstructor.apply(this,[a]);J(this);this.min_x=a.min_x;this.max_x=a.max_x;this.min_y=a.min_y;this.max_y=a.max_y;this.type="draggableview"};
m.utils.objects.extend(Q,C);Q.prototype.move=function(a){var b=a[0];if(this.min_x||this.min_x==0)b=Math.max(b,this.min_x);if(this.max_x||this.max_x==0)b=Math.min(b,this.max_x);a=a[1];if(this.min_y||this.min_y==0)a=Math.max(a,this.min_y);if(this.max_y||this.max_y==0)a=Math.min(a,this.max_y);C.prototype.move.apply(this,[[b,a]])};var o=b.Scroller=function(a){o.superConstructor.apply(this,[a]);this.img=null;if(a.image)this.img=new K({parent:this,position:[0,0],size:this.size,image:a.image})};m.utils.objects.extend(o,
Q);o.prototype.resize=function(a){Q.prototype.resize.apply(this,[a]);this.img&&this.img.resize(a)};var u=b.HorizontalScrollbar=function(a){u.superConstructor.apply(this,[a]);this.type="horizontalscrollbar";var b=a.left_btn_image;if(!b){var b=new m.Surface([this.size[1],this.size[1]]),c=[[0,this.size[1]/2],[this.size[1],0],[this.size[1],this.size[1]]];m.draw.polygon(b,"#C0C0C0",c)}this.left_btn=new R({parent:this,position:[0,0],size:[this.size[1],this.size[1]],image:b});this.left_btn.onClick(this.scrollLeft,
this);b=a.right_btn_image;b||(b=new m.Surface([this.size[1],this.size[1]]),c=[[0,0],[this.size[1],this.size[1]/2],[0,this.size[1]]],m.draw.polygon(b,"#C0C0C0",c));this.right_btn=new R({parent:this,position:[this.size[0]-this.size[1],0],size:[this.size[1],this.size[1]],image:b});this.right_btn.onClick(this.scrollRight,this);this.sts=this.size[0]-this.right_btn.size[0]-this.left_btn.size[0];a=a.scroller_image;a||(a=new m.Surface([this.size[1],this.size[1]]),c=a.getSize(),m.draw.rect(a,"#C0C0C0",new m.Rect([0,
0],[c[0],c[1]])));c=[Math.max(parseInt((this.size[0]-2*this.size[1])/2),a.getSize()[0]),this.size[1]];this.scroller=new this.scroller_class({parent:this,position:[this.size[1],0],image:a,size:c,min_x:this.size[1],max_x:this.size[0]-this.right_btn.size[0]-c[0],min_y:0,max_y:0});this.scroll_pos=0;this.max_scroll_pos=this.sts-this.scroller.size[0];this.scroller.on(B,function(a){this.setScrollPX(a.new_pos[0]-this.size[1])},this)};m.utils.objects.extend(u,C);u.prototype.scroller_class=o;u.prototype.setScrollerSize=
function(a){a=Math.min(Math.max(a,0.1),1);this.scroller.resize([this.sts*a,this.scroller.size[1]]);this.max_scroll_pos=this.sts-this.scroller.size[0];this.scroller.max_x=this.size[0]-this.left_btn.size[0]-this.scroller.size[0];this.refresh()};u.prototype.setScrollPX=function(a){this.scroller.move([a+this.left_btn.size[0],0]);this.scroll_pos=a=this.scroller.position[0]-this.left_btn.size[0];var b=0;this.max_scroll_pos>0&&(b=a/this.max_scroll_pos);this.despatchEvent({type:D,scroll_px:a,scroll:b});this.refresh()};
u.prototype.setScroll=function(a){this.setScrollPX(parseInt(this.max_scroll_pos*a))};u.prototype.scrollLeft=function(){this.setScrollPX(Math.max(0,this.scroll_pos-this.max_scroll_pos*0.1))};u.prototype.scrollRight=function(){this.setScrollPX(Math.min(this.max_scroll_pos,this.scroll_pos+this.max_scroll_pos*0.1))};var E=b.VerticalScrollbar=function(a){E.superConstructor.apply(this,[a]);this.type="verticalscrollbar";var b=a.top_btn_image;if(!b){var b=new m.Surface([this.size[0],this.size[0]]),c=[[this.size[0]/
2,0],[0,this.size[0]],[this.size[0],this.size[0]]];m.draw.polygon(b,"#C0C0C0",c)}this.top_btn=new R({parent:this,position:[0,0],size:[this.size[0],this.size[0]],image:b});this.top_btn.onClick(this.scrollUp,this);b=a.bot_btn_image;b||(b=new m.Surface([this.size[0],this.size[0]]),c=[[0,0],[this.size[0],0],[this.size[0]/2,this.size[0]]],m.draw.polygon(b,"#C0C0C0",c));this.bot_btn=new R({parent:this,position:[0,this.size[1]-this.size[0]],size:[this.size[0],this.size[0]],image:b});this.bot_btn.onClick(this.scrollDown,
this);this.sts=this.size[1]-this.bot_btn.size[1]-this.top_btn.size[1];a=a.scroller_image;a||(a=new m.Surface([this.size[0],this.size[0]]),c=a.getSize(),m.draw.rect(a,"#C0C0C0",new m.Rect([0,0],[c[0],c[1]])));c=[this.size[0],Math.max(parseInt((this.size[1]-2*this.size[0])/2),a.getSize()[1])];this.scroller=new this.scroller_class({parent:this,position:[0,this.size[0]],image:a,size:c,min_x:0,max_x:0,min_y:this.size[0],max_y:this.size[1]-this.bot_btn.size[1]-c[1]});this.scroll_pos=0;this.max_scroll_pos=
this.sts-this.scroller.size[1];this.scroller.on(B,function(a){this.setScrollPX(a.new_pos[1]-this.size[0])},this)};m.utils.objects.extend(E,C);E.prototype.scroller_class=o;E.prototype.setScrollerSize=function(a){a=Math.min(Math.max(a,0.1),1);this.scroller.resize([this.scroller.size[0],this.sts*a]);this.max_scroll_pos=this.sts-this.scroller.size[1];this.scroller.max_y=this.size[1]-this.bot_btn.size[1]-this.scroller.size[1];this.refresh()};E.prototype.setScrollPX=function(a){this.scroller.move([0,a+
this.top_btn.size[1]]);this.scroll_pos=a=this.scroller.position[1]-this.top_btn.size[1];var b=0;this.max_scroll_pos>0&&(b=a/this.max_scroll_pos);this.despatchEvent({type:D,scroll_px:a,scroll:b});this.refresh()};E.prototype.setScroll=function(a){this.setScrollPX(parseInt(this.max_scroll_pos*a))};E.prototype.scrollUp=function(){this.setScrollPX(Math.max(0,this.scroll_pos-this.max_scroll_pos*0.1))};E.prototype.scrollDown=function(){this.setScrollPX(Math.min(this.max_scroll_pos,this.scroll_pos+this.max_scroll_pos*
0.1))};var v=b.ScrollableView=function(a){v.superConstructor.apply(this,[a]);this.type="scrollableview";this.max_scroll_y=this.max_scroll_x=this.scroll_y=this.scroll_x=0;this.scrollable_area=[0,0];this.setScrollableArea(this.size);this.horizontal_scrollbar=this.vertical_scrollbar=null};m.utils.objects.extend(v,C);v.prototype.setVerticalScrollbar=function(a){this.vertical_scrollbar=a;a.on(D,function(a){this.setScrollY(Math.ceil(a.scroll*this.max_scroll_y))},this)};v.prototype.setHorizontalScrollbar=
function(a){this.horizontal_scrollbar=a;a.on(D,function(a){this.setScrollX(Math.ceil(a.scroll*this.max_scroll_x))},this)};v.prototype.setScrollableArea=function(a){this.scrollable_area=a;this.max_scroll_y=Math.max(a[1]-this.size[1],0);this.max_scroll_x=Math.max(a[0]-this.size[0],0);if(this.vertical_scrollbar){var b=Math.max(Math.min(1,this.size[1]/a[1]),0.1);this.vertical_scrollbar.setScrollerSize(b)}this.horizontal_scrollbar&&(b=Math.max(Math.min(1,this.size[0]/a[0]),0.1),this.horizontal_scrollbar.setScrollerSize(b))};
v.prototype.autoSetScrollableArea=function(){scrollable_area=[0,0];this.children.forEach(function(a){scrollable_area[0]=Math.max(scrollable_area[0],a.position[0]+a.size[0]+20);scrollable_area[1]=Math.max(scrollable_area[1],a.position[1]+a.size[1]+20)},this);this.setScrollableArea(scrollable_area)};v.prototype.addChild=function(a){C.prototype.addChild.apply(this,[a]);this.refresh()};v.prototype.blitChild=function(a){this.surface.blit(a.surface,[a.position[0]-this.scroll_x,a.position[1]-this.scroll_y])};
v.prototype.despatchEvent=function(b){if(b.pos)b=a(b),b.pos=[b.pos[0]+this.scroll_x,b.pos[1]+this.scroll_y];C.prototype.despatchEvent.apply(this,[b])};v.prototype.scrollX=function(a){this.setScrollX(this.scroll_x+a);this.refresh()};v.prototype.scrollY=function(a){this.setScrollY(this.scroll_y+a);this.refresh()};v.prototype.setScrollX=function(a){this.scroll_x=Math.min(Math.max(a,0),this.max_scroll_x);this.refresh()};v.prototype.setScrollY=function(a){this.scroll_y=Math.min(Math.max(a,0),this.max_scroll_y);
this.refresh()};var O=b.TextInput=function(a){O.superConstructor.apply(this,[a]);this.font=a.font?a.font:b.DEFAULT_FONT;this.text=a.text?a.text:"";this.blip=!1;this.pos=0;this.ms=500;this.scw=new v({parent:this,position:[0,0],size:a.scw_size||this.size});this.center(this.scw);this.label=new F({parent:this.scw,position:[0,0],font:this.font,text:this.text});this.scw.center(this.label);this.label.move([3,this.label.position[1]]);this.bliplabel=new F({parent:this.scw,position:[0,0],font:this.font,visible:!1,
text:"|"});this.on(f,this.onKeyDown,this);this.on(k,this.blipon,this);this.on(g,function(){this.blip=!1},this);this.setPos(this.text.length)};m.utils.objects.extend(O,C);O.prototype.blipon=function(){this.blip=!0;this.ms=500;this.refresh()};O.prototype.update=function(a){if(this.isFocused()){this.ms-=a;if(this.ms<0)this.ms=500,this.blip=!this.blip;this.blip?this.bliplabel.show():this.bliplabel.hide()}else this.bliplabel.hide()};O.prototype.paint=function(){this.surface.fill("#FFF");m.draw.rect(this.surface,
"#COCOCO",new m.Rect([0,0],this.size),1)};O.prototype.setText=function(a){this.setPos(this.text.length);this._setText(a)};O.prototype.setPos=function(a){this.pos=Math.min(Math.max(a,0),this.text.length);a=0;a=this.font.getTextSize(this.text.substr(0,this.pos))[0];a=Math.max(a-this.scw.size[0]+this.font.getTextSize("s")[0]);this.scw.setScrollX(a);this.bliplabel.move([Math.max(this.font.getTextSize(this.text.substr(0,this.pos))[0]+this.label.position[0]-2,0),this.label.position[1]])};O.prototype._setText=
function(a){this.text=a;this.label.setText(a);this.scw.autoSetScrollableArea();this.refresh();this.despatchEvent({type:p,value:a})};O.prototype.onKeyDown=function(a){var b=a.key;b==8&&this.text&&(this.pos==this.text.length?this._setText(this.text.substr(0,this.text.length-1)):this._setText(this.text.substr(0,this.pos-1)+this.text.substr(this.pos,this.text.length)),this.blipon(),this.setPos(this.pos-1));if(b>=48&&b<=90||b==32){var c=String.fromCharCode(b),c=a.shiftKey?c.toUpperCase():c.toLowerCase();
this.pos==this.text.length?this._setText(this.text+c):this._setText(this.text.substr(0,this.pos)+c+this.text.substr(this.pos,this.text.length));this.setPos(this.pos+1);this.blipon()}b==37&&(this.setPos(this.pos-1),this.blipon());b==39&&(this.setPos(this.pos+1),this.blipon())};var V=b.Dialog=function(a){a.position=j(a.parent.size,a.size);V.superConstructor.apply(this,[a])};m.utils.objects.extend(V,U);V.prototype.show=function(){this.getGUI().lockFrame(this);U.prototype.show.apply(this,[])};V.prototype.close=
function(){this.getGUI().unlockFrame();U.prototype.close.apply(this,[])};var S=b.Text=function(a){a.size=[a.width,1];S.superConstructor.apply(this,[a]);this.width=a.width;this.font=a.font?a.font:b.DEFAULT_FONT;this.setText(a.text);this.justify=a.justify};m.utils.objects.extend(S,C);S.prototype.setText=function(a){this.text=a;this.lines=[];a=a.split(/\r\n|\r|\n/);a.push(" ");var b,c,t,d,o,e="",f=0,g=0,v="";for(c=0;c<a.length;c++){b=a[c];b+=" ";for(t=0;t<b.length;t++){d=b[t];if(d==" "||d=="\t"){if(e){o=
this.font.getTextSize(e)[0];if(g+o>this.size[0]&&v!=""&&(this.lines.push({t:v,e:!1}),f+=this.font.getTextSize(v)[1],v="",g=0,e[0]==" "||e[0]=="\t"))e=e.substr(1,e.length);v+=e;g+=o}e=""}e+=d}v&&(this.lines.push({t:v,e:!0}),f+=this.font.getTextSize(v)[1],v="",g=0)}this.resize([this.width,f]);this.refresh()};S.prototype.paint=function(){C.prototype.paint.apply(this,[]);var a=0;this.lines.forEach(function(b){var c=this.font.getTextSize(b.t),t=0;if(this.justify&&!b.e){for(var d=t=0;d<b.t.length;d++)b.t[d]==
" "&&t++;t=Math.floor((this.size[0]-c[0])/t)}this.font.render(this.surface,b.t,[0,a],this.font.space_width+t);a+=c[1]},this)};var t=b.GUI=function(a){t.superConstructor.apply(this,[{position:[0,0],parent:null,size:a.getSize(),surface:a}]);this.type="gui";this.locked_frame=null;this.frames=[]};m.utils.objects.extend(t,C);t.prototype.draw=function(a){a&&this.refresh();var b=C.prototype.draw.apply(this,[]);this.frames.forEach(function(a){if(a.visible&&(a.draw()||b))this.locked_frame&&this.locked_frame.id==
a.id&&(this.refresh(),this.blur_bg()),this.surface.blit(a.surface,a.position)},this)};t.prototype.paint=function(){};t.prototype.blur_bg=function(){m.draw.rect(this.surface,"rgba(192,192, 192, 0.5)",new m.Rect([0,0],this.size),0)};t.prototype.removeFrame=function(a){if(typeof a!="number")a=a.id;for(var b=0;b<this.frames.length;b++)if(this.frames[b].id==a)return this.frames.splice(b,1),this.refresh(),!0;return!1};t.prototype.moveFrameToTop=function(a){for(var b=0;b<this.frames.length;b++){var c=this.frames[b];
if(c.id==a.id){if(b==this.frames.length-1)break;this.despatchEvent({type:g});this.frames.splice(b,1);this.frames.push(c);this.refresh();a.despatchEvent({type:k});break}}};t.prototype.update=function(a){this.children.forEach(function(b){b._update(a)});this.frames.forEach(function(b){b._update(a)})};t.prototype.lockFrame=function(a){this.locked_frame=a;this.refresh()};t.prototype.unlockFrame=function(){this.locked_frame=null;this.refresh()};t.prototype.despatchEvent=function(b){if(b.pos)b.global_pos=
b.pos;var t,T;if(b.type==q||b.type==c||b.type==h){var o=!1,e=null,v=null,u=null;for(t=this.frames.length-1;t>=0;t--)if(T=this.frames[t],!(this.locked_frame&&this.locked_frame.id!=T.id))if(T.visible&&T.getRect().collidePoint(b.pos)){T.despatchEvent(a(b,T.position));b.type==q?e=t:b.type==c&&(v=t);o=!0;T.isFocused()&&(u=t);break}else b.type==q&&T.isFocused()&&T.despatchEvent({type:g});if(e!=null){C.prototype.despatchEvent.apply(this,[{type:g}]);for(t=0;t<this.frames.length;t++)t!=e&&this.frames[t].despatchEvent({type:g})}if(v!=
null){C.prototype.despatchEvent.apply(this,[{type:d}]);for(t=0;t<this.frames.length;t++)t!=v&&this.frames[t].despatchEvent({type:d})}!o&&!this.locked_frame?C.prototype.despatchEvent.apply(this,[b]):C.prototype.handleEvent.apply(this,[b]);u!=null&&this.moveFrameToTop(this.frames[u])}else(b.type==g||b.type==d||b.type==f||b.type==l)&&this.frames.forEach(function(c){c.visible&&(!this.locked_frame||this.locked_frame.id==c.id)&&c.despatchEvent(a(b,c.position))}),this.locked_frame?C.prototype.handleEvent.apply(this,
[b]):C.prototype.despatchEvent.apply(this,[b])};b.layout={vertical:function(a,b,c){b=b||0;c=c||0;a.forEach(function(a){a.move([a.position[0],b]);b+=a.size[1]+c})},horizontal:function(a,b,c){b=b||0;c=c||0;a.forEach(function(a){a.move([b,a.position[1]]);b+=a.size[0]+c})}}}},["gamejs"]);
require.define({"settings-example":function(n,b){var a=b.settings={SCREEN_WIDTH:800,SCREEN_HEIGHT:600,FPS:60,PHYS_SCALE:10,STARTING_BALANCE:1E5,MAX_INDIVIDUAL_SOUND_CHANNELS:4,MAX_GLOBAL_SOUND_CHANNELS:8,STARTING_LEAGUE:0,SERVER:"ws://www.banditracer.eu:8000",DEBUG:!0,SOUND:!0};b.get=function(b){return a[b]};b.init=function(){for(var b in a)window.hasOwnProperty(b)&&(a[b]=window[b])};b.set=function(b,m){a[b]=m}}},[]);
require.define({settings:function(n,b){var a=b.settings={SCREEN_WIDTH:800,SCREEN_HEIGHT:600,FPS:60,PHYS_SCALE:10,STARTING_BALANCE:3E3,STARTING_LEAGUE:0,SERVER:"ws://localhost:8001",DEBUG:!1,SOUND:!1,ENGINE_SOUND:!1};b.get=function(b){return a[b]};b.init=function(){for(var b in a)window.hasOwnProperty(b)&&(a[b]=window[b])};b.set=function(b,m){a[b]=m}}},[]);
require.define({"engine/world":function(n,b){var a=n("./box2d"),j=n("./game"),m=n("./sound"),k=n("gamejs"),g=k.utils.vectors,e=k.utils.math.radians,d=n("./utils"),f=d.arr,l=d.vec,h=function(b){this.world=b;this.BeginContact=function(c){var d=c.GetFixtureA().GetBody(),h=c.GetFixtureB().GetBody(),d=d.GetUserData(),h=h.GetUserData();if(d&&h){var l=new a.b2WorldManifold;c.GetWorldManifold(l);l=f(l.m_normal);b._register_impact(d,h,c,l);b._register_impact(h,d,c,g.rotate(l,e(180)))}};this.EndContact=function(){};
this.PreSolve=function(){};this.PostSolve=function(){};return this},k=b.World=function(b){this._next_event_id=this._next_object_id=0;this._events={};this._impacts=[];this.objects={};this.objects_by_tag={};d.process_parameters(b,[["gravity",[0,0]]]);this.parameters=b;this.b2world=new a.b2World(l(b.gravity),!1);this.b2world.SetContactListener(new h(this))};k.prototype._register_impact=function(a,b,d,e){this._impacts.push([a,b,d,e])};k.prototype._process_impacts=function(){for(;this._impacts.length;){var a=
this._impacts.pop();a[0].impact(a[1],a[2],a[3])}this._impacts=[]};k.prototype._register_event=function(a,b){return this._process_event({type:a,data:b,id:this._next_event_id++})};k.prototype._create_body=function(a){return this.b2world.CreateBody(a)};k.prototype._destroy_body=function(a){this.b2world.DestroyBody(a)};k.prototype._process_event=function(a){if(a.type=="create"){a=d.copy(a.data,{});a.world=this;a.id=this._next_object_id++;for(var b in a)if((a[b]+"").search("_o_")==0){var e=parseInt(a[b].replace("_o_",
""));a[b]=this.get_object(e)}b=new (j.get_class_by_id(a.class_id))(a);for(var f in b._tags)this.objects_by_tag[f]||(this.objects_by_tag[f]=[]),this.objects_by_tag[f].push(b);b.on_create();return b}else this._destroy(this.get_object(a.data))};k.prototype.get_object=function(a){var b=this.objects[a];if(!b)throw"Uh oh. Unknown object id= "+a;return b};k.prototype.get_objects_by_tag=function(a){if(this.objects_by_tag[a])return this.objects_by_tag[a];return[]};k.prototype._destroy=function(a){a.die();
delete this.objects[a.id];var b=[];this._impacts.forEach(function(d){d[0].id==a.id||d[1].id==a.id||b.push(d)});this._impacts=b;a.body&&this._destroy_body(a.body);for(var d in a._tags)for(var e=0;e<this.objects_by_tag[d].length;e++)if(this.objects_by_tag[d][e].id==a.id){this.objects_by_tag[d].splice(e,1);break}};k.prototype.create=function(a,b){b.class_id=j.get_id_by_class(a);for(var d in b)b[d]&&b[d].AM_OBJECT&&(b[d]="_o_"+b[d].id);return this._register_event("create",b)};k.prototype.destroy=function(a){this._register_event("destroy",
a.id)};k.prototype.update=function(a){this._process_impacts();for(var b in this.objects)this.objects[b].update(a)};k.prototype.draw=function(a){for(var b in this.objects)this.objects[b].draw(a)};k.prototype.play_sound=function(a,b){this.create(m.SoundObject,{filename:a,position:b})}}},["engine/box2d","engine/game","engine/sound","gamejs","engine/utils"]);
require.define({"engine/entity":function(n,b){n("./logging");var a=n("./box2d"),j=n("./object"),m=n("./utils"),k=n("gamejs"),g=k.utils.vectors,e=k.utils.math,d=e.radians,f=e.degrees,m=n("./utils"),l=m.arr,h=m.vec,q=b.Entity=function(b){m.process_parameters(b,["position","size",["angle",0],["max_health",0],["fixed_rotation",!1],["density",1],["restitution",0.4],["friction",0.3],["linear_damping",0.15],["angular_damping",0.3],["bullet",!1],["body_type",a.b2Body.b2_dynamicBody],["sensor",!1],["alive",
!0]]);q.superConstructor.apply(this,[b]);this.add_tag("entity");this.parameters.sensor?this.add_tag("sensor"):this.add_tag("solid");this.health=this.max_health=this.parameters.max_health;this.alive=this.parameters.alive;this.buffs=[];this._next_buff_id=1;if(this.parameters.angle==void 0||this.parameters.angle==null)throw"Invaldi angle";if(isNaN(this.parameters.position[0])||isNaN(this.parameters.position[1]))throw"Invalid position: "+this.parameters.position;this.initialize_body();k.utils.objects.accessor(this,
"position",this.get_position,this.set_position);k.utils.objects.accessor(this,"angle",this.get_angle,this.set_angle)};k.utils.objects.extend(q,j.Object);q.prototype.initialize_body=function(){var b=new a.b2BodyDef;b.type=this.parameters.body_type;b.position=h(this.parameters.position);b.angle=d(this.parameters.angle+1.0E-5);b.linearDamping=this.parameters.linear_damping;b.angularDamping=this.parameters.angular_damping;b.bullet=this.parameters.bullet;b.fixedRotation=this.parameters.fixed_rotation;
this.body=this.world._create_body(b);this.body.SetUserData(this);b=new a.b2FixtureDef;b.density=this.parameters.density;b.friction=this.parameters.friction;b.isSensor=this.parameters.sensor;b.restitution=this.parameters.restitution;b.shape=this.initialize_shape();this.body.CreateFixture(b)};q.prototype.initialize_shape=function(){var b=new a.b2PolygonShape;b.SetAsBox(this.parameters.size[0]/2,this.parameters.size[1]/2);return b};q.prototype.get_position=function(){return l(this.body.GetPosition())};
q.prototype.set_position=function(a){this.body.SetPosition(h(a))};q.prototype.get_angle=function(){return f(this.body.GetAngle())};q.prototype.set_angle=function(a){this.body.SetAngle(d(a))};q.prototype.set_linear_velocity=function(a){this.body.SetLinearVelocity(h(a))};q.prototype.get_linear_velocity=function(a){return a?l(this.body.GetLinearVelocityFromLocalPoint(h(a))):l(this.body.GetLinearVelocity())};q.prototype.set_speed=function(a){velocity=g.multiply(g.unit(this.get_direction_vector()),a*1E3/
3600);this.set_linear_velocity(velocity)};q.prototype.impact=function(){};q.prototype.destroy=function(){this.world.destroy(this)};q.prototype.apply_damage=function(a){this.health-=a;this.health<0&&this.die()};q.prototype.get_world_point=function(a){return l(this.body.GetWorldPoint(h(a)))};q.prototype.get_local_point=function(a){return l(this.body.GetLocalPoint(h(a)))};q.prototype.get_world_vector=function(a){return l(this.body.GetWorldVector(h(a)))};q.prototype.get_local_vector=function(a){return l(this.body.GetLocalVector(h(a)))};
q.prototype.get_local_velocity=function(a){a==void 0&&(a=[0,0]);return l(this.body.GetLinearVelocityFromLocalPoint(h(a)))};q.prototype.get_mass=function(){return this.body.GetMass()};q.prototype.get_sideways_vector=function(){return this.get_world_vector([-1,0])};q.prototype.get_direction_vector=function(){return g.rotate(this.get_local_vector(this.get_local_velocity())[1]>0?[0,1]:[0,-1],this.body.GetAngle())};q.prototype.get_backward_direction_vector=function(){return g.rotate(this.get_local_velocity()[1]>
0?[0,-1]:[0,1],this.body.GetAngle())};q.prototype.get_world_center=function(){return l(this.body.GetWorldCenter())};q.prototype.apply_force=function(a,b){this.body.ApplyForce(h(this.get_world_vector(a)),h(this.get_world_point(b)))};q.prototype.apply_impulse=function(a,b){this.body.ApplyImpulse(h(a),h(b))}}},["engine/logging","engine/box2d","engine/object","engine/utils","gamejs"]);
require.define({"engine/game":function(n,b){b._next_class_id=1;b._registered_classes={};b.register_class=function(a){b._registered_classes[b._next_class_id++]=a};b.get_class_by_id=function(a){if(a in b._registered_classes)return b._registered_classes[a];else throw NaN%a;};b.get_id_by_class=function(a){for(var j in b._registered_classes)if(a===b._registered_classes[j])return j;throw"No id for class!";}}},[]);
require.define({"engine/box2d":function(n,b){var a={};(function(a,b){function d(){}if(!(Object.prototype.defineProperty instanceof Function)&&Object.prototype.__defineGetter__ instanceof Function&&Object.prototype.__defineSetter__ instanceof Function)Object.defineProperty=function(a,b,d){d.get instanceof Function&&a.__defineGetter__(b,d.get);d.set instanceof Function&&a.__defineSetter__(b,d.set)};a.inherit=function(a,b){d.prototype=b.prototype;a.prototype=new d;a.prototype.constructor=a};a.generateCallback=
function(a,b){return function(){b.apply(a,arguments)}};a.NVector=function(a){a===b&&(a=0);for(var d=Array(a||0),g=0;g<a;++g)d[g]=0;return d};a.is=function(a,d){if(a===null)return!1;if(d instanceof Function&&a instanceof d)return!0;if(a.constructor.__implements!=b&&a.constructor.__implements[d])return!0;return!1};a.parseUInt=function(a){return Math.abs(parseInt(a))}})(a);var j=Array,m=a.NVector;typeof a==="undefined"&&(a={});if(typeof a.Collision==="undefined")a.Collision={};if(typeof a.Collision.Shapes===
"undefined")a.Collision.Shapes={};if(typeof a.Common==="undefined")a.Common={};if(typeof a.Common.Math==="undefined")a.Common.Math={};if(typeof a.Dynamics==="undefined")a.Dynamics={};if(typeof a.Dynamics.Contacts==="undefined")a.Dynamics.Contacts={};if(typeof a.Dynamics.Controllers==="undefined")a.Dynamics.Controllers={};if(typeof a.Dynamics.Joints==="undefined")a.Dynamics.Joints={};(function(){function b(){b.b2AABB.apply(this,arguments)}function e(){e.b2Bound.apply(this,arguments)}function d(){d.b2BoundValues.apply(this,
arguments);this.constructor===d&&this.b2BoundValues.apply(this,arguments)}function f(){f.b2Collision.apply(this,arguments)}function l(){l.b2ContactID.apply(this,arguments);this.constructor===l&&this.b2ContactID.apply(this,arguments)}function h(){h.b2ContactPoint.apply(this,arguments)}function j(){j.b2Distance.apply(this,arguments)}function c(){c.b2DistanceInput.apply(this,arguments)}function z(){z.b2DistanceOutput.apply(this,arguments)}function m(){m.b2DistanceProxy.apply(this,arguments)}function n(){n.b2DynamicTree.apply(this,
arguments);this.constructor===n&&this.b2DynamicTree.apply(this,arguments)}function k(){k.b2DynamicTreeBroadPhase.apply(this,arguments)}function A(){A.b2DynamicTreeNode.apply(this,arguments)}function w(){w.b2DynamicTreePair.apply(this,arguments)}function y(){y.b2Manifold.apply(this,arguments);this.constructor===y&&this.b2Manifold.apply(this,arguments)}function G(){G.b2ManifoldPoint.apply(this,arguments);this.constructor===G&&this.b2ManifoldPoint.apply(this,arguments)}function p(){p.b2Point.apply(this,
arguments)}function L(){L.b2RayCastInput.apply(this,arguments);this.constructor===L&&this.b2RayCastInput.apply(this,arguments)}function J(){J.b2RayCastOutput.apply(this,arguments)}function M(){M.b2Segment.apply(this,arguments)}function I(){I.b2SeparationFunction.apply(this,arguments)}function C(){C.b2Simplex.apply(this,arguments);this.constructor===C&&this.b2Simplex.apply(this,arguments)}function F(){F.b2SimplexCache.apply(this,arguments)}function R(){R.b2SimplexVertex.apply(this,arguments)}function K(){K.b2TimeOfImpact.apply(this,
arguments)}function N(){N.b2TOIInput.apply(this,arguments)}function U(){U.b2WorldManifold.apply(this,arguments);this.constructor===U&&this.b2WorldManifold.apply(this,arguments)}function Q(){Q.ClipVertex.apply(this,arguments)}function o(){o.Features.apply(this,arguments)}function u(){u.b2CircleShape.apply(this,arguments);this.constructor===u&&this.b2CircleShape.apply(this,arguments)}function E(){E.b2EdgeChainDef.apply(this,arguments);this.constructor===E&&this.b2EdgeChainDef.apply(this,arguments)}
function v(){v.b2EdgeShape.apply(this,arguments);this.constructor===v&&this.b2EdgeShape.apply(this,arguments)}function O(){O.b2MassData.apply(this,arguments)}function V(){V.b2PolygonShape.apply(this,arguments);this.constructor===V&&this.b2PolygonShape.apply(this,arguments)}function S(){S.b2Shape.apply(this,arguments);this.constructor===S&&this.b2Shape.apply(this,arguments)}function t(){t.b2Color.apply(this,arguments);this.constructor===t&&this.b2Color.apply(this,arguments)}function r(){r.b2Settings.apply(this,
arguments)}function H(){H.b2Mat22.apply(this,arguments);this.constructor===H&&this.b2Mat22.apply(this,arguments)}function T(){T.b2Mat33.apply(this,arguments);this.constructor===T&&this.b2Mat33.apply(this,arguments)}function Ia(){Ia.b2Math.apply(this,arguments)}function Ha(){Ha.b2Sweep.apply(this,arguments)}function X(){X.b2Transform.apply(this,arguments);this.constructor===X&&this.b2Transform.apply(this,arguments)}function W(){W.b2Vec2.apply(this,arguments);this.constructor===W&&this.b2Vec2.apply(this,
arguments)}function Y(){Y.b2Vec3.apply(this,arguments);this.constructor===Y&&this.b2Vec3.apply(this,arguments)}function Z(){Z.b2Body.apply(this,arguments);this.constructor===Z&&this.b2Body.apply(this,arguments)}function aa(){aa.b2BodyDef.apply(this,arguments);this.constructor===aa&&this.b2BodyDef.apply(this,arguments)}function Ja(){Ja.b2ContactFilter.apply(this,arguments)}function Ka(){Ka.b2ContactImpulse.apply(this,arguments)}function La(){La.b2ContactListener.apply(this,arguments)}function ba(){ba.b2ContactManager.apply(this,
arguments);this.constructor===ba&&this.b2ContactManager.apply(this,arguments)}function ca(){ca.b2DebugDraw.apply(this,arguments);this.constructor===ca&&this.b2DebugDraw.apply(this,arguments)}function Ma(){Ma.b2DestructionListener.apply(this,arguments)}function Na(){Na.b2FilterData.apply(this,arguments)}function da(){da.b2Fixture.apply(this,arguments);this.constructor===da&&this.b2Fixture.apply(this,arguments)}function ea(){ea.b2FixtureDef.apply(this,arguments);this.constructor===ea&&this.b2FixtureDef.apply(this,
arguments)}function fa(){fa.b2Island.apply(this,arguments);this.constructor===fa&&this.b2Island.apply(this,arguments)}function Oa(){Oa.b2TimeStep.apply(this,arguments)}function ga(){ga.b2World.apply(this,arguments);this.constructor===ga&&this.b2World.apply(this,arguments)}function Pa(){Pa.b2CircleContact.apply(this,arguments)}function ha(){ha.b2Contact.apply(this,arguments);this.constructor===ha&&this.b2Contact.apply(this,arguments)}function ia(){ia.b2ContactConstraint.apply(this,arguments);this.constructor===
ia&&this.b2ContactConstraint.apply(this,arguments)}function Qa(){Qa.b2ContactConstraintPoint.apply(this,arguments)}function Ra(){Ra.b2ContactEdge.apply(this,arguments)}function ja(){ja.b2ContactFactory.apply(this,arguments);this.constructor===ja&&this.b2ContactFactory.apply(this,arguments)}function Sa(){Sa.b2ContactRegister.apply(this,arguments)}function Ta(){Ta.b2ContactResult.apply(this,arguments)}function ka(){ka.b2ContactSolver.apply(this,arguments);this.constructor===ka&&this.b2ContactSolver.apply(this,
arguments)}function Ua(){Ua.b2EdgeAndCircleContact.apply(this,arguments)}function la(){la.b2NullContact.apply(this,arguments);this.constructor===la&&this.b2NullContact.apply(this,arguments)}function Va(){Va.b2PolyAndCircleContact.apply(this,arguments)}function Wa(){Wa.b2PolyAndEdgeContact.apply(this,arguments)}function Xa(){Xa.b2PolygonContact.apply(this,arguments)}function ma(){ma.b2PositionSolverManifold.apply(this,arguments);this.constructor===ma&&this.b2PositionSolverManifold.apply(this,arguments)}
function Ya(){Ya.b2BuoyancyController.apply(this,arguments)}function Za(){Za.b2ConstantAccelController.apply(this,arguments)}function $a(){$a.b2ConstantForceController.apply(this,arguments)}function ab(){ab.b2Controller.apply(this,arguments)}function bb(){bb.b2ControllerEdge.apply(this,arguments)}function cb(){cb.b2GravityController.apply(this,arguments)}function db(){db.b2TensorDampingController.apply(this,arguments)}function na(){na.b2DistanceJoint.apply(this,arguments);this.constructor===na&&this.b2DistanceJoint.apply(this,
arguments)}function oa(){oa.b2DistanceJointDef.apply(this,arguments);this.constructor===oa&&this.b2DistanceJointDef.apply(this,arguments)}function pa(){pa.b2FrictionJoint.apply(this,arguments);this.constructor===pa&&this.b2FrictionJoint.apply(this,arguments)}function qa(){qa.b2FrictionJointDef.apply(this,arguments);this.constructor===qa&&this.b2FrictionJointDef.apply(this,arguments)}function ra(){ra.b2GearJoint.apply(this,arguments);this.constructor===ra&&this.b2GearJoint.apply(this,arguments)}function sa(){sa.b2GearJointDef.apply(this,
arguments);this.constructor===sa&&this.b2GearJointDef.apply(this,arguments)}function eb(){eb.b2Jacobian.apply(this,arguments)}function ta(){ta.b2Joint.apply(this,arguments);this.constructor===ta&&this.b2Joint.apply(this,arguments)}function ua(){ua.b2JointDef.apply(this,arguments);this.constructor===ua&&this.b2JointDef.apply(this,arguments)}function fb(){fb.b2JointEdge.apply(this,arguments)}function va(){va.b2LineJoint.apply(this,arguments);this.constructor===va&&this.b2LineJoint.apply(this,arguments)}
function wa(){wa.b2LineJointDef.apply(this,arguments);this.constructor===wa&&this.b2LineJointDef.apply(this,arguments)}function xa(){xa.b2MouseJoint.apply(this,arguments);this.constructor===xa&&this.b2MouseJoint.apply(this,arguments)}function ya(){ya.b2MouseJointDef.apply(this,arguments);this.constructor===ya&&this.b2MouseJointDef.apply(this,arguments)}function za(){za.b2PrismaticJoint.apply(this,arguments);this.constructor===za&&this.b2PrismaticJoint.apply(this,arguments)}function Aa(){Aa.b2PrismaticJointDef.apply(this,
arguments);this.constructor===Aa&&this.b2PrismaticJointDef.apply(this,arguments)}function Ba(){Ba.b2PulleyJoint.apply(this,arguments);this.constructor===Ba&&this.b2PulleyJoint.apply(this,arguments)}function Ca(){Ca.b2PulleyJointDef.apply(this,arguments);this.constructor===Ca&&this.b2PulleyJointDef.apply(this,arguments)}function Da(){Da.b2RevoluteJoint.apply(this,arguments);this.constructor===Da&&this.b2RevoluteJoint.apply(this,arguments)}function Ea(){Ea.b2RevoluteJointDef.apply(this,arguments);this.constructor===
Ea&&this.b2RevoluteJointDef.apply(this,arguments)}function Fa(){Fa.b2WeldJoint.apply(this,arguments);this.constructor===Fa&&this.b2WeldJoint.apply(this,arguments)}function Ga(){Ga.b2WeldJointDef.apply(this,arguments);this.constructor===Ga&&this.b2WeldJointDef.apply(this,arguments)}a.Collision.IBroadPhase="Box2D.Collision.IBroadPhase";a.Collision.b2AABB=b;a.Collision.b2Bound=e;a.Collision.b2BoundValues=d;a.Collision.b2Collision=f;a.Collision.b2ContactID=l;a.Collision.b2ContactPoint=h;a.Collision.b2Distance=
j;a.Collision.b2DistanceInput=c;a.Collision.b2DistanceOutput=z;a.Collision.b2DistanceProxy=m;a.Collision.b2DynamicTree=n;a.Collision.b2DynamicTreeBroadPhase=k;a.Collision.b2DynamicTreeNode=A;a.Collision.b2DynamicTreePair=w;a.Collision.b2Manifold=y;a.Collision.b2ManifoldPoint=G;a.Collision.b2Point=p;a.Collision.b2RayCastInput=L;a.Collision.b2RayCastOutput=J;a.Collision.b2Segment=M;a.Collision.b2SeparationFunction=I;a.Collision.b2Simplex=C;a.Collision.b2SimplexCache=F;a.Collision.b2SimplexVertex=R;
a.Collision.b2TimeOfImpact=K;a.Collision.b2TOIInput=N;a.Collision.b2WorldManifold=U;a.Collision.ClipVertex=Q;a.Collision.Features=o;a.Collision.Shapes.b2CircleShape=u;a.Collision.Shapes.b2EdgeChainDef=E;a.Collision.Shapes.b2EdgeShape=v;a.Collision.Shapes.b2MassData=O;a.Collision.Shapes.b2PolygonShape=V;a.Collision.Shapes.b2Shape=S;a.Common.b2internal="Box2D.Common.b2internal";a.Common.b2Color=t;a.Common.b2Settings=r;a.Common.Math.b2Mat22=H;a.Common.Math.b2Mat33=T;a.Common.Math.b2Math=Ia;a.Common.Math.b2Sweep=
Ha;a.Common.Math.b2Transform=X;a.Common.Math.b2Vec2=W;a.Common.Math.b2Vec3=Y;a.Dynamics.b2Body=Z;a.Dynamics.b2BodyDef=aa;a.Dynamics.b2ContactFilter=Ja;a.Dynamics.b2ContactImpulse=Ka;a.Dynamics.b2ContactListener=La;a.Dynamics.b2ContactManager=ba;a.Dynamics.b2DebugDraw=ca;a.Dynamics.b2DestructionListener=Ma;a.Dynamics.b2FilterData=Na;a.Dynamics.b2Fixture=da;a.Dynamics.b2FixtureDef=ea;a.Dynamics.b2Island=fa;a.Dynamics.b2TimeStep=Oa;a.Dynamics.b2World=ga;a.Dynamics.Contacts.b2CircleContact=Pa;a.Dynamics.Contacts.b2Contact=
ha;a.Dynamics.Contacts.b2ContactConstraint=ia;a.Dynamics.Contacts.b2ContactConstraintPoint=Qa;a.Dynamics.Contacts.b2ContactEdge=Ra;a.Dynamics.Contacts.b2ContactFactory=ja;a.Dynamics.Contacts.b2ContactRegister=Sa;a.Dynamics.Contacts.b2ContactResult=Ta;a.Dynamics.Contacts.b2ContactSolver=ka;a.Dynamics.Contacts.b2EdgeAndCircleContact=Ua;a.Dynamics.Contacts.b2NullContact=la;a.Dynamics.Contacts.b2PolyAndCircleContact=Va;a.Dynamics.Contacts.b2PolyAndEdgeContact=Wa;a.Dynamics.Contacts.b2PolygonContact=Xa;
a.Dynamics.Contacts.b2PositionSolverManifold=ma;a.Dynamics.Controllers.b2BuoyancyController=Ya;a.Dynamics.Controllers.b2ConstantAccelController=Za;a.Dynamics.Controllers.b2ConstantForceController=$a;a.Dynamics.Controllers.b2Controller=ab;a.Dynamics.Controllers.b2ControllerEdge=bb;a.Dynamics.Controllers.b2GravityController=cb;a.Dynamics.Controllers.b2TensorDampingController=db;a.Dynamics.Joints.b2DistanceJoint=na;a.Dynamics.Joints.b2DistanceJointDef=oa;a.Dynamics.Joints.b2FrictionJoint=pa;a.Dynamics.Joints.b2FrictionJointDef=
qa;a.Dynamics.Joints.b2GearJoint=ra;a.Dynamics.Joints.b2GearJointDef=sa;a.Dynamics.Joints.b2Jacobian=eb;a.Dynamics.Joints.b2Joint=ta;a.Dynamics.Joints.b2JointDef=ua;a.Dynamics.Joints.b2JointEdge=fb;a.Dynamics.Joints.b2LineJoint=va;a.Dynamics.Joints.b2LineJointDef=wa;a.Dynamics.Joints.b2MouseJoint=xa;a.Dynamics.Joints.b2MouseJointDef=ya;a.Dynamics.Joints.b2PrismaticJoint=za;a.Dynamics.Joints.b2PrismaticJointDef=Aa;a.Dynamics.Joints.b2PulleyJoint=Ba;a.Dynamics.Joints.b2PulleyJointDef=Ca;a.Dynamics.Joints.b2RevoluteJoint=
Da;a.Dynamics.Joints.b2RevoluteJointDef=Ea;a.Dynamics.Joints.b2WeldJoint=Fa;a.Dynamics.Joints.b2WeldJointDef=Ga})();a.postDefs=[];(function(){var b=a.Collision.Shapes.b2CircleShape,e=a.Collision.Shapes.b2PolygonShape,d=a.Collision.Shapes.b2Shape,f=a.Common.b2Settings,l=a.Common.Math.b2Math,h=a.Common.Math.b2Sweep,q=a.Common.Math.b2Transform,c=a.Common.Math.b2Vec2,z=a.Collision.b2AABB,n=a.Collision.b2Bound,k=a.Collision.b2BoundValues,B=a.Collision.b2Collision,A=a.Collision.b2ContactID,w=a.Collision.b2ContactPoint,
y=a.Collision.b2Distance,G=a.Collision.b2DistanceInput,p=a.Collision.b2DistanceOutput,L=a.Collision.b2DistanceProxy,J=a.Collision.b2DynamicTree,M=a.Collision.b2DynamicTreeBroadPhase,I=a.Collision.b2DynamicTreeNode,C=a.Collision.b2DynamicTreePair,F=a.Collision.b2Manifold,R=a.Collision.b2ManifoldPoint,K=a.Collision.b2Point,N=a.Collision.b2RayCastInput,U=a.Collision.b2RayCastOutput,Q=a.Collision.b2Segment,o=a.Collision.b2SeparationFunction,u=a.Collision.b2Simplex,E=a.Collision.b2SimplexCache,v=a.Collision.b2SimplexVertex,
O=a.Collision.b2TimeOfImpact,V=a.Collision.b2TOIInput,S=a.Collision.b2WorldManifold,t=a.Collision.ClipVertex,r=a.Collision.Features,H=a.Collision.IBroadPhase;z.b2AABB=function(){this.lowerBound=new c;this.upperBound=new c};z.prototype.IsValid=function(){var a=this.upperBound.y-this.lowerBound.y;return a=(a=this.upperBound.x-this.lowerBound.x>=0&&a>=0)&&this.lowerBound.IsValid()&&this.upperBound.IsValid()};z.prototype.GetCenter=function(){return new c((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+
this.upperBound.y)/2)};z.prototype.GetExtents=function(){return new c((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)};z.prototype.Contains=function(a){var b;return b=(b=(b=(b=this.lowerBound.x<=a.lowerBound.x)&&this.lowerBound.y<=a.lowerBound.y)&&a.upperBound.x<=this.upperBound.x)&&a.upperBound.y<=this.upperBound.y};z.prototype.RayCast=function(a,b){var c=-Number.MAX_VALUE,t=Number.MAX_VALUE,d=b.p1.x,r=b.p1.y,o=b.p2.x-b.p1.x,e=b.p2.y-b.p1.y,f=Math.abs(e),g=a.normal,
v=0,u=0,H=v=0,H=0;if(Math.abs(o)<Number.MIN_VALUE){if(d<this.lowerBound.x||this.upperBound.x<d)return!1}else{v=1/o;u=(this.lowerBound.x-d)*v;v*=this.upperBound.x-d;H=-1;u>v&&(H=u,u=v,v=H,H=1);if(u>c)g.x=H,g.y=0,c=u;t=Math.min(t,v);if(c>t)return!1}if(f<Number.MIN_VALUE){if(r<this.lowerBound.y||this.upperBound.y<r)return!1}else{v=1/e;u=(this.lowerBound.y-r)*v;v*=this.upperBound.y-r;H=-1;u>v&&(H=u,u=v,v=H,H=1);if(u>c)g.y=H,g.x=0,c=u;t=Math.min(t,v);if(c>t)return!1}a.fraction=c;return!0};z.prototype.TestOverlap=
function(a){var b=a.lowerBound.y-this.upperBound.y,c=this.lowerBound.y-a.upperBound.y;if(a.lowerBound.x-this.upperBound.x>0||b>0)return!1;if(this.lowerBound.x-a.upperBound.x>0||c>0)return!1;return!0};z.Combine=function(a,b){var c=new z;c.Combine(a,b);return c};z.prototype.Combine=function(a,b){this.lowerBound.x=Math.min(a.lowerBound.x,b.lowerBound.x);this.lowerBound.y=Math.min(a.lowerBound.y,b.lowerBound.y);this.upperBound.x=Math.max(a.upperBound.x,b.upperBound.x);this.upperBound.y=Math.max(a.upperBound.y,
b.upperBound.y)};n.b2Bound=function(){};n.prototype.IsLower=function(){return(this.value&1)==0};n.prototype.IsUpper=function(){return(this.value&1)==1};n.prototype.Swap=function(a){var b=this.value,c=this.proxy,t=this.stabbingCount;this.value=a.value;this.proxy=a.proxy;this.stabbingCount=a.stabbingCount;a.value=b;a.proxy=c;a.stabbingCount=t};k.b2BoundValues=function(){};k.prototype.b2BoundValues=function(){this.lowerValues=new m;this.lowerValues[0]=0;this.lowerValues[1]=0;this.upperValues=new m;this.upperValues[0]=
0;this.upperValues[1]=0};B.b2Collision=function(){};B.ClipSegmentToLine=function(a,b,c,t){t===void 0&&(t=0);var d,r=0;d=b[0];var o=d.v;d=b[1];var e=d.v,f=c.x*o.x+c.y*o.y-t;d=c.x*e.x+c.y*e.y-t;f<=0&&a[r++].Set(b[0]);d<=0&&a[r++].Set(b[1]);if(f*d<0)c=f/(f-d),d=a[r],d=d.v,d.x=o.x+c*(e.x-o.x),d.y=o.y+c*(e.y-o.y),d=a[r],d.id=(f>0?b[0]:b[1]).id,++r;return r};B.EdgeSeparation=function(a,b,c,t,d){c===void 0&&(c=0);parseInt(a.m_vertexCount);var r=a.m_vertices,a=a.m_normals,o=parseInt(t.m_vertexCount),e=t.m_vertices,
f,g;f=b.R;g=a[c];a=f.col1.x*g.x+f.col2.x*g.y;t=f.col1.y*g.x+f.col2.y*g.y;f=d.R;var v=f.col1.x*a+f.col1.y*t;f=f.col2.x*a+f.col2.y*t;for(var u=0,H=Number.MAX_VALUE,h=0;h<o;++h)g=e[h],g=g.x*v+g.y*f,g<H&&(H=g,u=h);g=r[c];f=b.R;c=b.position.x+(f.col1.x*g.x+f.col2.x*g.y);b=b.position.y+(f.col1.y*g.x+f.col2.y*g.y);g=e[u];f=d.R;r=d.position.x+(f.col1.x*g.x+f.col2.x*g.y);d=d.position.y+(f.col1.y*g.x+f.col2.y*g.y);r-=c;d-=b;return r*a+d*t};B.FindMaxSeparation=function(a,b,c,t,d){var r=parseInt(b.m_vertexCount),
o=b.m_normals,e,f;f=d.R;e=t.m_centroid;var g=d.position.x+(f.col1.x*e.x+f.col2.x*e.y),v=d.position.y+(f.col1.y*e.x+f.col2.y*e.y);f=c.R;e=b.m_centroid;g-=c.position.x+(f.col1.x*e.x+f.col2.x*e.y);v-=c.position.y+(f.col1.y*e.x+f.col2.y*e.y);f=g*c.R.col1.x+v*c.R.col1.y;for(var v=g*c.R.col2.x+v*c.R.col2.y,g=0,u=-Number.MAX_VALUE,H=0;H<r;++H)e=o[H],e=e.x*f+e.y*v,e>u&&(u=e,g=H);o=B.EdgeSeparation(b,c,g,t,d);e=parseInt(g-1>=0?g-1:r-1);f=B.EdgeSeparation(b,c,e,t,d);var v=parseInt(g+1<r?g+1:0),u=B.EdgeSeparation(b,
c,v,t,d),h=H=0,p=0;if(f>o&&f>u)p=-1,H=e,h=f;else if(u>o)p=1,H=v,h=u;else return a[0]=g,o;for(;;)if(g=p==-1?H-1>=0?H-1:r-1:H+1<r?H+1:0,o=B.EdgeSeparation(b,c,g,t,d),o>h)H=g,h=o;else break;a[0]=H;return h};B.FindIncidentEdge=function(a,b,c,t,d,r){t===void 0&&(t=0);parseInt(b.m_vertexCount);var o=b.m_normals,e=parseInt(d.m_vertexCount),b=d.m_vertices,d=d.m_normals,f;f=c.R;var c=o[t],o=f.col1.x*c.x+f.col2.x*c.y,g=f.col1.y*c.x+f.col2.y*c.y;f=r.R;c=f.col1.x*o+f.col1.y*g;g=f.col2.x*o+f.col2.y*g;o=c;f=0;
for(var v=Number.MAX_VALUE,u=0;u<e;++u)c=d[u],c=o*c.x+g*c.y,c<v&&(v=c,f=u);d=parseInt(f);o=parseInt(d+1<e?d+1:0);e=a[0];c=b[d];f=r.R;e.v.x=r.position.x+(f.col1.x*c.x+f.col2.x*c.y);e.v.y=r.position.y+(f.col1.y*c.x+f.col2.y*c.y);e.id.features.referenceEdge=t;e.id.features.incidentEdge=d;e.id.features.incidentVertex=0;e=a[1];c=b[o];f=r.R;e.v.x=r.position.x+(f.col1.x*c.x+f.col2.x*c.y);e.v.y=r.position.y+(f.col1.y*c.x+f.col2.y*c.y);e.id.features.referenceEdge=t;e.id.features.incidentEdge=o;e.id.features.incidentVertex=
1};B.MakeClipPointVector=function(){var a=new j(2);a[0]=new t;a[1]=new t;return a};B.CollidePolygons=function(a,b,c,t,d){var r;a.m_pointCount=0;var o=b.m_radius+t.m_radius;B.s_edgeAO[0]=0;var e=B.FindMaxSeparation(B.s_edgeAO,b,c,t,d);r=B.s_edgeAO[0];if(!(e>o)){var g;B.s_edgeBO[0]=0;var v=B.FindMaxSeparation(B.s_edgeBO,t,d,b,c);g=B.s_edgeBO[0];if(!(v>o)){var u=0,H=0;v>0.98*e+0.001?(e=t,t=b,b=d,u=g,a.m_type=F.e_faceB,H=1):(e=b,b=c,c=d,u=r,a.m_type=F.e_faceA,H=0);r=B.s_incidentEdge;B.FindIncidentEdge(r,
e,b,u,t,c);g=parseInt(e.m_vertexCount);var d=e.m_vertices,e=d[u],h;h=u+1<g?d[parseInt(u+1)]:d[0];u=B.s_localTangent;u.Set(h.x-e.x,h.y-e.y);u.Normalize();d=B.s_localNormal;d.x=u.y;d.y=-u.x;t=B.s_planePoint;t.Set(0.5*(e.x+h.x),0.5*(e.y+h.y));v=B.s_tangent;g=b.R;v.x=g.col1.x*u.x+g.col2.x*u.y;v.y=g.col1.y*u.x+g.col2.y*u.y;var p=B.s_tangent2;p.x=-v.x;p.y=-v.y;u=B.s_normal;u.x=v.y;u.y=-v.x;var l=B.s_v11,E=B.s_v12;l.x=b.position.x+(g.col1.x*e.x+g.col2.x*e.y);l.y=b.position.y+(g.col1.y*e.x+g.col2.y*e.y);
E.x=b.position.x+(g.col1.x*h.x+g.col2.x*h.y);E.y=b.position.y+(g.col1.y*h.x+g.col2.y*h.y);b=u.x*l.x+u.y*l.y;g=v.x*E.x+v.y*E.y+o;h=B.s_clipPoints1;e=B.s_clipPoints2;E=0;E=B.ClipSegmentToLine(h,r,p,-v.x*l.x-v.y*l.y+o);if(!(E<2)&&(E=B.ClipSegmentToLine(e,h,v,g),!(E<2))){a.m_localPlaneNormal.SetV(d);a.m_localPoint.SetV(t);for(t=d=0;t<f.b2_maxManifoldPoints;++t)if(r=e[t],u.x*r.v.x+u.y*r.v.y-b<=o)v=a.m_points[d],g=c.R,p=r.v.x-c.position.x,l=r.v.y-c.position.y,v.m_localPoint.x=p*g.col1.x+l*g.col1.y,v.m_localPoint.y=
p*g.col2.x+l*g.col2.y,v.m_id.Set(r.id),v.m_id.features.flip=H,++d;a.m_pointCount=d}}}};B.CollideCircles=function(a,b,c,t,d){a.m_pointCount=0;var r,o;r=c.R;o=b.m_p;var e=c.position.x+(r.col1.x*o.x+r.col2.x*o.y),c=c.position.y+(r.col1.y*o.x+r.col2.y*o.y);r=d.R;o=t.m_p;e=d.position.x+(r.col1.x*o.x+r.col2.x*o.y)-e;d=d.position.y+(r.col1.y*o.x+r.col2.y*o.y)-c;r=b.m_radius+t.m_radius;if(!(e*e+d*d>r*r))a.m_type=F.e_circles,a.m_localPoint.SetV(b.m_p),a.m_localPlaneNormal.SetZero(),a.m_pointCount=1,a.m_points[0].m_localPoint.SetV(t.m_p),
a.m_points[0].m_id.key=0};B.CollidePolygonAndCircle=function(a,b,c,t,d){var r=a.m_pointCount=0,o=0,e,f;f=d.R;e=t.m_p;var g=d.position.y+(f.col1.y*e.x+f.col2.y*e.y),r=d.position.x+(f.col1.x*e.x+f.col2.x*e.y)-c.position.x,o=g-c.position.y;f=c.R;c=r*f.col1.x+o*f.col1.y;f=r*f.col2.x+o*f.col2.y;for(var v=0,g=-Number.MAX_VALUE,d=b.m_radius+t.m_radius,u=parseInt(b.m_vertexCount),H=b.m_vertices,b=b.m_normals,h=0;h<u;++h){e=H[h];r=c-e.x;o=f-e.y;e=b[h];r=e.x*r+e.y*o;if(r>d)return;r>g&&(g=r,v=h)}r=parseInt(v);
o=parseInt(r+1<u?r+1:0);e=H[r];H=H[o];if(g<Number.MIN_VALUE)a.m_pointCount=1,a.m_type=F.e_faceA,a.m_localPlaneNormal.SetV(b[v]),a.m_localPoint.x=0.5*(e.x+H.x),a.m_localPoint.y=0.5*(e.y+H.y);else if(g=(c-H.x)*(e.x-H.x)+(f-H.y)*(e.y-H.y),(c-e.x)*(H.x-e.x)+(f-e.y)*(H.y-e.y)<=0){if((c-e.x)*(c-e.x)+(f-e.y)*(f-e.y)>d*d)return;a.m_pointCount=1;a.m_type=F.e_faceA;a.m_localPlaneNormal.x=c-e.x;a.m_localPlaneNormal.y=f-e.y;a.m_localPlaneNormal.Normalize();a.m_localPoint.SetV(e)}else if(g<=0){if((c-H.x)*(c-H.x)+
(f-H.y)*(f-H.y)>d*d)return;a.m_pointCount=1;a.m_type=F.e_faceA;a.m_localPlaneNormal.x=c-H.x;a.m_localPlaneNormal.y=f-H.y;a.m_localPlaneNormal.Normalize();a.m_localPoint.SetV(H)}else{v=0.5*(e.x+H.x);e=0.5*(e.y+H.y);g=(c-v)*b[r].x+(f-e)*b[r].y;if(g>d)return;a.m_pointCount=1;a.m_type=F.e_faceA;a.m_localPlaneNormal.x=b[r].x;a.m_localPlaneNormal.y=b[r].y;a.m_localPlaneNormal.Normalize();a.m_localPoint.Set(v,e)}a.m_points[0].m_localPoint.SetV(t.m_p);a.m_points[0].m_id.key=0};B.TestOverlap=function(a,b){var c=
b.lowerBound,t=a.upperBound,d=c.x-t.x,r=c.y-t.y,c=a.lowerBound,t=b.upperBound,e=c.y-t.y;if(d>0||r>0)return!1;if(c.x-t.x>0||e>0)return!1;return!0};a.postDefs.push(function(){a.Collision.b2Collision.s_incidentEdge=B.MakeClipPointVector();a.Collision.b2Collision.s_clipPoints1=B.MakeClipPointVector();a.Collision.b2Collision.s_clipPoints2=B.MakeClipPointVector();a.Collision.b2Collision.s_edgeAO=new m(1);a.Collision.b2Collision.s_edgeBO=new m(1);a.Collision.b2Collision.s_localTangent=new c;a.Collision.b2Collision.s_localNormal=
new c;a.Collision.b2Collision.s_planePoint=new c;a.Collision.b2Collision.s_normal=new c;a.Collision.b2Collision.s_tangent=new c;a.Collision.b2Collision.s_tangent2=new c;a.Collision.b2Collision.s_v11=new c;a.Collision.b2Collision.s_v12=new c;a.Collision.b2Collision.b2CollidePolyTempVec=new c;a.Collision.b2Collision.b2_nullFeature=255});A.b2ContactID=function(){this.features=new r};A.prototype.b2ContactID=function(){this.features._m_id=this};A.prototype.Set=function(a){this.key=a._key};A.prototype.Copy=
function(){var a=new A;a.key=this.key;return a};Object.defineProperty(A.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key}});Object.defineProperty(A.prototype,"key",{enumerable:!1,configurable:!0,set:function(a){a===void 0&&(a=0);this._key=a;this.features._referenceEdge=this._key&255;this.features._incidentEdge=(this._key&65280)>>8&255;this.features._incidentVertex=(this._key&16711680)>>16&255;this.features._flip=(this._key&4278190080)>>24&255}});w.b2ContactPoint=function(){this.position=
new c;this.velocity=new c;this.normal=new c;this.id=new A};y.b2Distance=function(){};y.Distance=function(a,b,t){++y.b2_gjkCalls;var d=t.proxyA,r=t.proxyB,e=t.transformA,o=t.transformB,g=y.s_simplex;g.ReadCache(b,d,e,r,o);var v=g.m_vertices,u=y.s_saveA,H=y.s_saveB,h=0;g.GetClosestPoint().LengthSquared();for(var p=0,E,j=0;j<20;){h=g.m_count;for(p=0;p<h;p++)u[p]=v[p].indexA,H[p]=v[p].indexB;switch(g.m_count){case 1:break;case 2:g.Solve2();break;case 3:g.Solve3();break;default:f.b2Assert(!1)}if(g.m_count==
3)break;E=g.GetClosestPoint();E.LengthSquared();p=g.GetSearchDirection();if(p.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;E=v[g.m_count];E.indexA=d.GetSupport(l.MulTMV(e.R,p.GetNegative()));E.wA=l.MulX(e,d.GetVertex(E.indexA));E.indexB=r.GetSupport(l.MulTMV(o.R,p));E.wB=l.MulX(o,r.GetVertex(E.indexB));E.w=l.SubtractVV(E.wB,E.wA);++j;++y.b2_gjkIters;for(var S=!1,p=0;p<h;p++)if(E.indexA==u[p]&&E.indexB==H[p]){S=!0;break}if(S)break;++g.m_count}y.b2_gjkMaxIters=l.Max(y.b2_gjkMaxIters,j);g.GetWitnessPoints(a.pointA,
a.pointB);a.distance=l.SubtractVV(a.pointA,a.pointB).Length();a.iterations=j;g.WriteCache(b);if(t.useRadii)b=d.m_radius,r=r.m_radius,a.distance>b+r&&a.distance>Number.MIN_VALUE?(a.distance-=b+r,t=l.SubtractVV(a.pointB,a.pointA),t.Normalize(),a.pointA.x+=b*t.x,a.pointA.y+=b*t.y,a.pointB.x-=r*t.x,a.pointB.y-=r*t.y):(E=new c,E.x=0.5*(a.pointA.x+a.pointB.x),E.y=0.5*(a.pointA.y+a.pointB.y),a.pointA.x=a.pointB.x=E.x,a.pointA.y=a.pointB.y=E.y,a.distance=0)};a.postDefs.push(function(){a.Collision.b2Distance.s_simplex=
new u;a.Collision.b2Distance.s_saveA=new m(3);a.Collision.b2Distance.s_saveB=new m(3)});G.b2DistanceInput=function(){};p.b2DistanceOutput=function(){this.pointA=new c;this.pointB=new c};L.b2DistanceProxy=function(){};L.prototype.Set=function(a){switch(a.GetType()){case d.e_circleShape:a=a instanceof b?a:null;this.m_vertices=new j(1,!0);this.m_vertices[0]=a.m_p;this.m_count=1;this.m_radius=a.m_radius;break;case d.e_polygonShape:a=a instanceof e?a:null;this.m_vertices=a.m_vertices;this.m_count=a.m_vertexCount;
this.m_radius=a.m_radius;break;default:f.b2Assert(!1)}};L.prototype.GetSupport=function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,t=1;t<this.m_count;++t){var d=this.m_vertices[t].x*a.x+this.m_vertices[t].y*a.y;d>c&&(b=t,c=d)}return b};L.prototype.GetSupportVertex=function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,t=1;t<this.m_count;++t){var d=this.m_vertices[t].x*a.x+this.m_vertices[t].y*a.y;d>c&&(b=t,c=d)}return this.m_vertices[b]};L.prototype.GetVertexCount=
function(){return this.m_count};L.prototype.GetVertex=function(a){a===void 0&&(a=0);f.b2Assert(0<=a&&a<this.m_count);return this.m_vertices[a]};J.b2DynamicTree=function(){};J.prototype.b2DynamicTree=function(){this.m_freeList=this.m_root=null;this.m_insertionCount=this.m_path=0};J.prototype.CreateProxy=function(a,b){var c=this.AllocateNode(),t=f.b2_aabbExtension,d=f.b2_aabbExtension;c.aabb.lowerBound.x=a.lowerBound.x-t;c.aabb.lowerBound.y=a.lowerBound.y-d;c.aabb.upperBound.x=a.upperBound.x+t;c.aabb.upperBound.y=
a.upperBound.y+d;c.userData=b;this.InsertLeaf(c);return c};J.prototype.DestroyProxy=function(a){this.RemoveLeaf(a);this.FreeNode(a)};J.prototype.MoveProxy=function(a,b,c){f.b2Assert(a.IsLeaf());if(a.aabb.Contains(b))return!1;this.RemoveLeaf(a);var t=f.b2_aabbExtension+f.b2_aabbMultiplier*(c.x>0?c.x:-c.x),c=f.b2_aabbExtension+f.b2_aabbMultiplier*(c.y>0?c.y:-c.y);a.aabb.lowerBound.x=b.lowerBound.x-t;a.aabb.lowerBound.y=b.lowerBound.y-c;a.aabb.upperBound.x=b.upperBound.x+t;a.aabb.upperBound.y=b.upperBound.y+
c;this.InsertLeaf(a);return!0};J.prototype.Rebalance=function(a){a===void 0&&(a=0);if(this.m_root!=null)for(var b=0;b<a;b++){for(var c=this.m_root,t=0;c.IsLeaf()==!1;)c=this.m_path>>t&1?c.child2:c.child1,t=t+1&31;++this.m_path;this.RemoveLeaf(c);this.InsertLeaf(c)}};J.prototype.GetFatAABB=function(a){return a.aabb};J.prototype.GetUserData=function(a){return a.userData};J.prototype.Query=function(a,b){if(this.m_root!=null){var c=new j,t=0;for(c[t++]=this.m_root;t>0;){var d=c[--t];if(d.aabb.TestOverlap(b))if(d.IsLeaf()){if(!a(d))break}else c[t++]=
d.child1,c[t++]=d.child2}}};J.prototype.RayCast=function(a,b){if(this.m_root!=null){var c=b.p1,t=b.p2,d=l.SubtractVV(c,t);d.Normalize();var d=l.CrossFV(1,d),r=l.AbsV(d),e=b.maxFraction,o=new z,f=0,g=0,f=c.x+e*(t.x-c.x),g=c.y+e*(t.y-c.y);o.lowerBound.x=Math.min(c.x,f);o.lowerBound.y=Math.min(c.y,g);o.upperBound.x=Math.max(c.x,f);o.upperBound.y=Math.max(c.y,g);var v=new j,u=0;for(v[u++]=this.m_root;u>0;)if(e=v[--u],e.aabb.TestOverlap(o)!=!1&&(f=e.aabb.GetCenter(),g=e.aabb.GetExtents(),!(Math.abs(d.x*
(c.x-f.x)+d.y*(c.y-f.y))-r.x*g.x-r.y*g.y>0)))if(e.IsLeaf()){f=new N;f.p1=b.p1;f.p2=b.p2;f.maxFraction=b.maxFraction;e=a(f,e);if(e==0)break;if(e>0)f=c.x+e*(t.x-c.x),g=c.y+e*(t.y-c.y),o.lowerBound.x=Math.min(c.x,f),o.lowerBound.y=Math.min(c.y,g),o.upperBound.x=Math.max(c.x,f),o.upperBound.y=Math.max(c.y,g)}else v[u++]=e.child1,v[u++]=e.child2}};J.prototype.AllocateNode=function(){if(this.m_freeList){var a=this.m_freeList;this.m_freeList=a.parent;a.parent=null;a.child1=null;a.child2=null;return a}return new I};
J.prototype.FreeNode=function(a){a.parent=this.m_freeList;this.m_freeList=a};J.prototype.InsertLeaf=function(a){++this.m_insertionCount;if(this.m_root==null)this.m_root=a,this.m_root.parent=null;else{var b=a.aabb.GetCenter(),c=this.m_root;if(c.IsLeaf()==!1){do var t=c.child1,c=c.child2,c=Math.abs((t.aabb.lowerBound.x+t.aabb.upperBound.x)/2-b.x)+Math.abs((t.aabb.lowerBound.y+t.aabb.upperBound.y)/2-b.y)<Math.abs((c.aabb.lowerBound.x+c.aabb.upperBound.x)/2-b.x)+Math.abs((c.aabb.lowerBound.y+c.aabb.upperBound.y)/
2-b.y)?t:c;while(c.IsLeaf()==!1)}b=c.parent;t=this.AllocateNode();t.parent=b;t.userData=null;t.aabb.Combine(a.aabb,c.aabb);if(b){c.parent.child1==c?b.child1=t:b.child2=t;t.child1=c;t.child2=a;c.parent=t;a.parent=t;do{if(b.aabb.Contains(t.aabb))break;b.aabb.Combine(b.child1.aabb,b.child2.aabb);t=b;b=b.parent}while(b)}else t.child1=c,t.child2=a,c.parent=t,this.m_root=a.parent=t}};J.prototype.RemoveLeaf=function(a){if(a==this.m_root)this.m_root=null;else{var b=a.parent,c=b.parent,a=b.child1==a?b.child2:
b.child1;if(c){c.child1==b?c.child1=a:c.child2=a;a.parent=c;for(this.FreeNode(b);c;){b=c.aabb;c.aabb=z.Combine(c.child1.aabb,c.child2.aabb);if(b.Contains(c.aabb))break;c=c.parent}}else this.m_root=a,a.parent=null,this.FreeNode(b)}};M.b2DynamicTreeBroadPhase=function(){this.m_tree=new J;this.m_moveBuffer=new j;this.m_pairBuffer=new j;this.m_pairCount=0};M.prototype.CreateProxy=function(a,b){var c=this.m_tree.CreateProxy(a,b);++this.m_proxyCount;this.BufferMove(c);return c};M.prototype.DestroyProxy=
function(a){this.UnBufferMove(a);--this.m_proxyCount;this.m_tree.DestroyProxy(a)};M.prototype.MoveProxy=function(a,b,c){this.m_tree.MoveProxy(a,b,c)&&this.BufferMove(a)};M.prototype.TestOverlap=function(a,b){var c=this.m_tree.GetFatAABB(a),t=this.m_tree.GetFatAABB(b);return c.TestOverlap(t)};M.prototype.GetUserData=function(a){return this.m_tree.GetUserData(a)};M.prototype.GetFatAABB=function(a){return this.m_tree.GetFatAABB(a)};M.prototype.GetProxyCount=function(){return this.m_proxyCount};M.prototype.UpdatePairs=
function(a){for(var b=this,c=b.m_pairCount=0,t,c=0;c<b.m_moveBuffer.length;++c){t=b.m_moveBuffer[c];var d=b.m_tree.GetFatAABB(t);b.m_tree.Query(function(a){if(a==t)return!0;b.m_pairCount==b.m_pairBuffer.length&&(b.m_pairBuffer[b.m_pairCount]=new C);var c=b.m_pairBuffer[b.m_pairCount];c.proxyA=a<t?a:t;c.proxyB=a>=t?a:t;++b.m_pairCount;return!0},d)}for(c=b.m_moveBuffer.length=0;c<b.m_pairCount;){var d=b.m_pairBuffer[c],r=b.m_tree.GetUserData(d.proxyA),e=b.m_tree.GetUserData(d.proxyB);a(r,e);for(++c;c<
b.m_pairCount;){r=b.m_pairBuffer[c];if(r.proxyA!=d.proxyA||r.proxyB!=d.proxyB)break;++c}}};M.prototype.Query=function(a,b){this.m_tree.Query(a,b)};M.prototype.RayCast=function(a,b){this.m_tree.RayCast(a,b)};M.prototype.Validate=function(){};M.prototype.Rebalance=function(a){a===void 0&&(a=0);this.m_tree.Rebalance(a)};M.prototype.BufferMove=function(a){this.m_moveBuffer[this.m_moveBuffer.length]=a};M.prototype.UnBufferMove=function(a){this.m_moveBuffer.splice(parseInt(this.m_moveBuffer.indexOf(a)),
1)};M.prototype.ComparePairs=function(){return 0};M.__implements={};M.__implements[H]=!0;I.b2DynamicTreeNode=function(){this.aabb=new z};I.prototype.IsLeaf=function(){return this.child1==null};C.b2DynamicTreePair=function(){};F.b2Manifold=function(){this.m_pointCount=0};F.prototype.b2Manifold=function(){this.m_points=new j(f.b2_maxManifoldPoints);for(var a=0;a<f.b2_maxManifoldPoints;a++)this.m_points[a]=new R;this.m_localPlaneNormal=new c;this.m_localPoint=new c};F.prototype.Reset=function(){for(var a=
0;a<f.b2_maxManifoldPoints;a++)(this.m_points[a]instanceof R?this.m_points[a]:null).Reset();this.m_localPlaneNormal.SetZero();this.m_localPoint.SetZero();this.m_pointCount=this.m_type=0};F.prototype.Set=function(a){this.m_pointCount=a.m_pointCount;for(var b=0;b<f.b2_maxManifoldPoints;b++)(this.m_points[b]instanceof R?this.m_points[b]:null).Set(a.m_points[b]);this.m_localPlaneNormal.SetV(a.m_localPlaneNormal);this.m_localPoint.SetV(a.m_localPoint);this.m_type=a.m_type};F.prototype.Copy=function(){var a=
new F;a.Set(this);return a};a.postDefs.push(function(){a.Collision.b2Manifold.e_circles=1;a.Collision.b2Manifold.e_faceA=2;a.Collision.b2Manifold.e_faceB=4});R.b2ManifoldPoint=function(){this.m_localPoint=new c;this.m_id=new A};R.prototype.b2ManifoldPoint=function(){this.Reset()};R.prototype.Reset=function(){this.m_localPoint.SetZero();this.m_tangentImpulse=this.m_normalImpulse=0;this.m_id.key=0};R.prototype.Set=function(a){this.m_localPoint.SetV(a.m_localPoint);this.m_normalImpulse=a.m_normalImpulse;
this.m_tangentImpulse=a.m_tangentImpulse;this.m_id.Set(a.m_id)};K.b2Point=function(){this.p=new c};K.prototype.Support=function(){return this.p};K.prototype.GetFirstVertex=function(){return this.p};N.b2RayCastInput=function(){this.p1=new c;this.p2=new c};N.prototype.b2RayCastInput=function(a,b,c){a===void 0&&(a=null);b===void 0&&(b=null);c===void 0&&(c=1);a&&this.p1.SetV(a);b&&this.p2.SetV(b);this.maxFraction=c};U.b2RayCastOutput=function(){this.normal=new c};Q.b2Segment=function(){this.p1=new c;
this.p2=new c};Q.prototype.TestSegment=function(a,b,c,t){t===void 0&&(t=0);var d=c.p1,r=c.p2.x-d.x,e=c.p2.y-d.y,c=this.p2.y-this.p1.y,o=-(this.p2.x-this.p1.x),f=100*Number.MIN_VALUE,g=-(r*c+e*o);if(g>f){var v=d.x-this.p1.x,u=d.y-this.p1.y,d=v*c+u*o;if(0<=d&&d<=t*g&&(t=-r*u+e*v,-f*g<=t&&t<=g*(1+f)))return d/=g,t=Math.sqrt(c*c+o*o),c/=t,o/=t,a[0]=d,b.Set(c,o),!0}return!1};Q.prototype.Extend=function(a){this.ExtendForward(a);this.ExtendBackward(a)};Q.prototype.ExtendForward=function(a){var b=this.p2.x-
this.p1.x,c=this.p2.y-this.p1.y,a=Math.min(b>0?(a.upperBound.x-this.p1.x)/b:b<0?(a.lowerBound.x-this.p1.x)/b:Number.POSITIVE_INFINITY,c>0?(a.upperBound.y-this.p1.y)/c:c<0?(a.lowerBound.y-this.p1.y)/c:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+b*a;this.p2.y=this.p1.y+c*a};Q.prototype.ExtendBackward=function(a){var b=-this.p2.x+this.p1.x,c=-this.p2.y+this.p1.y,a=Math.min(b>0?(a.upperBound.x-this.p2.x)/b:b<0?(a.lowerBound.x-this.p2.x)/b:Number.POSITIVE_INFINITY,c>0?(a.upperBound.y-this.p2.y)/c:c<
0?(a.lowerBound.y-this.p2.y)/c:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+b*a;this.p1.y=this.p2.y+c*a};o.b2SeparationFunction=function(){this.m_localPoint=new c;this.m_axis=new c};o.prototype.Initialize=function(a,b,t,d,r){this.m_proxyA=b;this.m_proxyB=d;var e=parseInt(a.count);f.b2Assert(0<e&&e<3);var g,v,u,H,h=H=u=d=b=0,p=0,h=0;e==1?(this.m_type=o.e_points,g=this.m_proxyA.GetVertex(a.indexA[0]),v=this.m_proxyB.GetVertex(a.indexB[0]),e=g,a=t.R,b=t.position.x+(a.col1.x*e.x+a.col2.x*e.y),d=t.position.y+
(a.col1.y*e.x+a.col2.y*e.y),e=v,a=r.R,u=r.position.x+(a.col1.x*e.x+a.col2.x*e.y),H=r.position.y+(a.col1.y*e.x+a.col2.y*e.y),this.m_axis.x=u-b,this.m_axis.y=H-d,this.m_axis.Normalize()):(a.indexB[0]==a.indexB[1]?(this.m_type=o.e_faceA,b=this.m_proxyA.GetVertex(a.indexA[0]),d=this.m_proxyA.GetVertex(a.indexA[1]),v=this.m_proxyB.GetVertex(a.indexB[0]),this.m_localPoint.x=0.5*(b.x+d.x),this.m_localPoint.y=0.5*(b.y+d.y),this.m_axis=l.CrossVF(l.SubtractVV(d,b),1),this.m_axis.Normalize(),e=this.m_axis,a=
t.R,h=a.col1.x*e.x+a.col2.x*e.y,p=a.col1.y*e.x+a.col2.y*e.y,e=this.m_localPoint,a=t.R,b=t.position.x+(a.col1.x*e.x+a.col2.x*e.y),d=t.position.y+(a.col1.y*e.x+a.col2.y*e.y),e=v,a=r.R,u=r.position.x+(a.col1.x*e.x+a.col2.x*e.y),H=r.position.y+(a.col1.y*e.x+a.col2.y*e.y),h=(u-b)*h+(H-d)*p):a.indexA[0]==a.indexA[0]?(this.m_type=o.e_faceB,u=this.m_proxyB.GetVertex(a.indexB[0]),H=this.m_proxyB.GetVertex(a.indexB[1]),g=this.m_proxyA.GetVertex(a.indexA[0]),this.m_localPoint.x=0.5*(u.x+H.x),this.m_localPoint.y=
0.5*(u.y+H.y),this.m_axis=l.CrossVF(l.SubtractVV(H,u),1),this.m_axis.Normalize(),e=this.m_axis,a=r.R,h=a.col1.x*e.x+a.col2.x*e.y,p=a.col1.y*e.x+a.col2.y*e.y,e=this.m_localPoint,a=r.R,u=r.position.x+(a.col1.x*e.x+a.col2.x*e.y),H=r.position.y+(a.col1.y*e.x+a.col2.y*e.y),e=g,a=t.R,b=t.position.x+(a.col1.x*e.x+a.col2.x*e.y),d=t.position.y+(a.col1.y*e.x+a.col2.y*e.y),h=(b-u)*h+(d-H)*p):(b=this.m_proxyA.GetVertex(a.indexA[0]),d=this.m_proxyA.GetVertex(a.indexA[1]),u=this.m_proxyB.GetVertex(a.indexB[0]),
H=this.m_proxyB.GetVertex(a.indexB[1]),l.MulX(t,g),g=l.MulMV(t.R,l.SubtractVV(d,b)),l.MulX(r,v),h=l.MulMV(r.R,l.SubtractVV(H,u)),r=g.x*g.x+g.y*g.y,v=h.x*h.x+h.y*h.y,a=l.SubtractVV(h,g),t=g.x*a.x+g.y*a.y,a=h.x*a.x+h.y*a.y,g=g.x*h.x+g.y*h.y,p=r*v-g*g,h=0,p!=0&&(h=l.Clamp((g*a-t*v)/p,0,1)),(g*h+a)/v<0&&(h=l.Clamp((g-t)/r,0,1)),g=new c,g.x=b.x+h*(d.x-b.x),g.y=b.y+h*(d.y-b.y),v=new c,v.x=u.x+h*(H.x-u.x),v.y=u.y+h*(H.y-u.y),h==0||h==1?(this.m_type=o.e_faceB,this.m_axis=l.CrossVF(l.SubtractVV(H,u),1),this.m_axis.Normalize(),
this.m_localPoint=v):(this.m_type=o.e_faceA,this.m_axis=l.CrossVF(l.SubtractVV(d,b),1),this.m_localPoint=g)),h<0&&this.m_axis.NegativeSelf())};o.prototype.Evaluate=function(a,b){var c,t,d=0;switch(this.m_type){case o.e_points:return c=l.MulTMV(a.R,this.m_axis),t=l.MulTMV(b.R,this.m_axis.GetNegative()),c=this.m_proxyA.GetSupportVertex(c),t=this.m_proxyB.GetSupportVertex(t),c=l.MulX(a,c),t=l.MulX(b,t),d=(t.x-c.x)*this.m_axis.x+(t.y-c.y)*this.m_axis.y;case o.e_faceA:return d=l.MulMV(a.R,this.m_axis),
c=l.MulX(a,this.m_localPoint),t=l.MulTMV(b.R,d.GetNegative()),t=this.m_proxyB.GetSupportVertex(t),t=l.MulX(b,t),d=(t.x-c.x)*d.x+(t.y-c.y)*d.y;case o.e_faceB:return d=l.MulMV(b.R,this.m_axis),t=l.MulX(b,this.m_localPoint),c=l.MulTMV(a.R,d.GetNegative()),c=this.m_proxyA.GetSupportVertex(c),c=l.MulX(a,c),d=(c.x-t.x)*d.x+(c.y-t.y)*d.y;default:return f.b2Assert(!1),0}};a.postDefs.push(function(){a.Collision.b2SeparationFunction.e_points=1;a.Collision.b2SeparationFunction.e_faceA=2;a.Collision.b2SeparationFunction.e_faceB=
4});u.b2Simplex=function(){this.m_v1=new v;this.m_v2=new v;this.m_v3=new v;this.m_vertices=new j(3)};u.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};u.prototype.ReadCache=function(a,b,c,t,d){f.b2Assert(0<=a.count&&a.count<=3);var r,e;this.m_count=a.count;for(var o=this.m_vertices,g=0;g<this.m_count;g++){var v=o[g];v.indexA=a.indexA[g];v.indexB=a.indexB[g];r=b.GetVertex(v.indexA);e=t.GetVertex(v.indexB);v.wA=l.MulX(c,r);v.wB=
l.MulX(d,e);v.w=l.SubtractVV(v.wB,v.wA);v.a=0}if(this.m_count>1&&(a=a.metric,r=this.GetMetric(),r<0.5*a||2*a<r||r<Number.MIN_VALUE))this.m_count=0;if(this.m_count==0)v=o[0],v.indexA=0,v.indexB=0,r=b.GetVertex(0),e=t.GetVertex(0),v.wA=l.MulX(c,r),v.wB=l.MulX(d,e),v.w=l.SubtractVV(v.wB,v.wA),this.m_count=1};u.prototype.WriteCache=function(b){b.metric=this.GetMetric();b.count=a.parseUInt(this.m_count);for(var c=this.m_vertices,t=0;t<this.m_count;t++)b.indexA[t]=a.parseUInt(c[t].indexA),b.indexB[t]=a.parseUInt(c[t].indexB)};
u.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var a=l.SubtractVV(this.m_v2.w,this.m_v1.w);return l.CrossVV(a,this.m_v1.w.GetNegative())>0?l.CrossFV(1,a):l.CrossVF(a,1);default:return f.b2Assert(!1),new c}};u.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return f.b2Assert(!1),new c;case 1:return this.m_v1.w;case 2:return new c(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*
this.m_v2.w.y);default:return f.b2Assert(!1),new c}};u.prototype.GetWitnessPoints=function(a,b){switch(this.m_count){case 0:f.b2Assert(!1);break;case 1:a.SetV(this.m_v1.wA);b.SetV(this.m_v1.wB);break;case 2:a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;b.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;b.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:b.x=a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+
this.m_v3.a*this.m_v3.wA.x;b.y=a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:f.b2Assert(!1)}};u.prototype.GetMetric=function(){switch(this.m_count){case 0:return f.b2Assert(!1),0;case 1:return 0;case 2:return l.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return l.CrossVV(l.SubtractVV(this.m_v2.w,this.m_v1.w),l.SubtractVV(this.m_v3.w,this.m_v1.w));default:return f.b2Assert(!1),0}};u.prototype.Solve2=function(){var a=this.m_v1.w,b=this.m_v2.w,
c=l.SubtractVV(b,a),a=-(a.x*c.x+a.y*c.y);a<=0?this.m_count=this.m_v1.a=1:(b=b.x*c.x+b.y*c.y,b<=0?(this.m_count=this.m_v2.a=1,this.m_v1.Set(this.m_v2)):(c=1/(b+a),this.m_v1.a=b*c,this.m_v2.a=a*c,this.m_count=2))};u.prototype.Solve3=function(){var a=this.m_v1.w,b=this.m_v2.w,c=this.m_v3.w,t=l.SubtractVV(b,a),d=l.Dot(a,t),r=l.Dot(b,t),d=-d,e=l.SubtractVV(c,a),o=l.Dot(a,e),f=l.Dot(c,e),o=-o,g=l.SubtractVV(c,b),v=l.Dot(b,g),g=l.Dot(c,g),v=-v,e=l.CrossVV(t,e),t=e*l.CrossVV(b,c),c=e*l.CrossVV(c,a),a=e*l.CrossVV(a,
b);d<=0&&o<=0?this.m_count=this.m_v1.a=1:r>0&&d>0&&a<=0?(f=1/(r+d),this.m_v1.a=r*f,this.m_v2.a=d*f,this.m_count=2):f>0&&o>0&&c<=0?(r=1/(f+o),this.m_v1.a=f*r,this.m_v3.a=o*r,this.m_count=2,this.m_v2.Set(this.m_v3)):r<=0&&v<=0?(this.m_count=this.m_v2.a=1,this.m_v1.Set(this.m_v2)):f<=0&&g<=0?(this.m_count=this.m_v3.a=1,this.m_v1.Set(this.m_v3)):g>0&&v>0&&t<=0?(r=1/(g+v),this.m_v2.a=g*r,this.m_v3.a=v*r,this.m_count=2,this.m_v1.Set(this.m_v3)):(r=1/(t+c+a),this.m_v1.a=t*r,this.m_v2.a=c*r,this.m_v3.a=a*
r,this.m_count=3)};E.b2SimplexCache=function(){this.indexA=new m(3);this.indexB=new m(3)};v.b2SimplexVertex=function(){};v.prototype.Set=function(a){this.wA.SetV(a.wA);this.wB.SetV(a.wB);this.w.SetV(a.w);this.a=a.a;this.indexA=a.indexA;this.indexB=a.indexB};O.b2TimeOfImpact=function(){};O.TimeOfImpact=function(a){++O.b2_toiCalls;var b=a.proxyA,c=a.proxyB,t=a.sweepA,d=a.sweepB;f.b2Assert(t.t0==d.t0);f.b2Assert(1-t.t0>Number.MIN_VALUE);var r=b.m_radius+c.m_radius,a=a.tolerance,e=0,o=0,g=0;O.s_cache.count=
0;for(O.s_distanceInput.useRadii=!1;;){t.GetTransform(O.s_xfA,e);d.GetTransform(O.s_xfB,e);O.s_distanceInput.proxyA=b;O.s_distanceInput.proxyB=c;O.s_distanceInput.transformA=O.s_xfA;O.s_distanceInput.transformB=O.s_xfB;y.Distance(O.s_distanceOutput,O.s_cache,O.s_distanceInput);if(O.s_distanceOutput.distance<=0){e=1;break}O.s_fcn.Initialize(O.s_cache,b,O.s_xfA,c,O.s_xfB);var v=O.s_fcn.Evaluate(O.s_xfA,O.s_xfB);if(v<=0){e=1;break}o==0&&(g=v>r?l.Max(r-a,0.75*r):l.Max(v-a,0.02*r));if(v-g<0.5*a){if(o==
0){e=1;break}break}var u=e,H=e,h=1;t.GetTransform(O.s_xfA,h);d.GetTransform(O.s_xfB,h);var p=O.s_fcn.Evaluate(O.s_xfA,O.s_xfB);if(p>=g){e=1;break}for(var E=0;;){var j=0,j=E&1?H+(g-v)*(h-H)/(p-v):0.5*(H+h);t.GetTransform(O.s_xfA,j);d.GetTransform(O.s_xfB,j);var S=O.s_fcn.Evaluate(O.s_xfA,O.s_xfB);if(l.Abs(S-g)<0.025*a){u=j;break}S>g?(H=j,v=S):(h=j,p=S);++E;++O.b2_toiRootIters;if(E==50)break}O.b2_toiMaxRootIters=l.Max(O.b2_toiMaxRootIters,E);if(u<(1+100*Number.MIN_VALUE)*e)break;e=u;o++;++O.b2_toiIters;
if(o==1E3)break}O.b2_toiMaxIters=l.Max(O.b2_toiMaxIters,o);return e};a.postDefs.push(function(){a.Collision.b2TimeOfImpact.b2_toiCalls=0;a.Collision.b2TimeOfImpact.b2_toiIters=0;a.Collision.b2TimeOfImpact.b2_toiMaxIters=0;a.Collision.b2TimeOfImpact.b2_toiRootIters=0;a.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0;a.Collision.b2TimeOfImpact.s_cache=new E;a.Collision.b2TimeOfImpact.s_distanceInput=new G;a.Collision.b2TimeOfImpact.s_xfA=new q;a.Collision.b2TimeOfImpact.s_xfB=new q;a.Collision.b2TimeOfImpact.s_fcn=
new o;a.Collision.b2TimeOfImpact.s_distanceOutput=new p});V.b2TOIInput=function(){this.proxyA=new L;this.proxyB=new L;this.sweepA=new h;this.sweepB=new h};S.b2WorldManifold=function(){this.m_normal=new c};S.prototype.b2WorldManifold=function(){this.m_points=new j(f.b2_maxManifoldPoints);for(var a=0;a<f.b2_maxManifoldPoints;a++)this.m_points[a]=new c};S.prototype.Initialize=function(a,b,c,t,d){c===void 0&&(c=0);d===void 0&&(d=0);if(a.m_pointCount!=0){var r=0,e,o,f=0,g=0,v=0,u=0,H=0;e=0;switch(a.m_type){case F.e_circles:o=
b.R;e=a.m_localPoint;r=b.position.x+o.col1.x*e.x+o.col2.x*e.y;b=b.position.y+o.col1.y*e.x+o.col2.y*e.y;o=t.R;e=a.m_points[0].m_localPoint;a=t.position.x+o.col1.x*e.x+o.col2.x*e.y;t=t.position.y+o.col1.y*e.x+o.col2.y*e.y;e=a-r;o=t-b;f=e*e+o*o;f>Number.MIN_VALUE*Number.MIN_VALUE?(f=Math.sqrt(f),this.m_normal.x=e/f,this.m_normal.y=o/f):(this.m_normal.x=1,this.m_normal.y=0);e=b+c*this.m_normal.y;t-=d*this.m_normal.y;this.m_points[0].x=0.5*(r+c*this.m_normal.x+(a-d*this.m_normal.x));this.m_points[0].y=
0.5*(e+t);break;case F.e_faceA:o=b.R;e=a.m_localPlaneNormal;f=o.col1.x*e.x+o.col2.x*e.y;g=o.col1.y*e.x+o.col2.y*e.y;o=b.R;e=a.m_localPoint;v=b.position.x+o.col1.x*e.x+o.col2.x*e.y;u=b.position.y+o.col1.y*e.x+o.col2.y*e.y;this.m_normal.x=f;this.m_normal.y=g;for(r=0;r<a.m_pointCount;r++)o=t.R,e=a.m_points[r].m_localPoint,H=t.position.x+o.col1.x*e.x+o.col2.x*e.y,e=t.position.y+o.col1.y*e.x+o.col2.y*e.y,this.m_points[r].x=H+0.5*(c-(H-v)*f-(e-u)*g-d)*f,this.m_points[r].y=e+0.5*(c-(H-v)*f-(e-u)*g-d)*g;
break;case F.e_faceB:o=t.R;e=a.m_localPlaneNormal;f=o.col1.x*e.x+o.col2.x*e.y;g=o.col1.y*e.x+o.col2.y*e.y;o=t.R;e=a.m_localPoint;v=t.position.x+o.col1.x*e.x+o.col2.x*e.y;u=t.position.y+o.col1.y*e.x+o.col2.y*e.y;this.m_normal.x=-f;this.m_normal.y=-g;for(r=0;r<a.m_pointCount;r++)o=b.R,e=a.m_points[r].m_localPoint,H=b.position.x+o.col1.x*e.x+o.col2.x*e.y,e=b.position.y+o.col1.y*e.x+o.col2.y*e.y,this.m_points[r].x=H+0.5*(d-(H-v)*f-(e-u)*g-c)*f,this.m_points[r].y=e+0.5*(d-(H-v)*f-(e-u)*g-c)*g}}};t.ClipVertex=
function(){this.v=new c;this.id=new A};t.prototype.Set=function(a){this.v.SetV(a.v);this.id.Set(a.id)};r.Features=function(){};Object.defineProperty(r.prototype,"referenceEdge",{enumerable:!1,configurable:!0,get:function(){return this._referenceEdge}});Object.defineProperty(r.prototype,"referenceEdge",{enumerable:!1,configurable:!0,set:function(a){a===void 0&&(a=0);this._referenceEdge=a;this._m_id._key=this._m_id._key&4294967040|this._referenceEdge&255}});Object.defineProperty(r.prototype,"incidentEdge",
{enumerable:!1,configurable:!0,get:function(){return this._incidentEdge}});Object.defineProperty(r.prototype,"incidentEdge",{enumerable:!1,configurable:!0,set:function(a){a===void 0&&(a=0);this._incidentEdge=a;this._m_id._key=this._m_id._key&4294902015|this._incidentEdge<<8&65280}});Object.defineProperty(r.prototype,"incidentVertex",{enumerable:!1,configurable:!0,get:function(){return this._incidentVertex}});Object.defineProperty(r.prototype,"incidentVertex",{enumerable:!1,configurable:!0,set:function(a){a===
void 0&&(a=0);this._incidentVertex=a;this._m_id._key=this._m_id._key&4278255615|this._incidentVertex<<16&16711680}});Object.defineProperty(r.prototype,"flip",{enumerable:!1,configurable:!0,get:function(){return this._flip}});Object.defineProperty(r.prototype,"flip",{enumerable:!1,configurable:!0,set:function(a){a===void 0&&(a=0);this._flip=a;this._m_id._key=this._m_id._key&16777215|this._flip<<24&4278190080}})})();(function(){var b=a.Common.b2Settings,e=a.Collision.Shapes.b2CircleShape,d=a.Collision.Shapes.b2EdgeChainDef,
f=a.Collision.Shapes.b2EdgeShape,l=a.Collision.Shapes.b2MassData,h=a.Collision.Shapes.b2PolygonShape,q=a.Collision.Shapes.b2Shape,c=a.Common.Math.b2Mat22,z=a.Common.Math.b2Math,n=a.Common.Math.b2Transform,k=a.Common.Math.b2Vec2,B=a.Collision.b2Distance,A=a.Collision.b2DistanceInput,w=a.Collision.b2DistanceOutput,y=a.Collision.b2DistanceProxy,G=a.Collision.b2SimplexCache;a.inherit(e,a.Collision.Shapes.b2Shape);e.prototype.__super=a.Collision.Shapes.b2Shape.prototype;e.b2CircleShape=function(){a.Collision.Shapes.b2Shape.b2Shape.apply(this,
arguments);this.m_p=new k};e.prototype.Copy=function(){var a=new e;a.Set(this);return a};e.prototype.Set=function(b){this.__super.Set.call(this,b);a.is(b,e)&&this.m_p.SetV((b instanceof e?b:null).m_p)};e.prototype.TestPoint=function(a,b){var c=a.R,d=a.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),c=a.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y),d=b.x-d,c=b.y-c;return d*d+c*c<=this.m_radius*this.m_radius};e.prototype.RayCast=function(a,b,c){var d=c.R,e=b.p1.x-(c.position.x+(d.col1.x*
this.m_p.x+d.col2.x*this.m_p.y)),c=b.p1.y-(c.position.y+(d.col1.y*this.m_p.x+d.col2.y*this.m_p.y)),d=b.p2.x-b.p1.x,f=b.p2.y-b.p1.y,g=e*d+c*f,h=d*d+f*f,l=g*g-h*(e*e+c*c-this.m_radius*this.m_radius);if(l<0||h<Number.MIN_VALUE)return!1;g=-(g+Math.sqrt(l));if(0<=g&&g<=b.maxFraction*h)return g/=h,a.fraction=g,a.normal.x=e+g*d,a.normal.y=c+g*f,a.normal.Normalize(),!0;return!1};e.prototype.ComputeAABB=function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),c=b.position.y+(c.col1.y*
this.m_p.x+c.col2.y*this.m_p.y);a.lowerBound.Set(d-this.m_radius,c-this.m_radius);a.upperBound.Set(d+this.m_radius,c+this.m_radius)};e.prototype.ComputeMass=function(a,c){c===void 0&&(c=0);a.mass=c*b.b2_pi*this.m_radius*this.m_radius;a.center.SetV(this.m_p);a.I=a.mass*(0.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))};e.prototype.ComputeSubmergedArea=function(a,b,c,d){b===void 0&&(b=0);var c=z.MulX(c,this.m_p),e=-(z.Dot(a,c)-b);if(e<-this.m_radius+Number.MIN_VALUE)return 0;
if(e>this.m_radius)return d.SetV(c),Math.PI*this.m_radius*this.m_radius;var b=this.m_radius*this.m_radius,f=e*e,e=b*(Math.asin(e/this.m_radius)+Math.PI/2)+e*Math.sqrt(b-f),b=-2/3*Math.pow(b-f,1.5)/e;d.x=c.x+a.x*b;d.y=c.y+a.y*b;return e};e.prototype.GetLocalPosition=function(){return this.m_p};e.prototype.SetLocalPosition=function(a){this.m_p.SetV(a)};e.prototype.GetRadius=function(){return this.m_radius};e.prototype.SetRadius=function(a){a===void 0&&(a=0);this.m_radius=a};e.prototype.b2CircleShape=
function(a){a===void 0&&(a=0);this.__super.b2Shape.call(this);this.m_type=q.e_circleShape;this.m_radius=a};d.b2EdgeChainDef=function(){};d.prototype.b2EdgeChainDef=function(){this.vertexCount=0;this.isALoop=!0;this.vertices=[]};a.inherit(f,a.Collision.Shapes.b2Shape);f.prototype.__super=a.Collision.Shapes.b2Shape.prototype;f.b2EdgeShape=function(){a.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);this.s_supportVec=new k;this.m_v1=new k;this.m_v2=new k;this.m_coreV1=new k;this.m_coreV2=new k;
this.m_normal=new k;this.m_direction=new k;this.m_cornerDir1=new k;this.m_cornerDir2=new k};f.prototype.TestPoint=function(){return!1};f.prototype.RayCast=function(a,b,c){var d,e=b.p2.x-b.p1.x,f=b.p2.y-b.p1.y;d=c.R;var g=c.position.x+(d.col1.x*this.m_v1.x+d.col2.x*this.m_v1.y),h=c.position.y+(d.col1.y*this.m_v1.x+d.col2.y*this.m_v1.y),l=c.position.y+(d.col1.y*this.m_v2.x+d.col2.y*this.m_v2.y)-h,c=-(c.position.x+(d.col1.x*this.m_v2.x+d.col2.x*this.m_v2.y)-g);d=100*Number.MIN_VALUE;var j=-(e*l+f*c);
if(j>d){var g=b.p1.x-g,z=b.p1.y-h,h=g*l+z*c;if(0<=h&&h<=b.maxFraction*j&&(b=-e*z+f*g,-d*j<=b&&b<=j*(1+d)))return h/=j,a.fraction=h,b=Math.sqrt(l*l+c*c),a.normal.x=l/b,a.normal.y=c/b,!0}return!1};f.prototype.ComputeAABB=function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_v1.x+c.col2.x*this.m_v1.y),e=b.position.y+(c.col1.y*this.m_v1.x+c.col2.y*this.m_v1.y),f=b.position.x+(c.col1.x*this.m_v2.x+c.col2.x*this.m_v2.y),c=b.position.y+(c.col1.y*this.m_v2.x+c.col2.y*this.m_v2.y);d<f?(a.lowerBound.x=d,
a.upperBound.x=f):(a.lowerBound.x=f,a.upperBound.x=d);e<c?(a.lowerBound.y=e,a.upperBound.y=c):(a.lowerBound.y=c,a.upperBound.y=e)};f.prototype.ComputeMass=function(a){a.mass=0;a.center.SetV(this.m_v1);a.I=0};f.prototype.ComputeSubmergedArea=function(a,b,c,d){b===void 0&&(b=0);var e=new k(a.x*b,a.y*b),f=z.MulX(c,this.m_v1),c=z.MulX(c,this.m_v2),g=z.Dot(a,f)-b,a=z.Dot(a,c)-b;if(g>0)if(a>0)return 0;else f.x=-a/(g-a)*f.x+g/(g-a)*c.x,f.y=-a/(g-a)*f.y+g/(g-a)*c.y;else if(a>0)c.x=-a/(g-a)*f.x+g/(g-a)*c.x,
c.y=-a/(g-a)*f.y+g/(g-a)*c.y;d.x=(e.x+f.x+c.x)/3;d.y=(e.y+f.y+c.y)/3;return 0.5*((f.x-e.x)*(c.y-e.y)-(f.y-e.y)*(c.x-e.x))};f.prototype.GetLength=function(){return this.m_length};f.prototype.GetVertex1=function(){return this.m_v1};f.prototype.GetVertex2=function(){return this.m_v2};f.prototype.GetCoreVertex1=function(){return this.m_coreV1};f.prototype.GetCoreVertex2=function(){return this.m_coreV2};f.prototype.GetNormalVector=function(){return this.m_normal};f.prototype.GetDirectionVector=function(){return this.m_direction};
f.prototype.GetCorner1Vector=function(){return this.m_cornerDir1};f.prototype.GetCorner2Vector=function(){return this.m_cornerDir2};f.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1};f.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2};f.prototype.GetFirstVertex=function(a){var b=a.R;return new k(a.position.x+(b.col1.x*this.m_coreV1.x+b.col2.x*this.m_coreV1.y),a.position.y+(b.col1.y*this.m_coreV1.x+b.col2.y*this.m_coreV1.y))};f.prototype.GetNextEdge=function(){return this.m_nextEdge};
f.prototype.GetPrevEdge=function(){return this.m_prevEdge};f.prototype.Support=function(a,b,c){b===void 0&&(b=0);c===void 0&&(c=0);var d=a.R,e=a.position.x+(d.col1.x*this.m_coreV1.x+d.col2.x*this.m_coreV1.y),f=a.position.y+(d.col1.y*this.m_coreV1.x+d.col2.y*this.m_coreV1.y),g=a.position.x+(d.col1.x*this.m_coreV2.x+d.col2.x*this.m_coreV2.y),a=a.position.y+(d.col1.y*this.m_coreV2.x+d.col2.y*this.m_coreV2.y);e*b+f*c>g*b+a*c?(this.s_supportVec.x=e,this.s_supportVec.y=f):(this.s_supportVec.x=g,this.s_supportVec.y=
a);return this.s_supportVec};f.prototype.b2EdgeShape=function(a,c){this.__super.b2Shape.call(this);this.m_type=q.e_edgeShape;this.m_nextEdge=this.m_prevEdge=null;this.m_v1=a;this.m_v2=c;this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y);this.m_length=this.m_direction.Normalize();this.m_normal.Set(this.m_direction.y,-this.m_direction.x);this.m_coreV1.Set(-b.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-b.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y);
this.m_coreV2.Set(-b.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-b.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y);this.m_cornerDir1=this.m_normal;this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)};f.prototype.SetPrevEdge=function(a,b,c,d){this.m_prevEdge=a;this.m_coreV1=b;this.m_cornerDir1=c;this.m_cornerConvex1=d};f.prototype.SetNextEdge=function(a,b,c,d){this.m_nextEdge=a;this.m_coreV2=b;this.m_cornerDir2=c;this.m_cornerConvex2=d};l.b2MassData=function(){this.mass=
0;this.center=new k(0,0);this.I=0};a.inherit(h,a.Collision.Shapes.b2Shape);h.prototype.__super=a.Collision.Shapes.b2Shape.prototype;h.b2PolygonShape=function(){a.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)};h.prototype.Copy=function(){var a=new h;a.Set(this);return a};h.prototype.Set=function(b){this.__super.Set.call(this,b);if(a.is(b,h)){b=b instanceof h?b:null;this.m_centroid.SetV(b.m_centroid);this.m_vertexCount=b.m_vertexCount;this.Reserve(this.m_vertexCount);for(var c=0;c<this.m_vertexCount;c++)this.m_vertices[c].SetV(b.m_vertices[c]),
this.m_normals[c].SetV(b.m_normals[c])}};h.prototype.SetAsArray=function(a,b){b===void 0&&(b=0);for(var c=new j,d=0,e,d=0;d<a.length;++d)e=a[d],c.push(e);this.SetAsVector(c,b)};h.AsArray=function(a,b){b===void 0&&(b=0);var c=new h;c.SetAsArray(a,b);return c};h.prototype.SetAsVector=function(a,c){c===void 0&&(c=0);if(c==0)c=a.length;b.b2Assert(2<=c);this.m_vertexCount=c;this.Reserve(c);for(var d=0,d=0;d<this.m_vertexCount;d++)this.m_vertices[d].SetV(a[d]);for(d=0;d<this.m_vertexCount;++d){var e=parseInt(d),
f=parseInt(d+1<this.m_vertexCount?d+1:0),e=z.SubtractVV(this.m_vertices[f],this.m_vertices[e]);b.b2Assert(e.LengthSquared()>Number.MIN_VALUE);this.m_normals[d].SetV(z.CrossVF(e,1));this.m_normals[d].Normalize()}this.m_centroid=h.ComputeCentroid(this.m_vertices,this.m_vertexCount)};h.AsVector=function(a,b){b===void 0&&(b=0);var c=new h;c.SetAsVector(a,b);return c};h.prototype.SetAsBox=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set(-a,-b);
this.m_vertices[1].Set(a,-b);this.m_vertices[2].Set(a,b);this.m_vertices[3].Set(-a,b);this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,0);this.m_centroid.SetZero()};h.AsBox=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);var c=new h;c.SetAsBox(a,b);return c};h.prototype.SetAsOrientedBox=function(a,b,c,d){a===void 0&&(a=0);b===void 0&&(b=0);c===void 0&&(c=null);d===void 0&&(d=0);this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set(-a,
-b);this.m_vertices[1].Set(a,-b);this.m_vertices[2].Set(a,b);this.m_vertices[3].Set(-a,b);this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,0);this.m_centroid=c;a=new n;a.position=c;a.R.Set(d);for(c=0;c<this.m_vertexCount;++c)this.m_vertices[c]=z.MulX(a,this.m_vertices[c]),this.m_normals[c]=z.MulMV(a.R,this.m_normals[c])};h.AsOrientedBox=function(a,b,c,d){a===void 0&&(a=0);b===void 0&&(b=0);c===void 0&&(c=null);d===void 0&&(d=0);var e=new h;
e.SetAsOrientedBox(a,b,c,d);return e};h.prototype.SetAsEdge=function(a,b){this.m_vertexCount=2;this.Reserve(2);this.m_vertices[0].SetV(a);this.m_vertices[1].SetV(b);this.m_centroid.x=0.5*(a.x+b.x);this.m_centroid.y=0.5*(a.y+b.y);this.m_normals[0]=z.CrossVF(z.SubtractVV(b,a),1);this.m_normals[0].Normalize();this.m_normals[1].x=-this.m_normals[0].x;this.m_normals[1].y=-this.m_normals[0].y};h.AsEdge=function(a,b){var c=new h;c.SetAsEdge(a,b);return c};h.prototype.TestPoint=function(a,b){var c;c=a.R;
for(var d=b.x-a.position.x,e=b.y-a.position.y,f=d*c.col1.x+e*c.col1.y,g=d*c.col2.x+e*c.col2.y,h=0;h<this.m_vertexCount;++h)if(c=this.m_vertices[h],d=f-c.x,e=g-c.y,c=this.m_normals[h],c.x*d+c.y*e>0)return!1;return!0};h.prototype.RayCast=function(a,b,c){var d=0,e=b.maxFraction,f=0,g=0,h,l,f=b.p1.x-c.position.x,g=b.p1.y-c.position.y;h=c.R;var j=f*h.col1.x+g*h.col1.y,z=f*h.col2.x+g*h.col2.y,f=b.p2.x-c.position.x,g=b.p2.y-c.position.y;h=c.R;b=f*h.col1.x+g*h.col1.y-j;h=f*h.col2.x+g*h.col2.y-z;for(var q=
parseInt(-1),o=0;o<this.m_vertexCount;++o){l=this.m_vertices[o];f=l.x-j;g=l.y-z;l=this.m_normals[o];f=l.x*f+l.y*g;g=l.x*b+l.y*h;if(g==0){if(f<0)return!1}else g<0&&f<d*g?(d=f/g,q=o):g>0&&f<e*g&&(e=f/g);if(e<d-Number.MIN_VALUE)return!1}if(q>=0)return a.fraction=d,h=c.R,l=this.m_normals[q],a.normal.x=h.col1.x*l.x+h.col2.x*l.y,a.normal.y=h.col1.y*l.x+h.col2.y*l.y,!0;return!1};h.prototype.ComputeAABB=function(a,b){for(var c=b.R,d=this.m_vertices[0],e=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),f=b.position.y+
(c.col1.y*d.x+c.col2.y*d.y),g=e,h=f,l=1;l<this.m_vertexCount;++l)var d=this.m_vertices[l],j=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),d=b.position.y+(c.col1.y*d.x+c.col2.y*d.y),e=e<j?e:j,f=f<d?f:d,g=g>j?g:j,h=h>d?h:d;a.lowerBound.x=e-this.m_radius;a.lowerBound.y=f-this.m_radius;a.upperBound.x=g+this.m_radius;a.upperBound.y=h+this.m_radius};h.prototype.ComputeMass=function(a,b){b===void 0&&(b=0);if(this.m_vertexCount==2)a.center.x=0.5*(this.m_vertices[0].x+this.m_vertices[1].x),a.center.y=0.5*(this.m_vertices[0].y+
this.m_vertices[1].y),a.mass=0,a.I=0;else{for(var c=0,d=0,e=0,f=0,g=1/3,h=0;h<this.m_vertexCount;++h){var l=this.m_vertices[h],j=h+1<this.m_vertexCount?this.m_vertices[parseInt(h+1)]:this.m_vertices[0],z=l.x-0,q=l.y-0,o=j.x-0,u=j.y-0,E=z*u-q*o,v=0.5*E;e+=v;c+=v*g*(0+l.x+j.x);d+=v*g*(0+l.y+j.y);l=z;f+=E*(g*(0.25*(l*l+o*l+o*o)+(0*l+0*o))+0+(g*(0.25*(q*q+u*q+u*u)+(0*q+0*u))+0))}a.mass=b*e;c*=1/e;d*=1/e;a.center.Set(c,d);a.I=b*f}};h.prototype.ComputeSubmergedArea=function(a,b,c,d){b===void 0&&(b=0);for(var e=
z.MulTMV(c.R,a),f=b-z.Dot(a,c.position),g=new m,h=0,j=parseInt(-1),b=parseInt(-1),q=!1,a=a=0;a<this.m_vertexCount;++a){g[a]=z.Dot(e,this.m_vertices[a])-f;var n=g[a]<-Number.MIN_VALUE;a>0&&(n?q||(j=a-1,h++):q&&(b=a-1,h++));q=n}switch(h){case 0:return q?(a=new l,this.ComputeMass(a,1),d.SetV(z.MulX(c,a.center)),a.mass):0;case 1:j==-1?j=this.m_vertexCount-1:b=this.m_vertexCount-1}a=parseInt((j+1)%this.m_vertexCount);e=parseInt((b+1)%this.m_vertexCount);f=(0-g[j])/(g[a]-g[j]);g=(0-g[b])/(g[e]-g[b]);j=
new k(this.m_vertices[j].x*(1-f)+this.m_vertices[a].x*f,this.m_vertices[j].y*(1-f)+this.m_vertices[a].y*f);b=new k(this.m_vertices[b].x*(1-g)+this.m_vertices[e].x*g,this.m_vertices[b].y*(1-g)+this.m_vertices[e].y*g);g=0;f=new k;for(h=this.m_vertices[a];a!=e;)a=(a+1)%this.m_vertexCount,q=a==e?b:this.m_vertices[a],n=0.5*((h.x-j.x)*(q.y-j.y)-(h.y-j.y)*(q.x-j.x)),g+=n,f.x+=n*(j.x+h.x+q.x)/3,f.y+=n*(j.y+h.y+q.y)/3,h=q;f.Multiply(1/g);d.SetV(z.MulX(c,f));return g};h.prototype.GetVertexCount=function(){return this.m_vertexCount};
h.prototype.GetVertices=function(){return this.m_vertices};h.prototype.GetNormals=function(){return this.m_normals};h.prototype.GetSupport=function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1;d<this.m_vertexCount;++d){var e=this.m_vertices[d].x*a.x+this.m_vertices[d].y*a.y;e>c&&(b=d,c=e)}return b};h.prototype.GetSupportVertex=function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1;d<this.m_vertexCount;++d){var e=this.m_vertices[d].x*a.x+this.m_vertices[d].y*
a.y;e>c&&(b=d,c=e)}return this.m_vertices[b]};h.prototype.Validate=function(){return!1};h.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this);this.m_type=q.e_polygonShape;this.m_centroid=new k;this.m_vertices=new j;this.m_normals=new j};h.prototype.Reserve=function(a){a===void 0&&(a=0);for(var b=parseInt(this.m_vertices.length);b<a;b++)this.m_vertices[b]=new k,this.m_normals[b]=new k};h.ComputeCentroid=function(a,b){b===void 0&&(b=0);for(var c=new k,d=0,e=1/3,f=0;f<b;++f){var g=a[f],
h=f+1<b?a[parseInt(f+1)]:a[0],l=0.5*((g.x-0)*(h.y-0)-(g.y-0)*(h.x-0));d+=l;c.x+=l*e*(0+g.x+h.x);c.y+=l*e*(0+g.y+h.y)}c.x*=1/d;c.y*=1/d;return c};h.ComputeOBB=function(a,b,c){c===void 0&&(c=0);for(var d=0,e=new j(c+1),d=0;d<c;++d)e[d]=b[d];e[c]=e[0];b=Number.MAX_VALUE;for(d=1;d<=c;++d){var f=e[parseInt(d-1)],g=e[d].x-f.x,h=e[d].y-f.y,l=Math.sqrt(g*g+h*h);g/=l;h/=l;for(var z=-h,q=g,m=l=Number.MAX_VALUE,o=-Number.MAX_VALUE,u=-Number.MAX_VALUE,E=0;E<c;++E){var v=e[E].x-f.x,O=e[E].y-f.y,V=g*v+h*O,v=z*
v+q*O;V<l&&(l=V);v<m&&(m=v);V>o&&(o=V);v>u&&(u=v)}E=(o-l)*(u-m);if(E<0.95*b)b=E,a.R.col1.x=g,a.R.col1.y=h,a.R.col2.x=z,a.R.col2.y=q,g=0.5*(l+o),h=0.5*(m+u),z=a.R,a.center.x=f.x+(z.col1.x*g+z.col2.x*h),a.center.y=f.y+(z.col1.y*g+z.col2.y*h),a.extents.x=0.5*(o-l),a.extents.y=0.5*(u-m)}};a.postDefs.push(function(){a.Collision.Shapes.b2PolygonShape.s_mat=new c});q.b2Shape=function(){};q.prototype.Copy=function(){return null};q.prototype.Set=function(a){this.m_radius=a.m_radius};q.prototype.GetType=function(){return this.m_type};
q.prototype.TestPoint=function(){return!1};q.prototype.RayCast=function(){return!1};q.prototype.ComputeAABB=function(){};q.prototype.ComputeMass=function(){};q.prototype.ComputeSubmergedArea=function(){return 0};q.TestOverlap=function(a,b,c,d){var e=new A;e.proxyA=new y;e.proxyA.Set(a);e.proxyB=new y;e.proxyB.Set(c);e.transformA=b;e.transformB=d;e.useRadii=!0;a=new G;a.count=0;b=new w;B.Distance(b,a,e);return b.distance<10*Number.MIN_VALUE};q.prototype.b2Shape=function(){this.m_type=q.e_unknownShape;
this.m_radius=b.b2_linearSlop};a.postDefs.push(function(){a.Collision.Shapes.b2Shape.e_unknownShape=parseInt(-1);a.Collision.Shapes.b2Shape.e_circleShape=0;a.Collision.Shapes.b2Shape.e_polygonShape=1;a.Collision.Shapes.b2Shape.e_edgeShape=2;a.Collision.Shapes.b2Shape.e_shapeTypeCount=3;a.Collision.Shapes.b2Shape.e_hitCollide=1;a.Collision.Shapes.b2Shape.e_missCollide=0;a.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt(-1)})})();(function(){var b=a.Common.b2Color,e=a.Common.b2Settings,d=a.Common.Math.b2Math;
b.b2Color=function(){this._b=this._g=this._r=0};b.prototype.b2Color=function(b,e,g){b===void 0&&(b=0);e===void 0&&(e=0);g===void 0&&(g=0);this._r=a.parseUInt(255*d.Clamp(b,0,1));this._g=a.parseUInt(255*d.Clamp(e,0,1));this._b=a.parseUInt(255*d.Clamp(g,0,1))};b.prototype.Set=function(b,e,g){b===void 0&&(b=0);e===void 0&&(e=0);g===void 0&&(g=0);this._r=a.parseUInt(255*d.Clamp(b,0,1));this._g=a.parseUInt(255*d.Clamp(e,0,1));this._b=a.parseUInt(255*d.Clamp(g,0,1))};Object.defineProperty(b.prototype,"r",
{enumerable:!1,configurable:!0,set:function(b){b===void 0&&(b=0);this._r=a.parseUInt(255*d.Clamp(b,0,1))}});Object.defineProperty(b.prototype,"g",{enumerable:!1,configurable:!0,set:function(b){b===void 0&&(b=0);this._g=a.parseUInt(255*d.Clamp(b,0,1))}});Object.defineProperty(b.prototype,"b",{enumerable:!1,configurable:!0,set:function(b){b===void 0&&(b=0);this._b=a.parseUInt(255*d.Clamp(b,0,1))}});Object.defineProperty(b.prototype,"color",{enumerable:!1,configurable:!0,get:function(){return this._r<<
16|this._g<<8|this._b}});e.b2Settings=function(){};e.b2MixFriction=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);return Math.sqrt(a*b)};e.b2MixRestitution=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);return a>b?a:b};e.b2Assert=function(a){if(!a)throw"Assertion Failed";};a.postDefs.push(function(){a.Common.b2Settings.VERSION="2.1alpha";a.Common.b2Settings.USHRT_MAX=65535;a.Common.b2Settings.b2_pi=Math.PI;a.Common.b2Settings.b2_maxManifoldPoints=2;a.Common.b2Settings.b2_aabbExtension=0.1;a.Common.b2Settings.b2_aabbMultiplier=
2;a.Common.b2Settings.b2_polygonRadius=2*e.b2_linearSlop;a.Common.b2Settings.b2_linearSlop=0.005;a.Common.b2Settings.b2_angularSlop=2/180*e.b2_pi;a.Common.b2Settings.b2_toiSlop=8*e.b2_linearSlop;a.Common.b2Settings.b2_maxTOIContactsPerIsland=32;a.Common.b2Settings.b2_maxTOIJointsPerIsland=32;a.Common.b2Settings.b2_velocityThreshold=1;a.Common.b2Settings.b2_maxLinearCorrection=0.2;a.Common.b2Settings.b2_maxAngularCorrection=8/180*e.b2_pi;a.Common.b2Settings.b2_maxTranslation=10;a.Common.b2Settings.b2_maxTranslationSquared=
e.b2_maxTranslation*e.b2_maxTranslation;a.Common.b2Settings.b2_maxRotation=0.5*e.b2_pi;a.Common.b2Settings.b2_maxRotationSquared=e.b2_maxRotation*e.b2_maxRotation;a.Common.b2Settings.b2_contactBaumgarte=0.2;a.Common.b2Settings.b2_timeToSleep=0.5;a.Common.b2Settings.b2_linearSleepTolerance=0.01;a.Common.b2Settings.b2_angularSleepTolerance=2/180*e.b2_pi})})();(function(){var b=a.Common.Math.b2Mat22,e=a.Common.Math.b2Mat33,d=a.Common.Math.b2Math,f=a.Common.Math.b2Sweep,l=a.Common.Math.b2Transform,h=
a.Common.Math.b2Vec2,j=a.Common.Math.b2Vec3;b.b2Mat22=function(){this.col1=new h;this.col2=new h};b.prototype.b2Mat22=function(){this.SetIdentity()};b.FromAngle=function(a){a===void 0&&(a=0);var d=new b;d.Set(a);return d};b.FromVV=function(a,d){var e=new b;e.SetVV(a,d);return e};b.prototype.Set=function(a){a===void 0&&(a=0);var b=Math.cos(a),a=Math.sin(a);this.col1.x=b;this.col2.x=-a;this.col1.y=a;this.col2.y=b};b.prototype.SetVV=function(a,b){this.col1.SetV(a);this.col2.SetV(b)};b.prototype.Copy=
function(){var a=new b;a.SetM(this);return a};b.prototype.SetM=function(a){this.col1.SetV(a.col1);this.col2.SetV(a.col2)};b.prototype.AddM=function(a){this.col1.x+=a.col1.x;this.col1.y+=a.col1.y;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y};b.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col1.y=0;this.col2.y=1};b.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col1.y=0;this.col2.y=0};b.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)};b.prototype.GetInverse=
function(a){var b=this.col1.x,d=this.col2.x,e=this.col1.y,f=this.col2.y,g=b*f-d*e;g!=0&&(g=1/g);a.col1.x=g*f;a.col2.x=-g*d;a.col1.y=-g*e;a.col2.y=g*b;return a};b.prototype.Solve=function(a,b,d){b===void 0&&(b=0);d===void 0&&(d=0);var e=this.col1.x,f=this.col2.x,g=this.col1.y,h=this.col2.y,j=e*h-f*g;j!=0&&(j=1/j);a.x=j*(h*b-f*d);a.y=j*(e*d-g*b);return a};b.prototype.Abs=function(){this.col1.Abs();this.col2.Abs()};e.b2Mat33=function(){this.col1=new j;this.col2=new j;this.col3=new j};e.prototype.b2Mat33=
function(a,b,d){a===void 0&&(a=null);b===void 0&&(b=null);d===void 0&&(d=null);!a&&!b&&!d?(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero()):(this.col1.SetV(a),this.col2.SetV(b),this.col3.SetV(d))};e.prototype.SetVVV=function(a,b,d){this.col1.SetV(a);this.col2.SetV(b);this.col3.SetV(d)};e.prototype.Copy=function(){return new e(this.col1,this.col2,this.col3)};e.prototype.SetM=function(a){this.col1.SetV(a.col1);this.col2.SetV(a.col2);this.col3.SetV(a.col3)};e.prototype.AddM=function(a){this.col1.x+=
a.col1.x;this.col1.y+=a.col1.y;this.col1.z+=a.col1.z;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y;this.col2.z+=a.col2.z;this.col3.x+=a.col3.x;this.col3.y+=a.col3.y;this.col3.z+=a.col3.z};e.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=1;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=1};e.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=0;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=
0};e.prototype.Solve22=function(a,b,d){b===void 0&&(b=0);d===void 0&&(d=0);var e=this.col1.x,f=this.col2.x,g=this.col1.y,h=this.col2.y,j=e*h-f*g;j!=0&&(j=1/j);a.x=j*(h*b-f*d);a.y=j*(e*d-g*b);return a};e.prototype.Solve33=function(a,b,d,e){b===void 0&&(b=0);d===void 0&&(d=0);e===void 0&&(e=0);var f=this.col1.x,g=this.col1.y,h=this.col1.z,j=this.col2.x,l=this.col2.y,q=this.col2.z,m=this.col3.x,k=this.col3.y,n=this.col3.z,I=f*(l*n-q*k)+g*(q*m-j*n)+h*(j*k-l*m);I!=0&&(I=1/I);a.x=I*(b*(l*n-q*k)+d*(q*m-
j*n)+e*(j*k-l*m));a.y=I*(f*(d*n-e*k)+g*(e*m-b*n)+h*(b*k-d*m));a.z=I*(f*(l*e-q*d)+g*(q*b-j*e)+h*(j*d-l*b));return a};d.b2Math=function(){};d.IsValid=function(a){a===void 0&&(a=0);return isFinite(a)};d.Dot=function(a,b){return a.x*b.x+a.y*b.y};d.CrossVV=function(a,b){return a.x*b.y-a.y*b.x};d.CrossVF=function(a,b){b===void 0&&(b=0);return new h(b*a.y,-b*a.x)};d.CrossFV=function(a,b){a===void 0&&(a=0);return new h(-a*b.y,a*b.x)};d.MulMV=function(a,b){return new h(a.col1.x*b.x+a.col2.x*b.y,a.col1.y*b.x+
a.col2.y*b.y)};d.MulTMV=function(a,b){return new h(d.Dot(b,a.col1),d.Dot(b,a.col2))};d.MulX=function(a,b){var e=d.MulMV(a.R,b);e.x+=a.position.x;e.y+=a.position.y;return e};d.MulXT=function(a,b){var e=d.SubtractVV(b,a.position),f=e.x*a.R.col1.x+e.y*a.R.col1.y;e.y=e.x*a.R.col2.x+e.y*a.R.col2.y;e.x=f;return e};d.AddVV=function(a,b){return new h(a.x+b.x,a.y+b.y)};d.SubtractVV=function(a,b){return new h(a.x-b.x,a.y-b.y)};d.Distance=function(a,b){var d=a.x-b.x,e=a.y-b.y;return Math.sqrt(d*d+e*e)};d.DistanceSquared=
function(a,b){var d=a.x-b.x,e=a.y-b.y;return d*d+e*e};d.MulFV=function(a,b){a===void 0&&(a=0);return new h(a*b.x,a*b.y)};d.AddMM=function(a,e){return b.FromVV(d.AddVV(a.col1,e.col1),d.AddVV(a.col2,e.col2))};d.MulMM=function(a,e){return b.FromVV(d.MulMV(a,e.col1),d.MulMV(a,e.col2))};d.MulTMM=function(a,e){var f=new h(d.Dot(a.col1,e.col1),d.Dot(a.col2,e.col1)),j=new h(d.Dot(a.col1,e.col2),d.Dot(a.col2,e.col2));return b.FromVV(f,j)};d.Abs=function(a){a===void 0&&(a=0);return a>0?a:-a};d.AbsV=function(a){return new h(d.Abs(a.x),
d.Abs(a.y))};d.AbsM=function(a){return b.FromVV(d.AbsV(a.col1),d.AbsV(a.col2))};d.Min=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);return a<b?a:b};d.MinV=function(a,b){return new h(d.Min(a.x,b.x),d.Min(a.y,b.y))};d.Max=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);return a>b?a:b};d.MaxV=function(a,b){return new h(d.Max(a.x,b.x),d.Max(a.y,b.y))};d.Clamp=function(a,b,d){a===void 0&&(a=0);b===void 0&&(b=0);d===void 0&&(d=0);return a<b?b:a>d?d:a};d.ClampV=function(a,b,e){return d.MaxV(b,d.MinV(a,
e))};d.Swap=function(a,b){var d=a[0];a[0]=b[0];b[0]=d};d.Random=function(){return Math.random()*2-1};d.RandomRange=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);var d=Math.random();return(b-a)*d+a};d.NextPowerOfTwo=function(a){a===void 0&&(a=0);a|=a>>1&2147483647;a|=a>>2&1073741823;a|=a>>4&268435455;a|=a>>8&16777215;a|=a>>16&65535;return a+1};d.IsPowerOfTwo=function(a){a===void 0&&(a=0);return a>0&&(a&a-1)==0};a.postDefs.push(function(){a.Common.Math.b2Math.b2Vec2_zero=new h(0,0);a.Common.Math.b2Math.b2Mat22_identity=
b.FromVV(new h(1,0),new h(0,1));a.Common.Math.b2Math.b2Transform_identity=new l(d.b2Vec2_zero,d.b2Mat22_identity)});f.b2Sweep=function(){this.localCenter=new h;this.c0=new h;this.c=new h};f.prototype.Set=function(a){this.localCenter.SetV(a.localCenter);this.c0.SetV(a.c0);this.c.SetV(a.c);this.a0=a.a0;this.a=a.a;this.t0=a.t0};f.prototype.Copy=function(){var a=new f;a.localCenter.SetV(this.localCenter);a.c0.SetV(this.c0);a.c.SetV(this.c);a.a0=this.a0;a.a=this.a;a.t0=this.t0;return a};f.prototype.GetTransform=
function(a,b){b===void 0&&(b=0);a.position.x=(1-b)*this.c0.x+b*this.c.x;a.position.y=(1-b)*this.c0.y+b*this.c.y;a.R.Set((1-b)*this.a0+b*this.a);var d=a.R;a.position.x-=d.col1.x*this.localCenter.x+d.col2.x*this.localCenter.y;a.position.y-=d.col1.y*this.localCenter.x+d.col2.y*this.localCenter.y};f.prototype.Advance=function(a){a===void 0&&(a=0);if(this.t0<a&&1-this.t0>Number.MIN_VALUE){var b=(a-this.t0)/(1-this.t0);this.c0.x=(1-b)*this.c0.x+b*this.c.x;this.c0.y=(1-b)*this.c0.y+b*this.c.y;this.a0=(1-
b)*this.a0+b*this.a;this.t0=a}};l.b2Transform=function(){this.position=new h;this.R=new b};l.prototype.b2Transform=function(a,b){a===void 0&&(a=null);b===void 0&&(b=null);a&&(this.position.SetV(a),this.R.SetM(b))};l.prototype.Initialize=function(a,b){this.position.SetV(a);this.R.SetM(b)};l.prototype.SetIdentity=function(){this.position.SetZero();this.R.SetIdentity()};l.prototype.Set=function(a){this.position.SetV(a.position);this.R.SetM(a.R)};l.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,
this.R.col1.x)};h.b2Vec2=function(){};h.prototype.b2Vec2=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);this.x=a;this.y=b};h.prototype.SetZero=function(){this.y=this.x=0};h.prototype.Set=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);this.x=a;this.y=b};h.prototype.SetV=function(a){this.x=a.x;this.y=a.y};h.prototype.GetNegative=function(){return new h(-this.x,-this.y)};h.prototype.NegativeSelf=function(){this.x=-this.x;this.y=-this.y};h.Make=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);
return new h(a,b)};h.prototype.Copy=function(){return new h(this.x,this.y)};h.prototype.Add=function(a){this.x+=a.x;this.y+=a.y};h.prototype.Subtract=function(a){this.x-=a.x;this.y-=a.y};h.prototype.Multiply=function(a){a===void 0&&(a=0);this.x*=a;this.y*=a};h.prototype.MulM=function(a){var b=this.x;this.x=a.col1.x*b+a.col2.x*this.y;this.y=a.col1.y*b+a.col2.y*this.y};h.prototype.MulTM=function(a){var b=d.Dot(this,a.col1);this.y=d.Dot(this,a.col2);this.x=b};h.prototype.CrossVF=function(a){a===void 0&&
(a=0);var b=this.x;this.x=a*this.y;this.y=-a*b};h.prototype.CrossFV=function(a){a===void 0&&(a=0);var b=this.x;this.x=-a*this.y;this.y=a*b};h.prototype.MinV=function(a){this.x=this.x<a.x?this.x:a.x;this.y=this.y<a.y?this.y:a.y};h.prototype.MaxV=function(a){this.x=this.x>a.x?this.x:a.x;this.y=this.y>a.y?this.y:a.y};h.prototype.Abs=function(){if(this.x<0)this.x=-this.x;if(this.y<0)this.y=-this.y};h.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};h.prototype.LengthSquared=
function(){return this.x*this.x+this.y*this.y};h.prototype.Normalize=function(){var a=Math.sqrt(this.x*this.x+this.y*this.y);if(a<Number.MIN_VALUE)return 0;var b=1/a;this.x*=b;this.y*=b;return a};h.prototype.IsValid=function(){return d.IsValid(this.x)&&d.IsValid(this.y)};j.b2Vec3=function(){};j.prototype.b2Vec3=function(a,b,d){a===void 0&&(a=0);b===void 0&&(b=0);d===void 0&&(d=0);this.x=a;this.y=b;this.z=d};j.prototype.SetZero=function(){this.x=this.y=this.z=0};j.prototype.Set=function(a,b,d){a===
void 0&&(a=0);b===void 0&&(b=0);d===void 0&&(d=0);this.x=a;this.y=b;this.z=d};j.prototype.SetV=function(a){this.x=a.x;this.y=a.y;this.z=a.z};j.prototype.GetNegative=function(){return new j(-this.x,-this.y,-this.z)};j.prototype.NegativeSelf=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z};j.prototype.Copy=function(){return new j(this.x,this.y,this.z)};j.prototype.Add=function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z};j.prototype.Subtract=function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z};j.prototype.Multiply=
function(a){a===void 0&&(a=0);this.x*=a;this.y*=a;this.z*=a}})();(function(){var b=a.Common.Math.b2Math,e=a.Common.Math.b2Sweep,d=a.Common.Math.b2Transform,f=a.Common.Math.b2Vec2,l=a.Common.b2Color,h=a.Common.b2Settings,q=a.Collision.b2AABB,c=a.Collision.b2ContactPoint,k=a.Collision.b2DynamicTreeBroadPhase,n=a.Collision.b2RayCastInput,D=a.Collision.b2RayCastOutput,B=a.Collision.Shapes.b2CircleShape,A=a.Collision.Shapes.b2EdgeShape,w=a.Collision.Shapes.b2MassData,y=a.Collision.Shapes.b2PolygonShape,
G=a.Collision.Shapes.b2Shape,p=a.Dynamics.b2Body,L=a.Dynamics.b2BodyDef,J=a.Dynamics.b2ContactFilter,M=a.Dynamics.b2ContactImpulse,I=a.Dynamics.b2ContactListener,C=a.Dynamics.b2ContactManager,F=a.Dynamics.b2DebugDraw,R=a.Dynamics.b2DestructionListener,K=a.Dynamics.b2FilterData,N=a.Dynamics.b2Fixture,U=a.Dynamics.b2FixtureDef,Q=a.Dynamics.b2Island,o=a.Dynamics.b2TimeStep,u=a.Dynamics.b2World,E=a.Dynamics.Contacts.b2Contact,v=a.Dynamics.Contacts.b2ContactFactory,O=a.Dynamics.Contacts.b2ContactSolver,
V=a.Dynamics.Joints.b2Joint,S=a.Dynamics.Joints.b2PulleyJoint;p.b2Body=function(){this.m_xf=new d;this.m_sweep=new e;this.m_linearVelocity=new f;this.m_force=new f};p.prototype.connectEdges=function(a,c,d){d===void 0&&(d=0);var e=Math.atan2(c.GetDirectionVector().y,c.GetDirectionVector().x),d=b.MulFV(Math.tan((e-d)*0.5),c.GetDirectionVector()),d=b.SubtractVV(d,c.GetNormalVector()),d=b.MulFV(h.b2_toiSlop,d),d=b.AddVV(d,c.GetVertex1()),o=b.AddVV(a.GetDirectionVector(),c.GetDirectionVector());o.Normalize();
var f=b.Dot(a.GetDirectionVector(),c.GetNormalVector())>0;a.SetNextEdge(c,d,o,f);c.SetPrevEdge(a,d,o,f);return e};p.prototype.CreateFixture=function(a){if(this.m_world.IsLocked()==!0)return null;var b=new N;b.Create(this,this.m_xf,a);this.m_flags&p.e_activeFlag&&b.CreateProxy(this.m_world.m_contactManager.m_broadPhase,this.m_xf);b.m_next=this.m_fixtureList;this.m_fixtureList=b;++this.m_fixtureCount;b.m_body=this;b.m_density>0&&this.ResetMassData();this.m_world.m_flags|=u.e_newFixture;return b};p.prototype.CreateFixture2=
function(a,b){b===void 0&&(b=0);var c=new U;c.shape=a;c.density=b;return this.CreateFixture(c)};p.prototype.DestroyFixture=function(a){if(this.m_world.IsLocked()!=!0){for(var b=this.m_fixtureList,c=null;b!=null;){if(b==a){c?c.m_next=a.m_next:this.m_fixtureList=a.m_next;break}c=b;b=b.m_next}for(b=this.m_contactList;b;){var c=b.contact,b=b.next,d=c.GetFixtureA(),e=c.GetFixtureB();(a==d||a==e)&&this.m_world.m_contactManager.Destroy(c)}this.m_flags&p.e_activeFlag&&a.DestroyProxy(this.m_world.m_contactManager.m_broadPhase);
a.Destroy();a.m_body=null;a.m_next=null;--this.m_fixtureCount;this.ResetMassData()}};p.prototype.SetPositionAndAngle=function(a,b){b===void 0&&(b=0);var c;if(this.m_world.IsLocked()!=!0){this.m_xf.R.Set(b);this.m_xf.position.SetV(a);c=this.m_xf.R;var d=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*d.x+c.col2.x*d.y;this.m_sweep.c.y=c.col1.y*d.x+c.col2.y*d.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);this.m_sweep.a0=this.m_sweep.a=
b;d=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;c;c=c.m_next)c.Synchronize(d,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}};p.prototype.SetTransform=function(a){this.SetPositionAndAngle(a.position,a.GetAngle())};p.prototype.GetTransform=function(){return this.m_xf};p.prototype.GetPosition=function(){return this.m_xf.position};p.prototype.SetPosition=function(a){this.SetPositionAndAngle(a,this.GetAngle())};p.prototype.GetAngle=function(){return this.m_sweep.a};
p.prototype.SetAngle=function(a){a===void 0&&(a=0);this.SetPositionAndAngle(this.GetPosition(),a)};p.prototype.GetWorldCenter=function(){return this.m_sweep.c};p.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter};p.prototype.SetLinearVelocity=function(a){this.m_type!=p.b2_staticBody&&this.m_linearVelocity.SetV(a)};p.prototype.GetLinearVelocity=function(){return this.m_linearVelocity};p.prototype.SetAngularVelocity=function(a){a===void 0&&(a=0);if(this.m_type!=p.b2_staticBody)this.m_angularVelocity=
a};p.prototype.GetAngularVelocity=function(){return this.m_angularVelocity};p.prototype.GetDefinition=function(){var a=new L;a.type=this.GetType();a.allowSleep=(this.m_flags&p.e_allowSleepFlag)==p.e_allowSleepFlag;a.angle=this.GetAngle();a.angularDamping=this.m_angularDamping;a.angularVelocity=this.m_angularVelocity;a.fixedRotation=(this.m_flags&p.e_fixedRotationFlag)==p.e_fixedRotationFlag;a.bullet=(this.m_flags&p.e_bulletFlag)==p.e_bulletFlag;a.awake=(this.m_flags&p.e_awakeFlag)==p.e_awakeFlag;
a.linearDamping=this.m_linearDamping;a.linearVelocity.SetV(this.GetLinearVelocity());a.position=this.GetPosition();a.userData=this.GetUserData();return a};p.prototype.ApplyForce=function(a,b){this.m_type==p.b2_dynamicBody&&(this.IsAwake()==!1&&this.SetAwake(!0),this.m_force.x+=a.x,this.m_force.y+=a.y,this.m_torque+=(b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x)};p.prototype.ApplyTorque=function(a){a===void 0&&(a=0);this.m_type==p.b2_dynamicBody&&(this.IsAwake()==!1&&this.SetAwake(!0),this.m_torque+=
a)};p.prototype.ApplyImpulse=function(a,b){this.m_type==p.b2_dynamicBody&&(this.IsAwake()==!1&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*a.x,this.m_linearVelocity.y+=this.m_invMass*a.y,this.m_angularVelocity+=this.m_invI*((b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x))};p.prototype.Split=function(a){for(var c=this.GetLinearVelocity().Copy(),d=this.GetAngularVelocity(),e=this.GetWorldCenter(),o=this.m_world.CreateBody(this.GetDefinition()),f,v=this.m_fixtureList;v;)if(a(v)){var h=
v.m_next;f?f.m_next=h:this.m_fixtureList=h;this.m_fixtureCount--;v.m_next=o.m_fixtureList;o.m_fixtureList=v;o.m_fixtureCount++;v.m_body=o;v=h}else f=v,v=v.m_next;this.ResetMassData();o.ResetMassData();f=this.GetWorldCenter();a=o.GetWorldCenter();f=b.AddVV(c,b.CrossFV(d,b.SubtractVV(f,e)));c=b.AddVV(c,b.CrossFV(d,b.SubtractVV(a,e)));this.SetLinearVelocity(f);o.SetLinearVelocity(c);this.SetAngularVelocity(d);o.SetAngularVelocity(d);this.SynchronizeFixtures();o.SynchronizeFixtures();return o};p.prototype.Merge=
function(a){var b;for(b=a.m_fixtureList;b;){var c=b.m_next;a.m_fixtureCount--;b.m_next=this.m_fixtureList;this.m_fixtureList=b;this.m_fixtureCount++;b.m_body=e;b=c}d.m_fixtureCount=0;var d=this,e=a;d.GetWorldCenter();e.GetWorldCenter();d.GetLinearVelocity().Copy();e.GetLinearVelocity().Copy();d.GetAngularVelocity();e.GetAngularVelocity();d.ResetMassData();this.SynchronizeFixtures()};p.prototype.GetMass=function(){return this.m_mass};p.prototype.GetInertia=function(){return this.m_I};p.prototype.GetMassData=
function(a){a.mass=this.m_mass;a.I=this.m_I;a.center.SetV(this.m_sweep.localCenter)};p.prototype.SetMassData=function(a){h.b2Assert(this.m_world.IsLocked()==!1);if(this.m_world.IsLocked()!=!0&&this.m_type==p.b2_dynamicBody){this.m_invI=this.m_I=this.m_invMass=0;this.m_mass=a.mass;if(this.m_mass<=0)this.m_mass=1;this.m_invMass=1/this.m_mass;if(a.I>0&&(this.m_flags&p.e_fixedRotationFlag)==0)this.m_I=a.I-this.m_mass*(a.center.x*a.center.x+a.center.y*a.center.y),this.m_invI=1/this.m_I;var c=this.m_sweep.c.Copy();
this.m_sweep.localCenter.SetV(a.center);this.m_sweep.c0.SetV(b.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-c.y);this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-c.x)}};p.prototype.ResetMassData=function(){this.m_invI=this.m_I=this.m_invMass=this.m_mass=0;this.m_sweep.localCenter.SetZero();if(!(this.m_type==p.b2_staticBody||this.m_type==p.b2_kinematicBody)){for(var a=f.Make(0,0),
c=this.m_fixtureList;c;c=c.m_next)if(c.m_density!=0){var d=c.GetMassData();this.m_mass+=d.mass;a.x+=d.center.x*d.mass;a.y+=d.center.y*d.mass;this.m_I+=d.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,a.x*=this.m_invMass,a.y*=this.m_invMass):this.m_invMass=this.m_mass=1;this.m_I>0&&(this.m_flags&p.e_fixedRotationFlag)==0?(this.m_I-=this.m_mass*(a.x*a.x+a.y*a.y),this.m_I*=this.m_inertiaScale,h.b2Assert(this.m_I>0),this.m_invI=1/this.m_I):this.m_invI=this.m_I=0;c=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(a);
this.m_sweep.c0.SetV(b.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-c.y);this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-c.x)}};p.prototype.GetWorldPoint=function(a){var b=this.m_xf.R,a=new f(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;return a};p.prototype.GetWorldVector=function(a){return b.MulMV(this.m_xf.R,a)};p.prototype.GetLocalPoint=
function(a){return b.MulXT(this.m_xf,a)};p.prototype.GetLocalVector=function(a){return b.MulTMV(this.m_xf.R,a)};p.prototype.GetLinearVelocityFromWorldPoint=function(a){return new f(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))};p.prototype.GetLinearVelocityFromLocalPoint=function(a){var b=this.m_xf.R,a=new f(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;
return new f(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))};p.prototype.GetLinearDamping=function(){return this.m_linearDamping};p.prototype.SetLinearDamping=function(a){a===void 0&&(a=0);this.m_linearDamping=a};p.prototype.GetAngularDamping=function(){return this.m_angularDamping};p.prototype.SetAngularDamping=function(a){a===void 0&&(a=0);this.m_angularDamping=a};p.prototype.SetType=function(a){a===void 0&&
(a=0);if(this.m_type!=a){this.m_type=a;this.ResetMassData();if(this.m_type==p.b2_staticBody)this.m_linearVelocity.SetZero(),this.m_angularVelocity=0;this.SetAwake(!0);this.m_force.SetZero();this.m_torque=0;for(a=this.m_contactList;a;a=a.next)a.contact.FlagForFiltering()}};p.prototype.GetType=function(){return this.m_type};p.prototype.SetBullet=function(a){a?this.m_flags|=p.e_bulletFlag:this.m_flags&=~p.e_bulletFlag};p.prototype.IsBullet=function(){return(this.m_flags&p.e_bulletFlag)==p.e_bulletFlag};
p.prototype.SetSleepingAllowed=function(a){a?this.m_flags|=p.e_allowSleepFlag:(this.m_flags&=~p.e_allowSleepFlag,this.SetAwake(!0))};p.prototype.SetAwake=function(a){a?(this.m_flags|=p.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~p.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)};p.prototype.IsAwake=function(){return(this.m_flags&p.e_awakeFlag)==p.e_awakeFlag};p.prototype.SetFixedRotation=function(a){a?this.m_flags|=
p.e_fixedRotationFlag:this.m_flags&=~p.e_fixedRotationFlag;this.ResetMassData()};p.prototype.IsFixedRotation=function(){return(this.m_flags&p.e_fixedRotationFlag)==p.e_fixedRotationFlag};p.prototype.SetActive=function(a){if(a!=this.IsActive()){var b;if(a){this.m_flags|=p.e_activeFlag;a=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;b;b=b.m_next)b.CreateProxy(a,this.m_xf)}else{this.m_flags&=~p.e_activeFlag;a=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;b;b=
b.m_next)b.DestroyProxy(a);for(a=this.m_contactList;a;)b=a,a=a.next,this.m_world.m_contactManager.Destroy(b.contact);this.m_contactList=null}}};p.prototype.IsActive=function(){return(this.m_flags&p.e_activeFlag)==p.e_activeFlag};p.prototype.IsSleepingAllowed=function(){return(this.m_flags&p.e_allowSleepFlag)==p.e_allowSleepFlag};p.prototype.GetFixtureList=function(){return this.m_fixtureList};p.prototype.GetJointList=function(){return this.m_jointList};p.prototype.GetControllerList=function(){return this.m_controllerList};
p.prototype.GetContactList=function(){return this.m_contactList};p.prototype.GetNext=function(){return this.m_next};p.prototype.GetUserData=function(){return this.m_userData};p.prototype.SetUserData=function(a){this.m_userData=a};p.prototype.GetWorld=function(){return this.m_world};p.prototype.b2Body=function(a,b){this.m_flags=0;a.bullet&&(this.m_flags|=p.e_bulletFlag);a.fixedRotation&&(this.m_flags|=p.e_fixedRotationFlag);a.allowSleep&&(this.m_flags|=p.e_allowSleepFlag);a.awake&&(this.m_flags|=p.e_awakeFlag);
a.active&&(this.m_flags|=p.e_activeFlag);this.m_world=b;this.m_xf.position.SetV(a.position);this.m_xf.R.Set(a.angle);this.m_sweep.localCenter.SetZero();this.m_sweep.t0=1;this.m_sweep.a0=this.m_sweep.a=a.angle;var c=this.m_xf.R,d=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*d.x+c.col2.x*d.y;this.m_sweep.c.y=c.col1.y*d.x+c.col2.y*d.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);this.m_contactList=this.m_controllerList=this.m_jointList=
null;this.m_controllerCount=0;this.m_next=this.m_prev=null;this.m_linearVelocity.SetV(a.linearVelocity);this.m_angularVelocity=a.angularVelocity;this.m_linearDamping=a.linearDamping;this.m_angularDamping=a.angularDamping;this.m_force.Set(0,0);this.m_sleepTime=this.m_torque=0;this.m_type=a.type;this.m_invMass=this.m_type==p.b2_dynamicBody?this.m_mass=1:this.m_mass=0;this.m_invI=this.m_I=0;this.m_inertiaScale=a.inertiaScale;this.m_userData=a.userData;this.m_fixtureList=null;this.m_fixtureCount=0};p.prototype.SynchronizeFixtures=
function(){var a=p.s_xf1;a.R.Set(this.m_sweep.a0);var b=a.R,c=this.m_sweep.localCenter;a.position.x=this.m_sweep.c0.x-(b.col1.x*c.x+b.col2.x*c.y);a.position.y=this.m_sweep.c0.y-(b.col1.y*c.x+b.col2.y*c.y);c=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;b;b=b.m_next)b.Synchronize(c,a,this.m_xf)};p.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var a=this.m_xf.R,b=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(a.col1.x*b.x+a.col2.x*b.y);
this.m_xf.position.y=this.m_sweep.c.y-(a.col1.y*b.x+a.col2.y*b.y)};p.prototype.ShouldCollide=function(a){if(this.m_type!=p.b2_dynamicBody&&a.m_type!=p.b2_dynamicBody)return!1;for(var b=this.m_jointList;b;b=b.next)if(b.other==a&&b.joint.m_collideConnected==!1)return!1;return!0};p.prototype.Advance=function(a){a===void 0&&(a=0);this.m_sweep.Advance(a);this.m_sweep.c.SetV(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.SynchronizeTransform()};a.postDefs.push(function(){a.Dynamics.b2Body.s_xf1=new d;
a.Dynamics.b2Body.e_islandFlag=1;a.Dynamics.b2Body.e_awakeFlag=2;a.Dynamics.b2Body.e_allowSleepFlag=4;a.Dynamics.b2Body.e_bulletFlag=8;a.Dynamics.b2Body.e_fixedRotationFlag=16;a.Dynamics.b2Body.e_activeFlag=32;a.Dynamics.b2Body.b2_staticBody=0;a.Dynamics.b2Body.b2_kinematicBody=1;a.Dynamics.b2Body.b2_dynamicBody=2});L.b2BodyDef=function(){this.position=new f;this.linearVelocity=new f};L.prototype.b2BodyDef=function(){this.userData=null;this.position.Set(0,0);this.angle=0;this.linearVelocity.Set(0,
0);this.angularDamping=this.linearDamping=this.angularVelocity=0;this.awake=this.allowSleep=!0;this.bullet=this.fixedRotation=!1;this.type=p.b2_staticBody;this.active=!0;this.inertiaScale=1};J.b2ContactFilter=function(){};J.prototype.ShouldCollide=function(a,b){var c=a.GetFilterData(),d=b.GetFilterData();if(c.groupIndex==d.groupIndex&&c.groupIndex!=0)return c.groupIndex>0;return(c.maskBits&d.categoryBits)!=0&&(c.categoryBits&d.maskBits)!=0};J.prototype.RayCollide=function(a,b){if(!a)return!0;return this.ShouldCollide(a instanceof
N?a:null,b)};a.postDefs.push(function(){a.Dynamics.b2ContactFilter.b2_defaultFilter=new J});M.b2ContactImpulse=function(){this.normalImpulses=new m(h.b2_maxManifoldPoints);this.tangentImpulses=new m(h.b2_maxManifoldPoints)};I.b2ContactListener=function(){};I.prototype.BeginContact=function(){};I.prototype.EndContact=function(){};I.prototype.PreSolve=function(){};I.prototype.PostSolve=function(){};a.postDefs.push(function(){a.Dynamics.b2ContactListener.b2_defaultListener=new I});C.b2ContactManager=
function(){};C.prototype.b2ContactManager=function(){this.m_world=null;this.m_contactCount=0;this.m_contactFilter=J.b2_defaultFilter;this.m_contactListener=I.b2_defaultListener;this.m_contactFactory=new v(this.m_allocator);this.m_broadPhase=new k};C.prototype.AddPair=function(a,b){var c=a instanceof N?a:null,d=b instanceof N?b:null,e=c.GetBody(),o=d.GetBody();if(e!=o){for(var f=o.GetContactList();f;){if(f.other==e){var g=f.contact.GetFixtureA(),v=f.contact.GetFixtureB();if(g==c&&v==d)return;if(g==
d&&v==c)return}f=f.next}if(o.ShouldCollide(e)!=!1&&this.m_contactFilter.ShouldCollide(c,d)!=!1){f=this.m_contactFactory.Create(c,d);c=f.GetFixtureA();d=f.GetFixtureB();e=c.m_body;o=d.m_body;f.m_prev=null;f.m_next=this.m_world.m_contactList;if(this.m_world.m_contactList!=null)this.m_world.m_contactList.m_prev=f;this.m_world.m_contactList=f;f.m_nodeA.contact=f;f.m_nodeA.other=o;f.m_nodeA.prev=null;f.m_nodeA.next=e.m_contactList;if(e.m_contactList!=null)e.m_contactList.prev=f.m_nodeA;e.m_contactList=
f.m_nodeA;f.m_nodeB.contact=f;f.m_nodeB.other=e;f.m_nodeB.prev=null;f.m_nodeB.next=o.m_contactList;if(o.m_contactList!=null)o.m_contactList.prev=f.m_nodeB;o.m_contactList=f.m_nodeB;++this.m_world.m_contactCount}}};C.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(a.generateCallback(this,this.AddPair))};C.prototype.Destroy=function(a){var b=a.GetFixtureA(),c=a.GetFixtureB(),b=b.GetBody(),c=c.GetBody();a.IsTouching()&&this.m_contactListener.EndContact(a);if(a.m_prev)a.m_prev.m_next=
a.m_next;if(a.m_next)a.m_next.m_prev=a.m_prev;if(a==this.m_world.m_contactList)this.m_world.m_contactList=a.m_next;if(a.m_nodeA.prev)a.m_nodeA.prev.next=a.m_nodeA.next;if(a.m_nodeA.next)a.m_nodeA.next.prev=a.m_nodeA.prev;if(a.m_nodeA==b.m_contactList)b.m_contactList=a.m_nodeA.next;if(a.m_nodeB.prev)a.m_nodeB.prev.next=a.m_nodeB.next;if(a.m_nodeB.next)a.m_nodeB.next.prev=a.m_nodeB.prev;if(a.m_nodeB==c.m_contactList)c.m_contactList=a.m_nodeB.next;this.m_contactFactory.Destroy(a);--this.m_contactCount};
C.prototype.Collide=function(){for(var a=this.m_world.m_contactList;a;){var b=a.GetFixtureA(),c=a.GetFixtureB(),d=b.GetBody(),e=c.GetBody();if(d.IsAwake()==!1&&e.IsAwake()==!1)a=a.GetNext();else{if(a.m_flags&E.e_filterFlag){if(e.ShouldCollide(d)==!1){b=a;a=b.GetNext();this.Destroy(b);continue}if(this.m_contactFilter.ShouldCollide(b,c)==!1){b=a;a=b.GetNext();this.Destroy(b);continue}a.m_flags&=~E.e_filterFlag}this.m_broadPhase.TestOverlap(b.m_proxy,c.m_proxy)==!1?(b=a,a=b.GetNext(),this.Destroy(b)):
(a.Update(this.m_contactListener),a=a.GetNext())}}};a.postDefs.push(function(){a.Dynamics.b2ContactManager.s_evalCP=new c});F.b2DebugDraw=function(){};F.prototype.b2DebugDraw=function(){};F.prototype.SetFlags=function(){};F.prototype.GetFlags=function(){};F.prototype.AppendFlags=function(){};F.prototype.ClearFlags=function(){};F.prototype.SetSprite=function(){};F.prototype.GetSprite=function(){};F.prototype.SetDrawScale=function(){};F.prototype.GetDrawScale=function(){};F.prototype.SetLineThickness=
function(){};F.prototype.GetLineThickness=function(){};F.prototype.SetAlpha=function(){};F.prototype.GetAlpha=function(){};F.prototype.SetFillAlpha=function(){};F.prototype.GetFillAlpha=function(){};F.prototype.SetXFormScale=function(){};F.prototype.GetXFormScale=function(){};F.prototype.DrawPolygon=function(){};F.prototype.DrawSolidPolygon=function(){};F.prototype.DrawCircle=function(){};F.prototype.DrawSolidCircle=function(){};F.prototype.DrawSegment=function(){};F.prototype.DrawTransform=function(){};
a.postDefs.push(function(){a.Dynamics.b2DebugDraw.e_shapeBit=1;a.Dynamics.b2DebugDraw.e_jointBit=2;a.Dynamics.b2DebugDraw.e_aabbBit=4;a.Dynamics.b2DebugDraw.e_pairBit=8;a.Dynamics.b2DebugDraw.e_centerOfMassBit=16;a.Dynamics.b2DebugDraw.e_controllerBit=32});R.b2DestructionListener=function(){};R.prototype.SayGoodbyeJoint=function(){};R.prototype.SayGoodbyeFixture=function(){};K.b2FilterData=function(){this.categoryBits=1;this.maskBits=65535;this.groupIndex=0};K.prototype.Copy=function(){var a=new K;
a.categoryBits=this.categoryBits;a.maskBits=this.maskBits;a.groupIndex=this.groupIndex;return a};N.b2Fixture=function(){this.m_filter=new K};N.prototype.GetType=function(){return this.m_shape.GetType()};N.prototype.GetShape=function(){return this.m_shape};N.prototype.SetSensor=function(a){if(this.m_isSensor!=a&&(this.m_isSensor=a,this.m_body!=null))for(a=this.m_body.GetContactList();a;){var b=a.contact,c=b.GetFixtureA(),d=b.GetFixtureB();if(c==this||d==this)b.SetSensor(c.IsSensor()||d.IsSensor());
a=a.next}};N.prototype.IsSensor=function(){return this.m_isSensor};N.prototype.SetFilterData=function(a){this.m_filter=a.Copy();if(!this.m_body)for(a=this.m_body.GetContactList();a;){var b=a.contact,c=b.GetFixtureA(),d=b.GetFixtureB();(c==this||d==this)&&b.FlagForFiltering();a=a.next}};N.prototype.GetFilterData=function(){return this.m_filter.Copy()};N.prototype.GetBody=function(){return this.m_body};N.prototype.GetNext=function(){return this.m_next};N.prototype.GetUserData=function(){return this.m_userData};
N.prototype.SetUserData=function(a){this.m_userData=a};N.prototype.TestPoint=function(a){return this.m_shape.TestPoint(this.m_body.GetTransform(),a)};N.prototype.RayCast=function(a,b){return this.m_shape.RayCast(a,b,this.m_body.GetTransform())};N.prototype.GetMassData=function(a){a===void 0&&(a=null);a==null&&(a=new w);this.m_shape.ComputeMass(a,this.m_density);return a};N.prototype.SetDensity=function(a){a===void 0&&(a=0);this.m_density=a};N.prototype.GetDensity=function(){return this.m_density};
N.prototype.GetFriction=function(){return this.m_friction};N.prototype.SetFriction=function(a){a===void 0&&(a=0);this.m_friction=a};N.prototype.GetRestitution=function(){return this.m_restitution};N.prototype.SetRestitution=function(a){a===void 0&&(a=0);this.m_restitution=a};N.prototype.GetAABB=function(){return this.m_aabb};N.prototype.b2Fixture=function(){this.m_aabb=new q;this.m_shape=this.m_next=this.m_body=this.m_userData=null;this.m_restitution=this.m_friction=this.m_density=0};N.prototype.Create=
function(a,b,c){this.m_userData=c.userData;this.m_friction=c.friction;this.m_restitution=c.restitution;this.m_body=a;this.m_next=null;this.m_filter=c.filter.Copy();this.m_isSensor=c.isSensor;this.m_shape=c.shape.Copy();this.m_density=c.density};N.prototype.Destroy=function(){this.m_shape=null};N.prototype.CreateProxy=function(a,b){this.m_shape.ComputeAABB(this.m_aabb,b);this.m_proxy=a.CreateProxy(this.m_aabb,this)};N.prototype.DestroyProxy=function(a){if(this.m_proxy!=null)a.DestroyProxy(this.m_proxy),
this.m_proxy=null};N.prototype.Synchronize=function(a,c,d){if(this.m_proxy){var e=new q,o=new q;this.m_shape.ComputeAABB(e,c);this.m_shape.ComputeAABB(o,d);this.m_aabb.Combine(e,o);c=b.SubtractVV(d.position,c.position);a.MoveProxy(this.m_proxy,this.m_aabb,c)}};U.b2FixtureDef=function(){this.filter=new K};U.prototype.b2FixtureDef=function(){this.userData=this.shape=null;this.friction=0.2;this.density=this.restitution=0;this.filter.categoryBits=1;this.filter.maskBits=65535;this.filter.groupIndex=0;
this.isSensor=!1};Q.b2Island=function(){};Q.prototype.b2Island=function(){this.m_bodies=new j;this.m_contacts=new j;this.m_joints=new j};Q.prototype.Initialize=function(a,b,c,d,e,o){a===void 0&&(a=0);b===void 0&&(b=0);c===void 0&&(c=0);var f=0;this.m_bodyCapacity=a;this.m_contactCapacity=b;this.m_jointCapacity=c;this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;this.m_allocator=d;this.m_listener=e;this.m_contactSolver=o;for(f=this.m_bodies.length;f<a;f++)this.m_bodies[f]=null;for(f=this.m_contacts.length;f<
b;f++)this.m_contacts[f]=null;for(f=this.m_joints.length;f<c;f++)this.m_joints[f]=null};Q.prototype.Clear=function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=0};Q.prototype.Solve=function(a,c,d){for(var e=0,o=0,f,e=0;e<this.m_bodyCount;++e)o=this.m_bodies[e],o.GetType()==p.b2_dynamicBody&&(o.m_linearVelocity.x+=a.dt*(c.x+o.m_invMass*o.m_force.x),o.m_linearVelocity.y+=a.dt*(c.y+o.m_invMass*o.m_force.y),o.m_angularVelocity+=a.dt*o.m_invI*o.m_torque,o.m_linearVelocity.Multiply(b.Clamp(1-
a.dt*o.m_linearDamping,0,1)),o.m_angularVelocity*=b.Clamp(1-a.dt*o.m_angularDamping,0,1));this.m_contactSolver.Initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);c=this.m_contactSolver;c.InitVelocityConstraints(a);for(e=0;e<this.m_jointCount;++e)f=this.m_joints[e],f.InitVelocityConstraints(a);for(e=0;e<a.velocityIterations;++e){for(o=0;o<this.m_jointCount;++o)f=this.m_joints[o],f.SolveVelocityConstraints(a);c.SolveVelocityConstraints()}for(e=0;e<this.m_jointCount;++e)f=this.m_joints[e],
f.FinalizeVelocityConstraints();c.FinalizeVelocityConstraints();for(e=0;e<this.m_bodyCount;++e)if(o=this.m_bodies[e],o.GetType()!=p.b2_staticBody){var v=a.dt*o.m_linearVelocity.x,u=a.dt*o.m_linearVelocity.y;v*v+u*u>h.b2_maxTranslationSquared&&(o.m_linearVelocity.Normalize(),o.m_linearVelocity.x*=h.b2_maxTranslation*a.inv_dt,o.m_linearVelocity.y*=h.b2_maxTranslation*a.inv_dt);v=a.dt*o.m_angularVelocity;if(v*v>h.b2_maxRotationSquared)o.m_angularVelocity=o.m_angularVelocity<0?-h.b2_maxRotation*a.inv_dt:
h.b2_maxRotation*a.inv_dt;o.m_sweep.c0.SetV(o.m_sweep.c);o.m_sweep.a0=o.m_sweep.a;o.m_sweep.c.x+=a.dt*o.m_linearVelocity.x;o.m_sweep.c.y+=a.dt*o.m_linearVelocity.y;o.m_sweep.a+=a.dt*o.m_angularVelocity;o.SynchronizeTransform()}for(e=0;e<a.positionIterations;++e){v=c.SolvePositionConstraints(h.b2_contactBaumgarte);u=!0;for(o=0;o<this.m_jointCount;++o)f=this.m_joints[o],f=f.SolvePositionConstraints(h.b2_contactBaumgarte),u=u&&f;if(v&&u)break}this.Report(c.m_constraints);if(d){d=Number.MAX_VALUE;c=h.b2_linearSleepTolerance*
h.b2_linearSleepTolerance;v=h.b2_angularSleepTolerance*h.b2_angularSleepTolerance;for(e=0;e<this.m_bodyCount;++e)if(o=this.m_bodies[e],o.GetType()!=p.b2_staticBody){if((o.m_flags&p.e_allowSleepFlag)==0)d=o.m_sleepTime=0;(o.m_flags&p.e_allowSleepFlag)==0||o.m_angularVelocity*o.m_angularVelocity>v||b.Dot(o.m_linearVelocity,o.m_linearVelocity)>c?d=o.m_sleepTime=0:(o.m_sleepTime+=a.dt,d=b.Min(d,o.m_sleepTime))}if(d>=h.b2_timeToSleep)for(e=0;e<this.m_bodyCount;++e)o=this.m_bodies[e],o.SetAwake(!1)}};Q.prototype.SolveTOI=
function(a){var b=0,c=0;this.m_contactSolver.Initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);for(var d=this.m_contactSolver,b=0;b<this.m_jointCount;++b)this.m_joints[b].InitVelocityConstraints(a);for(b=0;b<a.velocityIterations;++b){d.SolveVelocityConstraints();for(c=0;c<this.m_jointCount;++c)this.m_joints[c].SolveVelocityConstraints(a)}for(b=0;b<this.m_bodyCount;++b)if(c=this.m_bodies[b],c.GetType()!=p.b2_staticBody){var e=a.dt*c.m_linearVelocity.x,o=a.dt*c.m_linearVelocity.y;e*
e+o*o>h.b2_maxTranslationSquared&&(c.m_linearVelocity.Normalize(),c.m_linearVelocity.x*=h.b2_maxTranslation*a.inv_dt,c.m_linearVelocity.y*=h.b2_maxTranslation*a.inv_dt);e=a.dt*c.m_angularVelocity;if(e*e>h.b2_maxRotationSquared)c.m_angularVelocity=c.m_angularVelocity<0?-h.b2_maxRotation*a.inv_dt:h.b2_maxRotation*a.inv_dt;c.m_sweep.c0.SetV(c.m_sweep.c);c.m_sweep.a0=c.m_sweep.a;c.m_sweep.c.x+=a.dt*c.m_linearVelocity.x;c.m_sweep.c.y+=a.dt*c.m_linearVelocity.y;c.m_sweep.a+=a.dt*c.m_angularVelocity;c.SynchronizeTransform()}for(b=
0;b<a.positionIterations;++b){e=d.SolvePositionConstraints(0.75);o=!0;for(c=0;c<this.m_jointCount;++c)var f=this.m_joints[c].SolvePositionConstraints(h.b2_contactBaumgarte),o=o&&f;if(e&&o)break}this.Report(d.m_constraints)};Q.prototype.Report=function(a){if(this.m_listener!=null)for(var b=0;b<this.m_contactCount;++b){for(var c=this.m_contacts[b],d=a[b],e=0;e<d.pointCount;++e)Q.s_impulse.normalImpulses[e]=d.points[e].normalImpulse,Q.s_impulse.tangentImpulses[e]=d.points[e].tangentImpulse;this.m_listener.PostSolve(c,
Q.s_impulse)}};Q.prototype.AddBody=function(a){a.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=a};Q.prototype.AddContact=function(a){this.m_contacts[this.m_contactCount++]=a};Q.prototype.AddJoint=function(a){this.m_joints[this.m_jointCount++]=a};a.postDefs.push(function(){a.Dynamics.b2Island.s_impulse=new M});o.b2TimeStep=function(){};o.prototype.Set=function(a){this.dt=a.dt;this.inv_dt=a.inv_dt;this.positionIterations=a.positionIterations;this.velocityIterations=a.velocityIterations;
this.warmStarting=a.warmStarting};u.b2World=function(){this.s_stack=new j;this.m_contactManager=new C;this.m_contactSolver=new O;this.m_island=new Q};u.prototype.b2World=function(a,b){this.m_controllerList=this.m_jointList=this.m_contactList=this.m_bodyList=this.m_debugDraw=this.m_destructionListener=null;this.m_controllerCount=this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;u.m_warmStarting=!0;u.m_continuousPhysics=!0;this.m_allowSleep=b;this.m_gravity=a;this.m_inv_dt0=0;this.m_contactManager.m_world=
this;this.m_groundBody=this.CreateBody(new L)};u.prototype.SetDestructionListener=function(a){this.m_destructionListener=a};u.prototype.SetContactFilter=function(a){this.m_contactManager.m_contactFilter=a};u.prototype.SetContactListener=function(a){this.m_contactManager.m_contactListener=a};u.prototype.SetDebugDraw=function(a){this.m_debugDraw=a};u.prototype.SetBroadPhase=function(a){var b=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=a;for(var c=this.m_bodyList;c;c=c.m_next)for(var d=
c.m_fixtureList;d;d=d.m_next)d.m_proxy=a.CreateProxy(b.GetFatAABB(d.m_proxy),d)};u.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()};u.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()};u.prototype.CreateBody=function(a){if(this.IsLocked()==!0)return null;a=new p(a,this);a.m_prev=null;if(a.m_next=this.m_bodyList)this.m_bodyList.m_prev=a;this.m_bodyList=a;++this.m_bodyCount;return a};u.prototype.DestroyBody=function(a){if(this.IsLocked()!=
!0){for(var b=a.m_jointList;b;){var c=b,b=b.next;this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(c.joint);this.DestroyJoint(c.joint)}for(b=a.m_controllerList;b;)c=b,b=b.nextController,c.controller.RemoveBody(a);for(b=a.m_contactList;b;)c=b,b=b.next,this.m_contactManager.Destroy(c.contact);a.m_contactList=null;for(b=a.m_fixtureList;b;)c=b,b=b.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(c),c.DestroyProxy(this.m_contactManager.m_broadPhase),
c.Destroy();a.m_fixtureList=null;a.m_fixtureCount=0;if(a.m_prev)a.m_prev.m_next=a.m_next;if(a.m_next)a.m_next.m_prev=a.m_prev;if(a==this.m_bodyList)this.m_bodyList=a.m_next;--this.m_bodyCount}};u.prototype.CreateJoint=function(a){var b=V.Create(a,null);b.m_prev=null;if(b.m_next=this.m_jointList)this.m_jointList.m_prev=b;this.m_jointList=b;++this.m_jointCount;b.m_edgeA.joint=b;b.m_edgeA.other=b.m_bodyB;b.m_edgeA.prev=null;if(b.m_edgeA.next=b.m_bodyA.m_jointList)b.m_bodyA.m_jointList.prev=b.m_edgeA;
b.m_bodyA.m_jointList=b.m_edgeA;b.m_edgeB.joint=b;b.m_edgeB.other=b.m_bodyA;b.m_edgeB.prev=null;if(b.m_edgeB.next=b.m_bodyB.m_jointList)b.m_bodyB.m_jointList.prev=b.m_edgeB;b.m_bodyB.m_jointList=b.m_edgeB;var c=a.bodyA,d=a.bodyB;if(a.collideConnected==!1)for(a=d.GetContactList();a;)a.other==c&&a.contact.FlagForFiltering(),a=a.next;return b};u.prototype.DestroyJoint=function(a){var b=a.m_collideConnected;if(a.m_prev)a.m_prev.m_next=a.m_next;if(a.m_next)a.m_next.m_prev=a.m_prev;if(a==this.m_jointList)this.m_jointList=
a.m_next;var c=a.m_bodyA,d=a.m_bodyB;c.SetAwake(!0);d.SetAwake(!0);if(a.m_edgeA.prev)a.m_edgeA.prev.next=a.m_edgeA.next;if(a.m_edgeA.next)a.m_edgeA.next.prev=a.m_edgeA.prev;if(a.m_edgeA==c.m_jointList)c.m_jointList=a.m_edgeA.next;a.m_edgeA.prev=null;a.m_edgeA.next=null;if(a.m_edgeB.prev)a.m_edgeB.prev.next=a.m_edgeB.next;if(a.m_edgeB.next)a.m_edgeB.next.prev=a.m_edgeB.prev;if(a.m_edgeB==d.m_jointList)d.m_jointList=a.m_edgeB.next;a.m_edgeB.prev=null;a.m_edgeB.next=null;V.Destroy(a,null);--this.m_jointCount;
if(b==!1)for(a=d.GetContactList();a;)a.other==c&&a.contact.FlagForFiltering(),a=a.next};u.prototype.AddController=function(a){a.m_next=this.m_controllerList;a.m_prev=null;this.m_controllerList=a;a.m_world=this;this.m_controllerCount++;return a};u.prototype.RemoveController=function(a){if(a.m_prev)a.m_prev.m_next=a.m_next;if(a.m_next)a.m_next.m_prev=a.m_prev;if(this.m_controllerList==a)this.m_controllerList=a.m_next;this.m_controllerCount--};u.prototype.CreateController=function(a){if(a.m_world!=this)throw Error("Controller can only be a member of one world");
a.m_next=this.m_controllerList;a.m_prev=null;if(this.m_controllerList)this.m_controllerList.m_prev=a;this.m_controllerList=a;++this.m_controllerCount;a.m_world=this;return a};u.prototype.DestroyController=function(a){a.Clear();if(a.m_next)a.m_next.m_prev=a.m_prev;if(a.m_prev)a.m_prev.m_next=a.m_next;if(a==this.m_controllerList)this.m_controllerList=a.m_next;--this.m_controllerCount};u.prototype.SetWarmStarting=function(a){u.m_warmStarting=a};u.prototype.SetContinuousPhysics=function(a){u.m_continuousPhysics=
a};u.prototype.GetBodyCount=function(){return this.m_bodyCount};u.prototype.GetJointCount=function(){return this.m_jointCount};u.prototype.GetContactCount=function(){return this.m_contactCount};u.prototype.SetGravity=function(a){this.m_gravity=a};u.prototype.GetGravity=function(){return this.m_gravity};u.prototype.GetGroundBody=function(){return this.m_groundBody};u.prototype.Step=function(a,b,c){a===void 0&&(a=0);b===void 0&&(b=0);c===void 0&&(c=0);this.m_flags&u.e_newFixture&&(this.m_contactManager.FindNewContacts(),
this.m_flags&=~u.e_newFixture);this.m_flags|=u.e_locked;var d=u.s_timestep2;d.dt=a;d.velocityIterations=b;d.positionIterations=c;d.inv_dt=a>0?1/a:0;d.dtRatio=this.m_inv_dt0*a;d.warmStarting=u.m_warmStarting;this.m_contactManager.Collide();d.dt>0&&this.Solve(d);u.m_continuousPhysics&&d.dt>0&&this.SolveTOI(d);if(d.dt>0)this.m_inv_dt0=d.inv_dt;this.m_flags&=~u.e_locked};u.prototype.ClearForces=function(){for(var a=this.m_bodyList;a;a=a.m_next)a.m_force.SetZero(),a.m_torque=0};u.prototype.DrawDebugData=
function(){if(this.m_debugDraw!=null){this.m_debugDraw.m_sprite.graphics.clear();var a=this.m_debugDraw.GetFlags(),b,c,d;new f;new f;new f;var e;new q;new q;e=[new f,new f,new f,new f];var o=new l(0,0,0);if(a&F.e_shapeBit)for(b=this.m_bodyList;b;b=b.m_next){e=b.m_xf;for(c=b.GetFixtureList();c;c=c.m_next)d=c.GetShape(),b.IsActive()==!1?o.Set(0.5,0.5,0.3):b.GetType()==p.b2_staticBody?o.Set(0.5,0.9,0.5):b.GetType()==p.b2_kinematicBody?o.Set(0.5,0.5,0.9):b.IsAwake()==!1?o.Set(0.6,0.6,0.6):o.Set(0.9,0.7,
0.7),this.DrawShape(d,e,o)}if(a&F.e_jointBit)for(b=this.m_jointList;b;b=b.m_next)this.DrawJoint(b);if(a&F.e_controllerBit)for(b=this.m_controllerList;b;b=b.m_next)b.Draw(this.m_debugDraw);if(a&F.e_pairBit){o.Set(0.3,0.9,0.9);for(b=this.m_contactManager.m_contactList;b;b=b.GetNext())d=b.GetFixtureA(),c=b.GetFixtureB(),d=d.GetAABB().GetCenter(),c=c.GetAABB().GetCenter(),this.m_debugDraw.DrawSegment(d,c,o)}if(a&F.e_aabbBit){d=this.m_contactManager.m_broadPhase;e=[new f,new f,new f,new f];for(b=this.m_bodyList;b;b=
b.GetNext())if(b.IsActive()!=!1)for(c=b.GetFixtureList();c;c=c.GetNext()){var g=d.GetFatAABB(c.m_proxy);e[0].Set(g.lowerBound.x,g.lowerBound.y);e[1].Set(g.upperBound.x,g.lowerBound.y);e[2].Set(g.upperBound.x,g.upperBound.y);e[3].Set(g.lowerBound.x,g.upperBound.y);this.m_debugDraw.DrawPolygon(e,4,o)}}if(a&F.e_centerOfMassBit)for(b=this.m_bodyList;b;b=b.m_next)e=u.s_xf,e.R=b.m_xf.R,e.position=b.GetWorldCenter(),this.m_debugDraw.DrawTransform(e)}};u.prototype.QueryAABB=function(a,b){var c=this.m_contactManager.m_broadPhase;
c.Query(function(b){return a(c.GetUserData(b))},b)};u.prototype.QueryShape=function(a,b,c){c===void 0&&(c=null);c==null&&(c=new d,c.SetIdentity());var e=this.m_contactManager.m_broadPhase,o=new q;b.ComputeAABB(o,c);e.Query(function(d){d=e.GetUserData(d)instanceof N?e.GetUserData(d):null;if(G.TestOverlap(b,c,d.GetShape(),d.GetBody().GetTransform()))return a(d);return!0},o)};u.prototype.QueryPoint=function(a,b){var c=this.m_contactManager.m_broadPhase,d=new q;d.lowerBound.Set(b.x-h.b2_linearSlop,b.y-
h.b2_linearSlop);d.upperBound.Set(b.x+h.b2_linearSlop,b.y+h.b2_linearSlop);c.Query(function(d){d=c.GetUserData(d)instanceof N?c.GetUserData(d):null;if(d.TestPoint(b))return a(d);return!0},d)};u.prototype.RayCast=function(a,b,c){var d=this.m_contactManager.m_broadPhase,e=new D,o=new n(b,c);d.RayCast(function(o,g){var v=d.GetUserData(g),v=v instanceof N?v:null;if(v.RayCast(e,o)){var h=e.fraction,u=new f((1-h)*b.x+h*c.x,(1-h)*b.y+h*c.y);return a(v,u,e.normal,h)}return o.maxFraction},o)};u.prototype.RayCastOne=
function(a,b){var c;this.RayCast(function(a,b,d,e){e===void 0&&(e=0);c=a;return e},a,b);return c};u.prototype.RayCastAll=function(a,b){var c=new j;this.RayCast(function(a){c[c.length]=a;return 1},a,b);return c};u.prototype.GetBodyList=function(){return this.m_bodyList};u.prototype.GetJointList=function(){return this.m_jointList};u.prototype.GetContactList=function(){return this.m_contactList};u.prototype.IsLocked=function(){return(this.m_flags&u.e_locked)>0};u.prototype.Solve=function(a){for(var b,
c=this.m_controllerList;c;c=c.m_next)c.Step(a);c=this.m_island;c.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(b=this.m_bodyList;b;b=b.m_next)b.m_flags&=~p.e_islandFlag;for(var d=this.m_contactList;d;d=d.m_next)d.m_flags&=~E.e_islandFlag;for(d=this.m_jointList;d;d=d.m_next)d.m_islandFlag=!1;parseInt(this.m_bodyCount);for(var d=this.s_stack,e=this.m_bodyList;e;e=e.m_next)if(!(e.m_flags&p.e_islandFlag)&&!(e.IsAwake()==
!1||e.IsActive()==!1)&&e.GetType()!=p.b2_staticBody){c.Clear();var o=0;d[o++]=e;for(e.m_flags|=p.e_islandFlag;o>0;)if(b=d[--o],c.AddBody(b),b.IsAwake()==!1&&b.SetAwake(!0),b.GetType()!=p.b2_staticBody){for(var f,g=b.m_contactList;g;g=g.next)if(!(g.contact.m_flags&E.e_islandFlag)&&!(g.contact.IsSensor()==!0||g.contact.IsEnabled()==!1||g.contact.IsTouching()==!1))c.AddContact(g.contact),g.contact.m_flags|=E.e_islandFlag,f=g.other,f.m_flags&p.e_islandFlag||(d[o++]=f,f.m_flags|=p.e_islandFlag);for(b=
b.m_jointList;b;b=b.next)if(b.joint.m_islandFlag!=!0&&(f=b.other,f.IsActive()!=!1))c.AddJoint(b.joint),b.joint.m_islandFlag=!0,f.m_flags&p.e_islandFlag||(d[o++]=f,f.m_flags|=p.e_islandFlag)}c.Solve(a,this.m_gravity,this.m_allowSleep);for(o=0;o<c.m_bodyCount;++o)b=c.m_bodies[o],b.GetType()==p.b2_staticBody&&(b.m_flags&=~p.e_islandFlag)}for(o=0;o<d.length;++o){if(!d[o])break;d[o]=null}for(b=this.m_bodyList;b;b=b.m_next)b.IsAwake()==!1||b.IsActive()==!1||b.GetType()!=p.b2_staticBody&&b.SynchronizeFixtures();
this.m_contactManager.FindNewContacts()};u.prototype.SolveTOI=function(a){var b,c,d,e=this.m_island;e.Initialize(this.m_bodyCount,h.b2_maxTOIContactsPerIsland,h.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var o=u.s_queue;for(b=this.m_bodyList;b;b=b.m_next)b.m_flags&=~p.e_islandFlag,b.m_sweep.t0=0;for(d=this.m_contactList;d;d=d.m_next)d.m_flags&=~(E.e_toiFlag|E.e_islandFlag);for(d=this.m_jointList;d;d=d.m_next)d.m_islandFlag=!1;for(;;){var f=null,g=1;
for(d=this.m_contactList;d;d=d.m_next)if(!(d.IsSensor()==!0||d.IsEnabled()==!1||d.IsContinuous()==!1)){b=1;if(d.m_flags&E.e_toiFlag)b=d.m_toi;else{b=d.m_fixtureA;c=d.m_fixtureB;b=b.m_body;c=c.m_body;if((b.GetType()!=p.b2_dynamicBody||b.IsAwake()==!1)&&(c.GetType()!=p.b2_dynamicBody||c.IsAwake()==!1))continue;var v=b.m_sweep.t0;if(b.m_sweep.t0<c.m_sweep.t0)v=c.m_sweep.t0,b.m_sweep.Advance(v);else if(c.m_sweep.t0<b.m_sweep.t0)v=b.m_sweep.t0,c.m_sweep.Advance(v);b=d.ComputeTOI(b.m_sweep,c.m_sweep);h.b2Assert(0<=
b&&b<=1);b>0&&b<1&&(b=(1-b)*v+b,b>1&&(b=1));d.m_toi=b;d.m_flags|=E.e_toiFlag}Number.MIN_VALUE<b&&b<g&&(f=d,g=b)}if(f==null||1-100*Number.MIN_VALUE<g)break;b=f.m_fixtureA;c=f.m_fixtureB;b=b.m_body;c=c.m_body;u.s_backupA.Set(b.m_sweep);u.s_backupB.Set(c.m_sweep);b.Advance(g);c.Advance(g);f.Update(this.m_contactManager.m_contactListener);f.m_flags&=~E.e_toiFlag;if(f.IsSensor()==!0||f.IsEnabled()==!1)b.m_sweep.Set(u.s_backupA),c.m_sweep.Set(u.s_backupB),b.SynchronizeTransform(),c.SynchronizeTransform();
else if(f.IsTouching()!=!1){b.GetType()!=p.b2_dynamicBody&&(b=c);e.Clear();f=d=0;o[d+f++]=b;for(b.m_flags|=p.e_islandFlag;f>0;)if(b=o[d++],--f,e.AddBody(b),b.IsAwake()==!1&&b.SetAwake(!0),b.GetType()==p.b2_dynamicBody){for(c=b.m_contactList;c;c=c.next){if(e.m_contactCount==e.m_contactCapacity)break;if(!(c.contact.m_flags&E.e_islandFlag)&&!(c.contact.IsSensor()==!0||c.contact.IsEnabled()==!1||c.contact.IsTouching()==!1))e.AddContact(c.contact),c.contact.m_flags|=E.e_islandFlag,v=c.other,v.m_flags&
p.e_islandFlag||(v.GetType()!=p.b2_staticBody&&(v.Advance(g),v.SetAwake(!0)),o[d+f]=v,++f,v.m_flags|=p.e_islandFlag)}for(b=b.m_jointList;b;b=b.next)if(e.m_jointCount!=e.m_jointCapacity&&b.joint.m_islandFlag!=!0&&(v=b.other,v.IsActive()!=!1))e.AddJoint(b.joint),b.joint.m_islandFlag=!0,v.m_flags&p.e_islandFlag||(v.GetType()!=p.b2_staticBody&&(v.Advance(g),v.SetAwake(!0)),o[d+f]=v,++f,v.m_flags|=p.e_islandFlag)}d=u.s_timestep;d.warmStarting=!1;d.dt=(1-g)*a.dt;d.inv_dt=1/d.dt;d.dtRatio=0;d.velocityIterations=
a.velocityIterations;d.positionIterations=a.positionIterations;e.SolveTOI(d);for(g=g=0;g<e.m_bodyCount;++g)if(b=e.m_bodies[g],b.m_flags&=~p.e_islandFlag,b.IsAwake()!=!1&&b.GetType()==p.b2_dynamicBody){b.SynchronizeFixtures();for(c=b.m_contactList;c;c=c.next)c.contact.m_flags&=~E.e_toiFlag}for(g=0;g<e.m_contactCount;++g)d=e.m_contacts[g],d.m_flags&=~(E.e_toiFlag|E.e_islandFlag);for(g=0;g<e.m_jointCount;++g)d=e.m_joints[g],d.m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}};u.prototype.DrawJoint=
function(a){var b=a.GetBodyA(),c=a.GetBodyB(),d=b.m_xf.position,e=c.m_xf.position,o=a.GetAnchorA(),f=a.GetAnchorB(),g=u.s_jointColor;switch(a.m_type){case V.e_distanceJoint:this.m_debugDraw.DrawSegment(o,f,g);break;case V.e_pulleyJoint:b=a instanceof S?a:null;a=b.GetGroundAnchorA();b=b.GetGroundAnchorB();this.m_debugDraw.DrawSegment(a,o,g);this.m_debugDraw.DrawSegment(b,f,g);this.m_debugDraw.DrawSegment(a,b,g);break;case V.e_mouseJoint:this.m_debugDraw.DrawSegment(o,f,g);break;default:b!=this.m_groundBody&&
this.m_debugDraw.DrawSegment(d,o,g),this.m_debugDraw.DrawSegment(o,f,g),c!=this.m_groundBody&&this.m_debugDraw.DrawSegment(e,f,g)}};u.prototype.DrawShape=function(a,c,d){switch(a.m_type){case G.e_circleShape:var e=a instanceof B?a:null;this.m_debugDraw.DrawSolidCircle(b.MulX(c,e.m_p),e.m_radius,c.R.col1,d);break;case G.e_polygonShape:for(var e=0,e=a instanceof y?a:null,a=parseInt(e.GetVertexCount()),o=e.GetVertices(),f=new j(a),e=0;e<a;++e)f[e]=b.MulX(c,o[e]);this.m_debugDraw.DrawSolidPolygon(f,a,
d);break;case G.e_edgeShape:e=a instanceof A?a:null,this.m_debugDraw.DrawSegment(b.MulX(c,e.GetVertex1()),b.MulX(c,e.GetVertex2()),d)}};a.postDefs.push(function(){a.Dynamics.b2World.s_timestep2=new o;a.Dynamics.b2World.s_xf=new d;a.Dynamics.b2World.s_backupA=new e;a.Dynamics.b2World.s_backupB=new e;a.Dynamics.b2World.s_timestep=new o;a.Dynamics.b2World.s_queue=new j;a.Dynamics.b2World.s_jointColor=new l(0.5,0.8,0.8);a.Dynamics.b2World.e_newFixture=1;a.Dynamics.b2World.e_locked=2})})();(function(){var b=
a.Collision.Shapes.b2CircleShape,e=a.Collision.Shapes.b2EdgeShape,d=a.Collision.Shapes.b2PolygonShape,f=a.Collision.Shapes.b2Shape,l=a.Dynamics.Contacts.b2CircleContact,h=a.Dynamics.Contacts.b2Contact,q=a.Dynamics.Contacts.b2ContactConstraint,c=a.Dynamics.Contacts.b2ContactConstraintPoint,k=a.Dynamics.Contacts.b2ContactEdge,n=a.Dynamics.Contacts.b2ContactFactory,D=a.Dynamics.Contacts.b2ContactRegister,B=a.Dynamics.Contacts.b2ContactResult,A=a.Dynamics.Contacts.b2ContactSolver,w=a.Dynamics.Contacts.b2EdgeAndCircleContact,
y=a.Dynamics.Contacts.b2NullContact,G=a.Dynamics.Contacts.b2PolyAndCircleContact,p=a.Dynamics.Contacts.b2PolyAndEdgeContact,L=a.Dynamics.Contacts.b2PolygonContact,J=a.Dynamics.Contacts.b2PositionSolverManifold,M=a.Dynamics.b2Body,I=a.Dynamics.b2TimeStep,C=a.Common.b2Settings,F=a.Common.Math.b2Mat22,R=a.Common.Math.b2Math,K=a.Common.Math.b2Vec2,N=a.Collision.b2Collision,U=a.Collision.b2ContactID,Q=a.Collision.b2Manifold,o=a.Collision.b2TimeOfImpact,u=a.Collision.b2TOIInput,E=a.Collision.b2WorldManifold;
a.inherit(l,a.Dynamics.Contacts.b2Contact);l.prototype.__super=a.Dynamics.Contacts.b2Contact.prototype;l.b2CircleContact=function(){a.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};l.Create=function(){return new l};l.Destroy=function(){};l.prototype.Reset=function(a,b){this.__super.Reset.call(this,a,b)};l.prototype.Evaluate=function(){var a=this.m_fixtureA.GetBody(),c=this.m_fixtureB.GetBody();N.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof b?this.m_fixtureA.GetShape():
null,a.m_xf,this.m_fixtureB.GetShape()instanceof b?this.m_fixtureB.GetShape():null,c.m_xf)};h.b2Contact=function(){this.m_nodeA=new k;this.m_nodeB=new k;this.m_manifold=new Q;this.m_oldManifold=new Q};h.prototype.GetManifold=function(){return this.m_manifold};h.prototype.GetWorldManifold=function(a){var b=this.m_fixtureA.GetBody(),c=this.m_fixtureB.GetBody(),d=this.m_fixtureA.GetShape(),e=this.m_fixtureB.GetShape();a.Initialize(this.m_manifold,b.GetTransform(),d.m_radius,c.GetTransform(),e.m_radius)};
h.prototype.IsTouching=function(){return(this.m_flags&h.e_touchingFlag)==h.e_touchingFlag};h.prototype.IsContinuous=function(){return(this.m_flags&h.e_continuousFlag)==h.e_continuousFlag};h.prototype.SetSensor=function(a){a?this.m_flags|=h.e_sensorFlag:this.m_flags&=~h.e_sensorFlag};h.prototype.IsSensor=function(){return(this.m_flags&h.e_sensorFlag)==h.e_sensorFlag};h.prototype.SetEnabled=function(a){a?this.m_flags|=h.e_enabledFlag:this.m_flags&=~h.e_enabledFlag};h.prototype.IsEnabled=function(){return(this.m_flags&
h.e_enabledFlag)==h.e_enabledFlag};h.prototype.GetNext=function(){return this.m_next};h.prototype.GetFixtureA=function(){return this.m_fixtureA};h.prototype.GetFixtureB=function(){return this.m_fixtureB};h.prototype.FlagForFiltering=function(){this.m_flags|=h.e_filterFlag};h.prototype.b2Contact=function(){};h.prototype.Reset=function(a,b){a===void 0&&(a=null);b===void 0&&(b=null);this.m_flags=h.e_enabledFlag;if(!a||!b)this.m_fixtureB=this.m_fixtureA=null;else{if(a.IsSensor()||b.IsSensor())this.m_flags|=
h.e_sensorFlag;var c=a.GetBody(),d=b.GetBody();if(c.GetType()!=M.b2_dynamicBody||c.IsBullet()||d.GetType()!=M.b2_dynamicBody||d.IsBullet())this.m_flags|=h.e_continuousFlag;this.m_fixtureA=a;this.m_fixtureB=b;this.m_manifold.m_pointCount=0;this.m_next=this.m_prev=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null}};h.prototype.Update=function(a){var b=this.m_oldManifold;
this.m_oldManifold=this.m_manifold;this.m_manifold=b;this.m_flags|=h.e_enabledFlag;var c=!1,b=(this.m_flags&h.e_touchingFlag)==h.e_touchingFlag,d=this.m_fixtureA.m_body,e=this.m_fixtureB.m_body,o=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&h.e_sensorFlag)o&&(c=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape(),d=d.GetTransform(),e=e.GetTransform(),c=f.TestOverlap(c,d,o,e)),this.m_manifold.m_pointCount=0;else{d.GetType()!=M.b2_dynamicBody||d.IsBullet()||e.GetType()!=
M.b2_dynamicBody||e.IsBullet()?this.m_flags|=h.e_continuousFlag:this.m_flags&=~h.e_continuousFlag;if(o){this.Evaluate();c=this.m_manifold.m_pointCount>0;for(o=0;o<this.m_manifold.m_pointCount;++o){var g=this.m_manifold.m_points[o];g.m_normalImpulse=0;g.m_tangentImpulse=0;for(var u=g.m_id,j=0;j<this.m_oldManifold.m_pointCount;++j){var l=this.m_oldManifold.m_points[j];if(l.m_id.key==u.key){g.m_normalImpulse=l.m_normalImpulse;g.m_tangentImpulse=l.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=
0;c!=b&&(d.SetAwake(!0),e.SetAwake(!0))}c?this.m_flags|=h.e_touchingFlag:this.m_flags&=~h.e_touchingFlag;b==!1&&c==!0&&a.BeginContact(this);b==!0&&c==!1&&a.EndContact(this);(this.m_flags&h.e_sensorFlag)==0&&a.PreSolve(this,this.m_oldManifold)};h.prototype.Evaluate=function(){};h.prototype.ComputeTOI=function(a,b){h.s_input.proxyA.Set(this.m_fixtureA.GetShape());h.s_input.proxyB.Set(this.m_fixtureB.GetShape());h.s_input.sweepA=a;h.s_input.sweepB=b;h.s_input.tolerance=C.b2_linearSlop;return o.TimeOfImpact(h.s_input)};
a.postDefs.push(function(){a.Dynamics.Contacts.b2Contact.e_sensorFlag=1;a.Dynamics.Contacts.b2Contact.e_continuousFlag=2;a.Dynamics.Contacts.b2Contact.e_islandFlag=4;a.Dynamics.Contacts.b2Contact.e_toiFlag=8;a.Dynamics.Contacts.b2Contact.e_touchingFlag=16;a.Dynamics.Contacts.b2Contact.e_enabledFlag=32;a.Dynamics.Contacts.b2Contact.e_filterFlag=64;a.Dynamics.Contacts.b2Contact.s_input=new u});q.b2ContactConstraint=function(){this.localPlaneNormal=new K;this.localPoint=new K;this.normal=new K;this.normalMass=
new F;this.K=new F};q.prototype.b2ContactConstraint=function(){this.points=new j(C.b2_maxManifoldPoints);for(var a=0;a<C.b2_maxManifoldPoints;a++)this.points[a]=new c};c.b2ContactConstraintPoint=function(){this.localPoint=new K;this.rA=new K;this.rB=new K};k.b2ContactEdge=function(){};n.b2ContactFactory=function(){};n.prototype.b2ContactFactory=function(a){this.m_allocator=a;this.InitializeRegisters()};n.prototype.AddType=function(a,b,c,d){c===void 0&&(c=0);d===void 0&&(d=0);this.m_registers[c][d].createFcn=
a;this.m_registers[c][d].destroyFcn=b;this.m_registers[c][d].primary=!0;if(c!=d)this.m_registers[d][c].createFcn=a,this.m_registers[d][c].destroyFcn=b,this.m_registers[d][c].primary=!1};n.prototype.InitializeRegisters=function(){this.m_registers=new j(f.e_shapeTypeCount);for(var a=0;a<f.e_shapeTypeCount;a++){this.m_registers[a]=new j(f.e_shapeTypeCount);for(var b=0;b<f.e_shapeTypeCount;b++)this.m_registers[a][b]=new D}this.AddType(l.Create,l.Destroy,f.e_circleShape,f.e_circleShape);this.AddType(G.Create,
G.Destroy,f.e_polygonShape,f.e_circleShape);this.AddType(L.Create,L.Destroy,f.e_polygonShape,f.e_polygonShape);this.AddType(w.Create,w.Destroy,f.e_edgeShape,f.e_circleShape);this.AddType(p.Create,p.Destroy,f.e_polygonShape,f.e_edgeShape)};n.prototype.Create=function(a,b){var c=parseInt(a.GetType()),d=parseInt(b.GetType()),c=this.m_registers[c][d];if(c.pool)return d=c.pool,c.pool=d.m_next,c.poolCount--,d.Reset(a,b),d;d=c.createFcn;return d!=null?(c.primary?(d=d(this.m_allocator),d.Reset(a,b)):(d=d(this.m_allocator),
d.Reset(b,a)),d):null};n.prototype.Destroy=function(a){a.m_manifold.m_pointCount>0&&(a.m_fixtureA.m_body.SetAwake(!0),a.m_fixtureB.m_body.SetAwake(!0));var b=parseInt(a.m_fixtureA.GetType()),c=parseInt(a.m_fixtureB.GetType()),b=this.m_registers[b][c];b.poolCount++;a.m_next=b.pool;b.pool=a;b=b.destroyFcn;b(a,this.m_allocator)};D.b2ContactRegister=function(){};B.b2ContactResult=function(){this.position=new K;this.normal=new K;this.id=new U};A.b2ContactSolver=function(){this.m_step=new I;this.m_constraints=
new j};A.prototype.b2ContactSolver=function(){};A.prototype.Initialize=function(a,b,c,d){c===void 0&&(c=0);var e;this.m_step.Set(a);this.m_allocator=d;a=0;for(this.m_constraintCount=c;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new q;for(a=0;a<c;++a){e=b[a];var d=e.m_fixtureA,o=e.m_fixtureB,f=d.m_shape.m_radius,g=o.m_shape.m_radius,h=d.m_body,u=o.m_body,j=e.GetManifold(),l=C.b2MixFriction(d.GetFriction(),o.GetFriction()),E=C.b2MixRestitution(d.GetRestitution(),
o.GetRestitution()),m=h.m_linearVelocity.x,k=h.m_linearVelocity.y,n=u.m_linearVelocity.x,p=u.m_linearVelocity.y,w=h.m_angularVelocity,z=u.m_angularVelocity;C.b2Assert(j.m_pointCount>0);A.s_worldManifold.Initialize(j,h.m_xf,f,u.m_xf,g);o=A.s_worldManifold.m_normal.x;e=A.s_worldManifold.m_normal.y;d=this.m_constraints[a];d.bodyA=h;d.bodyB=u;d.manifold=j;d.normal.x=o;d.normal.y=e;d.pointCount=j.m_pointCount;d.friction=l;d.restitution=E;d.localPlaneNormal.x=j.m_localPlaneNormal.x;d.localPlaneNormal.y=
j.m_localPlaneNormal.y;d.localPoint.x=j.m_localPoint.x;d.localPoint.y=j.m_localPoint.y;d.radius=f+g;d.type=j.m_type;for(f=0;f<d.pointCount;++f){l=j.m_points[f];g=d.points[f];g.normalImpulse=l.m_normalImpulse;g.tangentImpulse=l.m_tangentImpulse;g.localPoint.SetV(l.m_localPoint);var l=g.rA.x=A.s_worldManifold.m_points[f].x-h.m_sweep.c.x,E=g.rA.y=A.s_worldManifold.m_points[f].y-h.m_sweep.c.y,B=g.rB.x=A.s_worldManifold.m_points[f].x-u.m_sweep.c.x,y=g.rB.y=A.s_worldManifold.m_points[f].y-u.m_sweep.c.y,
D=l*e-E*o,P=B*e-y*o;D*=D;P*=P;g.normalMass=1/(h.m_invMass+u.m_invMass+h.m_invI*D+u.m_invI*P);var G=h.m_mass*h.m_invMass+u.m_mass*u.m_invMass;G+=h.m_mass*h.m_invI*D+u.m_mass*u.m_invI*P;g.equalizedMass=1/G;P=e;G=-o;D=l*G-E*P;P=B*G-y*P;D*=D;P*=P;g.tangentMass=1/(h.m_invMass+u.m_invMass+h.m_invI*D+u.m_invI*P);g.velocityBias=0;l=d.normal.x*(n+-z*y-m- -w*E)+d.normal.y*(p+z*B-k-w*l);l<-C.b2_velocityThreshold&&(g.velocityBias+=-d.restitution*l)}if(d.pointCount==2)p=d.points[0],n=d.points[1],j=h.m_invMass,
h=h.m_invI,m=u.m_invMass,u=u.m_invI,k=p.rA.x*e-p.rA.y*o,p=p.rB.x*e-p.rB.y*o,w=n.rA.x*e-n.rA.y*o,n=n.rB.x*e-n.rB.y*o,o=j+m+h*k*k+u*p*p,e=j+m+h*w*w+u*n*n,u=j+m+h*k*w+u*p*n,o*o<100*(o*e-u*u)?(d.K.col1.Set(o,u),d.K.col2.Set(u,e),d.K.GetInverse(d.normalMass)):d.pointCount=1}};A.prototype.InitVelocityConstraints=function(a){for(var b=0;b<this.m_constraintCount;++b){var c=this.m_constraints[b],d=c.bodyA,e=c.bodyB,o=d.m_invMass,f=d.m_invI,g=e.m_invMass,h=e.m_invI,u=c.normal.x,j=c.normal.y,l=j,E=-u,q=0,m=
0;if(a.warmStarting){m=c.pointCount;for(q=0;q<m;++q){var k=c.points[q];k.normalImpulse*=a.dtRatio;k.tangentImpulse*=a.dtRatio;var n=k.normalImpulse*u+k.tangentImpulse*l,p=k.normalImpulse*j+k.tangentImpulse*E;d.m_angularVelocity-=f*(k.rA.x*p-k.rA.y*n);d.m_linearVelocity.x-=o*n;d.m_linearVelocity.y-=o*p;e.m_angularVelocity+=h*(k.rB.x*p-k.rB.y*n);e.m_linearVelocity.x+=g*n;e.m_linearVelocity.y+=g*p}}else{m=c.pointCount;for(q=0;q<m;++q)d=c.points[q],d.normalImpulse=0,d.tangentImpulse=0}}};A.prototype.SolveVelocityConstraints=
function(){for(var a=0,b,c=0,d=0,e=0,o=d=d=c=c=0,f=c=c=0,g=c=e=0,h=0,u,j=0;j<this.m_constraintCount;++j){var e=this.m_constraints[j],l=e.bodyA,E=e.bodyB,q=l.m_angularVelocity,m=E.m_angularVelocity,k=l.m_linearVelocity,n=E.m_linearVelocity,p=l.m_invMass,w=l.m_invI,z=E.m_invMass,A=E.m_invI,g=e.normal.x,B=h=e.normal.y;u=-g;f=e.friction;for(a=0;a<e.pointCount;a++)b=e.points[a],c=n.x-m*b.rB.y-k.x+q*b.rA.y,d=n.y+m*b.rB.x-k.y-q*b.rA.x,c=c*B+d*u,c=b.tangentMass*-c,d=f*b.normalImpulse,d=R.Clamp(b.tangentImpulse+
c,-d,d),c=d-b.tangentImpulse,o=c*B,c*=u,k.x-=p*o,k.y-=p*c,q-=w*(b.rA.x*c-b.rA.y*o),n.x+=z*o,n.y+=z*c,m+=A*(b.rB.x*c-b.rB.y*o),b.tangentImpulse=d;parseInt(e.pointCount);if(e.pointCount==1)b=e.points[0],c=n.x+-m*b.rB.y-k.x- -q*b.rA.y,d=n.y+m*b.rB.x-k.y-q*b.rA.x,e=c*g+d*h,c=-b.normalMass*(e-b.velocityBias),d=b.normalImpulse+c,d=d>0?d:0,c=d-b.normalImpulse,o=c*g,c*=h,k.x-=p*o,k.y-=p*c,q-=w*(b.rA.x*c-b.rA.y*o),n.x+=z*o,n.y+=z*c,m+=A*(b.rB.x*c-b.rB.y*o),b.normalImpulse=d;else{b=e.points[0];var a=e.points[1],
c=b.normalImpulse,f=a.normalImpulse,y=(n.x-m*b.rB.y-k.x+q*b.rA.y)*g+(n.y+m*b.rB.x-k.y-q*b.rA.x)*h,D=(n.x-m*a.rB.y-k.x+q*a.rA.y)*g+(n.y+m*a.rB.x-k.y-q*a.rA.x)*h,d=y-b.velocityBias,o=D-a.velocityBias;u=e.K;d-=u.col1.x*c+u.col2.x*f;for(o-=u.col1.y*c+u.col2.y*f;;){u=e.normalMass;B=-(u.col1.x*d+u.col2.x*o);u=-(u.col1.y*d+u.col2.y*o);if(B>=0&&u>=0){c=B-c;f=u-f;e=c*g;c*=h;g*=f;h*=f;k.x-=p*(e+g);k.y-=p*(c+h);q-=w*(b.rA.x*c-b.rA.y*e+a.rA.x*h-a.rA.y*g);n.x+=z*(e+g);n.y+=z*(c+h);m+=A*(b.rB.x*c-b.rB.y*e+a.rB.x*
h-a.rB.y*g);b.normalImpulse=B;a.normalImpulse=u;break}B=-b.normalMass*d;u=0;D=e.K.col1.y*B+o;if(B>=0&&D>=0){c=B-c;f=u-f;e=c*g;c*=h;g*=f;h*=f;k.x-=p*(e+g);k.y-=p*(c+h);q-=w*(b.rA.x*c-b.rA.y*e+a.rA.x*h-a.rA.y*g);n.x+=z*(e+g);n.y+=z*(c+h);m+=A*(b.rB.x*c-b.rB.y*e+a.rB.x*h-a.rB.y*g);b.normalImpulse=B;a.normalImpulse=u;break}B=0;u=-a.normalMass*o;y=e.K.col2.x*u+d;if(u>=0&&y>=0){c=B-c;f=u-f;e=c*g;c*=h;g*=f;h*=f;k.x-=p*(e+g);k.y-=p*(c+h);q-=w*(b.rA.x*c-b.rA.y*e+a.rA.x*h-a.rA.y*g);n.x+=z*(e+g);n.y+=z*(c+h);
m+=A*(b.rB.x*c-b.rB.y*e+a.rB.x*h-a.rB.y*g);b.normalImpulse=B;a.normalImpulse=u;break}u=B=0;y=d;D=o;if(y>=0&&D>=0){c=B-c;f=u-f;e=c*g;c*=h;g*=f;h*=f;k.x-=p*(e+g);k.y-=p*(c+h);q-=w*(b.rA.x*c-b.rA.y*e+a.rA.x*h-a.rA.y*g);n.x+=z*(e+g);n.y+=z*(c+h);m+=A*(b.rB.x*c-b.rB.y*e+a.rB.x*h-a.rB.y*g);b.normalImpulse=B;a.normalImpulse=u;break}break}}l.m_angularVelocity=q;E.m_angularVelocity=m}};A.prototype.FinalizeVelocityConstraints=function(){for(var a=0;a<this.m_constraintCount;++a)for(var b=this.m_constraints[a],
c=b.manifold,d=0;d<b.pointCount;++d){var e=c.m_points[d],o=b.points[d];e.m_normalImpulse=o.normalImpulse;e.m_tangentImpulse=o.tangentImpulse}};A.prototype.SolvePositionConstraints=function(a){a===void 0&&(a=0);for(var b=0,c=0;c<this.m_constraintCount;c++){var d=this.m_constraints[c],e=d.bodyA,o=d.bodyB,f=e.m_mass*e.m_invMass,g=e.m_mass*e.m_invI,h=o.m_mass*o.m_invMass,u=o.m_mass*o.m_invI;A.s_psm.Initialize(d);for(var j=A.s_psm.m_normal,l=0;l<d.pointCount;l++){var E=d.points[l],q=A.s_psm.m_points[l],
k=A.s_psm.m_separations[l],m=q.x-e.m_sweep.c.x,n=q.y-e.m_sweep.c.y,p=q.x-o.m_sweep.c.x,q=q.y-o.m_sweep.c.y,b=b<k?b:k,k=R.Clamp(a*(k+C.b2_linearSlop),-C.b2_maxLinearCorrection,0);k*=-E.equalizedMass;E=k*j.x;k*=j.y;e.m_sweep.c.x-=f*E;e.m_sweep.c.y-=f*k;e.m_sweep.a-=g*(m*k-n*E);e.SynchronizeTransform();o.m_sweep.c.x+=h*E;o.m_sweep.c.y+=h*k;o.m_sweep.a+=u*(p*k-q*E);o.SynchronizeTransform()}}return b>-1.5*C.b2_linearSlop};a.postDefs.push(function(){a.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new E;
a.Dynamics.Contacts.b2ContactSolver.s_psm=new J});a.inherit(w,a.Dynamics.Contacts.b2Contact);w.prototype.__super=a.Dynamics.Contacts.b2Contact.prototype;w.b2EdgeAndCircleContact=function(){a.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};w.Create=function(){return new w};w.Destroy=function(){};w.prototype.Reset=function(a,b){this.__super.Reset.call(this,a,b)};w.prototype.Evaluate=function(){var a=this.m_fixtureA.GetBody(),c=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,
this.m_fixtureA.GetShape()instanceof e?this.m_fixtureA.GetShape():null,a.m_xf,this.m_fixtureB.GetShape()instanceof b?this.m_fixtureB.GetShape():null,c.m_xf)};w.prototype.b2CollideEdgeAndCircle=function(){};a.inherit(y,a.Dynamics.Contacts.b2Contact);y.prototype.__super=a.Dynamics.Contacts.b2Contact.prototype;y.b2NullContact=function(){a.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};y.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)};y.prototype.Evaluate=function(){};
a.inherit(G,a.Dynamics.Contacts.b2Contact);G.prototype.__super=a.Dynamics.Contacts.b2Contact.prototype;G.b2PolyAndCircleContact=function(){a.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};G.Create=function(){return new G};G.Destroy=function(){};G.prototype.Reset=function(a,b){this.__super.Reset.call(this,a,b);C.b2Assert(a.GetType()==f.e_polygonShape);C.b2Assert(b.GetType()==f.e_circleShape)};G.prototype.Evaluate=function(){var a=this.m_fixtureA.m_body,c=this.m_fixtureB.m_body;N.CollidePolygonAndCircle(this.m_manifold,
this.m_fixtureA.GetShape()instanceof d?this.m_fixtureA.GetShape():null,a.m_xf,this.m_fixtureB.GetShape()instanceof b?this.m_fixtureB.GetShape():null,c.m_xf)};a.inherit(p,a.Dynamics.Contacts.b2Contact);p.prototype.__super=a.Dynamics.Contacts.b2Contact.prototype;p.b2PolyAndEdgeContact=function(){a.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};p.Create=function(){return new p};p.Destroy=function(){};p.prototype.Reset=function(a,b){this.__super.Reset.call(this,a,b);C.b2Assert(a.GetType()==
f.e_polygonShape);C.b2Assert(b.GetType()==f.e_edgeShape)};p.prototype.Evaluate=function(){var a=this.m_fixtureA.GetBody(),b=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof d?this.m_fixtureA.GetShape():null,a.m_xf,this.m_fixtureB.GetShape()instanceof e?this.m_fixtureB.GetShape():null,b.m_xf)};p.prototype.b2CollidePolyAndEdge=function(){};a.inherit(L,a.Dynamics.Contacts.b2Contact);L.prototype.__super=a.Dynamics.Contacts.b2Contact.prototype;L.b2PolygonContact=
function(){a.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};L.Create=function(){return new L};L.Destroy=function(){};L.prototype.Reset=function(a,b){this.__super.Reset.call(this,a,b)};L.prototype.Evaluate=function(){var a=this.m_fixtureA.GetBody(),b=this.m_fixtureB.GetBody();N.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof d?this.m_fixtureA.GetShape():null,a.m_xf,this.m_fixtureB.GetShape()instanceof d?this.m_fixtureB.GetShape():null,b.m_xf)};J.b2PositionSolverManifold=
function(){};J.prototype.b2PositionSolverManifold=function(){this.m_normal=new K;this.m_separations=new m(C.b2_maxManifoldPoints);this.m_points=new j(C.b2_maxManifoldPoints);for(var a=0;a<C.b2_maxManifoldPoints;a++)this.m_points[a]=new K};J.prototype.Initialize=function(a){C.b2Assert(a.pointCount>0);var b=0,c=0,d=0,e,o=0,f=0;switch(a.type){case Q.e_circles:e=a.bodyA.m_xf.R;d=a.localPoint;b=a.bodyA.m_xf.position.x+(e.col1.x*d.x+e.col2.x*d.y);c=a.bodyA.m_xf.position.y+(e.col1.y*d.x+e.col2.y*d.y);e=
a.bodyB.m_xf.R;d=a.points[0].localPoint;o=a.bodyB.m_xf.position.x+(e.col1.x*d.x+e.col2.x*d.y);e=a.bodyB.m_xf.position.y+(e.col1.y*d.x+e.col2.y*d.y);var d=o-b,f=e-c,g=d*d+f*f;g>Number.MIN_VALUE*Number.MIN_VALUE?(g=Math.sqrt(g),this.m_normal.x=d/g,this.m_normal.y=f/g):(this.m_normal.x=1,this.m_normal.y=0);this.m_points[0].x=0.5*(b+o);this.m_points[0].y=0.5*(c+e);this.m_separations[0]=d*this.m_normal.x+f*this.m_normal.y-a.radius;break;case Q.e_faceA:e=a.bodyA.m_xf.R;d=a.localPlaneNormal;this.m_normal.x=
e.col1.x*d.x+e.col2.x*d.y;this.m_normal.y=e.col1.y*d.x+e.col2.y*d.y;e=a.bodyA.m_xf.R;d=a.localPoint;o=a.bodyA.m_xf.position.x+(e.col1.x*d.x+e.col2.x*d.y);f=a.bodyA.m_xf.position.y+(e.col1.y*d.x+e.col2.y*d.y);e=a.bodyB.m_xf.R;for(b=0;b<a.pointCount;++b)d=a.points[b].localPoint,c=a.bodyB.m_xf.position.x+(e.col1.x*d.x+e.col2.x*d.y),d=a.bodyB.m_xf.position.y+(e.col1.y*d.x+e.col2.y*d.y),this.m_separations[b]=(c-o)*this.m_normal.x+(d-f)*this.m_normal.y-a.radius,this.m_points[b].x=c,this.m_points[b].y=d;
break;case Q.e_faceB:e=a.bodyB.m_xf.R;d=a.localPlaneNormal;this.m_normal.x=e.col1.x*d.x+e.col2.x*d.y;this.m_normal.y=e.col1.y*d.x+e.col2.y*d.y;e=a.bodyB.m_xf.R;d=a.localPoint;o=a.bodyB.m_xf.position.x+(e.col1.x*d.x+e.col2.x*d.y);f=a.bodyB.m_xf.position.y+(e.col1.y*d.x+e.col2.y*d.y);e=a.bodyA.m_xf.R;for(b=0;b<a.pointCount;++b)d=a.points[b].localPoint,c=a.bodyA.m_xf.position.x+(e.col1.x*d.x+e.col2.x*d.y),d=a.bodyA.m_xf.position.y+(e.col1.y*d.x+e.col2.y*d.y),this.m_separations[b]=(c-o)*this.m_normal.x+
(d-f)*this.m_normal.y-a.radius,this.m_points[b].Set(c,d);this.m_normal.x*=-1;this.m_normal.y*=-1}};a.postDefs.push(function(){a.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new K;a.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new K})})();(function(){var b=a.Common.Math.b2Mat22,e=a.Common.Math.b2Math,d=a.Common.Math.b2Vec2,f=a.Common.b2Color,j=a.Dynamics.Controllers.b2BuoyancyController,h=a.Dynamics.Controllers.b2ConstantAccelController,q=a.Dynamics.Controllers.b2ConstantForceController,
c=a.Dynamics.Controllers.b2Controller,k=a.Dynamics.Controllers.b2ControllerEdge,m=a.Dynamics.Controllers.b2GravityController,n=a.Dynamics.Controllers.b2TensorDampingController;a.inherit(j,a.Dynamics.Controllers.b2Controller);j.prototype.__super=a.Dynamics.Controllers.b2Controller.prototype;j.b2BuoyancyController=function(){a.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.normal=new d(0,-1);this.density=this.offset=0;this.velocity=new d(0,0);this.linearDrag=2;this.angularDrag=
1;this.useDensity=!1;this.useWorldGravity=!0;this.gravity=null};j.prototype.Step=function(){if(this.m_bodyList){if(this.useWorldGravity)this.gravity=this.GetWorld().GetGravity().Copy();for(var a=this.m_bodyList;a;a=a.nextBody){var b=a.body;if(b.IsAwake()!=!1){for(var c=new d,e=new d,f=0,g=0,h=b.GetFixtureList();h;h=h.GetNext()){var j=new d,l=h.GetShape().ComputeSubmergedArea(this.normal,this.offset,b.GetTransform(),j);f+=l;c.x+=l*j.x;c.y+=l*j.y;var k=0,k=1;g+=l*k;e.x+=l*j.x*k;e.y+=l*j.y*k}c.x/=f;
c.y/=f;e.x/=g;e.y/=g;f<Number.MIN_VALUE||(g=this.gravity.GetNegative(),g.Multiply(this.density*f),b.ApplyForce(g,e),e=b.GetLinearVelocityFromWorldPoint(c),e.Subtract(this.velocity),e.Multiply(-this.linearDrag*f),b.ApplyForce(e,c),b.ApplyTorque(-b.GetInertia()/b.GetMass()*f*b.GetAngularVelocity()*this.angularDrag))}}}};j.prototype.Draw=function(a){var b=new d,c=new d;b.x=this.normal.x*this.offset+this.normal.y*1E3;b.y=this.normal.y*this.offset-this.normal.x*1E3;c.x=this.normal.x*this.offset-this.normal.y*
1E3;c.y=this.normal.y*this.offset+this.normal.x*1E3;var e=new f(0,0,1);a.DrawSegment(b,c,e)};a.inherit(h,a.Dynamics.Controllers.b2Controller);h.prototype.__super=a.Dynamics.Controllers.b2Controller.prototype;h.b2ConstantAccelController=function(){a.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.A=new d(0,0)};h.prototype.Step=function(a){for(var a=new d(this.A.x*a.dt,this.A.y*a.dt),b=this.m_bodyList;b;b=b.nextBody){var c=b.body;c.IsAwake()&&c.SetLinearVelocity(new d(c.GetLinearVelocity().x+
a.x,c.GetLinearVelocity().y+a.y))}};a.inherit(q,a.Dynamics.Controllers.b2Controller);q.prototype.__super=a.Dynamics.Controllers.b2Controller.prototype;q.b2ConstantForceController=function(){a.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.F=new d(0,0)};q.prototype.Step=function(){for(var a=this.m_bodyList;a;a=a.nextBody){var b=a.body;b.IsAwake()&&b.ApplyForce(this.F,b.GetWorldCenter())}};c.b2Controller=function(){};c.prototype.Step=function(){};c.prototype.Draw=function(){};
c.prototype.AddBody=function(a){var b=new k;b.controller=this;b.body=a;b.nextBody=this.m_bodyList;b.prevBody=null;this.m_bodyList=b;if(b.nextBody)b.nextBody.prevBody=b;this.m_bodyCount++;b.nextController=a.m_controllerList;b.prevController=null;a.m_controllerList=b;if(b.nextController)b.nextController.prevController=b;a.m_controllerCount++};c.prototype.RemoveBody=function(a){for(var b=a.m_controllerList;b&&b.controller!=this;)b=b.nextController;if(b.prevBody)b.prevBody.nextBody=b.nextBody;if(b.nextBody)b.nextBody.prevBody=
b.prevBody;if(b.nextController)b.nextController.prevController=b.prevController;if(b.prevController)b.prevController.nextController=b.nextController;if(this.m_bodyList==b)this.m_bodyList=b.nextBody;if(a.m_controllerList==b)a.m_controllerList=b.nextController;a.m_controllerCount--;this.m_bodyCount--};c.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)};c.prototype.GetNext=function(){return this.m_next};c.prototype.GetWorld=function(){return this.m_world};c.prototype.GetBodyList=
function(){return this.m_bodyList};k.b2ControllerEdge=function(){};a.inherit(m,a.Dynamics.Controllers.b2Controller);m.prototype.__super=a.Dynamics.Controllers.b2Controller.prototype;m.b2GravityController=function(){a.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.G=1;this.invSqr=!0};m.prototype.Step=function(){var a=null,b=null,c=null,e=0,f=null,g=null,h=null,j=0,l=0,k=0,j=null;if(this.invSqr)for(a=this.m_bodyList;a;a=a.nextBody){b=a.body;c=b.GetWorldCenter();e=b.GetMass();
for(f=this.m_bodyList;f!=a;f=f.nextBody)g=f.body,h=g.GetWorldCenter(),j=h.x-c.x,l=h.y-c.y,k=j*j+l*l,k<Number.MIN_VALUE||(j=new d(j,l),j.Multiply(this.G/k/Math.sqrt(k)*e*g.GetMass()),b.IsAwake()&&b.ApplyForce(j,c),j.Multiply(-1),g.IsAwake()&&g.ApplyForce(j,h))}else for(a=this.m_bodyList;a;a=a.nextBody){b=a.body;c=b.GetWorldCenter();e=b.GetMass();for(f=this.m_bodyList;f!=a;f=f.nextBody)g=f.body,h=g.GetWorldCenter(),j=h.x-c.x,l=h.y-c.y,k=j*j+l*l,k<Number.MIN_VALUE||(j=new d(j,l),j.Multiply(this.G/k*
e*g.GetMass()),b.IsAwake()&&b.ApplyForce(j,c),j.Multiply(-1),g.IsAwake()&&g.ApplyForce(j,h))}};a.inherit(n,a.Dynamics.Controllers.b2Controller);n.prototype.__super=a.Dynamics.Controllers.b2Controller.prototype;n.b2TensorDampingController=function(){a.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.T=new b;this.maxTimestep=0};n.prototype.SetAxisAligned=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);this.T.col1.x=-a;this.T.col1.y=0;this.T.col2.x=0;this.T.col2.y=-b;this.maxTimestep=
a>0||b>0?1/Math.max(a,b):0};n.prototype.Step=function(a){a=a.dt;if(!(a<=Number.MIN_VALUE)){if(a>this.maxTimestep&&this.maxTimestep>0)a=this.maxTimestep;for(var b=this.m_bodyList;b;b=b.nextBody){var c=b.body;if(c.IsAwake()){var f=c.GetWorldVector(e.MulMV(this.T,c.GetLocalVector(c.GetLinearVelocity())));c.SetLinearVelocity(new d(c.GetLinearVelocity().x+f.x*a,c.GetLinearVelocity().y+f.y*a))}}}}})();(function(){var b=a.Common.b2Settings,e=a.Common.Math.b2Mat22,d=a.Common.Math.b2Mat33,f=a.Common.Math.b2Math,
j=a.Common.Math.b2Vec2,h=a.Common.Math.b2Vec3,k=a.Dynamics.Joints.b2DistanceJoint,c=a.Dynamics.Joints.b2DistanceJointDef,m=a.Dynamics.Joints.b2FrictionJoint,n=a.Dynamics.Joints.b2FrictionJointDef,D=a.Dynamics.Joints.b2GearJoint,B=a.Dynamics.Joints.b2GearJointDef,A=a.Dynamics.Joints.b2Jacobian,w=a.Dynamics.Joints.b2Joint,y=a.Dynamics.Joints.b2JointDef,G=a.Dynamics.Joints.b2JointEdge,p=a.Dynamics.Joints.b2LineJoint,L=a.Dynamics.Joints.b2LineJointDef,J=a.Dynamics.Joints.b2MouseJoint,M=a.Dynamics.Joints.b2MouseJointDef,
I=a.Dynamics.Joints.b2PrismaticJoint,C=a.Dynamics.Joints.b2PrismaticJointDef,F=a.Dynamics.Joints.b2PulleyJoint,R=a.Dynamics.Joints.b2PulleyJointDef,K=a.Dynamics.Joints.b2RevoluteJoint,N=a.Dynamics.Joints.b2RevoluteJointDef,U=a.Dynamics.Joints.b2WeldJoint,Q=a.Dynamics.Joints.b2WeldJointDef;a.inherit(k,a.Dynamics.Joints.b2Joint);k.prototype.__super=a.Dynamics.Joints.b2Joint.prototype;k.b2DistanceJoint=function(){a.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new j;this.m_localAnchor2=
new j;this.m_u=new j};k.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};k.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};k.prototype.GetReactionForce=function(a){a===void 0&&(a=0);return new j(a*this.m_impulse*this.m_u.x,a*this.m_impulse*this.m_u.y)};k.prototype.GetReactionTorque=function(){return 0};k.prototype.GetLength=function(){return this.m_length};k.prototype.SetLength=function(a){a===void 0&&(a=0);this.m_length=
a};k.prototype.GetFrequency=function(){return this.m_frequencyHz};k.prototype.SetFrequency=function(a){a===void 0&&(a=0);this.m_frequencyHz=a};k.prototype.GetDampingRatio=function(){return this.m_dampingRatio};k.prototype.SetDampingRatio=function(a){a===void 0&&(a=0);this.m_dampingRatio=a};k.prototype.b2DistanceJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchor1.SetV(a.localAnchorA);this.m_localAnchor2.SetV(a.localAnchorB);this.m_length=a.length;this.m_frequencyHz=a.frequencyHz;
this.m_dampingRatio=a.dampingRatio;this.m_bias=this.m_gamma=this.m_impulse=0};k.prototype.InitVelocityConstraints=function(a){var c,d=0,e=this.m_bodyA,f=this.m_bodyB;c=e.m_xf.R;var h=this.m_localAnchor1.x-e.m_sweep.localCenter.x,j=this.m_localAnchor1.y-e.m_sweep.localCenter.y,d=c.col1.x*h+c.col2.x*j,j=c.col1.y*h+c.col2.y*j,h=d;c=f.m_xf.R;var t=this.m_localAnchor2.x-f.m_sweep.localCenter.x,r=this.m_localAnchor2.y-f.m_sweep.localCenter.y,d=c.col1.x*t+c.col2.x*r,r=c.col1.y*t+c.col2.y*r,t=d;this.m_u.x=
f.m_sweep.c.x+t-e.m_sweep.c.x-h;this.m_u.y=f.m_sweep.c.y+r-e.m_sweep.c.y-j;d=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);d>b.b2_linearSlop?this.m_u.Multiply(1/d):this.m_u.SetZero();c=h*this.m_u.y-j*this.m_u.x;var l=t*this.m_u.y-r*this.m_u.x;c=e.m_invMass+e.m_invI*c*c+f.m_invMass+f.m_invI*l*l;this.m_mass=c!=0?1/c:0;if(this.m_frequencyHz>0){d-=this.m_length;var l=2*Math.PI*this.m_frequencyHz,k=this.m_mass*l*l;this.m_gamma=a.dt*(2*this.m_mass*this.m_dampingRatio*l+a.dt*k);this.m_gamma=this.m_gamma!=
0?1/this.m_gamma:0;this.m_bias=d*a.dt*k*this.m_gamma;this.m_mass=c+this.m_gamma;this.m_mass=this.m_mass!=0?1/this.m_mass:0}a.warmStarting?(this.m_impulse*=a.dtRatio,a=this.m_impulse*this.m_u.x,c=this.m_impulse*this.m_u.y,e.m_linearVelocity.x-=e.m_invMass*a,e.m_linearVelocity.y-=e.m_invMass*c,e.m_angularVelocity-=e.m_invI*(h*c-j*a),f.m_linearVelocity.x+=f.m_invMass*a,f.m_linearVelocity.y+=f.m_invMass*c,f.m_angularVelocity+=f.m_invI*(t*c-r*a)):this.m_impulse=0};k.prototype.SolveVelocityConstraints=
function(){var a,b=this.m_bodyA,c=this.m_bodyB;a=b.m_xf.R;var d=this.m_localAnchor1.x-b.m_sweep.localCenter.x,e=this.m_localAnchor1.y-b.m_sweep.localCenter.y,f=a.col1.x*d+a.col2.x*e,e=a.col1.y*d+a.col2.y*e,d=f;a=c.m_xf.R;var g=this.m_localAnchor2.x-c.m_sweep.localCenter.x,h=this.m_localAnchor2.y-c.m_sweep.localCenter.y,f=a.col1.x*g+a.col2.x*h,h=a.col1.y*g+a.col2.y*h,g=f,f=-this.m_mass*(this.m_u.x*(c.m_linearVelocity.x+-c.m_angularVelocity*h-(b.m_linearVelocity.x+-b.m_angularVelocity*e))+this.m_u.y*
(c.m_linearVelocity.y+c.m_angularVelocity*g-(b.m_linearVelocity.y+b.m_angularVelocity*d))+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=f;a=f*this.m_u.x;f*=this.m_u.y;b.m_linearVelocity.x-=b.m_invMass*a;b.m_linearVelocity.y-=b.m_invMass*f;b.m_angularVelocity-=b.m_invI*(d*f-e*a);c.m_linearVelocity.x+=c.m_invMass*a;c.m_linearVelocity.y+=c.m_invMass*f;c.m_angularVelocity+=c.m_invI*(g*f-h*a)};k.prototype.SolvePositionConstraints=function(){var a;if(this.m_frequencyHz>0)return!0;var c=this.m_bodyA,
d=this.m_bodyB;a=c.m_xf.R;var e=this.m_localAnchor1.x-c.m_sweep.localCenter.x,h=this.m_localAnchor1.y-c.m_sweep.localCenter.y,j=a.col1.x*e+a.col2.x*h,h=a.col1.y*e+a.col2.y*h,e=j;a=d.m_xf.R;var l=this.m_localAnchor2.x-d.m_sweep.localCenter.x,t=this.m_localAnchor2.y-d.m_sweep.localCenter.y,j=a.col1.x*l+a.col2.x*t,t=a.col1.y*l+a.col2.y*t,l=j,j=d.m_sweep.c.x+l-c.m_sweep.c.x-e,r=d.m_sweep.c.y+t-c.m_sweep.c.y-h;a=Math.sqrt(j*j+r*r);j/=a;r/=a;a-=this.m_length;a=f.Clamp(a,-b.b2_maxLinearCorrection,b.b2_maxLinearCorrection);
var k=-this.m_mass*a;this.m_u.Set(j,r);j=k*this.m_u.x;r=k*this.m_u.y;c.m_sweep.c.x-=c.m_invMass*j;c.m_sweep.c.y-=c.m_invMass*r;c.m_sweep.a-=c.m_invI*(e*r-h*j);d.m_sweep.c.x+=d.m_invMass*j;d.m_sweep.c.y+=d.m_invMass*r;d.m_sweep.a+=d.m_invI*(l*r-t*j);c.SynchronizeTransform();d.SynchronizeTransform();return f.Abs(a)<b.b2_linearSlop};a.inherit(c,a.Dynamics.Joints.b2JointDef);c.prototype.__super=a.Dynamics.Joints.b2JointDef.prototype;c.b2DistanceJointDef=function(){a.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,
arguments);this.localAnchorA=new j;this.localAnchorB=new j};c.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this);this.type=w.e_distanceJoint;this.length=1;this.dampingRatio=this.frequencyHz=0};c.prototype.Initialize=function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(c));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(d));a=d.x-c.x;c=d.y-c.y;this.length=Math.sqrt(a*a+c*c);this.dampingRatio=this.frequencyHz=0};a.inherit(m,a.Dynamics.Joints.b2Joint);
m.prototype.__super=a.Dynamics.Joints.b2Joint.prototype;m.b2FrictionJoint=function(){a.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new j;this.m_localAnchorB=new j;this.m_linearMass=new e;this.m_linearImpulse=new j};m.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};m.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};m.prototype.GetReactionForce=function(a){a===void 0&&(a=0);return new j(a*this.m_linearImpulse.x,
a*this.m_linearImpulse.y)};m.prototype.GetReactionTorque=function(a){a===void 0&&(a=0);return a*this.m_angularImpulse};m.prototype.SetMaxForce=function(a){a===void 0&&(a=0);this.m_maxForce=a};m.prototype.GetMaxForce=function(){return this.m_maxForce};m.prototype.SetMaxTorque=function(a){a===void 0&&(a=0);this.m_maxTorque=a};m.prototype.GetMaxTorque=function(){return this.m_maxTorque};m.prototype.b2FrictionJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchorA.SetV(a.localAnchorA);
this.m_localAnchorB.SetV(a.localAnchorB);this.m_linearMass.SetZero();this.m_angularMass=0;this.m_linearImpulse.SetZero();this.m_angularImpulse=0;this.m_maxForce=a.maxForce;this.m_maxTorque=a.maxTorque};m.prototype.InitVelocityConstraints=function(a){var b,c=0,d=this.m_bodyA,f=this.m_bodyB;b=d.m_xf.R;var g=this.m_localAnchorA.x-d.m_sweep.localCenter.x,h=this.m_localAnchorA.y-d.m_sweep.localCenter.y,c=b.col1.x*g+b.col2.x*h,h=b.col1.y*g+b.col2.y*h,g=c;b=f.m_xf.R;var j=this.m_localAnchorB.x-f.m_sweep.localCenter.x,
r=this.m_localAnchorB.y-f.m_sweep.localCenter.y,c=b.col1.x*j+b.col2.x*r,r=b.col1.y*j+b.col2.y*r,j=c;b=d.m_invMass;var c=f.m_invMass,l=d.m_invI,k=f.m_invI,m=new e;m.col1.x=b+c;m.col2.x=0;m.col1.y=0;m.col2.y=b+c;m.col1.x+=l*h*h;m.col2.x+=-l*g*h;m.col1.y+=-l*g*h;m.col2.y+=l*g*g;m.col1.x+=k*r*r;m.col2.x+=-k*j*r;m.col1.y+=-k*j*r;m.col2.y+=k*j*j;m.GetInverse(this.m_linearMass);this.m_angularMass=l+k;if(this.m_angularMass>0)this.m_angularMass=1/this.m_angularMass;a.warmStarting?(this.m_linearImpulse.x*=
a.dtRatio,this.m_linearImpulse.y*=a.dtRatio,this.m_angularImpulse*=a.dtRatio,a=this.m_linearImpulse,d.m_linearVelocity.x-=b*a.x,d.m_linearVelocity.y-=b*a.y,d.m_angularVelocity-=l*(g*a.y-h*a.x+this.m_angularImpulse),f.m_linearVelocity.x+=c*a.x,f.m_linearVelocity.y+=c*a.y,f.m_angularVelocity+=k*(j*a.y-r*a.x+this.m_angularImpulse)):(this.m_linearImpulse.SetZero(),this.m_angularImpulse=0)};m.prototype.SolveVelocityConstraints=function(a){var b,c=0,d=this.m_bodyA,e=this.m_bodyB,g=d.m_linearVelocity,h=
d.m_angularVelocity,t=e.m_linearVelocity,r=e.m_angularVelocity,k=d.m_invMass,m=e.m_invMass,n=d.m_invI,q=e.m_invI;b=d.m_xf.R;var p=this.m_localAnchorA.x-d.m_sweep.localCenter.x,w=this.m_localAnchorA.y-d.m_sweep.localCenter.y,c=b.col1.x*p+b.col2.x*w,w=b.col1.y*p+b.col2.y*w,p=c;b=e.m_xf.R;var z=this.m_localAnchorB.x-e.m_sweep.localCenter.x,A=this.m_localAnchorB.y-e.m_sweep.localCenter.y,c=b.col1.x*z+b.col2.x*A,A=b.col1.y*z+b.col2.y*A,z=c;b=0;var c=-this.m_angularMass*(r-h),y=this.m_angularImpulse;b=
a.dt*this.m_maxTorque;this.m_angularImpulse=f.Clamp(this.m_angularImpulse+c,-b,b);c=this.m_angularImpulse-y;h-=n*c;r+=q*c;b=f.MulMV(this.m_linearMass,new j(-(t.x-r*A-g.x+h*w),-(t.y+r*z-g.y-h*p)));c=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(b);b=a.dt*this.m_maxForce;this.m_linearImpulse.LengthSquared()>b*b&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(b));b=f.SubtractVV(this.m_linearImpulse,c);g.x-=k*b.x;g.y-=k*b.y;h-=n*(p*b.y-w*b.x);t.x+=m*b.x;t.y+=m*b.y;r+=q*(z*b.y-
A*b.x);d.m_angularVelocity=h;e.m_angularVelocity=r};m.prototype.SolvePositionConstraints=function(){return!0};a.inherit(n,a.Dynamics.Joints.b2JointDef);n.prototype.__super=a.Dynamics.Joints.b2JointDef.prototype;n.b2FrictionJointDef=function(){a.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new j;this.localAnchorB=new j};n.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this);this.type=w.e_frictionJoint;this.maxTorque=this.maxForce=0};n.prototype.Initialize=
function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(c));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(c))};a.inherit(D,a.Dynamics.Joints.b2Joint);D.prototype.__super=a.Dynamics.Joints.b2Joint.prototype;D.b2GearJoint=function(){a.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_groundAnchor1=new j;this.m_groundAnchor2=new j;this.m_localAnchor1=new j;this.m_localAnchor2=new j;this.m_J=new A};D.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};
D.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};D.prototype.GetReactionForce=function(a){a===void 0&&(a=0);return new j(a*this.m_impulse*this.m_J.linearB.x,a*this.m_impulse*this.m_J.linearB.y)};D.prototype.GetReactionTorque=function(a){a===void 0&&(a=0);var b=this.m_bodyB.m_xf.R,c=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,d=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,e=b.col1.x*c+b.col2.x*d,d=b.col1.y*c+b.col2.y*d;return a*(this.m_impulse*
this.m_J.angularB-e*this.m_impulse*this.m_J.linearB.y+d*this.m_impulse*this.m_J.linearB.x)};D.prototype.GetRatio=function(){return this.m_ratio};D.prototype.SetRatio=function(a){a===void 0&&(a=0);this.m_ratio=a};D.prototype.b2GearJoint=function(a){this.__super.b2Joint.call(this,a);var b=parseInt(a.joint1.m_type),c=parseInt(a.joint2.m_type);this.m_prismatic2=this.m_revolute2=this.m_prismatic1=this.m_revolute1=null;var d=0,e=0;this.m_ground1=a.joint1.GetBodyA();this.m_bodyA=a.joint1.GetBodyB();b==w.e_revoluteJoint?
(this.m_revolute1=a.joint1 instanceof K?a.joint1:null,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),d=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=a.joint1 instanceof I?a.joint1:null,this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),d=this.m_prismatic1.GetJointTranslation());this.m_ground2=a.joint2.GetBodyA();this.m_bodyB=a.joint2.GetBodyB();c==w.e_revoluteJoint?
(this.m_revolute2=a.joint2 instanceof K?a.joint2:null,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),e=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=a.joint2 instanceof I?a.joint2:null,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),e=this.m_prismatic2.GetJointTranslation());this.m_ratio=a.ratio;this.m_constant=d+this.m_ratio*e;this.m_impulse=0};D.prototype.InitVelocityConstraints=
function(a){var b=this.m_ground1,c=this.m_ground2,d=this.m_bodyA,e=this.m_bodyB,f=0,g=0,h=0,j=0,l=h=0,k=0;this.m_J.SetZero();this.m_revolute1?(this.m_J.angularA=-1,k+=d.m_invI):(b=b.m_xf.R,g=this.m_prismatic1.m_localXAxis1,f=b.col1.x*g.x+b.col2.x*g.y,g=b.col1.y*g.x+b.col2.y*g.y,b=d.m_xf.R,h=this.m_localAnchor1.x-d.m_sweep.localCenter.x,j=this.m_localAnchor1.y-d.m_sweep.localCenter.y,l=b.col1.x*h+b.col2.x*j,j=b.col1.y*h+b.col2.y*j,h=l*g-j*f,this.m_J.linearA.Set(-f,-g),this.m_J.angularA=-h,k+=d.m_invMass+
d.m_invI*h*h);this.m_revolute2?(this.m_J.angularB=-this.m_ratio,k+=this.m_ratio*this.m_ratio*e.m_invI):(b=c.m_xf.R,g=this.m_prismatic2.m_localXAxis1,f=b.col1.x*g.x+b.col2.x*g.y,g=b.col1.y*g.x+b.col2.y*g.y,b=e.m_xf.R,h=this.m_localAnchor2.x-e.m_sweep.localCenter.x,j=this.m_localAnchor2.y-e.m_sweep.localCenter.y,l=b.col1.x*h+b.col2.x*j,j=b.col1.y*h+b.col2.y*j,h=l*g-j*f,this.m_J.linearB.Set(-this.m_ratio*f,-this.m_ratio*g),this.m_J.angularB=-this.m_ratio*h,k+=this.m_ratio*this.m_ratio*(e.m_invMass+e.m_invI*
h*h));this.m_mass=k>0?1/k:0;a.warmStarting?(d.m_linearVelocity.x+=d.m_invMass*this.m_impulse*this.m_J.linearA.x,d.m_linearVelocity.y+=d.m_invMass*this.m_impulse*this.m_J.linearA.y,d.m_angularVelocity+=d.m_invI*this.m_impulse*this.m_J.angularA,e.m_linearVelocity.x+=e.m_invMass*this.m_impulse*this.m_J.linearB.x,e.m_linearVelocity.y+=e.m_invMass*this.m_impulse*this.m_J.linearB.y,e.m_angularVelocity+=e.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0};D.prototype.SolveVelocityConstraints=function(){var a=
this.m_bodyA,b=this.m_bodyB,c=-this.m_mass*this.m_J.Compute(a.m_linearVelocity,a.m_angularVelocity,b.m_linearVelocity,b.m_angularVelocity);this.m_impulse+=c;a.m_linearVelocity.x+=a.m_invMass*c*this.m_J.linearA.x;a.m_linearVelocity.y+=a.m_invMass*c*this.m_J.linearA.y;a.m_angularVelocity+=a.m_invI*c*this.m_J.angularA;b.m_linearVelocity.x+=b.m_invMass*c*this.m_J.linearB.x;b.m_linearVelocity.y+=b.m_invMass*c*this.m_J.linearB.y;b.m_angularVelocity+=b.m_invI*c*this.m_J.angularB};D.prototype.SolvePositionConstraints=
function(){var a=this.m_bodyA,c=this.m_bodyB,d=0,e=0,d=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),e=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation(),d=-this.m_mass*(this.m_constant-(d+this.m_ratio*e));a.m_sweep.c.x+=a.m_invMass*d*this.m_J.linearA.x;a.m_sweep.c.y+=a.m_invMass*d*this.m_J.linearA.y;a.m_sweep.a+=a.m_invI*d*this.m_J.angularA;c.m_sweep.c.x+=c.m_invMass*d*this.m_J.linearB.x;c.m_sweep.c.y+=c.m_invMass*
d*this.m_J.linearB.y;c.m_sweep.a+=c.m_invI*d*this.m_J.angularB;a.SynchronizeTransform();c.SynchronizeTransform();return 0<b.b2_linearSlop};a.inherit(B,a.Dynamics.Joints.b2JointDef);B.prototype.__super=a.Dynamics.Joints.b2JointDef.prototype;B.b2GearJointDef=function(){a.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)};B.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this);this.type=w.e_gearJoint;this.joint2=this.joint1=null;this.ratio=1};A.b2Jacobian=function(){this.linearA=
new j;this.linearB=new j};A.prototype.SetZero=function(){this.linearA.SetZero();this.angularA=0;this.linearB.SetZero();this.angularB=0};A.prototype.Set=function(a,b,c,d){b===void 0&&(b=0);d===void 0&&(d=0);this.linearA.SetV(a);this.angularA=b;this.linearB.SetV(c);this.angularB=d};A.prototype.Compute=function(a,b,c,d){b===void 0&&(b=0);d===void 0&&(d=0);return this.linearA.x*a.x+this.linearA.y*a.y+this.angularA*b+(this.linearB.x*c.x+this.linearB.y*c.y)+this.angularB*d};w.b2Joint=function(){this.m_edgeA=
new G;this.m_edgeB=new G;this.m_localCenterA=new j;this.m_localCenterB=new j};w.prototype.GetType=function(){return this.m_type};w.prototype.GetAnchorA=function(){return null};w.prototype.GetAnchorB=function(){return null};w.prototype.GetReactionForce=function(){return null};w.prototype.GetReactionTorque=function(){return 0};w.prototype.GetBodyA=function(){return this.m_bodyA};w.prototype.GetBodyB=function(){return this.m_bodyB};w.prototype.GetNext=function(){return this.m_next};w.prototype.GetUserData=
function(){return this.m_userData};w.prototype.SetUserData=function(a){this.m_userData=a};w.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()};w.Create=function(a){var b=null;switch(a.type){case w.e_distanceJoint:b=new k(a instanceof c?a:null);break;case w.e_mouseJoint:b=new J(a instanceof M?a:null);break;case w.e_prismaticJoint:b=new I(a instanceof C?a:null);break;case w.e_revoluteJoint:b=new K(a instanceof N?a:null);break;case w.e_pulleyJoint:b=new F(a instanceof
R?a:null);break;case w.e_gearJoint:b=new D(a instanceof B?a:null);break;case w.e_lineJoint:b=new p(a instanceof L?a:null);break;case w.e_weldJoint:b=new U(a instanceof Q?a:null);break;case w.e_frictionJoint:b=new m(a instanceof n?a:null)}return b};w.Destroy=function(){};w.prototype.b2Joint=function(a){b.b2Assert(a.bodyA!=a.bodyB);this.m_type=a.type;this.m_next=this.m_prev=null;this.m_bodyA=a.bodyA;this.m_bodyB=a.bodyB;this.m_collideConnected=a.collideConnected;this.m_islandFlag=!1;this.m_userData=
a.userData};w.prototype.InitVelocityConstraints=function(){};w.prototype.SolveVelocityConstraints=function(){};w.prototype.FinalizeVelocityConstraints=function(){};w.prototype.SolvePositionConstraints=function(){return!1};a.postDefs.push(function(){a.Dynamics.Joints.b2Joint.e_unknownJoint=0;a.Dynamics.Joints.b2Joint.e_revoluteJoint=1;a.Dynamics.Joints.b2Joint.e_prismaticJoint=2;a.Dynamics.Joints.b2Joint.e_distanceJoint=3;a.Dynamics.Joints.b2Joint.e_pulleyJoint=4;a.Dynamics.Joints.b2Joint.e_mouseJoint=
5;a.Dynamics.Joints.b2Joint.e_gearJoint=6;a.Dynamics.Joints.b2Joint.e_lineJoint=7;a.Dynamics.Joints.b2Joint.e_weldJoint=8;a.Dynamics.Joints.b2Joint.e_frictionJoint=9;a.Dynamics.Joints.b2Joint.e_inactiveLimit=0;a.Dynamics.Joints.b2Joint.e_atLowerLimit=1;a.Dynamics.Joints.b2Joint.e_atUpperLimit=2;a.Dynamics.Joints.b2Joint.e_equalLimits=3});y.b2JointDef=function(){};y.prototype.b2JointDef=function(){this.type=w.e_unknownJoint;this.bodyB=this.bodyA=this.userData=null;this.collideConnected=!1};G.b2JointEdge=
function(){};a.inherit(p,a.Dynamics.Joints.b2Joint);p.prototype.__super=a.Dynamics.Joints.b2Joint.prototype;p.b2LineJoint=function(){a.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new j;this.m_localAnchor2=new j;this.m_localXAxis1=new j;this.m_localYAxis1=new j;this.m_axis=new j;this.m_perp=new j;this.m_K=new e;this.m_impulse=new j};p.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};p.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};
p.prototype.GetReactionForce=function(a){a===void 0&&(a=0);return new j(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))};p.prototype.GetReactionTorque=function(a){a===void 0&&(a=0);return a*this.m_impulse.y};p.prototype.GetJointTranslation=function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.GetWorldPoint(this.m_localAnchor1),d=b.GetWorldPoint(this.m_localAnchor2),b=d.x-c.x,
c=d.y-c.y,a=a.GetWorldVector(this.m_localXAxis1);return a.x*b+a.y*c};p.prototype.GetJointSpeed=function(){var a=this.m_bodyA,b=this.m_bodyB,c;c=a.m_xf.R;var d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*e,d=f;c=b.m_xf.R;var g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,h=this.m_localAnchor2.y-b.m_sweep.localCenter.y,f=c.col1.x*g+c.col2.x*h,h=c.col1.y*g+c.col2.y*h,g=f;c=b.m_sweep.c.x+g-(a.m_sweep.c.x+
d);var f=b.m_sweep.c.y+h-(a.m_sweep.c.y+e),j=a.GetWorldVector(this.m_localXAxis1),l=a.m_linearVelocity,k=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return c*-a*j.y+f*a*j.x+(j.x*(k.x+-b*h-l.x- -a*e)+j.y*(k.y+b*g-l.y-a*d))};p.prototype.IsLimitEnabled=function(){return this.m_enableLimit};p.prototype.EnableLimit=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableLimit=a};p.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};p.prototype.GetUpperLimit=
function(){return this.m_upperTranslation};p.prototype.SetLimits=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=b};p.prototype.IsMotorEnabled=function(){return this.m_enableMotor};p.prototype.EnableMotor=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=a};p.prototype.SetMotorSpeed=function(a){a===void 0&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);
this.m_motorSpeed=a};p.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};p.prototype.SetMaxMotorForce=function(a){a===void 0&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorForce=a};p.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce};p.prototype.GetMotorForce=function(){return this.m_motorImpulse};p.prototype.b2LineJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchor1.SetV(a.localAnchorA);this.m_localAnchor2.SetV(a.localAnchorB);
this.m_localXAxis1.SetV(a.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_impulse.SetZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=w.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};p.prototype.InitVelocityConstraints=
function(a){var c=this.m_bodyA,d=this.m_bodyB,e,h=0;this.m_localCenterA.SetV(c.GetLocalCenter());this.m_localCenterB.SetV(d.GetLocalCenter());var j=c.GetTransform();d.GetTransform();e=c.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,t=this.m_localAnchor1.y-this.m_localCenterA.y,h=e.col1.x*l+e.col2.x*t,t=e.col1.y*l+e.col2.y*t,l=h;e=d.m_xf.R;var r=this.m_localAnchor2.x-this.m_localCenterB.x,k=this.m_localAnchor2.y-this.m_localCenterB.y,h=e.col1.x*r+e.col2.x*k,k=e.col1.y*r+e.col2.y*k,r=h;e=
d.m_sweep.c.x+r-c.m_sweep.c.x-l;h=d.m_sweep.c.y+k-c.m_sweep.c.y-t;this.m_invMassA=c.m_invMass;this.m_invMassB=d.m_invMass;this.m_invIA=c.m_invI;this.m_invIB=d.m_invI;this.m_axis.SetV(f.MulMV(j.R,this.m_localXAxis1));this.m_a1=(e+l)*this.m_axis.y-(h+t)*this.m_axis.x;this.m_a2=r*this.m_axis.y-k*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0;this.m_perp.SetV(f.MulMV(j.R,
this.m_localYAxis1));this.m_s1=(e+l)*this.m_perp.y-(h+t)*this.m_perp.x;this.m_s2=r*this.m_perp.y-k*this.m_perp.x;j=this.m_invMassA;l=this.m_invMassB;t=this.m_invIA;r=this.m_invIB;this.m_K.col1.x=j+l+t*this.m_s1*this.m_s1+r*this.m_s2*this.m_s2;this.m_K.col1.y=t*this.m_s1*this.m_a1+r*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=j+l+t*this.m_a1*this.m_a1+r*this.m_a2*this.m_a2;if(this.m_enableLimit)if(e=this.m_axis.x*e+this.m_axis.y*h,f.Abs(this.m_upperTranslation-this.m_lowerTranslation)<
2*b.b2_linearSlop)this.m_limitState=w.e_equalLimits;else if(e<=this.m_lowerTranslation){if(this.m_limitState!=w.e_atLowerLimit)this.m_limitState=w.e_atLowerLimit,this.m_impulse.y=0}else if(e>=this.m_upperTranslation){if(this.m_limitState!=w.e_atUpperLimit)this.m_limitState=w.e_atUpperLimit,this.m_impulse.y=0}else this.m_limitState=w.e_inactiveLimit,this.m_impulse.y=0;else this.m_limitState=w.e_inactiveLimit;if(this.m_enableMotor==!1)this.m_motorImpulse=0;a.warmStarting?(this.m_impulse.x*=a.dtRatio,
this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,e=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,h=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,j=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2,c.m_linearVelocity.x-=this.m_invMassA*a,c.m_linearVelocity.y-=this.m_invMassA*e,c.m_angularVelocity-=this.m_invIA*
h,d.m_linearVelocity.x+=this.m_invMassB*a,d.m_linearVelocity.y+=this.m_invMassB*e,d.m_angularVelocity+=this.m_invIB*j):(this.m_impulse.SetZero(),this.m_motorImpulse=0)};p.prototype.SolveVelocityConstraints=function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_linearVelocity,e=b.m_angularVelocity,g=c.m_linearVelocity,h=c.m_angularVelocity,t=0,k=0,m=0,n=0;if(this.m_enableMotor&&this.m_limitState!=w.e_equalLimits)n=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(g.x-d.x)+this.m_axis.y*(g.y-d.y)+this.m_a2*
h-this.m_a1*e)),t=this.m_motorImpulse,k=a.dt*this.m_maxMotorForce,this.m_motorImpulse=f.Clamp(this.m_motorImpulse+n,-k,k),n=this.m_motorImpulse-t,t=n*this.m_axis.x,k=n*this.m_axis.y,m=n*this.m_a1,n*=this.m_a2,d.x-=this.m_invMassA*t,d.y-=this.m_invMassA*k,e-=this.m_invIA*m,g.x+=this.m_invMassB*t,g.y+=this.m_invMassB*k,h+=this.m_invIB*n;k=this.m_perp.x*(g.x-d.x)+this.m_perp.y*(g.y-d.y)+this.m_s2*h-this.m_s1*e;if(this.m_enableLimit&&this.m_limitState!=w.e_inactiveLimit){m=this.m_axis.x*(g.x-d.x)+this.m_axis.y*
(g.y-d.y)+this.m_a2*h-this.m_a1*e;t=this.m_impulse.Copy();a=this.m_K.Solve(new j,-k,-m);this.m_impulse.Add(a);if(this.m_limitState==w.e_atLowerLimit)this.m_impulse.y=f.Max(this.m_impulse.y,0);else if(this.m_limitState==w.e_atUpperLimit)this.m_impulse.y=f.Min(this.m_impulse.y,0);k=-k-(this.m_impulse.y-t.y)*this.m_K.col2.x;m=0;m=this.m_K.col1.x!=0?k/this.m_K.col1.x+t.x:t.x;this.m_impulse.x=m;a.x=this.m_impulse.x-t.x;a.y=this.m_impulse.y-t.y;t=a.x*this.m_perp.x+a.y*this.m_axis.x;k=a.x*this.m_perp.y+
a.y*this.m_axis.y;m=a.x*this.m_s1+a.y*this.m_a1;n=a.x*this.m_s2+a.y*this.m_a2}else a=0,a=this.m_K.col1.x!=0?-k/this.m_K.col1.x:0,this.m_impulse.x+=a,t=a*this.m_perp.x,k=a*this.m_perp.y,m=a*this.m_s1,n=a*this.m_s2;d.x-=this.m_invMassA*t;d.y-=this.m_invMassA*k;e-=this.m_invIA*m;g.x+=this.m_invMassB*t;g.y+=this.m_invMassB*k;h+=this.m_invIB*n;b.m_linearVelocity.SetV(d);b.m_angularVelocity=e;c.m_linearVelocity.SetV(g);c.m_angularVelocity=h};p.prototype.SolvePositionConstraints=function(){var a=this.m_bodyA,
c=this.m_bodyB,d=a.m_sweep.c,h=a.m_sweep.a,k=c.m_sweep.c,m=c.m_sweep.a,n,t=0,r=0,q=0,p=0,w=n=0,z=0,r=!1,A=0,y=e.FromAngle(h),q=e.FromAngle(m);n=y;var z=this.m_localAnchor1.x-this.m_localCenterA.x,B=this.m_localAnchor1.y-this.m_localCenterA.y,t=n.col1.x*z+n.col2.x*B,B=n.col1.y*z+n.col2.y*B,z=t;n=q;q=this.m_localAnchor2.x-this.m_localCenterB.x;p=this.m_localAnchor2.y-this.m_localCenterB.y;t=n.col1.x*q+n.col2.x*p;p=n.col1.y*q+n.col2.y*p;q=t;n=k.x+q-d.x-z;t=k.y+p-d.y-B;if(this.m_enableLimit){this.m_axis=
f.MulMV(y,this.m_localXAxis1);this.m_a1=(n+z)*this.m_axis.y-(t+B)*this.m_axis.x;this.m_a2=q*this.m_axis.y-p*this.m_axis.x;var D=this.m_axis.x*n+this.m_axis.y*t;f.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b.b2_linearSlop?(A=f.Clamp(D,-b.b2_maxLinearCorrection,b.b2_maxLinearCorrection),w=f.Abs(D),r=!0):D<=this.m_lowerTranslation?(A=f.Clamp(D-this.m_lowerTranslation+b.b2_linearSlop,-b.b2_maxLinearCorrection,0),w=this.m_lowerTranslation-D,r=!0):D>=this.m_upperTranslation&&(A=f.Clamp(D-this.m_upperTranslation+
b.b2_linearSlop,0,b.b2_maxLinearCorrection),w=D-this.m_upperTranslation,r=!0)}this.m_perp=f.MulMV(y,this.m_localYAxis1);this.m_s1=(n+z)*this.m_perp.y-(t+B)*this.m_perp.x;this.m_s2=q*this.m_perp.y-p*this.m_perp.x;y=new j;B=this.m_perp.x*n+this.m_perp.y*t;w=f.Max(w,f.Abs(B));z=0;r?(r=this.m_invMassA,q=this.m_invMassB,p=this.m_invIA,n=this.m_invIB,this.m_K.col1.x=r+q+p*this.m_s1*this.m_s1+n*this.m_s2*this.m_s2,this.m_K.col1.y=p*this.m_s1*this.m_a1+n*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,
this.m_K.col2.y=r+q+p*this.m_a1*this.m_a1+n*this.m_a2*this.m_a2,this.m_K.Solve(y,-B,-A)):(r=this.m_invMassA,q=this.m_invMassB,p=this.m_invIA,n=this.m_invIB,A=r+q+p*this.m_s1*this.m_s1+n*this.m_s2*this.m_s2,r=0,y.x=A!=0?-B/A:0,y.y=0);A=y.x*this.m_perp.x+y.y*this.m_axis.x;r=y.x*this.m_perp.y+y.y*this.m_axis.y;B=y.x*this.m_s1+y.y*this.m_a1;y=y.x*this.m_s2+y.y*this.m_a2;d.x-=this.m_invMassA*A;d.y-=this.m_invMassA*r;h-=this.m_invIA*B;k.x+=this.m_invMassB*A;k.y+=this.m_invMassB*r;m+=this.m_invIB*y;a.m_sweep.a=
h;c.m_sweep.a=m;a.SynchronizeTransform();c.SynchronizeTransform();return w<=b.b2_linearSlop&&z<=b.b2_angularSlop};a.inherit(L,a.Dynamics.Joints.b2JointDef);L.prototype.__super=a.Dynamics.Joints.b2JointDef.prototype;L.b2LineJointDef=function(){a.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new j;this.localAnchorB=new j;this.localAxisA=new j};L.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this);this.type=w.e_lineJoint;this.localAxisA.Set(1,0);this.enableLimit=
!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0};L.prototype.Initialize=function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.GetLocalPoint(c);this.localAnchorB=this.bodyB.GetLocalPoint(c);this.localAxisA=this.bodyA.GetLocalVector(d)};a.inherit(J,a.Dynamics.Joints.b2Joint);J.prototype.__super=a.Dynamics.Joints.b2Joint.prototype;J.b2MouseJoint=function(){a.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new e;
this.K1=new e;this.K2=new e;this.m_localAnchor=new j;this.m_target=new j;this.m_impulse=new j;this.m_mass=new e;this.m_C=new j};J.prototype.GetAnchorA=function(){return this.m_target};J.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)};J.prototype.GetReactionForce=function(a){a===void 0&&(a=0);return new j(a*this.m_impulse.x,a*this.m_impulse.y)};J.prototype.GetReactionTorque=function(){return 0};J.prototype.GetTarget=function(){return this.m_target};J.prototype.SetTarget=
function(a){this.m_bodyB.IsAwake()==!1&&this.m_bodyB.SetAwake(!0);this.m_target=a};J.prototype.GetMaxForce=function(){return this.m_maxForce};J.prototype.SetMaxForce=function(a){a===void 0&&(a=0);this.m_maxForce=a};J.prototype.GetFrequency=function(){return this.m_frequencyHz};J.prototype.SetFrequency=function(a){a===void 0&&(a=0);this.m_frequencyHz=a};J.prototype.GetDampingRatio=function(){return this.m_dampingRatio};J.prototype.SetDampingRatio=function(a){a===void 0&&(a=0);this.m_dampingRatio=a};
J.prototype.b2MouseJoint=function(a){this.__super.b2Joint.call(this,a);this.m_target.SetV(a.target);var b=this.m_target.x-this.m_bodyB.m_xf.position.x,c=this.m_target.y-this.m_bodyB.m_xf.position.y,d=this.m_bodyB.m_xf.R;this.m_localAnchor.x=b*d.col1.x+c*d.col1.y;this.m_localAnchor.y=b*d.col2.x+c*d.col2.y;this.m_maxForce=a.maxForce;this.m_impulse.SetZero();this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_gamma=this.m_beta=0};J.prototype.InitVelocityConstraints=function(a){var b=
this.m_bodyB,c=b.GetMass(),d=2*Math.PI*this.m_frequencyHz,e=c*d*d;this.m_gamma=a.dt*(2*c*this.m_dampingRatio*d+a.dt*e);this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0;this.m_beta=a.dt*e*this.m_gamma;var e=b.m_xf.R,c=this.m_localAnchor.x-b.m_sweep.localCenter.x,d=this.m_localAnchor.y-b.m_sweep.localCenter.y,f=e.col1.x*c+e.col2.x*d,d=e.col1.y*c+e.col2.y*d,c=f,e=b.m_invMass,f=b.m_invI;this.K1.col1.x=e;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=e;this.K2.col1.x=f*d*d;this.K2.col2.x=-f*c*d;this.K2.col1.y=
-f*c*d;this.K2.col2.y=f*c*c;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.col1.x+=this.m_gamma;this.K.col2.y+=this.m_gamma;this.K.GetInverse(this.m_mass);this.m_C.x=b.m_sweep.c.x+c-this.m_target.x;this.m_C.y=b.m_sweep.c.y+d-this.m_target.y;b.m_angularVelocity*=0.98;this.m_impulse.x*=a.dtRatio;this.m_impulse.y*=a.dtRatio;b.m_linearVelocity.x+=e*this.m_impulse.x;b.m_linearVelocity.y+=e*this.m_impulse.y;b.m_angularVelocity+=f*(c*this.m_impulse.y-d*this.m_impulse.x)};J.prototype.SolveVelocityConstraints=
function(a){var b=this.m_bodyB,c,d=0,e=0;c=b.m_xf.R;var f=this.m_localAnchor.x-b.m_sweep.localCenter.x,g=this.m_localAnchor.y-b.m_sweep.localCenter.y,d=c.col1.x*f+c.col2.x*g,g=c.col1.y*f+c.col2.y*g,f=d,d=b.m_linearVelocity.x+-b.m_angularVelocity*g,h=b.m_linearVelocity.y+b.m_angularVelocity*f;c=this.m_mass;d=d+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x;e=h+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;h=-(c.col1.x*d+c.col2.x*e);e=-(c.col1.y*d+c.col2.y*e);c=this.m_impulse.x;d=this.m_impulse.y;
this.m_impulse.x+=h;this.m_impulse.y+=e;a=a.dt*this.m_maxForce;this.m_impulse.LengthSquared()>a*a&&this.m_impulse.Multiply(a/this.m_impulse.Length());h=this.m_impulse.x-c;e=this.m_impulse.y-d;b.m_linearVelocity.x+=b.m_invMass*h;b.m_linearVelocity.y+=b.m_invMass*e;b.m_angularVelocity+=b.m_invI*(f*e-g*h)};J.prototype.SolvePositionConstraints=function(){return!0};a.inherit(M,a.Dynamics.Joints.b2JointDef);M.prototype.__super=a.Dynamics.Joints.b2JointDef.prototype;M.b2MouseJointDef=function(){a.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,
arguments);this.target=new j};M.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this);this.type=w.e_mouseJoint;this.maxForce=0;this.frequencyHz=5;this.dampingRatio=0.7};a.inherit(I,a.Dynamics.Joints.b2Joint);I.prototype.__super=a.Dynamics.Joints.b2Joint.prototype;I.b2PrismaticJoint=function(){a.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new j;this.m_localAnchor2=new j;this.m_localXAxis1=new j;this.m_localYAxis1=new j;this.m_axis=new j;this.m_perp=new j;
this.m_K=new d;this.m_impulse=new h};I.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};I.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};I.prototype.GetReactionForce=function(a){a===void 0&&(a=0);return new j(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))};I.prototype.GetReactionTorque=function(a){a===
void 0&&(a=0);return a*this.m_impulse.y};I.prototype.GetJointTranslation=function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.GetWorldPoint(this.m_localAnchor1),d=b.GetWorldPoint(this.m_localAnchor2),b=d.x-c.x,c=d.y-c.y,a=a.GetWorldVector(this.m_localXAxis1);return a.x*b+a.y*c};I.prototype.GetJointSpeed=function(){var a=this.m_bodyA,b=this.m_bodyB,c;c=a.m_xf.R;var d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*
e,d=f;c=b.m_xf.R;var g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,h=this.m_localAnchor2.y-b.m_sweep.localCenter.y,f=c.col1.x*g+c.col2.x*h,h=c.col1.y*g+c.col2.y*h,g=f;c=b.m_sweep.c.x+g-(a.m_sweep.c.x+d);var f=b.m_sweep.c.y+h-(a.m_sweep.c.y+e),j=a.GetWorldVector(this.m_localXAxis1),l=a.m_linearVelocity,k=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return c*-a*j.y+f*a*j.x+(j.x*(k.x+-b*h-l.x- -a*e)+j.y*(k.y+b*g-l.y-a*d))};I.prototype.IsLimitEnabled=function(){return this.m_enableLimit};
I.prototype.EnableLimit=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableLimit=a};I.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};I.prototype.GetUpperLimit=function(){return this.m_upperTranslation};I.prototype.SetLimits=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=b};I.prototype.IsMotorEnabled=function(){return this.m_enableMotor};I.prototype.EnableMotor=
function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=a};I.prototype.SetMotorSpeed=function(a){a===void 0&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=a};I.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};I.prototype.SetMaxMotorForce=function(a){a===void 0&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorForce=a};I.prototype.GetMotorForce=function(){return this.m_motorImpulse};I.prototype.b2PrismaticJoint=
function(a){this.__super.b2Joint.call(this,a);this.m_localAnchor1.SetV(a.localAnchorA);this.m_localAnchor2.SetV(a.localAnchorB);this.m_localXAxis1.SetV(a.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_refAngle=a.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;
this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=w.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};I.prototype.InitVelocityConstraints=function(a){var c=this.m_bodyA,d=this.m_bodyB,e,h=0;this.m_localCenterA.SetV(c.GetLocalCenter());this.m_localCenterB.SetV(d.GetLocalCenter());var j=c.GetTransform();d.GetTransform();e=c.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,k=this.m_localAnchor1.y-this.m_localCenterA.y,h=e.col1.x*l+e.col2.x*k,k=e.col1.y*
l+e.col2.y*k,l=h;e=d.m_xf.R;var r=this.m_localAnchor2.x-this.m_localCenterB.x,m=this.m_localAnchor2.y-this.m_localCenterB.y,h=e.col1.x*r+e.col2.x*m,m=e.col1.y*r+e.col2.y*m,r=h;e=d.m_sweep.c.x+r-c.m_sweep.c.x-l;h=d.m_sweep.c.y+m-c.m_sweep.c.y-k;this.m_invMassA=c.m_invMass;this.m_invMassB=d.m_invMass;this.m_invIA=c.m_invI;this.m_invIB=d.m_invI;this.m_axis.SetV(f.MulMV(j.R,this.m_localXAxis1));this.m_a1=(e+l)*this.m_axis.y-(h+k)*this.m_axis.x;this.m_a2=r*this.m_axis.y-m*this.m_axis.x;this.m_motorMass=
this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;if(this.m_motorMass>Number.MIN_VALUE)this.m_motorMass=1/this.m_motorMass;this.m_perp.SetV(f.MulMV(j.R,this.m_localYAxis1));this.m_s1=(e+l)*this.m_perp.y-(h+k)*this.m_perp.x;this.m_s2=r*this.m_perp.y-m*this.m_perp.x;j=this.m_invMassA;l=this.m_invMassB;k=this.m_invIA;r=this.m_invIB;this.m_K.col1.x=j+l+k*this.m_s1*this.m_s1+r*this.m_s2*this.m_s2;this.m_K.col1.y=k*this.m_s1+r*this.m_s2;this.m_K.col1.z=k*
this.m_s1*this.m_a1+r*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=k+r;this.m_K.col2.z=k*this.m_a1+r*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=j+l+k*this.m_a1*this.m_a1+r*this.m_a2*this.m_a2;if(this.m_enableLimit)if(e=this.m_axis.x*e+this.m_axis.y*h,f.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b.b2_linearSlop)this.m_limitState=w.e_equalLimits;else if(e<=this.m_lowerTranslation){if(this.m_limitState!=w.e_atLowerLimit)this.m_limitState=
w.e_atLowerLimit,this.m_impulse.z=0}else if(e>=this.m_upperTranslation){if(this.m_limitState!=w.e_atUpperLimit)this.m_limitState=w.e_atUpperLimit,this.m_impulse.z=0}else this.m_limitState=w.e_inactiveLimit,this.m_impulse.z=0;else this.m_limitState=w.e_inactiveLimit;if(this.m_enableMotor==!1)this.m_motorImpulse=0;a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,
e=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,h=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,j=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2,c.m_linearVelocity.x-=this.m_invMassA*a,c.m_linearVelocity.y-=this.m_invMassA*e,c.m_angularVelocity-=this.m_invIA*h,d.m_linearVelocity.x+=this.m_invMassB*a,d.m_linearVelocity.y+=this.m_invMassB*e,d.m_angularVelocity+=this.m_invIB*
j):(this.m_impulse.SetZero(),this.m_motorImpulse=0)};I.prototype.SolveVelocityConstraints=function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_linearVelocity,e=b.m_angularVelocity,g=c.m_linearVelocity,k=c.m_angularVelocity,m=0,r=0,n=0,q=0;if(this.m_enableMotor&&this.m_limitState!=w.e_equalLimits)q=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(g.x-d.x)+this.m_axis.y*(g.y-d.y)+this.m_a2*k-this.m_a1*e)),m=this.m_motorImpulse,a=a.dt*this.m_maxMotorForce,this.m_motorImpulse=f.Clamp(this.m_motorImpulse+
q,-a,a),q=this.m_motorImpulse-m,m=q*this.m_axis.x,r=q*this.m_axis.y,n=q*this.m_a1,q*=this.m_a2,d.x-=this.m_invMassA*m,d.y-=this.m_invMassA*r,e-=this.m_invIA*n,g.x+=this.m_invMassB*m,g.y+=this.m_invMassB*r,k+=this.m_invIB*q;n=this.m_perp.x*(g.x-d.x)+this.m_perp.y*(g.y-d.y)+this.m_s2*k-this.m_s1*e;r=k-e;if(this.m_enableLimit&&this.m_limitState!=w.e_inactiveLimit){a=this.m_axis.x*(g.x-d.x)+this.m_axis.y*(g.y-d.y)+this.m_a2*k-this.m_a1*e;m=this.m_impulse.Copy();a=this.m_K.Solve33(new h,-n,-r,-a);this.m_impulse.Add(a);
if(this.m_limitState==w.e_atLowerLimit)this.m_impulse.z=f.Max(this.m_impulse.z,0);else if(this.m_limitState==w.e_atUpperLimit)this.m_impulse.z=f.Min(this.m_impulse.z,0);n=-n-(this.m_impulse.z-m.z)*this.m_K.col3.x;r=-r-(this.m_impulse.z-m.z)*this.m_K.col3.y;r=this.m_K.Solve22(new j,n,r);r.x+=m.x;r.y+=m.y;this.m_impulse.x=r.x;this.m_impulse.y=r.y;a.x=this.m_impulse.x-m.x;a.y=this.m_impulse.y-m.y;a.z=this.m_impulse.z-m.z;m=a.x*this.m_perp.x+a.z*this.m_axis.x;r=a.x*this.m_perp.y+a.z*this.m_axis.y;n=a.x*
this.m_s1+a.y+a.z*this.m_a1;q=a.x*this.m_s2+a.y+a.z*this.m_a2}else a=this.m_K.Solve22(new j,-n,-r),this.m_impulse.x+=a.x,this.m_impulse.y+=a.y,m=a.x*this.m_perp.x,r=a.x*this.m_perp.y,n=a.x*this.m_s1+a.y,q=a.x*this.m_s2+a.y;d.x-=this.m_invMassA*m;d.y-=this.m_invMassA*r;e-=this.m_invIA*n;g.x+=this.m_invMassB*m;g.y+=this.m_invMassB*r;k+=this.m_invIB*q;b.m_linearVelocity.SetV(d);b.m_angularVelocity=e;c.m_linearVelocity.SetV(g);c.m_angularVelocity=k};I.prototype.SolvePositionConstraints=function(){var a=
this.m_bodyA,c=this.m_bodyB,d=a.m_sweep.c,k=a.m_sweep.a,m=c.m_sweep.c,n=c.m_sweep.a,q,t=0,r=0,p=0,w=t=q=0,z=0,r=!1,A=0,y=e.FromAngle(k),B=e.FromAngle(n);q=y;var z=this.m_localAnchor1.x-this.m_localCenterA.x,D=this.m_localAnchor1.y-this.m_localCenterA.y,t=q.col1.x*z+q.col2.x*D,D=q.col1.y*z+q.col2.y*D,z=t;q=B;B=this.m_localAnchor2.x-this.m_localCenterB.x;p=this.m_localAnchor2.y-this.m_localCenterB.y;t=q.col1.x*B+q.col2.x*p;p=q.col1.y*B+q.col2.y*p;B=t;q=m.x+B-d.x-z;t=m.y+p-d.y-D;if(this.m_enableLimit){this.m_axis=
f.MulMV(y,this.m_localXAxis1);this.m_a1=(q+z)*this.m_axis.y-(t+D)*this.m_axis.x;this.m_a2=B*this.m_axis.y-p*this.m_axis.x;var P=this.m_axis.x*q+this.m_axis.y*t;f.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*b.b2_linearSlop?(A=f.Clamp(P,-b.b2_maxLinearCorrection,b.b2_maxLinearCorrection),w=f.Abs(P),r=!0):P<=this.m_lowerTranslation?(A=f.Clamp(P-this.m_lowerTranslation+b.b2_linearSlop,-b.b2_maxLinearCorrection,0),w=this.m_lowerTranslation-P,r=!0):P>=this.m_upperTranslation&&(A=f.Clamp(P-this.m_upperTranslation+
b.b2_linearSlop,0,b.b2_maxLinearCorrection),w=P-this.m_upperTranslation,r=!0)}this.m_perp=f.MulMV(y,this.m_localYAxis1);this.m_s1=(q+z)*this.m_perp.y-(t+D)*this.m_perp.x;this.m_s2=B*this.m_perp.y-p*this.m_perp.x;y=new h;D=this.m_perp.x*q+this.m_perp.y*t;B=n-k-this.m_refAngle;w=f.Max(w,f.Abs(D));z=f.Abs(B);r?(r=this.m_invMassA,p=this.m_invMassB,q=this.m_invIA,t=this.m_invIB,this.m_K.col1.x=r+p+q*this.m_s1*this.m_s1+t*this.m_s2*this.m_s2,this.m_K.col1.y=q*this.m_s1+t*this.m_s2,this.m_K.col1.z=q*this.m_s1*
this.m_a1+t*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=q+t,this.m_K.col2.z=q*this.m_a1+t*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=r+p+q*this.m_a1*this.m_a1+t*this.m_a2*this.m_a2,this.m_K.Solve33(y,-D,-B,-A)):(r=this.m_invMassA,p=this.m_invMassB,q=this.m_invIA,t=this.m_invIB,A=q*this.m_s1+t*this.m_s2,P=q+t,this.m_K.col1.Set(r+p+q*this.m_s1*this.m_s1+t*this.m_s2*this.m_s2,A,0),this.m_K.col2.Set(A,P,0),A=this.m_K.Solve22(new j,
-D,-B),y.x=A.x,y.y=A.y,y.z=0);A=y.x*this.m_perp.x+y.z*this.m_axis.x;r=y.x*this.m_perp.y+y.z*this.m_axis.y;D=y.x*this.m_s1+y.y+y.z*this.m_a1;y=y.x*this.m_s2+y.y+y.z*this.m_a2;d.x-=this.m_invMassA*A;d.y-=this.m_invMassA*r;k-=this.m_invIA*D;m.x+=this.m_invMassB*A;m.y+=this.m_invMassB*r;n+=this.m_invIB*y;a.m_sweep.a=k;c.m_sweep.a=n;a.SynchronizeTransform();c.SynchronizeTransform();return w<=b.b2_linearSlop&&z<=b.b2_angularSlop};a.inherit(C,a.Dynamics.Joints.b2JointDef);C.prototype.__super=a.Dynamics.Joints.b2JointDef.prototype;
C.b2PrismaticJointDef=function(){a.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new j;this.localAnchorB=new j;this.localAxisA=new j};C.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this);this.type=w.e_prismaticJoint;this.localAxisA.Set(1,0);this.referenceAngle=0;this.enableLimit=!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0};C.prototype.Initialize=function(a,b,c,d){this.bodyA=a;this.bodyB=
b;this.localAnchorA=this.bodyA.GetLocalPoint(c);this.localAnchorB=this.bodyB.GetLocalPoint(c);this.localAxisA=this.bodyA.GetLocalVector(d);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};a.inherit(F,a.Dynamics.Joints.b2Joint);F.prototype.__super=a.Dynamics.Joints.b2Joint.prototype;F.b2PulleyJoint=function(){a.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_groundAnchor1=new j;this.m_groundAnchor2=new j;this.m_localAnchor1=new j;this.m_localAnchor2=new j;this.m_u1=new j;
this.m_u2=new j};F.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};F.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};F.prototype.GetReactionForce=function(a){a===void 0&&(a=0);return new j(a*this.m_impulse*this.m_u2.x,a*this.m_impulse*this.m_u2.y)};F.prototype.GetReactionTorque=function(){return 0};F.prototype.GetGroundAnchorA=function(){var a=this.m_ground.m_xf.position.Copy();a.Add(this.m_groundAnchor1);return a};F.prototype.GetGroundAnchorB=
function(){var a=this.m_ground.m_xf.position.Copy();a.Add(this.m_groundAnchor2);return a};F.prototype.GetLength1=function(){var a=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),b=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),a=a.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y);return Math.sqrt(b*b+a*a)};F.prototype.GetLength2=function(){var a=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),b=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor2.x),a=a.y-(this.m_ground.m_xf.position.y+
this.m_groundAnchor2.y);return Math.sqrt(b*b+a*a)};F.prototype.GetRatio=function(){return this.m_ratio};F.prototype.b2PulleyJoint=function(a){this.__super.b2Joint.call(this,a);this.m_ground=this.m_bodyA.m_world.m_groundBody;this.m_groundAnchor1.x=a.groundAnchorA.x-this.m_ground.m_xf.position.x;this.m_groundAnchor1.y=a.groundAnchorA.y-this.m_ground.m_xf.position.y;this.m_groundAnchor2.x=a.groundAnchorB.x-this.m_ground.m_xf.position.x;this.m_groundAnchor2.y=a.groundAnchorB.y-this.m_ground.m_xf.position.y;
this.m_localAnchor1.SetV(a.localAnchorA);this.m_localAnchor2.SetV(a.localAnchorB);this.m_ratio=a.ratio;this.m_constant=a.lengthA+this.m_ratio*a.lengthB;this.m_maxLength1=f.Min(a.maxLengthA,this.m_constant-this.m_ratio*F.b2_minPulleyLength);this.m_maxLength2=f.Min(a.maxLengthB,(this.m_constant-F.b2_minPulleyLength)/this.m_ratio);this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0};F.prototype.InitVelocityConstraints=function(a){var c=this.m_bodyA,d=this.m_bodyB,e;e=c.m_xf.R;var f=this.m_localAnchor1.x-
c.m_sweep.localCenter.x,h=this.m_localAnchor1.y-c.m_sweep.localCenter.y,j=e.col1.x*f+e.col2.x*h,h=e.col1.y*f+e.col2.y*h,f=j;e=d.m_xf.R;var k=this.m_localAnchor2.x-d.m_sweep.localCenter.x,l=this.m_localAnchor2.y-d.m_sweep.localCenter.y,j=e.col1.x*k+e.col2.x*l,l=e.col1.y*k+e.col2.y*l,k=j;e=d.m_sweep.c.x+k;var j=d.m_sweep.c.y+l,m=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,n=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(c.m_sweep.c.x+f-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),
c.m_sweep.c.y+h-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y));this.m_u2.Set(e-m,j-n);e=this.m_u1.Length();j=this.m_u2.Length();e>b.b2_linearSlop?this.m_u1.Multiply(1/e):this.m_u1.SetZero();j>b.b2_linearSlop?this.m_u2.Multiply(1/j):this.m_u2.SetZero();this.m_constant-e-this.m_ratio*j>0?(this.m_state=w.e_inactiveLimit,this.m_impulse=0):this.m_state=w.e_atUpperLimit;e<this.m_maxLength1?(this.m_limitState1=w.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=w.e_atUpperLimit;j<this.m_maxLength2?
(this.m_limitState2=w.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=w.e_atUpperLimit;e=f*this.m_u1.y-h*this.m_u1.x;j=k*this.m_u2.y-l*this.m_u2.x;this.m_limitMass1=c.m_invMass+c.m_invI*e*e;this.m_limitMass2=d.m_invMass+d.m_invI*j*j;this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2;this.m_limitMass1=1/this.m_limitMass1;this.m_limitMass2=1/this.m_limitMass2;this.m_pulleyMass=1/this.m_pulleyMass;a.warmStarting?(this.m_impulse*=a.dtRatio,this.m_limitImpulse1*=
a.dtRatio,this.m_limitImpulse2*=a.dtRatio,a=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,e=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,j=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,m=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y,c.m_linearVelocity.x+=c.m_invMass*a,c.m_linearVelocity.y+=c.m_invMass*e,c.m_angularVelocity+=c.m_invI*(f*e-h*a),d.m_linearVelocity.x+=d.m_invMass*j,d.m_linearVelocity.y+=d.m_invMass*m,d.m_angularVelocity+=d.m_invI*(k*m-l*
j)):this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0};F.prototype.SolveVelocityConstraints=function(){var a=this.m_bodyA,b=this.m_bodyB,c;c=a.m_xf.R;var d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,g=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*e,d=g;c=b.m_xf.R;var h=this.m_localAnchor2.x-b.m_sweep.localCenter.x,j=this.m_localAnchor2.y-b.m_sweep.localCenter.y,g=c.col1.x*h+c.col2.x*j,j=c.col1.y*h+c.col2.y*j,h=g,k=g=c=0,l=0;c=l=c=l=k=g=c=0;
if(this.m_state==w.e_atUpperLimit)c=a.m_linearVelocity.x+-a.m_angularVelocity*e,g=a.m_linearVelocity.y+a.m_angularVelocity*d,k=b.m_linearVelocity.x+-b.m_angularVelocity*j,l=b.m_linearVelocity.y+b.m_angularVelocity*h,c=-(this.m_u1.x*c+this.m_u1.y*g)-this.m_ratio*(this.m_u2.x*k+this.m_u2.y*l),l=this.m_pulleyMass*-c,c=this.m_impulse,this.m_impulse=f.Max(0,this.m_impulse+l),l=this.m_impulse-c,c=-l*this.m_u1.x,g=-l*this.m_u1.y,k=-this.m_ratio*l*this.m_u2.x,l=-this.m_ratio*l*this.m_u2.y,a.m_linearVelocity.x+=
a.m_invMass*c,a.m_linearVelocity.y+=a.m_invMass*g,a.m_angularVelocity+=a.m_invI*(d*g-e*c),b.m_linearVelocity.x+=b.m_invMass*k,b.m_linearVelocity.y+=b.m_invMass*l,b.m_angularVelocity+=b.m_invI*(h*l-j*k);if(this.m_limitState1==w.e_atUpperLimit)c=a.m_linearVelocity.x+-a.m_angularVelocity*e,g=a.m_linearVelocity.y+a.m_angularVelocity*d,c=-(this.m_u1.x*c+this.m_u1.y*g),l=-this.m_limitMass1*c,c=this.m_limitImpulse1,this.m_limitImpulse1=f.Max(0,this.m_limitImpulse1+l),l=this.m_limitImpulse1-c,c=-l*this.m_u1.x,
g=-l*this.m_u1.y,a.m_linearVelocity.x+=a.m_invMass*c,a.m_linearVelocity.y+=a.m_invMass*g,a.m_angularVelocity+=a.m_invI*(d*g-e*c);if(this.m_limitState2==w.e_atUpperLimit)k=b.m_linearVelocity.x+-b.m_angularVelocity*j,l=b.m_linearVelocity.y+b.m_angularVelocity*h,c=-(this.m_u2.x*k+this.m_u2.y*l),l=-this.m_limitMass2*c,c=this.m_limitImpulse2,this.m_limitImpulse2=f.Max(0,this.m_limitImpulse2+l),l=this.m_limitImpulse2-c,k=-l*this.m_u2.x,l=-l*this.m_u2.y,b.m_linearVelocity.x+=b.m_invMass*k,b.m_linearVelocity.y+=
b.m_invMass*l,b.m_angularVelocity+=b.m_invI*(h*l-j*k)};F.prototype.SolvePositionConstraints=function(){var a=this.m_bodyA,c=this.m_bodyB,d,e=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,h=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,j=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,l=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,k=0,m=0,n=0,q=0,p=d=0,z=0,y=0,A=p=y=d=p=d=0;if(this.m_state==w.e_atUpperLimit)d=a.m_xf.R,k=this.m_localAnchor1.x-a.m_sweep.localCenter.x,m=this.m_localAnchor1.y-
a.m_sweep.localCenter.y,p=d.col1.x*k+d.col2.x*m,m=d.col1.y*k+d.col2.y*m,k=p,d=c.m_xf.R,n=this.m_localAnchor2.x-c.m_sweep.localCenter.x,q=this.m_localAnchor2.y-c.m_sweep.localCenter.y,p=d.col1.x*n+d.col2.x*q,q=d.col1.y*n+d.col2.y*q,n=p,d=a.m_sweep.c.x+k,p=a.m_sweep.c.y+m,z=c.m_sweep.c.x+n,y=c.m_sweep.c.y+q,this.m_u1.Set(d-e,p-h),this.m_u2.Set(z-j,y-l),d=this.m_u1.Length(),p=this.m_u2.Length(),d>b.b2_linearSlop?this.m_u1.Multiply(1/d):this.m_u1.SetZero(),p>b.b2_linearSlop?this.m_u2.Multiply(1/p):this.m_u2.SetZero(),
d=this.m_constant-d-this.m_ratio*p,A=f.Max(A,-d),d=f.Clamp(d+b.b2_linearSlop,-b.b2_maxLinearCorrection,0),y=-this.m_pulleyMass*d,d=-y*this.m_u1.x,p=-y*this.m_u1.y,z=-this.m_ratio*y*this.m_u2.x,y=-this.m_ratio*y*this.m_u2.y,a.m_sweep.c.x+=a.m_invMass*d,a.m_sweep.c.y+=a.m_invMass*p,a.m_sweep.a+=a.m_invI*(k*p-m*d),c.m_sweep.c.x+=c.m_invMass*z,c.m_sweep.c.y+=c.m_invMass*y,c.m_sweep.a+=c.m_invI*(n*y-q*z),a.SynchronizeTransform(),c.SynchronizeTransform();if(this.m_limitState1==w.e_atUpperLimit)d=a.m_xf.R,
k=this.m_localAnchor1.x-a.m_sweep.localCenter.x,m=this.m_localAnchor1.y-a.m_sweep.localCenter.y,p=d.col1.x*k+d.col2.x*m,m=d.col1.y*k+d.col2.y*m,k=p,d=a.m_sweep.c.x+k,p=a.m_sweep.c.y+m,this.m_u1.Set(d-e,p-h),d=this.m_u1.Length(),d>b.b2_linearSlop?(this.m_u1.x*=1/d,this.m_u1.y*=1/d):this.m_u1.SetZero(),d=this.m_maxLength1-d,A=f.Max(A,-d),d=f.Clamp(d+b.b2_linearSlop,-b.b2_maxLinearCorrection,0),y=-this.m_limitMass1*d,d=-y*this.m_u1.x,p=-y*this.m_u1.y,a.m_sweep.c.x+=a.m_invMass*d,a.m_sweep.c.y+=a.m_invMass*
p,a.m_sweep.a+=a.m_invI*(k*p-m*d),a.SynchronizeTransform();if(this.m_limitState2==w.e_atUpperLimit)d=c.m_xf.R,n=this.m_localAnchor2.x-c.m_sweep.localCenter.x,q=this.m_localAnchor2.y-c.m_sweep.localCenter.y,p=d.col1.x*n+d.col2.x*q,q=d.col1.y*n+d.col2.y*q,n=p,z=c.m_sweep.c.x+n,y=c.m_sweep.c.y+q,this.m_u2.Set(z-j,y-l),p=this.m_u2.Length(),p>b.b2_linearSlop?(this.m_u2.x*=1/p,this.m_u2.y*=1/p):this.m_u2.SetZero(),d=this.m_maxLength2-p,A=f.Max(A,-d),d=f.Clamp(d+b.b2_linearSlop,-b.b2_maxLinearCorrection,
0),y=-this.m_limitMass2*d,z=-y*this.m_u2.x,y=-y*this.m_u2.y,c.m_sweep.c.x+=c.m_invMass*z,c.m_sweep.c.y+=c.m_invMass*y,c.m_sweep.a+=c.m_invI*(n*y-q*z),c.SynchronizeTransform();return A<b.b2_linearSlop};a.postDefs.push(function(){a.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2});a.inherit(R,a.Dynamics.Joints.b2JointDef);R.prototype.__super=a.Dynamics.Joints.b2JointDef.prototype;R.b2PulleyJointDef=function(){a.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.groundAnchorA=new j;
this.groundAnchorB=new j;this.localAnchorA=new j;this.localAnchorB=new j};R.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this);this.type=w.e_pulleyJoint;this.groundAnchorA.Set(-1,1);this.groundAnchorB.Set(1,1);this.localAnchorA.Set(-1,0);this.localAnchorB.Set(1,0);this.maxLengthB=this.lengthB=this.maxLengthA=this.lengthA=0;this.ratio=1;this.collideConnected=!0};R.prototype.Initialize=function(a,b,c,d,e,f,g){g===void 0&&(g=0);this.bodyA=a;this.bodyB=b;this.groundAnchorA.SetV(c);
this.groundAnchorB.SetV(d);this.localAnchorA=this.bodyA.GetLocalPoint(e);this.localAnchorB=this.bodyB.GetLocalPoint(f);a=e.x-c.x;c=e.y-c.y;this.lengthA=Math.sqrt(a*a+c*c);c=f.x-d.x;d=f.y-d.y;this.lengthB=Math.sqrt(c*c+d*d);this.ratio=g;g=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=g-this.ratio*F.b2_minPulleyLength;this.maxLengthB=(g-F.b2_minPulleyLength)/this.ratio};a.inherit(K,a.Dynamics.Joints.b2Joint);K.prototype.__super=a.Dynamics.Joints.b2Joint.prototype;K.b2RevoluteJoint=function(){a.Dynamics.Joints.b2Joint.b2Joint.apply(this,
arguments);this.K=new e;this.K1=new e;this.K2=new e;this.K3=new e;this.impulse3=new h;this.impulse2=new j;this.reduced=new j;this.m_localAnchor1=new j;this.m_localAnchor2=new j;this.m_impulse=new h;this.m_mass=new d};K.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};K.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};K.prototype.GetReactionForce=function(a){a===void 0&&(a=0);return new j(a*this.m_impulse.x,a*this.m_impulse.y)};
K.prototype.GetReactionTorque=function(a){a===void 0&&(a=0);return a*this.m_impulse.z};K.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle};K.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity};K.prototype.IsLimitEnabled=function(){return this.m_enableLimit};K.prototype.EnableLimit=function(a){this.m_enableLimit=a};K.prototype.GetLowerLimit=function(){return this.m_lowerAngle};K.prototype.GetUpperLimit=
function(){return this.m_upperAngle};K.prototype.SetLimits=function(a,b){a===void 0&&(a=0);b===void 0&&(b=0);this.m_lowerAngle=a;this.m_upperAngle=b};K.prototype.IsMotorEnabled=function(){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);return this.m_enableMotor};K.prototype.EnableMotor=function(a){this.m_enableMotor=a};K.prototype.SetMotorSpeed=function(a){a===void 0&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=a};K.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};
K.prototype.SetMaxMotorTorque=function(a){a===void 0&&(a=0);this.m_maxMotorTorque=a};K.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque};K.prototype.b2RevoluteJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchor1.SetV(a.localAnchorA);this.m_localAnchor2.SetV(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=0;this.m_lowerAngle=a.lowerAngle;this.m_upperAngle=a.upperAngle;this.m_maxMotorTorque=a.maxMotorTorque;this.m_motorSpeed=
a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=w.e_inactiveLimit};K.prototype.InitVelocityConstraints=function(a){var c=this.m_bodyA,d=this.m_bodyB,e,h=0;e=c.m_xf.R;var j=this.m_localAnchor1.x-c.m_sweep.localCenter.x,k=this.m_localAnchor1.y-c.m_sweep.localCenter.y,h=e.col1.x*j+e.col2.x*k,k=e.col1.y*j+e.col2.y*k,j=h;e=d.m_xf.R;var l=this.m_localAnchor2.x-d.m_sweep.localCenter.x,m=this.m_localAnchor2.y-d.m_sweep.localCenter.y,h=e.col1.x*l+e.col2.x*m,
m=e.col1.y*l+e.col2.y*m,l=h;e=c.m_invMass;var h=d.m_invMass,n=c.m_invI,q=d.m_invI;this.m_mass.col1.x=e+h+k*k*n+m*m*q;this.m_mass.col2.x=-k*j*n-m*l*q;this.m_mass.col3.x=-k*n-m*q;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=e+h+j*j*n+l*l*q;this.m_mass.col3.y=j*n+l*q;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=n+q;this.m_motorMass=1/(n+q);if(this.m_enableMotor==!1)this.m_motorImpulse=0;if(this.m_enableLimit){var p=d.m_sweep.a-c.m_sweep.a-
this.m_referenceAngle;if(f.Abs(this.m_upperAngle-this.m_lowerAngle)<2*b.b2_angularSlop)this.m_limitState=w.e_equalLimits;else if(p<=this.m_lowerAngle){if(this.m_limitState!=w.e_atLowerLimit)this.m_impulse.z=0;this.m_limitState=w.e_atLowerLimit}else if(p>=this.m_upperAngle){if(this.m_limitState!=w.e_atUpperLimit)this.m_impulse.z=0;this.m_limitState=w.e_atUpperLimit}else this.m_limitState=w.e_inactiveLimit,this.m_impulse.z=0}else this.m_limitState=w.e_inactiveLimit;a.warmStarting?(this.m_impulse.x*=
a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x,p=this.m_impulse.y,c.m_linearVelocity.x-=e*a,c.m_linearVelocity.y-=e*p,c.m_angularVelocity-=n*(j*p-k*a+this.m_motorImpulse+this.m_impulse.z),d.m_linearVelocity.x+=h*a,d.m_linearVelocity.y+=h*p,d.m_angularVelocity+=q*(l*p-m*a+this.m_motorImpulse+this.m_impulse.z)):(this.m_impulse.SetZero(),this.m_motorImpulse=0)};K.prototype.SolveVelocityConstraints=function(a){var b=this.m_bodyA,c=this.m_bodyB,d=0,e=d=0,g=0,h=
0,j=0,k=b.m_linearVelocity,l=b.m_angularVelocity,m=c.m_linearVelocity,n=c.m_angularVelocity,q=b.m_invMass,p=c.m_invMass,z=b.m_invI,y=c.m_invI;if(this.m_enableMotor&&this.m_limitState!=w.e_equalLimits)e=this.m_motorMass*-(n-l-this.m_motorSpeed),g=this.m_motorImpulse,h=a.dt*this.m_maxMotorTorque,this.m_motorImpulse=f.Clamp(this.m_motorImpulse+e,-h,h),e=this.m_motorImpulse-g,l-=z*e,n+=y*e;if(this.m_enableLimit&&this.m_limitState!=w.e_inactiveLimit){var a=b.m_xf.R,e=this.m_localAnchor1.x-b.m_sweep.localCenter.x,
g=this.m_localAnchor1.y-b.m_sweep.localCenter.y,d=a.col1.x*e+a.col2.x*g,g=a.col1.y*e+a.col2.y*g,e=d,a=c.m_xf.R,h=this.m_localAnchor2.x-c.m_sweep.localCenter.x,j=this.m_localAnchor2.y-c.m_sweep.localCenter.y,d=a.col1.x*h+a.col2.x*j,j=a.col1.y*h+a.col2.y*j,h=d,a=m.x+-n*j-k.x- -l*g,A=m.y+n*h-k.y-l*e;this.m_mass.Solve33(this.impulse3,-a,-A,-(n-l));if(this.m_limitState==w.e_equalLimits)this.m_impulse.Add(this.impulse3);else if(this.m_limitState==w.e_atLowerLimit){if(d=this.m_impulse.z+this.impulse3.z,
d<0)this.m_mass.Solve22(this.reduced,-a,-A),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0}else if(this.m_limitState==w.e_atUpperLimit&&(d=this.m_impulse.z+this.impulse3.z,d>0))this.m_mass.Solve22(this.reduced,-a,-A),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,
this.m_impulse.z=0;k.x-=q*this.impulse3.x;k.y-=q*this.impulse3.y;l-=z*(e*this.impulse3.y-g*this.impulse3.x+this.impulse3.z);m.x+=p*this.impulse3.x;m.y+=p*this.impulse3.y;n+=y*(h*this.impulse3.y-j*this.impulse3.x+this.impulse3.z)}else a=b.m_xf.R,e=this.m_localAnchor1.x-b.m_sweep.localCenter.x,g=this.m_localAnchor1.y-b.m_sweep.localCenter.y,d=a.col1.x*e+a.col2.x*g,g=a.col1.y*e+a.col2.y*g,e=d,a=c.m_xf.R,h=this.m_localAnchor2.x-c.m_sweep.localCenter.x,j=this.m_localAnchor2.y-c.m_sweep.localCenter.y,d=
a.col1.x*h+a.col2.x*j,j=a.col1.y*h+a.col2.y*j,h=d,this.m_mass.Solve22(this.impulse2,-(m.x+-n*j-k.x- -l*g),-(m.y+n*h-k.y-l*e)),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,k.x-=q*this.impulse2.x,k.y-=q*this.impulse2.y,l-=z*(e*this.impulse2.y-g*this.impulse2.x),m.x+=p*this.impulse2.x,m.y+=p*this.impulse2.y,n+=y*(h*this.impulse2.y-j*this.impulse2.x);b.m_linearVelocity.SetV(k);b.m_angularVelocity=l;c.m_linearVelocity.SetV(m);c.m_angularVelocity=n};K.prototype.SolvePositionConstraints=
function(){var a=0,c,d=this.m_bodyA,e=this.m_bodyB,h=0,j=c=0,k=0,l=0;if(this.m_enableLimit&&this.m_limitState!=w.e_inactiveLimit){var a=e.m_sweep.a-d.m_sweep.a-this.m_referenceAngle,m=0;this.m_limitState==w.e_equalLimits?(a=f.Clamp(a-this.m_lowerAngle,-b.b2_maxAngularCorrection,b.b2_maxAngularCorrection),m=-this.m_motorMass*a,h=f.Abs(a)):this.m_limitState==w.e_atLowerLimit?(a-=this.m_lowerAngle,h=-a,a=f.Clamp(a+b.b2_angularSlop,-b.b2_maxAngularCorrection,0),m=-this.m_motorMass*a):this.m_limitState==
w.e_atUpperLimit&&(a-=this.m_upperAngle,h=a,a=f.Clamp(a-b.b2_angularSlop,0,b.b2_maxAngularCorrection),m=-this.m_motorMass*a);d.m_sweep.a-=d.m_invI*m;e.m_sweep.a+=e.m_invI*m;d.SynchronizeTransform();e.SynchronizeTransform()}c=d.m_xf.R;m=this.m_localAnchor1.x-d.m_sweep.localCenter.x;a=this.m_localAnchor1.y-d.m_sweep.localCenter.y;j=c.col1.x*m+c.col2.x*a;a=c.col1.y*m+c.col2.y*a;m=j;c=e.m_xf.R;var n=this.m_localAnchor2.x-e.m_sweep.localCenter.x,q=this.m_localAnchor2.y-e.m_sweep.localCenter.y,j=c.col1.x*
n+c.col2.x*q,q=c.col1.y*n+c.col2.y*q,n=j,k=e.m_sweep.c.x+n-d.m_sweep.c.x-m,l=e.m_sweep.c.y+q-d.m_sweep.c.y-a,p=k*k+l*l;c=Math.sqrt(p);var j=d.m_invMass,z=e.m_invMass,y=d.m_invI,A=e.m_invI,B=10*b.b2_linearSlop;p>B*B&&(p=1/(j+z),k=p*-k,l=p*-l,d.m_sweep.c.x-=0.5*j*k,d.m_sweep.c.y-=0.5*j*l,e.m_sweep.c.x+=0.5*z*k,e.m_sweep.c.y+=0.5*z*l,k=e.m_sweep.c.x+n-d.m_sweep.c.x-m,l=e.m_sweep.c.y+q-d.m_sweep.c.y-a);this.K1.col1.x=j+z;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=j+z;this.K2.col1.x=y*a*a;this.K2.col2.x=
-y*m*a;this.K2.col1.y=-y*m*a;this.K2.col2.y=y*m*m;this.K3.col1.x=A*q*q;this.K3.col2.x=-A*n*q;this.K3.col1.y=-A*n*q;this.K3.col2.y=A*n*n;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.AddM(this.K3);this.K.Solve(K.tImpulse,-k,-l);k=K.tImpulse.x;l=K.tImpulse.y;d.m_sweep.c.x-=d.m_invMass*k;d.m_sweep.c.y-=d.m_invMass*l;d.m_sweep.a-=d.m_invI*(m*l-a*k);e.m_sweep.c.x+=e.m_invMass*k;e.m_sweep.c.y+=e.m_invMass*l;e.m_sweep.a+=e.m_invI*(n*l-q*k);d.SynchronizeTransform();e.SynchronizeTransform();return c<=b.b2_linearSlop&&
h<=b.b2_angularSlop};a.postDefs.push(function(){a.Dynamics.Joints.b2RevoluteJoint.tImpulse=new j});a.inherit(N,a.Dynamics.Joints.b2JointDef);N.prototype.__super=a.Dynamics.Joints.b2JointDef.prototype;N.b2RevoluteJointDef=function(){a.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new j;this.localAnchorB=new j};N.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this);this.type=w.e_revoluteJoint;this.localAnchorA.Set(0,0);this.localAnchorB.Set(0,0);
this.motorSpeed=this.maxMotorTorque=this.upperAngle=this.lowerAngle=this.referenceAngle=0;this.enableMotor=this.enableLimit=!1};N.prototype.Initialize=function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.GetLocalPoint(c);this.localAnchorB=this.bodyB.GetLocalPoint(c);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};a.inherit(U,a.Dynamics.Joints.b2Joint);U.prototype.__super=a.Dynamics.Joints.b2Joint.prototype;U.b2WeldJoint=function(){a.Dynamics.Joints.b2Joint.b2Joint.apply(this,
arguments);this.m_localAnchorA=new j;this.m_localAnchorB=new j;this.m_impulse=new h;this.m_mass=new d};U.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};U.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};U.prototype.GetReactionForce=function(a){a===void 0&&(a=0);return new j(a*this.m_impulse.x,a*this.m_impulse.y)};U.prototype.GetReactionTorque=function(a){a===void 0&&(a=0);return a*this.m_impulse.z};U.prototype.b2WeldJoint=
function(a){this.__super.b2Joint.call(this,a);this.m_localAnchorA.SetV(a.localAnchorA);this.m_localAnchorB.SetV(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.SetZero();this.m_mass=new d};U.prototype.InitVelocityConstraints=function(a){var b,c=0,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchorA.x-d.m_sweep.localCenter.x,g=this.m_localAnchorA.y-d.m_sweep.localCenter.y,c=b.col1.x*f+b.col2.x*g,g=b.col1.y*f+b.col2.y*g,f=c;b=e.m_xf.R;var h=this.m_localAnchorB.x-
e.m_sweep.localCenter.x,j=this.m_localAnchorB.y-e.m_sweep.localCenter.y,c=b.col1.x*h+b.col2.x*j,j=b.col1.y*h+b.col2.y*j,h=c;b=d.m_invMass;var c=e.m_invMass,k=d.m_invI,l=e.m_invI;this.m_mass.col1.x=b+c+g*g*k+j*j*l;this.m_mass.col2.x=-g*f*k-j*h*l;this.m_mass.col3.x=-g*k-j*l;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=b+c+f*f*k+h*h*l;this.m_mass.col3.y=f*k+h*l;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=k+l;a.warmStarting?(this.m_impulse.x*=
a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_impulse.z*=a.dtRatio,d.m_linearVelocity.x-=b*this.m_impulse.x,d.m_linearVelocity.y-=b*this.m_impulse.y,d.m_angularVelocity-=k*(f*this.m_impulse.y-g*this.m_impulse.x+this.m_impulse.z),e.m_linearVelocity.x+=c*this.m_impulse.x,e.m_linearVelocity.y+=c*this.m_impulse.y,e.m_angularVelocity+=l*(h*this.m_impulse.y-j*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()};U.prototype.SolveVelocityConstraints=function(){var a,b=0,c=this.m_bodyA,d=this.m_bodyB,
e=c.m_linearVelocity,f=c.m_angularVelocity,g=d.m_linearVelocity,j=d.m_angularVelocity,k=c.m_invMass,l=d.m_invMass,m=c.m_invI,n=d.m_invI;a=c.m_xf.R;var q=this.m_localAnchorA.x-c.m_sweep.localCenter.x,p=this.m_localAnchorA.y-c.m_sweep.localCenter.y,b=a.col1.x*q+a.col2.x*p,p=a.col1.y*q+a.col2.y*p,q=b;a=d.m_xf.R;var z=this.m_localAnchorB.x-d.m_sweep.localCenter.x,w=this.m_localAnchorB.y-d.m_sweep.localCenter.y,b=a.col1.x*z+a.col2.x*w,w=a.col1.y*z+a.col2.y*w,z=b;a=g.x-j*w-e.x+f*p;var b=g.y+j*z-e.y-f*q,
y=j-f,A=new h;this.m_mass.Solve33(A,-a,-b,-y);this.m_impulse.Add(A);e.x-=k*A.x;e.y-=k*A.y;f-=m*(q*A.y-p*A.x+A.z);g.x+=l*A.x;g.y+=l*A.y;j+=n*(z*A.y-w*A.x+A.z);c.m_angularVelocity=f;d.m_angularVelocity=j};U.prototype.SolvePositionConstraints=function(){var a,c=0,d=this.m_bodyA,e=this.m_bodyB;a=d.m_xf.R;var j=this.m_localAnchorA.x-d.m_sweep.localCenter.x,k=this.m_localAnchorA.y-d.m_sweep.localCenter.y,c=a.col1.x*j+a.col2.x*k,k=a.col1.y*j+a.col2.y*k,j=c;a=e.m_xf.R;var l=this.m_localAnchorB.x-e.m_sweep.localCenter.x,
m=this.m_localAnchorB.y-e.m_sweep.localCenter.y,c=a.col1.x*l+a.col2.x*m,m=a.col1.y*l+a.col2.y*m,l=c;a=d.m_invMass;var c=e.m_invMass,n=d.m_invI,q=e.m_invI,p=e.m_sweep.c.x+l-d.m_sweep.c.x-j,z=e.m_sweep.c.y+m-d.m_sweep.c.y-k,w=e.m_sweep.a-d.m_sweep.a-this.m_referenceAngle,y=10*b.b2_linearSlop,A=Math.sqrt(p*p+z*z),B=f.Abs(w);A>y&&(n*=1,q*=1);this.m_mass.col1.x=a+c+k*k*n+m*m*q;this.m_mass.col2.x=-k*j*n-m*l*q;this.m_mass.col3.x=-k*n-m*q;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=a+c+j*j*n+
l*l*q;this.m_mass.col3.y=j*n+l*q;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=n+q;y=new h;this.m_mass.Solve33(y,-p,-z,-w);d.m_sweep.c.x-=a*y.x;d.m_sweep.c.y-=a*y.y;d.m_sweep.a-=n*(j*y.y-k*y.x+y.z);e.m_sweep.c.x+=c*y.x;e.m_sweep.c.y+=c*y.y;e.m_sweep.a+=q*(l*y.y-m*y.x+y.z);d.SynchronizeTransform();e.SynchronizeTransform();return A<=b.b2_linearSlop&&B<=b.b2_angularSlop};a.inherit(Q,a.Dynamics.Joints.b2JointDef);Q.prototype.__super=a.Dynamics.Joints.b2JointDef.prototype;
Q.b2WeldJointDef=function(){a.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new j;this.localAnchorB=new j};Q.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this);this.type=w.e_weldJoint;this.referenceAngle=0};Q.prototype.Initialize=function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(c));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(c));this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}})();(function(){var b=
a.Dynamics.b2DebugDraw;b.b2DebugDraw=function(){this.m_xformScale=this.m_fillAlpha=this.m_alpha=this.m_lineThickness=this.m_drawScale=1;var a=this;this.m_sprite={graphics:{clear:function(){a.m_ctx.clearRect(0,0,a.m_ctx.canvas.width,a.m_ctx.canvas.height)}}}};b.prototype._color=function(a,b){return"rgba("+((a&16711680)>>16)+","+((a&65280)>>8)+","+(a&255)+","+b+")"};b.prototype.b2DebugDraw=function(){this.m_drawFlags=0};b.prototype.SetFlags=function(a){a===void 0&&(a=0);this.m_drawFlags=a};b.prototype.GetFlags=
function(){return this.m_drawFlags};b.prototype.AppendFlags=function(a){a===void 0&&(a=0);this.m_drawFlags|=a};b.prototype.ClearFlags=function(a){a===void 0&&(a=0);this.m_drawFlags&=~a};b.prototype.SetSprite=function(a){this.m_ctx=a};b.prototype.GetSprite=function(){return this.m_ctx};b.prototype.SetDrawScale=function(a){a===void 0&&(a=0);this.m_drawScale=a};b.prototype.GetDrawScale=function(){return this.m_drawScale};b.prototype.SetLineThickness=function(a){a===void 0&&(a=0);this.m_lineThickness=
a;this.m_ctx.strokeWidth=a};b.prototype.GetLineThickness=function(){return this.m_lineThickness};b.prototype.SetAlpha=function(a){a===void 0&&(a=0);this.m_alpha=a};b.prototype.GetAlpha=function(){return this.m_alpha};b.prototype.SetFillAlpha=function(a){a===void 0&&(a=0);this.m_fillAlpha=a};b.prototype.GetFillAlpha=function(){return this.m_fillAlpha};b.prototype.SetXFormScale=function(a){a===void 0&&(a=0);this.m_xformScale=a};b.prototype.GetXFormScale=function(){return this.m_xformScale};b.prototype.DrawPolygon=
function(a,b,f){if(b){var g=this.m_ctx,h=this.m_drawScale;g.beginPath();g.strokeStyle=this._color(f.color,this.m_alpha);g.moveTo(a[0].x*h,a[0].y*h);for(f=1;f<b;f++)g.lineTo(a[f].x*h,a[f].y*h);g.lineTo(a[0].x*h,a[0].y*h);g.closePath();g.stroke()}};b.prototype.DrawSolidPolygon=function(a,b,f){if(b){var g=this.m_ctx,h=this.m_drawScale;g.beginPath();g.strokeStyle=this._color(f.color,this.m_alpha);g.fillStyle=this._color(f.color,this.m_fillAlpha);g.moveTo(a[0].x*h,a[0].y*h);for(f=1;f<b;f++)g.lineTo(a[f].x*
h,a[f].y*h);g.lineTo(a[0].x*h,a[0].y*h);g.closePath();g.fill();g.stroke()}};b.prototype.DrawCircle=function(a,b,f){if(b){var g=this.m_ctx,h=this.m_drawScale;g.beginPath();g.strokeStyle=this._color(f.color,this.m_alpha);g.arc(a.x*h,a.y*h,b*h,0,Math.PI*2,!0);g.closePath();g.stroke()}};b.prototype.DrawSolidCircle=function(a,b,f,g){if(b){var h=this.m_ctx,j=this.m_drawScale,c=a.x*j,k=a.y*j;h.moveTo(0,0);h.beginPath();h.strokeStyle=this._color(g.color,this.m_alpha);h.fillStyle=this._color(g.color,this.m_fillAlpha);
h.arc(c,k,b*j,0,Math.PI*2,!0);h.moveTo(c,k);h.lineTo((a.x+f.x*b)*j,(a.y+f.y*b)*j);h.closePath();h.fill();h.stroke()}};b.prototype.DrawSegment=function(a,b,f){var g=this.m_ctx,h=this.m_drawScale;g.strokeStyle=this._color(f.color,this.m_alpha);g.beginPath();g.moveTo(a.x*h,a.y*h);g.lineTo(b.x*h,b.y*h);g.closePath();g.stroke()};b.prototype.DrawTransform=function(a){var b=this.m_ctx,f=this.m_drawScale;b.beginPath();b.strokeStyle=this._color(16711680,this.m_alpha);b.moveTo(a.position.x*f,a.position.y*f);
b.lineTo((a.position.x+this.m_xformScale*a.R.col1.x)*f,(a.position.y+this.m_xformScale*a.R.col1.y)*f);b.strokeStyle=this._color(65280,this.m_alpha);b.moveTo(a.position.x*f,a.position.y*f);b.lineTo((a.position.x+this.m_xformScale*a.R.col2.x)*f,(a.position.y+this.m_xformScale*a.R.col2.y)*f);b.closePath();b.stroke()}})();var k;for(k=0;k<a.postDefs.length;++k)a.postDefs[k]();delete a.postDefs;b.Box2D=a;b.b2AABB=a.Collision.b2AABB;b.b2Vec2=a.Common.Math.b2Vec2;b.b2BodyDef=a.Dynamics.b2BodyDef;b.b2Body=
a.Dynamics.b2Body;b.b2FixtureDef=a.Dynamics.b2FixtureDef;b.b2Fixture=a.Dynamics.b2Fixture;b.b2World=a.Dynamics.b2World;b.b2MassData=a.Collision.Shapes.b2MassData;b.b2PolygonShape=a.Collision.Shapes.b2PolygonShape;b.b2CircleShape=a.Collision.Shapes.b2CircleShape;b.b2DebugDraw=a.Dynamics.b2DebugDraw;b.b2RevoluteJointDef=a.Dynamics.Joints.b2RevoluteJointDef;b.b2PrismaticJointDef=a.Dynamics.Joints.b2PrismaticJointDef;b.b2Transform=a.Common.Math.b2Transform;b.b2WorldManifold=a.Collision.b2WorldManifold}},
[]);
require.define({"engine/audia":function(){(function(){var n=null;typeof AudioContext=="function"?n=new AudioContext:typeof webkitAudioContext=="function"&&(n=new webkitAudioContext);var b,a=Boolean(n),j=0;if(a){var m={},k=function(a,b){var d=function(b){if(b.duration!==a._duration)a._duration=b.duration,a.dispatchEvent("durationchange");a.dispatchEvent("canplay");a.dispatchEvent("canplaythrough");a.dispatchEvent("load");a._autoplay&&a.play()};if(b in m)d(m[b]);else{var e=new XMLHttpRequest;e.open("GET",b,
!0);e.responseType="arraybuffer";e.onload=function(){n.decodeAudioData(e.response,function(a){m[b]=a;d(a)})};e.send()}},g=function(a){a.bufferSource=n.createBufferSource();a.bufferSource.buffer=m[a.src];a.bufferSource.connect(a.gainNode);a.bufferSource.loop=a._loop},e=n.createGainNode();e.gain.value=1;e.connect(n.destination);b=function(a){this.id=++j;this._listenerId=0;this._listeners={};this._autoplay=!1;this._buffered=[];this._currentSrc="";this._currentTime=0;this._defaultPlaybackRate=1;this._duration=
NaN;this._muted=this._loop=!1;this._paused=!0;this._playbackRate=1;this._played=[];this._preload="auto";this._seekable=[];this._seeking=!1;this._src="";this._volume=1;this.gainNode=n.createGainNode();this.gainNode.gain.value=this._volume;this.gainNode.connect(e);if(a!==void 0)this.src=a};b.prototype.load=function(){this._src&&k(this,this._src)};b.prototype.play=function(){this._paused=!1;g(this);this.bufferSource.noteOn(0)};b.prototype.pause=function(){if(!this._paused)this._paused=!0,this.bufferSource.noteOff(0)};
b.prototype.stop=function(){if(!this._paused)this.pause(),this.currentTime=0};b.prototype.addEventListener=function(a,b){this._listeners[++this._listenerKey]={eventName:a,callback:b}};b.prototype.dispatchEvent=function(a,b){for(var d in this._listeners){var e=this._listeners[d];e.eventName==a&&e.callback&&e.callback.apply(e.callback,b)}};b.prototype.removeEventListener=function(a,b){var d=null,e;for(e in this._listeners){var f=this._listeners[e];if(f.eventName===a&&f.callback===b){d=e;break}}d!==
null&&delete this._listeners[d]};Object.defineProperty(b.prototype,"autoplay",{get:function(){return this._autoplay},set:function(a){this._autoplay=a}});Object.defineProperty(b.prototype,"buffered",{get:function(){return this._buffered}});Object.defineProperty(b.prototype,"currentSrc",{get:function(){return this._currentSrc}});Object.defineProperty(b.prototype,"currentTime",{get:function(){return this._currentTime},set:function(a){this._currentTime=a}});Object.defineProperty(b.prototype,"defaultPlaybackRate",
{get:function(){return Number(this._defaultPlaybackRate)},set:function(a){this._defaultPlaybackRate=a}});Object.defineProperty(b.prototype,"duration",{get:function(){return this._duration}});Object.defineProperty(b.prototype,"loop",{get:function(){return this._loop},set:function(a){if(this._loop!==a&&(this._loop=a,this.bufferSource))this._paused?(g(this),this.bufferSource.loop=a):(this.pause(),g(this),this.bufferSource.loop=a,this.play())}});Object.defineProperty(b.prototype,"muted",{get:function(){return this._muted},
set:function(a){this._muted=a;this.gainNode.gain.value=a?0:this._volume}});Object.defineProperty(b.prototype,"paused",{get:function(){return this._paused}});Object.defineProperty(b.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(a){this._playbackRate=a}});Object.defineProperty(b.prototype,"played",{get:function(){return this._played}});Object.defineProperty(b.prototype,"preload",{get:function(){return this._preload},set:function(a){this._preload=a}});Object.defineProperty(b.prototype,
"seekable",{get:function(){return this._seekable}});Object.defineProperty(b.prototype,"seeking",{get:function(){return this._seeking}});Object.defineProperty(b.prototype,"src",{get:function(){return this._src},set:function(a){this._src=a;k(this,a)}});Object.defineProperty(b.prototype,"volume",{get:function(){return this._volume},set:function(a){a<0&&(a=0);this._volume=a;if(!this._muted)this.gainNode.gain.value=a,this.dispatchEvent("volumechange")}})}else b=function(a){this.id=++j;this._audioNode=
new Audio;if(a!==void 0)this.src=a},b.prototype.load=function(){this._audioNode.load()},b.prototype.play=function(a){if(a!==void 0)this._audioNode.currentTime=a;this._audioNode.play()},b.prototype.pause=function(){this._audioNode.pause()},b.prototype.stop=function(){this._audioNode.pause();this._audioNode.currentTime=0},b.prototype.addEventListener=function(a,b,d){this._audioNode.addEventListener(a,b,d)},b.prototype.removeEventListener=function(a,b,d){this._audioNode.removeEventListener(a,b,d)},Object.defineProperty(b.prototype,
"autoplay",{get:function(){return this._audioNode.autoplay},set:function(a){this._audioNode.autoplay=a}}),Object.defineProperty(b.prototype,"buffered",{get:function(){return this._audioNode.buffered}}),Object.defineProperty(b.prototype,"currentSrc",{get:function(){return this._audioNode.src}}),Object.defineProperty(b.prototype,"currentTime",{get:function(){return this._audioNode.currentTime},set:function(a){this._audioNode.currentTime=a}}),Object.defineProperty(b.prototype,"defaultPlaybackRate",{get:function(){return this._audioNode.defaultPlaybackRate},
set:function(a){this._audioNode.defaultPlaybackRate=a}}),Object.defineProperty(b.prototype,"duration",{get:function(){return this._audioNode.duration}}),Object.defineProperty(b.prototype,"loop",{get:function(){return this._audioNode.loop},set:function(a){if(this._audioNode.currentTime>=this._audioNode.duration)this._audioNode.currentTime=0;this._audioNode.loop=a}}),Object.defineProperty(b.prototype,"muted",{get:function(){return this._audioNode.muted},set:function(a){this._audioNode.muted=a}}),Object.defineProperty(b.prototype,
"paused",{get:function(){return this._audioNode.paused}}),Object.defineProperty(b.prototype,"playbackRate",{get:function(){return this._audioNode.playbackRate},set:function(a){this._audioNode.playbackRate=a}}),Object.defineProperty(b.prototype,"played",{get:function(){return this._audioNode.played}}),Object.defineProperty(b.prototype,"preload",{get:function(){return this._audioNode.preload},set:function(a){this._audioNode.preload=a}}),Object.defineProperty(b.prototype,"seekable",{get:function(){return this._audioNode.seekable}}),
Object.defineProperty(b.prototype,"seeking",{get:function(){return this._audioNode.seeking}}),Object.defineProperty(b.prototype,"src",{get:function(){return this._audioNode.src},set:function(a){this._audioNode.src=a}}),Object.defineProperty(b.prototype,"volume",{get:function(){return this._audioNode.volume},set:function(a){b.preventErrors&&(a=Math.min(Math.max(Number(a),0),1));this._audioNode.volume=a}});b.preventErrors=!0;Object.defineProperty(b,"hasWebAudio",{get:function(){return a}});Object.defineProperty(b,
"audioContext",{get:function(){return n}});Object.defineProperty(b,"gainNode",{get:function(){return e}});Object.defineProperty(b,"version",{get:function(){return"0.3.0"}});var d;b.canPlayType=function(a){d===void 0&&(d=new Audio);a=(a.match("/")===null?"audio/":"")+a;return d.canPlayType(a)};b.prototype.canPlayType=function(a){return b.canPlayType(a)};for(var f=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play",
"playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange"],l=0,h=f.length;l<h;++l)(function(a){var c="_on"+a;b.prototype[c]=null;Object.defineProperty(b.prototype,"on"+a,{get:function(){return this[c]},set:function(b){this[c]&&this.removeEventListener(a,this[c],!1);typeof b=="function"?(this[c]=b,this.addEventListener(a,b,!1)):this[c]=null}})})(f[l]);return b})()}},[]);
require.define({"engine/director":function(n,b){var a=n("gamejs"),j=function(a){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){window.setTimeout(b,1E3/a)}}(),m=b.Director=function(a,b){this.on_air=!1;this.scenes=[];this.display=a;this.last_t=null;this.fps=b;this.tick(0)};m.prototype.push=function(a){this.scenes.push(a)};m.prototype.pop=function(){if(this.scenes.length){var a=
this.scenes.pop();a.destroy&&a.destroy();return a}return null};m.prototype.replace=function(a){this.pop();this.push(a)};m.prototype.get_active_scene=function(){if(this.scenes.length)return this.scenes[this.scenes.length-1];return null};m.prototype.clear=function(){for(;this.scenes.length;)this.pop()};m.prototype.tick=function(a){var a=a||(new Date).getTime(),b=a-this.last_t;this.last_t=a;this.get_active_scene()&&this.on_air&&(this.tick_logic(b),this.tick_render(b));var e=this;j(function(a){e.tick(a)},
display._canvas)};m.prototype.tick_logic=function(b){var g=this.get_active_scene();if(g.handleEvent){var e=a.event.get(),d;for(d=0;d<e.length;d++)g.handleEvent(e[d])}else a.event.get();g.update&&g.update(b)};m.prototype.tick_render=function(a){var b=this.get_active_scene();b.draw&&b.draw(this.display,a)};m.prototype.start=function(){this.on_air=!0}}},["gamejs"]);
require.define({"engine/sound":function(n,b){var a=n("./audia"),j=a.Audia,m=n("./object"),k=n("./utils"),g=n("gamejs"),e={};if(a.supported){var d=b.Sound=function(a){this.cur=0;this.audios=[];for(var b=0;b<8;b++)this.audios.push(new j(a))};d.prototype.play=function(a){var b=this.audios[this.cur++];if(this.cur==8)this.cur=0;b.loop=a?!0:!1;b.play()};d.prototype.stop=function(){this.audios.forEach(function(a){a.stop()})}}else d=b.Sound=function(a){this.audio=new g.mixer.Sound(a)},d.prototype.play=function(a){this.audio.play(a?
!0:!1)},d.prototype.stop=function(){this.audio.stop()};var f=b.SoundObject=function(a){k.process_parameters(a,["filename",["loop",!1],["position",null]]);f.superConstructor.apply(this,[a])};g.utils.objects.extend(f,m.Object);b.play=function(a){e[a].play()};f.prototype.draw=function(a){var b=!1;if(this.parameters.position){var d=a.getScreenPoint(this.parameters.position);d[0]>0&&d[0]<a.width&&d[1]>0&&d[1]<a.height&&(b=!0)}else b=!0;b&&e[this.parameters.filename].play(this.parameters.loop);this.world.destroy(this)};
a=n("../engine");a.register_class(f);a.initialize_sounds=b.initialize=function(a){a.forEach(function(a){e[a]=new d(a)})}}},["engine/audia","engine/object","engine/utils","gamejs","engine"]);
require.define({"engine/object":function(n,b){n("./logging");var a=n("./utils"),j=b.Object=function(b){this.parameters=a.process_parameters(b,["world"]);this.id=this.parameters.id;this.world=this.parameters.world;this.world.objects[this.id]=this;this._tags={}};j.prototype.AM_OBJECT=!0;j.prototype.add_tag=function(a){this._tags[a]=!0};j.prototype.has_tag=function(a){return this._tags[a]?!0:!1};j.prototype.update=function(){};j.prototype.draw=function(){};j.prototype.on_create=function(){};j.prototype.destroy=
function(){};j.prototype.die=function(){}}},["engine/logging","engine/utils"]);require.define({"engine/logging":function(n,b){var a=b.TYPE_WARNING="warning",j=b.TYPE_ERROR="error",m=b.Logger=function(){};m.prototype.log=function(a,b){console.log(a,b)};b.logger=new m;b.warning=function(j){b.logger.log(a,j)};b.error=function(a){b.logger.log(j,a)}}},[]);
require.define({"engine/utils":function(n,b){var a=n("./box2d");b.vec=function(){if(!arguments.length||!arguments[0].hasOwnProperty("x"))if(arguments.length==1)return new a.b2Vec2(arguments[0][0],arguments[0][1]);else if(arguments.length==2)return new a.b2Vec2(arguments[0],arguments[1]);else throw"kablooie";else return arguments[0]};b.arr=function(a){if(a.hasOwnProperty("x"))return[a.x,a.y];return a};b.process_parameters=function(a,b){b.forEach(function(b){var g,e=void 0;b instanceof Array?(g=b[0],
b.length>1&&(e=b[1])):g=b;if(!(g in a))if(e!=void 0)a[g]=e;else throw"Missing parameter: "+g;});return a};b.copy=function(a,b){for(var k in a)b[k]=a[k];return b}}},["engine/box2d"]);
require.define({gamejs:function(n,b){function a(){var a=0,b=0,d=0,e=0;if(arguments.length===2)arguments[0]instanceof Array&&arguments[1]instanceof Array?(a=arguments[0][0],b=arguments[0][1],d=arguments[1][0],e=arguments[1][1]):(a=arguments[0],b=arguments[1]);else if(arguments.length===1&&arguments[0]instanceof Array)a=arguments[0][0],b=arguments[0][1],d=arguments[0][2],e=arguments[0][3];else if(arguments.length===1&&arguments[0]instanceof f)a=arguments[0].left,b=arguments[0].top,d=arguments[0].width,
e=arguments[0].height;else if(arguments.length===4)a=arguments[0],b=arguments[1],d=arguments[2],e=arguments[3];else throw Error("not a valid rectangle specification");return{left:a||0,top:b||0,width:d||0,height:e||0}}var j=n("./gamejs/utils/matrix"),m=n("./gamejs/utils/objects"),k=n("./gamejs/callback").Callback,g=["info","warn","error","fatal"],e=2;b.setLogLevel=function(a){if(typeof a==="string"&&g.indexOf(a))e=g.indexOf(a);else if(typeof a==="number")e=a;else throw Error("invalid logLevel ",a,
" Must be one of: ",g);return e};var d=b.log=function(){if(h.worker.inWorker===!0)h.worker._logMessage(arguments);else{var a=Array.prototype.slice.apply(arguments,[0]);a.unshift(Date.now());window.console!==void 0&&console.log.apply&&console.log.apply(console,a)}};b.info=function(){e<=g.indexOf("info")&&d.apply(this,arguments)};b.warn=function(){e<=g.indexOf("warn")&&d.apply(this,arguments)};b.error=function(){e<=g.indexOf("error")&&d.apply(this,arguments)};b.fatal=function(){e<=g.indexOf("fatal")&&
d.apply(this,arguments)};var f=b.Rect=function(){var b=a.apply(this,arguments);this.left=b.left;this.top=b.top;this.width=b.width;this.height=b.height;return this};m.accessors(f.prototype,{bottom:{get:function(){return this.top+this.height},set:function(a){this.top=a-this.height}},right:{get:function(){return this.left+this.width},set:function(a){this.left=a-this.width}},center:{get:function(){return[this.left+this.width/2|0,this.top+this.height/2|0]},set:function(){var b=a.apply(this,arguments);
this.left=b.left-this.width/2|0;this.top=b.top-this.height/2|0}},topleft:{get:function(){return[this.left,this.top]},set:function(){var b=a.apply(this,arguments);this.left=b.left;this.top=b.top}},bottomleft:{get:function(){return[this.left,this.bottom]},set:function(){var b=a.apply(this,arguments);this.left=b.left;this.bottom=b.top}},topright:{get:function(){return[this.right,this.top]},set:function(){var b=a.apply(this,arguments);this.right=b.left;this.top=b.top}},bottomright:{get:function(){return[this.right,
this.bottom]},set:function(){var b=a.apply(this,arguments);this.right=b.left;this.bottom=b.top}},x:{get:function(){return this.left},set:function(a){this.left=a}},y:{get:function(){return this.top},set:function(a){this.top=a}}});f.prototype.move=function(){var b=a.apply(this,arguments);return new f(this.left+b.left,this.top+b.top,this.width,this.height)};f.prototype.moveIp=function(){var b=a.apply(this,arguments);this.left+=b.left;this.top+=b.top};f.prototype.clip=function(a){if(!this.collideRect(a))return new f(0,
0,0,0);var b,d,e,g;if(this.left>=a.left&&this.left<a.right)b=this.left;else if(a.left>=this.left&&a.left<this.right)b=a.left;this.right>a.left&&this.right<=a.right?e=this.right-b:a.right>this.left&&a.right<=this.right&&(e=a.right-b);if(this.top>=a.top&&this.top<a.bottom)d=this.top;else if(a.top>=this.top&&a.top<this.bottom)d=a.top;this.bottom>a.top&&this.bottom<=a.bottom?g=this.bottom-d:a.bottom>this.top&&a.bottom<=this.bottom&&(g=a.bottom-d);return new f(b,d,e,g)};f.prototype.union=function(a){var b,
d;b=Math.min(this.left,a.left);d=Math.min(this.top,a.top);return new f(b,d,Math.max(this.right,a.right)-b,Math.max(this.bottom,a.bottom)-d)};f.prototype.inflate=function(a,b){var d=this.clone();d.inflateIp(a,b);return d};f.prototype.inflateIp=function(a,b){this.left-=Math.floor(a/2);this.top-=Math.floor(b/2);this.width+=a;this.height+=b};f.prototype.collidePoint=function(){var b=a.apply(this,arguments);return this.left<=b.left&&b.left<=this.right&&this.top<=b.top&&b.top<=this.bottom};f.prototype.collideRect=
function(a){return!(this.left>a.right||this.right<a.left||this.top>a.bottom||this.bottom<a.top)};f.prototype.collideLine=function(a,b){var d=a[0],e=a[1],f=b[0],g=b[1],h=!0,j=!0,k=!0;[[this.left,this.top],[this.left,this.bottom],[this.right,this.top],[this.right,this.bottom]].map(function(a){return(g-e)*a[0]+(d-f)*a[1]+(f*e-d*g)}).forEach(function(a){a>0?j=!1:a<0?h=!1:a===0&&(k=!1)},this);if((h||j)&&k)return!1;return!(d>this.right&&f>this.right||d<this.left&&f<this.left||e<this.top&&g<this.top||e>
this.bottom&&g>this.bottom)};f.prototype.toString=function(){return["[",this.left,",",this.top,"] [",this.width,",",this.height,"]"].join("")};f.prototype.clone=function(){return new f(this)};var l=b.Surface=function(){var c=a.apply(this,arguments),d=c.left,e=c.top;if(arguments.length==1&&arguments[0]instanceof f)d=c.width,e=c.height;this._matrix=j.identity();this._canvas=document.createElement("canvas");this._canvas.width=d;this._canvas.height=e;this._blitAlpha=1;this._context=this._canvas.getContext("2d");
b.display._isSmoothingEnabled()?this._smooth():this._noSmooth();return this};l.prototype._noSmooth=function(){this.context.mozImageSmoothingEnabled=!1;this.context.webkitImageSmoothingEnabled=!1};l.prototype._smooth=function(){this.context.mozImageSmoothingEnabled=!0;this.context.webkitImageSmoothingEnabled=!0};l.prototype.blit=function(a,b,d,e){if(b instanceof f){var b=b.clone(),g=a.getSize();if(!b.width)b.width=g[0];if(!b.height)b.height=g[1]}else b=b&&b instanceof Array&&b.length==2?new f(b,a.getSize()):
new f([0,0],a.getSize());e=e||"source-over";d instanceof f||(d&&d instanceof Array&&d.length==2?(g=a.getSize(),d=new f(d,[g[0]-d[0],g[1]-d[1]])):d=new f([0,0],a.getSize()));if(isNaN(b.left)||isNaN(b.top)||isNaN(b.width)||isNaN(b.height))throw Error("[blit] bad parameters, destination is "+b);this.context.save();this.context.globalCompositeOperation=e;e=j.translate(j.identity(),b.left,b.top);e=j.multiply(e,a._matrix);this.context.transform(e[0],e[1],e[2],e[3],e[4],e[5]);this.context.globalAlpha=a._blitAlpha;
this.context.drawImage(a.canvas,d.left,d.top,d.width,d.height,0,0,b.width,b.height);this.context.restore()};l.prototype.getSize=function(){return[this.canvas.width,this.canvas.height]};l.prototype.getRect=function(){return new f([0,0],this.getSize())};l.prototype.fill=function(a,b){this.context.save();this.context.fillStyle=a||"#000000";b===void 0&&(b=new f(0,0,this.canvas.width,this.canvas.height));this.context.fillRect(b.left,b.top,b.width,b.height);this.context.restore()};l.prototype.clear=function(a){var b=
this.getSize(),a=a||new f(0,0,b[0],b[1]);this.context.clearRect(a.left,a.top,a.width,a.height)};m.accessors(l.prototype,{rect:{get:function(){return this.getRect()}},context:{get:function(){return this._context}},canvas:{get:function(){return this._canvas}}});l.prototype.clone=function(){var a=new l(this.getRect());a.blit(this);return a};l.prototype.getAlpha=function(){return 1-this._blitAlpha};l.prototype.setAlpha=function(a){if(!isNaN(a)&&!(a<0||a>1))return this._blitAlpha=1-a,1-this._blitAlpha};
l.prototype.getImageData=function(){var a=this.getSize();return this.context.getImageData(0,0,a[0],a[1])};b.display=n("./gamejs/display");b.draw=n("./gamejs/draw");b.event=n("./gamejs/event");b.font=n("./gamejs/font");b.http=n("./gamejs/http");b.image=n("./gamejs/image");b.mask=n("./gamejs/mask");b.mixer=n("./gamejs/mixer");b.sprite=n("./gamejs/sprite");b.surfacearray=n("./gamejs/surfacearray");b.time=n("./gamejs/time");b.transform=n("./gamejs/transform");b.utils={arrays:n("./gamejs/utils/arrays"),
objects:n("./gamejs/utils/objects"),matrix:n("./gamejs/utils/matrix"),vectors:n("./gamejs/utils/vectors"),math:n("./gamejs/utils/math"),uri:n("./gamejs/utils/uri"),prng:n("./gamejs/utils/prng"),base64:n("./gamejs/utils/base64")};b.pathfinding={astar:n("./gamejs/pathfinding/astar")};b.worker=n("./gamejs/worker");b.xml=n("./gamejs/xml");b.tmx=n("./gamejs/tmx");b.noise=n("./gamejs/noise");var h=b,q={};b.ready=h.worker.inWorker===!0?function(a){n("./gamejs/worker")._ready();h.init();a()}:function(a){function b(){if(!document.body)return window.setTimeout(b,
50);f=h.image.preload(q);try{e=h.mixer.preload(q)}catch(a){h.debug("Error loading audio files ",a)}window.setTimeout(d,50)}function d(){if(f()<1||e()<1)return window.setTimeout(d,100);h.display.init();h.image.init();h.mixer.init();h.event.init();h.utils.prng.init();a()}var e=null,f=null;h.time.init();window.setTimeout(b,13);return function(){if(f)return 0.5*f()+0.5*e();return 0.1}};b.init=function(){var a={};["time","display","image","mixer","event"].forEach(function(b){try{h[b].init()}catch(d){a[b]=
d.toString()}});return a};b.preload=function(a){var b=n("./gamejs/utils/uri"),d=window.$g&&window.$g.resourceBaseHref||document.location.href;a.forEach(function(a){q[a]=b.resolve(d,a)},this)};b.onEvent=function(a,d){b.event._CALLBACK=new k(a,d)};b.onTick=function(a,d){b.time._CALLBACK=new k(a,d)}}},["gamejs/utils/matrix","gamejs/utils/objects","gamejs/callback","gamejs/display","gamejs/draw","gamejs/event","gamejs/font","gamejs/http","gamejs/image","gamejs/mask","gamejs/mixer","gamejs/sprite","gamejs/surfacearray",
"gamejs/time","gamejs/transform","gamejs/utils/arrays","gamejs/utils/vectors","gamejs/utils/math","gamejs/utils/uri","gamejs/utils/prng","gamejs/utils/base64","gamejs/pathfinding/astar","gamejs/worker","gamejs/xml","gamejs/tmx","gamejs/noise"]);
require.define({combatracer:function(n,b){var a=n("gamejs"),j=n("./renderer"),m=n("./utils");n("./levels");var k=n("./resources");n("./weapons");var g=n("./ui"),e=n("./uiscenes"),d=n("./settings"),f=n("./gamescenes"),l=n("./sounds"),h=n("./editor"),q=n("./garage"),c=n("./engine"),z=b.getDefCarDescr=function(a){return{type:a?a:"Sandbug",front_weapon:{type:"Machinegun",ammo_upgrades:0,damage_upgrades:0},util:null,rear_weapon:{type:"MineLauncher",ammo_upgrades:0,damage_upgrades:0},acc_upgrades:0,speed_upgrades:0,
armor_upgrades:0}};b.image_filenames=[];b.sound_filenames=[];b.get_preload_list=function(){var a=[],c;for(c=0;c<k.cars.length;c++)a[a.length]="images/cars/"+k.cars[c];for(c=0;c<k.tiles.length;c++)a[a.length]="images/tiles/"+k.tiles[c];for(c=0;c<k.props.length;c++)a[a.length]="images/props/"+k.props[c];for(c=0;c<k.animations.length;c++)a[a.length]="images/animations/"+k.animations[c];for(c=0;c<k.statics.length;c++)a[a.length]="images/static/"+k.statics[c];for(c=0;c<k.ui.length;c++)a[a.length]="images/ui/"+
k.ui[c];k.decals.forEach(function(b){a.push("images/decals/"+b)});b.image_filenames=a;a=[];if(d.get("SOUND"))k.sound_fx.forEach(function(b){a.push("sounds/fx/"+b)}),b.sound_filenames=a;return b.image_filenames.concat(b.sound_filenames)};var P=b.Director=function(b){var c=null;this.display=b;this.start=function(a){this.replaceScene(a)};this.replaceScene=function(a){c&&c.destroy&&c.destroy();c=a};this.getScene=function(){return c};a.onTick(function(a){c&&c.update&&c.update(a);c&&c.draw&&c.draw(b,a)});
a.onEvent(function(a){c&&c.handleEvent&&c.handleEvent(a)});return this},D=b.Communicator=function(b){this.game=b;this.next_transaction_id=1;this.messages=[];this.status="closed";this.queueMessage=function(a,b){this.messages[this.messages.length]=[a,b?b:{}];this.send()};this.send=function(){if(this.status=="open"){for(var a=0;a<this.messages.length;a++){var b={cmd:this.messages[a][0],uid:this.game.player.uid,payload:this.messages[a][1]},b=JSON.stringify(b);this.socket.send(b)}this.messages=[]}else if(this.status==
"closed")this.connect();else throw Error("unknown network status");};this.connect=function(){a.log("Connecting...");this.socket=new WebSocket(d.get("SERVER"),"banditracer");this.status="connecting";var b=this;this.socket.onopen=function(){b.onopen()};this.socket.onmessage=function(a){b.onmessage(a)};this.socket.onclose=function(){b.onclose()};this.socket.onerror=function(){b.onerror()}};this.onopen=function(){a.log("Connection established!");this.status="open";this.send()};this.onmessage=function(a){a=
JSON.parse(a.data);this.game.director.getScene().handleMessage(a.cmd,a.payload)};this.onclose=function(){this.status="closed";console.log(this.error?"socket closed on error ":"socket closed!");this.game.aquainted=!1;this.game.showTitle();this.game.player.uid=null;this.game.title_scene.alert(this.error?"Socket error, connection closed.":"Server closed the connection!");this.error=!1};this.error=!1;this.onerror=function(){this.socket.close();this.error=!0}};b.init=function(){b.game=new B;return b.game};
var B=b.Game=function(){this.director=null;this.cache=j.init();d.get("SOUND")&&(c.initialize_sounds(b.sound_filenames),l.init());g.init();this.socket=null;this.tried_loading=!1;this.player={alias:"Player",uid:null,singleplayer:{balance:d.get("STARTING_BALANCE"),difficulty:2,car:z(),league:d.get("STARTING_LEAGUE"),completed:!1,completed_tracks:[]}};this.communicator=null;this.acquainted=!1;this.getCommunicator=function(){if(!this.communicator)this.communicator=new D(this);return this.communicator};
this.start=function(a){this.display=a;this.director=new P(a);this.title_scene=new e.TitleScene(this,this.cache);this.director.start(this.title_scene)};this.showEndGameScene=function(a){this.director.replaceScene(new e.EndRaceScene(this,this.cache,a))};this.showTitle=function(){this.director.replaceScene(this.title_scene)};this.showCongratulations=function(){this.director.replaceScene(new e.CongratulationsScene)};this.createLobby=function(){this.director.replaceScene(new e.CreateLobbyScene(this,this.cache))};
this.showLobbyList=function(){this.director.replaceScene(new e.JoinLobbyScene(this,this.cache))};this.returnTo=function(){if(this.return_to)if(this.return_to=="editor"){this.return_to="";this.showEditor();return}else if(this.return_to=="singleplayer"){this.return_to="";this.singleplayer();return}this.showTitle()};this.showSPGameOver=function(a,b,c){this.director.replaceScene(new e.SPGameOverScene(a,b,c))};this.showEditor=function(){if(!this.editor_scene)this.editor_scene=new h.EditorScene;this.director.replaceScene(this.editor_scene)};
this.joinLobby=function(a){this.director.replaceScene(new e.LobbyScene(this,this.cache,a))};this.singleplayer=function(){this.director.replaceScene(new e.SinglePlayerScene(this,this.cache))};this.showGarage=function(a){this.director.replaceScene(new q.GarageScene(a))};this.showCarDealer=function(a){this.director.replaceScene(new q.BuyCarScene(a))};this.showSPGarage=function(){this.director.replaceScene(new q.GarageScene(this.player.singleplayer))};this.playMultiplayer=function(a){this.level_scene=
new f.MultiplayerLevelScene(this,a,this.cache);this.director.replaceScene(this.level_scene)};this.playLevel=function(a,b,c){this.level_scene=new f.SingleplayerLevelScene(a,b);this.return_to=c;this.director.replaceScene(new e.ControlsSplash(this,this.cache,this.level_scene))};this.cacheCarSprites=function(a){this.cache.cacheCarSprite("wheel.png");this.cache.cacheCarSprite("big_wheel.png");a.controllers.forEach(function(a){a=a.car;this.cache.cacheCarSprite(a.filename);[a.front_weapon,a.rear_weapon,
a.util].forEach(function(a){a&&a.pars.preload&&a.pars.preload.forEach(function(a){this.cache.cacheCarSprite(a)},this)},this)},this)};this.haveSave=function(){if(m.supports_html5_storage()&&localStorage.getItem("banditracer_save"))return!0;return!1};this.load=function(){if(m.supports_html5_storage()&&localStorage.getItem("banditracer_save")){var a=JSON.parse(localStorage.getItem("banditracer_save"));this.player.alias=a.alias;this.player.singleplayer=a.singleplayer;if(!this.player.singleplayer.difficulty)this.player.singleplayer.difficulty=
2;return!0}return!1};this.save=function(){if(m.supports_html5_storage()){var a=JSON.stringify({alias:this.player.alias,singleplayer:this.player.singleplayer});localStorage.setItem("banditracer_save",a);return!0}return!1}}}},["gamejs","renderer","utils","levels","resources","weapons","ui","uiscenes","settings","gamescenes","sounds","editor","garage","engine"]);
require.define({buffs:function(n,b){var a=n("gamejs"),j=n("./animation");n("./utils");var m=n("./engine"),k=b.EFFECT_NO_GRIP="no_grip",g=b.EFFECT_ENGINE="engine",e=b.EFFECT_INVULNERABLE="invulnerable",d=b.Buff=function(a){d.superConstructor.apply(this,[a]);this.age=0;this.duration=a.duration?a.duration:null;this.effect=a.effect;this.value=a.value;this.object=a.object;this.object.buffs.push(this)};a.utils.objects.extend(d,m.Object);d.prototype.update=function(a){this.age+=a;this.age>this.duration&&
this.world.destroy(this)};d.prototype.die=function(){for(var a=0;a<this.object.buffs.length;a++)if(this.object.buffs[a].id==this.id){this.object.buffs.splice(a,1);break}};d.prototype.process_hit=function(){return!0};var f=b.EngineBuff=function(a){a.effect=g;f.superConstructor.apply(this,[a])};a.utils.objects.extend(f,d);m.register_class(f);var l=b.SlipDebuff=function(a){a.effect=k;l.superConstructor.apply(this,[a])};a.utils.objects.extend(l,d);m.register_class(l);var h=b.InvulnerabilityBuff=function(a){a.effect=
e;a.duration=1;this.hits_left=3;h.superConstructor.apply(this,[a]);this.animation=new j.Animation({filename:"forcefield.png",duration:1E3,repeat:!0})};a.utils.objects.extend(h,d);m.register_class(h);h.prototype.update=function(a){this.animation.update(a)};h.prototype.process_hit=function(){this.hits_left--;this.hits_left==0&&this.world.destroy(this);return!1};h.prototype.draw=function(a){this.animation.draw(a,this.object.get_position())}}},["gamejs","animation","utils","engine"]);
